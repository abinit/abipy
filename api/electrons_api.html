<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>electrons Package &#8212; abipy 0.6.0.dev documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.6.0.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="eph Package" href="eph_api.html" />
    <link rel="prev" title="dynamics Package" href="dynamics_api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          abipy</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6.0.dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guide.html">Coding guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting AbiPy</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">electrons Package</a><ul>
<li><a class="reference internal" href="#id1"><code class="docutils literal"><span class="pre">electrons</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.bse"><code class="docutils literal"><span class="pre">bse</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.charges"><code class="docutils literal"><span class="pre">charges</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.ddk"><code class="docutils literal"><span class="pre">ddk</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.denpot"><code class="docutils literal"><span class="pre">denpot</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.ebands"><code class="docutils literal"><span class="pre">ebands</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.fatbands"><code class="docutils literal"><span class="pre">fatbands</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.fold2bloch"><code class="docutils literal"><span class="pre">fold2bloch</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.gsr"><code class="docutils literal"><span class="pre">gsr</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.gw"><code class="docutils literal"><span class="pre">gw</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.lobster"><code class="docutils literal"><span class="pre">lobster</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.optic"><code class="docutils literal"><span class="pre">optic</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.psps"><code class="docutils literal"><span class="pre">psps</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.scissors"><code class="docutils literal"><span class="pre">scissors</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.scr"><code class="docutils literal"><span class="pre">scr</span></code> Module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="dynamics_api.html" title="Previous Chapter: dynamics Package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; dynamics Package</span>
    </a>
  </li>
  <li>
    <a href="eph_api.html" title="Next Chapter: eph Package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">eph Package &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/electrons_api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="electrons-package">
<h1><a class="toc-backref" href="#contents">electrons Package</a><a class="headerlink" href="#electrons-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#electrons-package" id="id4">electrons Package</a><ul>
<li><a class="reference internal" href="#id1" id="id5"><code class="xref py py-mod docutils literal"><span class="pre">electrons</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.bse" id="id6"><code class="xref py py-mod docutils literal"><span class="pre">bse</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.charges" id="id7"><code class="xref py py-mod docutils literal"><span class="pre">charges</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.ddk" id="id8"><code class="xref py py-mod docutils literal"><span class="pre">ddk</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.denpot" id="id9"><code class="xref py py-mod docutils literal"><span class="pre">denpot</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.ebands" id="id10"><code class="xref py py-mod docutils literal"><span class="pre">ebands</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.fatbands" id="id11"><code class="xref py py-mod docutils literal"><span class="pre">fatbands</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.fold2bloch" id="id12"><code class="xref py py-mod docutils literal"><span class="pre">fold2bloch</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.gsr" id="id13"><code class="xref py py-mod docutils literal"><span class="pre">gsr</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.gw" id="id14"><code class="xref py py-mod docutils literal"><span class="pre">gw</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.lobster" id="id15"><code class="xref py py-mod docutils literal"><span class="pre">lobster</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.optic" id="id16"><code class="xref py py-mod docutils literal"><span class="pre">optic</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.psps" id="id17"><code class="xref py py-mod docutils literal"><span class="pre">psps</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.scissors" id="id18"><code class="xref py py-mod docutils literal"><span class="pre">scissors</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.electrons.scr" id="id19"><code class="xref py py-mod docutils literal"><span class="pre">scr</span></code> Module</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">electrons</span></code> Package</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.electrons"></span><p>This module provides classes and functions for the analysis of electronic properties.</p>
</div>
<div class="section" id="module-abipy.electrons.bse">
<span id="bse-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">bse</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.bse" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of BSE calculations</p>
<dl class="class">
<dt id="abipy.electrons.bse.DielectricTensor">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">DielectricTensor</code><span class="sig-paren">(</span><em>mdf</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the frequency-dependent macroscopic dielectric tensor
obtained from the dielectric functions for different q-directions.</p>
<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.to_array">
<code class="descname">to_array</code><span class="sig-paren">(</span><em>red_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with a copy of the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>red_coords</strong> – True for tensors in reduced coordinates else Cartesian.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.symmetrize">
<code class="descname">symmetrize</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.symmetrize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrize the tensor using the symmetry operations in structure.
Change the object in place.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.to_func1d">
<code class="descname">to_func1d</code><span class="sig-paren">(</span><em>red_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.to_func1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.to_func1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of Function.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all the components of the tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>red_coords</td>
<td>True to plot the reduced coordinate tensor (Default: True)</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricTensor.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>what</em>, <em>red_coords</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricTensor.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricTensor.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a></li>
<li><strong>what</strong> – Sequential index of the tensor matrix element.</li>
<li><strong>args</strong> – Positional arguments passed to <code class="docutils literal"><span class="pre">ax.plot</span></code></li>
<li><strong>kwargs</strong> – Keyword arguments passed to matplotlib. Accepts also:</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cplx_mode:</td>
<td><p class="first">string defining the data to print (case-insensitive).
Possible choices are:</p>
<blockquote>
<div><ul class="simple">
<li>“re”  for real part</li>
<li>“im” for imaginary part only.</li>
<li>“abs’ for the absolute value</li>
</ul>
</div></blockquote>
<p class="last">Options can be concated with “-“.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.DielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">DielectricFunction</code><span class="sig-paren">(</span><em>structure</em>, <em>qpoints</em>, <em>wmesh</em>, <em>emacros_q</em>, <em>info</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the frequency-dependent macroscopic dielectric function
computed for different q-directions in reciprocal space.</p>
<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em>, <em>with_info=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.num_qpoints">
<code class="descname">num_qpoints</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.num_qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of q-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.DielectricFunction.qfrac_coords">
<code class="descname">qfrac_coords</code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with the fractional coordinates of the q-points.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the MDF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>only_mean</td>
<td>True if only the averaged spectrum is wanted (default True)</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.DielectricFunction.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>qpoint=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a></li>
<li><strong>qpoint</strong> – index of the q-point or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object or None to plot emacro_avg.</li>
<li><strong>kwargs</strong> – <p>Keyword arguments passed to matplotlib. Accepts also:</p>
<dl class="docutils">
<dt>cplx_mode:</dt>
<dd>string defining the data to print (case-insensitive).
Possible choices are<blockquote>
<div><ul>
<li>”re”  for real part</li>
<li>”im” for imaginary part only.</li>
<li>”abs’ for the absolute value</li>
</ul>
</div></blockquote>
<p class="last">Options can be concated with “-“.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">MdfFile</span><span class="p">(</span><span class="s2">&quot;foo_MDF.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mdf</span><span class="p">:</span>
    <span class="n">mdf</span><span class="o">.</span><span class="n">plot_mdfs</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-5d155c8133dd5aa26bc7646cf79c827f80a2063d.png" alt="Inheritance diagram of MdfFile" usemap="#inheritance6a7e4af0c2" class="inheritance"/>
<map id="inheritance6a7e4af0c2" name="inheritance6a7e4af0c2">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="243,101,441,125"/>
<area shape="rect" id="node5" href="#abipy.electrons.bse.MdfFile" target="_top" title="Usage example:" alt="" coords="500,53,682,77"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,101,184,125"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="236,5,448,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="232,53,452,77"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.bse.MdfFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.structure">
<code class="descname">structure</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.exc_mdf">
<code class="descname">exc_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.exc_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Excitonic macroscopic dieletric function.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.rpanlf_mdf">
<code class="descname">rpanlf_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.rpanlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA dielectric function without local-field effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.gwnlf_mdf">
<code class="descname">gwnlf_mdf</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.gwnlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA-GW dielectric function without local-field effects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.qpoints">
<code class="descname">qpoints</code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.qfrac_coords">
<code class="descname">qfrac_coords</code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with the fractional coordinates of the q-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters that are usually tested for convergence.
Used to build Pandas dataframes in Robots.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.get_mdf">
<code class="descname">get_mdf</code><span class="sig-paren">(</span><em>mdf_type='exc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Returns the macroscopic dielectric function.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.plot_mdfs">
<code class="descname">plot_mdfs</code><span class="sig-paren">(</span><em>cplx_mode='Im'</em>, <em>mdf_type='all'</em>, <em>qpoint=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.plot_mdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.plot_mdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macroscopic dielectric function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cplx_mode</strong> – <p>string defining the data to print (case-insensitive).
Possible choices are</p>
<blockquote>
<div><ul>
<li>”re”  for real part</li>
<li>”im” for imaginary part only.</li>
<li>”abs’ for the absolute value</li>
</ul>
</div></blockquote>
<p>Options can be concated with “-“.</p>
</li>
<li><strong>mdf_type</strong> – <p>Select the type of macroscopic dielectric function.
Possible choices are</p>
<blockquote>
<div><ul>
<li>”exc” for the MDF with excitonic effects.</li>
<li>”rpa” for RPA with KS energies.</li>
<li>”gwrpa” for RPA with GW (or KS-corrected) results</li>
<li>”all” if all types are wanted.</li>
</ul>
</div></blockquote>
<p>Options can be concated with “-“.</p>
</li>
<li><strong>qpoint</strong> – index of the q-point or Kpoint object or None to plot emacro_avg.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.get_tensor">
<code class="descname">get_tensor</code><span class="sig-paren">(</span><em>mdf_type='exc'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the macroscopic dielectric tensor from the MDF.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfReader</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads data from the MDF.nc file produced by ABINIT.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-d1d94a7663c9d2711f80355251343f12e523f6a9.png" alt="Inheritance diagram of MdfReader" usemap="#inheritance83fb40235f" class="inheritance"/>
<map id="inheritance83fb40235f" name="inheritance83fb40235f">
<area shape="rect" id="node1" href="#abipy.electrons.bse.MdfReader" target="_top" title="This object reads data from the MDF.nc file produced by ABINIT." alt="" coords="615,4,764,21"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="447,4,580,21"/>
<area shape="rect" id="node3" title="This object reads data from a file written according to the ETSF&#45;IO specifications." alt="" coords="224,4,412,21"/>
<area shape="rect" id="node4" title="Wraps and extends netCDF4.Dataset. Read only mode. Supports with statements." alt="" coords="4,4,190,21"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.bse.MdfReader.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.qpoints">
<code class="descname">qpoints</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.qpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points (ndarray).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MdfReader.wmesh">
<code class="descname">wmesh</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.wmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The frequency mesh in eV.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_params">
<code class="descname">read_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters of the run.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_exc_mdf">
<code class="descname">read_exc_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_exc_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the excitonic MDF.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_rpanlf_mdf">
<code class="descname">read_rpanlf_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_rpanlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the KS-RPA MDF without LF effects.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfReader.read_gwnlf_mdf">
<code class="descname">read_gwnlf_mdf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_gwnlf_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the GW-RPA MDF without LF effects.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MdfPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MdfPlotter</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class for plotting Macroscopic dielectric functions.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MdfPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf</span><span class="p">(</span><span class="s2">&quot;EXC&quot;</span><span class="p">,</span> <span class="n">exc_mdf</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf</span><span class="p">(</span><span class="s2">&quot;KS-RPA&quot;</span><span class="p">,</span> <span class="n">rpanlf_mdf</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.electrons.bse.MdfPlotter.add_mdf">
<code class="descname">add_mdf</code><span class="sig-paren">(</span><em>label</em>, <em>mdf</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.add_mdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.add_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal"><span class="pre">DielectricFunction</span></code></a> for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – name for the MDF. Must be unique.</li>
<li><strong>mdf</strong> – <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal"><span class="pre">DielectricFunction</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MdfPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>cplx_mode='Im'</em>, <em>qpoint=None</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a matplotlib plot showing the MDFs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>cplx_mode</strong> – string defining the data to print (case-insensitive).
Possible choices are <code class="docutils literal"><span class="pre">re</span></code> for the real part, <code class="docutils literal"><span class="pre">im</span></code> for imaginary part only. <code class="docutils literal"><span class="pre">abs</span></code> for the absolute value.
Options can be concated with “-“.</li>
<li><strong>qpoint</strong> – index of the q-point or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object or None to plot emacro_avg.</li>
<li><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – Same meaning as <code class="docutils literal"><span class="pre">ylims</span></code> but for the y-axis</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.bse.MultipleMdfPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.bse.</code><code class="descname">MultipleMdfPlotter</code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class for plotting multipe macroscopic dielectric functions
extracted from several MDF.nc files</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MultipleMdfPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_file</span><span class="p">(</span><span class="s2">&quot;file1&quot;</span><span class="p">,</span> <span class="n">mdf_file1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_file</span><span class="p">(</span><span class="s2">&quot;file2&quot;</span><span class="p">,</span> <span class="n">mdf_file2</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPES">
<code class="descname">MDF_TYPES</code><em class="property"> = ('exc', 'rpa', 'gwrpa')</em><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPECPLX2TEX">
<code class="descname">MDF_TYPECPLX2TEX</code><em class="property"> = {'exc': {'re': '$\\Re(\\varepsilon_{exc})$', 'im': '$\\Im(\\varepsilon_{exc}$)', 'abs': '$|\\varepsilon_{exc}|$'}, 'rpa': {'re': '$\\Re(\\varepsilon_{rpa})$', 'im': '$\\Im(\\varepsilon_{rpa})$', 'abs': '$|\\varepsilon_{rpa}|$'}, 'gwrpa': {'re': '$\\Re(\\varepsilon_{gw-rpa})$', 'im': '$\\Im(\\varepsilon_{gw-rpa})$', 'abs': '$|\\varepsilon_{gw-rpa}|$'}}</em><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPECPLX2TEX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.add_mdf_file">
<code class="descname">add_mdf_file</code><span class="sig-paren">(</span><em>label</em>, <em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.add_mdf_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.add_mdf_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract dielectric functions from object <code class="docutils literal"><span class="pre">obj</span></code>, store data for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> – label associated to the MDF file. Must be unique.</li>
<li><strong>mdf</strong> – filepath or <a class="reference internal" href="#abipy.electrons.bse.MdfFile" title="abipy.electrons.bse.MdfFile"><code class="xref py py-class docutils literal"><span class="pre">MdfFile</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>mdf_type='exc'</em>, <em>qview='avg'</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all macroscopic dielectric functions (MDF) stored in the plotter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mdf_type</strong> – Selects the type of dielectric function.
“exc” for the MDF with excitonic effects.
“rpa” for RPA with KS energies.
“gwrpa” for RPA with GW (or KS-corrected) results.</li>
<li><strong>qview</strong> – “avg” to plot the results averaged over q-points. “all” to plot q-point dependence.</li>
<li><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – Same meaning as <cite>ylims</cite> but for the y-axis</li>
<li><strong>fontsize</strong> – fontsize for titles and legend.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.plot_mdftype_cplx">
<code class="descname">plot_mdftype_cplx</code><span class="sig-paren">(</span><em>mdf_type</em>, <em>cplx_mode</em>, <em>qpoint=None</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>with_legend=True</em>, <em>with_xlabel=True</em>, <em>with_ylabel=True</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.plot_mdftype_cplx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.plot_mdftype_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data corresponds to <code class="docutils literal"><span class="pre">mdf_type</span></code>, <code class="docutils literal"><span class="pre">cplx_mode</span></code>, <code class="docutils literal"><span class="pre">qpoint</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>mdf_type</strong> – </li>
<li><strong>cplx_mode</strong> – string defining the data to print (case-insensitive).
Possible choices are <cite>re</cite> for the real part, <cite>im</cite> for imaginary part only. <cite>abs</cite> for the absolute value.</li>
<li><strong>qpoint</strong> – index of the q-point or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object or None to plot emacro_avg.</li>
<li><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – Same meaning as <cite>ylims</cite> but for the y-axis</li>
<li><strong>with_legend</strong> – True if legend should be added</li>
<li><strong>with_xlabel</strong> – </li>
<li><strong>with_ylabel</strong> – </li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.ipw_select_plot">
<code class="descname">ipw_select_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.ipw_select_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.charges">
<span id="charges-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">charges</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.charges" title="Permalink to this headline">¶</a></h2>
<p>HirshfeldCharges.</p>
<dl class="class">
<dt id="abipy.electrons.charges.HirshfeldCharges">
<em class="property">class </em><code class="descclassname">abipy.electrons.charges.</code><code class="descname">HirshfeldCharges</code><span class="sig-paren">(</span><em>electron_charges</em>, <em>structure</em>, <em>reference_charges=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.charges.Charges</span></code></p>
<p>Class representing the charges obtained from the Hirshfeld analysis.
The charges refer to the total charges for each atom (i.e. Z-n_electrons).
An eccess of electron has a negative charge</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-587716eb987e5c3e674bb2383098b34c2a0d8631.png" alt="Inheritance diagram of HirshfeldCharges" usemap="#inheritancee626124432" class="inheritance"/>
<map id="inheritancee626124432" name="inheritancee626124432">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="5,5,208,28"/>
<area shape="rect" id="node2" title="Base charges class, describing the atomic charges in a DFT calculation." alt="" coords="254,5,460,28"/>
<area shape="rect" id="node3" href="#abipy.electrons.charges.HirshfeldCharges" target="_top" title="Class representing the charges obtained from the Hirshfeld analysis." alt="" coords="506,5,763,28"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile">
<em class="property">classmethod </em><code class="descname">from_cut3d_outfile</code><span class="sig-paren">(</span><em>filepath</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges.from_cut3d_outfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a HirshfeldCharges object from the outputfile of cut3d and a structure.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.charges.BaderCharges">
<em class="property">class </em><code class="descclassname">abipy.electrons.charges.</code><code class="descname">BaderCharges</code><span class="sig-paren">(</span><em>electron_charges</em>, <em>structure</em>, <em>reference_charges=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#BaderCharges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.BaderCharges" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.charges.Charges</span></code></p>
<p>Class representing the charges obtained from the Bader analysis.
TThe charges refer to the total charges for each atom (i.e. Z-n_electrons).
An eccess of electron has a negative charge</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-f5364e04769b80ebb273fbdbdd596f86234b591b.png" alt="Inheritance diagram of BaderCharges" usemap="#inheritance3e58e8140e" class="inheritance"/>
<map id="inheritance3e58e8140e" name="inheritance3e58e8140e">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="5,5,213,29"/>
<area shape="rect" id="node3" title="Base charges class, describing the atomic charges in a DFT calculation." alt="" coords="260,5,470,29"/>
<area shape="rect" id="node2" href="#abipy.electrons.charges.BaderCharges" target="_top" title="Class representing the charges obtained from the Bader analysis." alt="" coords="517,5,763,29"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.charges.BaderCharges.from_files">
<em class="property">classmethod </em><code class="descname">from_files</code><span class="sig-paren">(</span><em>density_path</em>, <em>pseudopotential_paths</em>, <em>with_core=True</em>, <em>workdir=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#BaderCharges.from_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.charges.BaderCharges.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the abinit density files and the <a class="reference external" href="http://theory.cm.utexas.edu/henkelman/code/bader/">bader</a> executable from Henkelmann et al. to calculate
the bader charges of the system. If pseudopotentials are given, the atomic charges will be
extracted as well. See also <a class="reference internal" href="../zzbiblio.html#henkelman2006" id="id2">[Henkelman2006]</a>.</p>
<p>The extraction of the core charges may be a time consuming calculation, depending on the
size of the system. A tuning of the parameters may be required (see Density.ae_core_density_on_mesh).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>density_path</strong> – Path to the abinit density file. Can be a fortran _DEN or a netCDF DEN.nc file.
In case of fortran file, requires cut3d (version &gt;= 8.6.1) for the convertion.</li>
<li><strong>pseudopotential_paths</strong> – Dictionary {element: pseudopotential path} for all the elements present
in the system.</li>
<li><strong>with_core</strong> – Core charges will be extracted from the pseudopotentials with the
Density.ae_core_density_on_mesh method. Requires pseudopotential_paths.</li>
<li><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</li>
<li><strong>kwargs</strong> – arguments passed to the method <code class="docutils literal"><span class="pre">Density.ae_core_density_on_mesh</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An instance of <a class="reference internal" href="#abipy.electrons.charges.BaderCharges" title="abipy.electrons.charges.BaderCharges"><code class="xref py py-class docutils literal"><span class="pre">BaderCharges</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.ddk">
<span id="ddk-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">ddk</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.ddk" title="Permalink to this headline">¶</a></h2>
<p>DDK.nc file.</p>
<dl class="class">
<dt id="abipy.electrons.ddk.DdksAnalyzer">
<em class="property">class </em><code class="descclassname">abipy.electrons.ddk.</code><code class="descname">DdksAnalyzer</code><span class="sig-paren">(</span><em>ddk_paths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object received three ddks files with derivatives along the 3 reduced directions.</p>
<dl class="method">
<dt id="abipy.electrons.ddk.DdksAnalyzer.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ddk.DdksAnalyzer.v_skb">
<code class="descname">v_skb</code><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer.v_skb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer.v_skb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdksAnalyzer.get_doses">
<code class="descname">get_doses</code><span class="sig-paren">(</span><em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer.get_doses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer.get_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdksAnalyzer.plot_vdos">
<code class="descname">plot_vdos</code><span class="sig-paren">(</span><em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer.plot_vdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer.plot_vdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdksAnalyzer.plot_ebands_with_doses">
<code class="descname">plot_ebands_with_doses</code><span class="sig-paren">(</span><em>ebands_kpath</em>, <em>doses</em>, <em>ylims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdksAnalyzer.plot_ebands_with_doses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdksAnalyzer.plot_ebands_with_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot band structure and doses</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ebands_kpath</strong> – </li>
<li><strong>doses</strong> – </li>
<li><strong>ylims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ddk.DdkFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.ddk.</code><code class="descname">DdkFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>File containing the DDK matrix elements for a single <cite>idir</cite> direction</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DdkFile</span><span class="p">(</span><span class="s2">&quot;out_DDK.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ddk</span><span class="p">:</span>
    <span class="n">ddk</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="abipy.electrons.ddk.DdkFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdkFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ddk.DdkFile.ebands">
<code class="descname">ebands</code><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ddk.DdkFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ddk.DdkFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdkFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdkFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdkFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em>, <em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ddk.DdkReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.ddk.</code><code class="descname">DdkReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronsReader</span></code></p>
<p>This object reads the results stored in the DDK.nc file
It provides helper function to access the most important quantities.</p>
<dl class="method">
<dt id="abipy.electrons.ddk.DdkReader.read_ddk_diagonal">
<code class="descname">read_ddk_diagonal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkReader.read_ddk_diagonal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkReader.read_ddk_diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the group velocities i.e the diagonal matrix elements.
Return (nsppol, nkpt) <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of real numbers.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ddk.DdkReader.read_ddk_skbb">
<code class="descname">read_ddk_skbb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ddk.html#DdkReader.read_ddk_skbb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ddk.DdkReader.read_ddk_skbb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.denpot">
<span id="denpot-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">denpot</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.denpot" title="Permalink to this headline">¶</a></h2>
<p>Density/potential files in netcdf/fortran format.</p>
<dl class="class">
<dt id="abipy.electrons.denpot.DensityNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">DensityNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p>Netcdf File containing the electronic density.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DensityNcFile</span><span class="p">(</span><span class="s2">&quot;foo_DEN.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">density</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-7f9fe360992b40b9709e47dbbe63090bd532eb54.png" alt="Inheritance diagram of DensityNcFile" usemap="#inheritancecb81189ead" class="inheritance"/>
<map id="inheritancecb81189ead" name="inheritancecb81189ead">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.DensityNcFile" target="_top" title="Netcdf File containing the electronic density." alt="" coords="5,5,246,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.field_name">
<code class="descname">field_name</code><em class="property"> = 'density'</em><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.density">
<code class="descname">density</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.density" title="Permalink to this definition">¶</a></dt>
<dd><p>Density object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_chgcar">
<code class="descname">write_chgcar</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_chgcar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_chgcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in CHGCAR format. Return <code class="xref py py-class docutils literal"><span class="pre">ChgCar</span></code> instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_xsf">
<code class="descname">write_xsf</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_xsf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_xsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in XSF format (<a class="reference external" href="http://www.xcrysden.org/">xcrysden</a>)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_cube">
<code class="descname">write_cube</code><span class="sig-paren">(</span><em>filename=None</em>, <em>spin='total'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in CUBE format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.denpot.VhartreeNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">VhartreeNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhartreeNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-ed96689f4cffde3172a6ca409ca1ef5da62a9d18.png" alt="Inheritance diagram of VhartreeNcFile" usemap="#inheritance1dea356815" class="inheritance"/>
<map id="inheritance1dea356815" name="inheritance1dea356815">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VhartreeNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,252,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.denpot.VhartreeNcFile.field_name">
<code class="descname">field_name</code><em class="property"> = 'vh'</em><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.VhartreeNcFile.vh">
<code class="descname">vh</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhartreeNcFile.vh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile.vh" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree potential.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.denpot.VxcNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">VxcNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VxcNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-55ccc8ba6129d765b948e489aa2fb2e75ee16417.png" alt="Inheritance diagram of VxcNcFile" usemap="#inheritancef4842e950b" class="inheritance"/>
<map id="inheritancef4842e950b" name="inheritancef4842e950b">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VxcNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,224,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.denpot.VxcNcFile.field_name">
<code class="descname">field_name</code><em class="property"> = 'vxc'</em><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.VxcNcFile.vxc">
<code class="descname">vxc</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VxcNcFile.vxc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile.vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>XC potential.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.denpot.VhxcNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">VhxcNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhxcNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-dc5aada5a3d8e45854f30112dadb84d87096b51a.png" alt="Inheritance diagram of VhxcNcFile" usemap="#inheritance0226348494" class="inheritance"/>
<map id="inheritance0226348494" name="inheritance0226348494">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VhxcNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,231,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.denpot.VhxcNcFile.field_name">
<code class="descname">field_name</code><em class="property"> = 'vhxc'</em><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.VhxcNcFile.vhxc">
<code class="descname">vhxc</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhxcNcFile.vhxc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile.vhxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree + XC potential.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.denpot.PotNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.denpot.</code><code class="descname">PotNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#PotNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-a05abd8a0c6eb853e24fd232dfd9b1a9e7eadd00.png" alt="Inheritance diagram of PotNcFile" usemap="#inheritance0c0dcb3aa1" class="inheritance"/>
<map id="inheritance0c0dcb3aa1" name="inheritance0c0dcb3aa1">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.PotNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,221,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.denpot.PotNcFile.field_name">
<code class="descname">field_name</code><em class="property"> = 'vks'</em><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.denpot.PotNcFile.vks">
<code class="descname">vks</code><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#PotNcFile.vks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile.vks" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree + XC potential + sum of local pseudo-potential terms.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.ebands">
<span id="ebands-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">ebands</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.ebands" title="Permalink to this headline">¶</a></h2>
<p>Classes to analyse electronic structures.</p>
<dl class="class">
<dt id="abipy.electrons.ebands.ElectronBands">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronBands</code><span class="sig-paren">(</span><em>structure</em>, <em>kpoints</em>, <em>eigens</em>, <em>fermie</em>, <em>occfacts</em>, <em>nelect</em>, <em>nspinor</em>, <em>nspden</em>, <em>nband_sk=None</em>, <em>smearing=None</em>, <em>linewidths=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>Object storing the electron band structure.</p>
<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.fermie">
<code class="descname">fermie</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi level in eV. Note that, if the band structure has been computed
with a NSCF run, fermie corresponds to the fermi level obtained
in the SCF run that produced the density used for the band structure calculation.</p>
</dd></dl>

<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-e6132e403cdff59e1e92ee38a82b0ebcc882c4ed.png" alt="Inheritance diagram of ElectronBands" usemap="#inheritance5d51cbb43e" class="inheritance"/>
<map id="inheritance5d51cbb43e" name="inheritance5d51cbb43e">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="5,5,218,29"/>
<area shape="rect" id="node2" href="#abipy.electrons.ebands.ElectronBands" target="_top" title="Object storing the electron band structure." alt="" coords="266,5,514,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ElectronBandsError</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.pad_fermie">
<code class="descname">pad_fermie</code><em class="property"> = 0.001</em><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.pad_fermie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> from the netCDF file <code class="docutils literal"><span class="pre">filepath</span></code>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct object from dictionary <code class="docutils literal"><span class="pre">d</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary with <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> serialization.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.as_ebands">
<em class="property">classmethod </em><code class="descname">as_ebands</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> from a generic object <cite>obj</cite>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li>instances of cls</li>
<li>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</li>
<li>objects providing an <cite>ebands</cite> attribute</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_mpid">
<em class="property">classmethod </em><code class="descname">from_mpid</code><span class="sig-paren">(</span><em>material_id</em>, <em>api_key=None</em>, <em>endpoint=None</em>, <em>nelect=None</em>, <em>has_timerev=True</em>, <em>nspinor=1</em>, <em>nspden=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_mpid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_mpid" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bandstructure data corresponding to a materials project <code class="docutils literal"><span class="pre">material_id</span></code>.
and return Abipy ElectronBands object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>material_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Materials Project material_id (a string, e.g., mp-1234).</li>
<li><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in
your .pmgrc.yaml. If so, it will use that environment
This makes easier for heavy users to simply add
this environment variable to their setups and MPRester can
then be called without any arguments.</li>
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</li>
<li><strong>nelect</strong> – Number of electrons in the unit cell.</li>
<li><strong>nspinor</strong> – Number of spinor components.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_json">
<code class="descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> string representation of the MSONable object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.spins">
<code class="descname">spins</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spins" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin range</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.nband">
<code class="descname">nband</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.nband" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.kidxs">
<code class="descname">kidxs</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kidxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Range with the index of the k-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.eigens">
<code class="descname">eigens</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues in eV. <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.linewidths">
<code class="descname">linewidths</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>linewidths in eV. <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_linewidths">
<code class="descname">has_linewidths</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>True if bands with linewidths.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.occfacts">
<code class="descname">occfacts</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.occfacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Occupation factors. <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.reciprocal_lattice">
<code class="descname">reciprocal_lattice</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2018.8.10)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.core.lattice.Lattice</span></code></a> with the reciprocal lattice vectors in Angstrom.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.shape">
<code class="descname">shape</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the array with the eigenvalues.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_metallic_scheme">
<code class="descname">has_metallic_scheme</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_metallic_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are using a metallic scheme for occupancies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie_to_vbm">
<code class="descname">set_fermie_to_vbm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie_to_vbm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie_to_vbm" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Fermi energy to the valence band maximum (VBM).
Useful when the initial fermie energy comes from a GS-SCF calculation
that underestimates the Fermi energy because e.g. the IBZ sampling
is shifted whereas the true VMB is at Gamma.</p>
<p>Return: New fermi energy in eV.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie_from_edos">
<code class="descname">set_fermie_from_edos</code><span class="sig-paren">(</span><em>edos</em>, <em>nelect=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie_from_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie_from_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Fermi level using the integrated DOS computed in edos.</p>
<blockquote>
<div><dl class="docutils">
<dt>Args:</dt>
<dd>edos: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.
nelect: Number of electrons. If None, the number of electrons in self. is used</dd>
</dl>
</div></blockquote>
<p>Return: New fermi energy in eV.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie">
<code class="descname">set_fermie</code><span class="sig-paren">(</span><em>new_fermie</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the new fermi energy. Return new value</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.with_points_along_path">
<code class="descname">with_points_along_path</code><span class="sig-paren">(</span><em>frac_bounds=None</em>, <em>knames=None</em>, <em>dist_tol=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.with_points_along_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.with_points_along_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Build new <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object containing the k-points along the
input k-path specified by <cite>frac_bounds</cite>. Useful to extract energies along a path
from calculation performed in the IBZ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>frac_bounds</strong> – [M, 3] array  with the vertexes of the k-path in reduced coordinates.
If None, the k-path is automatically selected from the structure.</li>
<li><strong>knames</strong> – List of strings with the k-point labels defining the k-path. It has precedence over frac_bounds.</li>
<li><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>namedtuple with the following attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ebands</span><span class="p">:</span> <span class="o">|</span><span class="n">ElectronBands</span><span class="o">|</span> <span class="nb">object</span><span class="o">.</span>
<span class="n">ik_new2prev</span><span class="p">:</span> <span class="n">Correspondence</span> <span class="n">between</span> <span class="n">the</span> <span class="n">k</span><span class="o">-</span><span class="n">points</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">new</span> <span class="n">ebands</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">kpoint</span>
    <span class="n">of</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">band</span> <span class="n">structure</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_dict4pandas">
<code class="descname">get_dict4pandas</code><span class="sig-paren">(</span><em>with_geo=True</em>, <em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_dict4pandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_dict4pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with the most important parameters:</p>
<blockquote>
<div><ul class="simple">
<li>Chemical formula and number of atoms.</li>
<li>Lattice lengths, angles and volume.</li>
<li>The spacegroup number computed by Abinit (set to None if not available).</li>
<li>The spacegroup number and symbol computed by spglib (set to None not <cite>with_spglib</cite>).</li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_geo</strong> – True if structure info should be added to the dataframe</li>
<li><strong>with_spglib</strong> – If True, <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> is invoked to get the spacegroup symbol and number.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzmesh">
<code class="descname">has_bzmesh</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_bzmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the k-point sampling is homogeneous.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzpath">
<code class="descname">has_bzpath</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_bzpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzpath" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the bands are computed on a k-path.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.kptopt">
<code class="descname">kptopt</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kptopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kptopt" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of the kptopt input variable.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.has_timrev">
<code class="descname">has_timrev</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_timrev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_timrev" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time-reversal symmetry is used in the BZ sampling.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.kindex">
<code class="descname">kindex</code><span class="sig-paren">(</span><em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kindex" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the k-point in the internal list of k-points.
Accepts: <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.skb_iter">
<code class="descname">skb_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.skb_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.skb_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over (spin, k, band) indices.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.degeneracies">
<code class="descname">degeneracies</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>bands_range</em>, <em>tol_ediff=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.degeneracies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.degeneracies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with the indices of the degenerate bands.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – K-point index or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object</li>
<li><strong>bands_range</strong> – List of band indices to analyze.</li>
<li><strong>tol_ediff</strong> – Tolerance on the energy difference (in eV)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of tuples [(e0, bands_e0), (e1, bands_e1, ….]
Each tuple stores the degenerate energy and a list with the band indices.
The band structure of silicon at Gamma, for example, will produce something like:
[(-6.3, [0]), (5.6, [1, 2, 3]), (8.1, [4, 5, 6])]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.enemin">
<code class="descname">enemin</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the eigenvalues.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.enemax">
<code class="descname">enemax</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemax" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the maximum of the eigenvalues.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.dispersionless_states">
<code class="descname">dispersionless_states</code><span class="sig-paren">(</span><em>erange=None</em>, <em>deltae=0.05</em>, <em>kfact=0.9</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.dispersionless_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.dispersionless_states" title="Permalink to this definition">¶</a></dt>
<dd><p>This function detects dispersionless states.
A state is dispersionless if there are more that (nkpt * kfact) energies
in the energy intervale [e0 - deltae, e0 + deltae]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>range to be analyzed in the form</strong><strong> [</strong><strong>emin</strong><strong>, </strong><strong>emax</strong><strong>]</strong> (<em>erange=Energy</em>) – </li>
<li><strong>deltae</strong> – Defines the energy interval in eV around the KS eigenvalue.</li>
<li><strong>kfact</strong> – Can be used to change the criterion used to detect dispersionless states.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code> objects. Each item contains information on
the energy, the occupation and the location of the dispersionless band.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_dataframe">
<code class="descname">get_dataframe</code><span class="sig-paren">(</span><em>e0='fermie'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div>[‘spin’, ‘kidx’, ‘band’, ‘eig’, ‘occ’, ‘kpoint’]</div></blockquote>
<p>where:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>spin</td>
<td>spin index</td>
</tr>
<tr class="row-odd"><td>kidx</td>
<td>k-point index</td>
</tr>
<tr class="row-even"><td>band</td>
<td>band index</td>
</tr>
<tr class="row-odd"><td>eig</td>
<td>KS eigenvalue in eV.</td>
</tr>
<tr class="row-even"><td>occ</td>
<td>Occupation of the state.</td>
</tr>
<tr class="row-odd"><td>kpoint</td>
<td><code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0
The Fermi energy is saved in frame.fermie</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>e0='fermie'</em>, <em>brange=None</em>, <em>swarm=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV.
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li><strong>brange</strong> – Only bands such as <code class="docutils literal"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronBands.from_pymatgen">
<em class="property">classmethod </em><code class="descname">from_pymatgen</code><span class="sig-paren">(</span><em>pmg_bands</em>, <em>nelect</em>, <em>weights=None</em>, <em>has_timerev=True</em>, <em>ksampling=None</em>, <em>smearing=None</em>, <em>nspinor=1</em>, <em>nspden=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pymatgen bandstructure object to an Abipy <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pmg_bands</strong> – pymatgen bandstructure object.</li>
<li><strong>nelect</strong> – Number of electrons in unit cell.</li>
<li><strong>weights</strong> – List of K-points weights (normalized to one, same order as pmg_bands.kpoints).
This argument is optional but recommended when <code class="docutils literal"><span class="pre">pmg_bands</span></code> represents an IBZ sampling.
If weights are not provided, Abipy methods requiring integrations in the BZ won’t work.</li>
<li><strong>has_timerev</strong> – True if time-reversal symmetry can be used.</li>
<li><strong>ksampling</strong> – dictionary with parameters passed to <code class="xref py py-class docutils literal"><span class="pre">KSamplingInfo</span></code> defining the k-points sampling.
If None, hard-coded values are used. This argument is recommended if IBZ sampling.</li>
<li><strong>smearing</strong> – dictionary with parameters passed to <code class="xref py py-class docutils literal"><span class="pre">Smearing</span></code>
If None, default hard-coded values are used.</li>
<li><strong>nspinor</strong> – Number of spinor components.</li>
<li><strong>nspden</strong> – Number of independent spin-density components.
If None, nspden is automatically computed from nsppol</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The Abipy bandstructure contains more information than the pymatgen object so
the conversion is not complete, especially if you rely on the default values.
Please read carefylly the docstring and the code and use the optional arguments to pass
additional data required by AbiPy if you need a complete conversion.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_pymatgen">
<code class="descname">to_pymatgen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_pymatgen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pymatgen bandstructure object from an Abipt <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.lomos">
<code class="descname">lomos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomos" title="Permalink to this definition">¶</a></dt>
<dd><p>lomo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.lomo_sk">
<code class="descname">lomo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lomo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LOMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index</li>
<li><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.homo_sk">
<code class="descname">homo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.homo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the HOMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index</li>
<li><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.lumo_sk">
<code class="descname">lumo_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lumo_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LUMO state for the given spin, kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index</li>
<li><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.homos">
<code class="descname">homos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homos" title="Permalink to this definition">¶</a></dt>
<dd><p>homo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.lumos">
<code class="descname">lumos</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumos" title="Permalink to this definition">¶</a></dt>
<dd><p>lumo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.bandwidths">
<code class="descname">bandwidths</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.bandwidths" title="Permalink to this definition">¶</a></dt>
<dd><p>The bandwidth for each spin channel i.e. the energy difference (homo - lomo).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.fundamental_gaps">
<code class="descname">fundamental_gaps</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fundamental_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal"><span class="pre">ElectronTransition</span></code> with info on the fundamental gaps for each spin.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBands.direct_gaps">
<code class="descname">direct_gaps</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.direct_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <cite>nsppol</cite> <code class="xref py py-class docutils literal"><span class="pre">ElectronTransition</span></code> with info on the direct gaps for each spin.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_gaps_string">
<code class="descname">get_gaps_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_gaps_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_gaps_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with info about fundamental and direct gap (if not metallic scheme)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>title=None</em>, <em>with_structure=True</em>, <em>with_kpoints=False</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful info such as band gaps, position of HOMO, LOMO…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_structure</strong> – False if structural info shoud not be displayed.</li>
<li><strong>with_kpoints</strong> – False if k-point info shoud not be displayed.</li>
<li><strong>verbose</strong> – Verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.new_with_irred_kpoints">
<code class="descname">new_with_irred_kpoints</code><span class="sig-paren">(</span><em>prune_step=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.new_with_irred_kpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.new_with_irred_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object in which only the irreducible k-points are kept.
This method is mainly used to prepare the band structure interpolation as the interpolator
will likely fail if the input k-path contains symmetrical k-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>prune_step</strong> – Optional argument used to select a subset of the irreducible points found.</li>
<li><strong>prune_step is None</strong><strong>, </strong><strong>all irreducible k-points are used.</strong> (<em>If</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.spacing">
<code class="descname">spacing</code><span class="sig-paren">(</span><em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.spacing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the statistical parameters of the energy spacing, i.e. e[b+1] - e[b]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">namedtuple</span></code> with the statistical parameters in eV</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.statdiff">
<code class="descname">statdiff</code><span class="sig-paren">(</span><em>other</em>, <em>axis=None</em>, <em>numpy_op=&lt;ufunc 'absolute'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.statdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the eigenenergies of two bands and compute the
statistical parameters: mean, standard deviation, min and max
The bands are aligned wrt to their fermi level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</li>
<li><strong>axis</strong> – Axis along which the statistical parameters are computed.
The default is to compute the parameters of the flattened array.</li>
<li><strong>numpy_op</strong> – Numpy function to apply to the difference of the eigenvalues. The
default computes <code class="docutils literal"><span class="pre">|self.eigens</span> <span class="pre">-</span> <span class="pre">other.eigens|</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">namedtuple</span></code> with the statistical parameters in eV</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.ipw_edos_widget">
<code class="descname">ipw_edos_widget</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.ipw_edos_widget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.ipw_edos_widget" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to compute the electron DOS.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_edos">
<code class="descname">get_edos</code><span class="sig-paren">(</span><em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.compare_gauss_edos">
<code class="descname">compare_gauss_edos</code><span class="sig-paren">(</span><em>widths</em>, <em>step=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.compare_gauss_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.compare_gauss_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS with the Gaussian method for different values
of the broadening. Return plotter object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>widths</strong> – List with the tandard deviation (eV) of the gaussian.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDosPlotter" title="abipy.electrons.ebands.ElectronDosPlotter"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDosPlotter</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_transitions">
<code class="descname">plot_transitions</code><span class="sig-paren">(</span><em>omega_ev</em>, <em>qpt=(0</em>, <em>0</em>, <em>0)</em>, <em>atol_ev=0.1</em>, <em>atol_kdiff=0.0001</em>, <em>ylims=None</em>, <em>ax=None</em>, <em>alpha=0.4</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_transitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot energy bands with arrows signaling possible k –&gt; k + q indipendent-particle transitions
of energy <code class="docutils literal"><span class="pre">omega_ev</span></code> connecting occupied to empty states.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>omega_ev</strong> – Transition energy in eV.</li>
<li><strong>qpt</strong> – Q-point in reduced coordinates.</li>
<li><strong>atol_ev</strong> – Absolute tolerance for energy difference in eV</li>
<li><strong>atol_kdiff</strong> – Tolerance used to compare k-points.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_ejdos">
<code class="descname">get_ejdos</code><span class="sig-paren">(</span><em>spin</em>, <em>valence</em>, <em>conduction</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>mesh=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_ejdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_ejdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the join density of states at q == 0.</p>
<blockquote>
<div><span class="math">\(\sum_{kbv} f_{vk} (1 - f_{ck}) \delta(\omega - E_{ck} + E_{vk})\)</span></div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The present implementation assumes an energy gap</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>valence</strong> – Int or iterable with the valence indices.</li>
<li><strong>conduction</strong> – Int or iterable with the conduction indices.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – String defining the integraion method.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>mesh</strong> – Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ejdosvc">
<code class="descname">plot_ejdosvc</code><span class="sig-paren">(</span><em>vrange</em>, <em>crange</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>colormap='jet'</em>, <em>cumulative=True</em>, <em>ax=None</em>, <em>alpha=0.7</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ejdosvc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ejdosvc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the decomposition of the joint-density of States (JDOS).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The present implementation assumes an energy gap</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vrange</strong> – Int or <cite>Iterable</cite> with the indices of the valence bands to consider.</li>
<li><strong>crange</strong> – Int or <cite>Iterable</cite> with the indices of the conduction bands to consider.</li>
<li><strong>method</strong> – String defining the method.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></li>
<li><strong>cumulative</strong> – True for cumulative plots (default).</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.apply_scissors">
<code class="descname">apply_scissors</code><span class="sig-paren">(</span><em>scissors</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.apply_scissors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.apply_scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the band structure with the scissors operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scissors</strong> – An instance of <code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> with modified energies.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band_range=None</em>, <em>klabels=None</em>, <em>e0='fermie'</em>, <em>ax=None</em>, <em>ylims=None</em>, <em>points=None</em>, <em>with_gaps=False</em>, <em>max_phfreq=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic band structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index. None to plot both spins.</li>
<li><strong>band_range</strong> – Tuple specifying the minimum and maximum band to plot (default: all bands are plotted)</li>
<li><strong>klabels</strong> – dictionary whose keys are tuple with the reduced
coordinates of the k-points. The values are the labels. e.g.
<code class="docutils literal"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):&quot;L&quot;}</span></code>.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives…</li>
<li><strong>with_gaps</strong> – True to add markers and arrows showing the fundamental and the direct gap.</li>
<li><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_scatter3d">
<code class="descname">plot_scatter3d</code><span class="sig-paren">(</span><em>band</em>, <em>spin=0</em>, <em>e0='fermie'</em>, <em>colormap='jet'</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_scatter3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_scatter3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib <code class="docutils literal"><span class="pre">scatter3D</span></code> to produce a scatter plot of the eigenvalues in 3D.
The color of the points gives the energy of the state wrt to the Fermi level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>band</strong> – Band index</li>
<li><strong>spin</strong> – Spin index.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
&lt;<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a>&gt;</li>
<li><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes3D</span></code> or None if a new figure should be created.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.decorate_ax">
<code class="descname">decorate_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.decorate_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add k-labels, title and unit name to axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>title</strong> – </li>
<li><strong>fontsize</strong> – </li>
<li><strong>klabels</strong> – </li>
<li><strong>klabel_size</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_e0">
<code class="descname">get_e0</code><span class="sig-paren">(</span><em>e0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).</li>
<li>Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>e0</em>, <em>spin=None</em>, <em>band=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the energies for (spin, band) on the axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a>.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</li>
<li><strong>spin</strong> – Spin index. If None, all spins are plotted.</li>
<li><strong>band</strong> – Band index, If None, all bands are plotted.</li>
<li><strong>kwargs</strong> – Passed to ax.plot</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: matplotlib lines</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_with_edos">
<code class="descname">plot_with_edos</code><span class="sig-paren">(</span><em>edos</em>, <em>klabels=None</em>, <em>ax_list=None</em>, <em>e0='fermie'</em>, <em>points=None</em>, <em>with_gaps=False</em>, <em>max_phfreq=None</em>, <em>ylims=None</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_with_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edos</strong> – An instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a>.</li>
<li><strong>klabels</strong> – dictionary whose keys are tuple with the reduced coordinates of the k-points.
The values are the labels. e.g. <code class="docutils literal"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>ax_list</strong> – The axes for the bandstructure plot and the DOS plot. If ax_list is None, a new figure
is created and the two axes are automatically generated.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>* ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See ``edos_fermie``.
* ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
*  Number e.g ``e0 = 0.5``: shift all eigenvalues to have zero energy at 0.5 eV
*  None: Don&#39;t shift energies, equivalent to ``e0 = 0``
</pre></div>
</div>
</li>
<li><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives…</li>
<li><strong>with_gaps</strong> – True to add markers and arrows showing the fundamental and the direct gap.</li>
<li><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</li>
<li><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_lws_vs_e0">
<code class="descname">plot_lws_vs_e0</code><span class="sig-paren">(</span><em>ax=None</em>, <em>e0='fermie'</em>, <em>function=&lt;function ElectronBands.&lt;lambda&gt;&gt;</em>, <em>exchange_xy=False</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_lws_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_lws_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic linewidths vs KS energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</li>
<li><strong>function</strong> – Apply this function to the values before plotting</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>ylims</strong> (<em>xlims</em><em>,</em>) – Set the data limits for the x-axis or the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> – fontsize for titles and legend.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_xmgrace">
<code class="descname">to_xmgrace</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_xmgrace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_xmgrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <a class="reference external" href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> file with band structure energies and labels for high-symmetry k-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> – String with filename or stream.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.to_bxsf">
<code class="descname">to_bxsf</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_bxsf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_bxsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the full band structure to <code class="docutils literal"><span class="pre">filepath</span></code> in BXSF format
suitable for the visualization of isosurfaces with <a class="reference external" href="http://www.xcrysden.org/">xcrysden</a> (xcrysden –bxsf FILE).
Require k-points in IBZ and gamma-centered k-mesh.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.get_ebands3d">
<code class="descname">get_ebands3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_ebands3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_ebands3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.derivatives">
<code class="descname">derivatives</code><span class="sig-paren">(</span><em>spin</em>, <em>band</em>, <em>order=1</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the eigenvalues wrt to k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index</li>
<li><strong>band</strong> – Band index</li>
<li><strong>order</strong> – </li>
<li><strong>acc</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.effective_masses">
<code class="descname">effective_masses</code><span class="sig-paren">(</span><em>spin</em>, <em>band</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.effective_masses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.effective_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses for the given <code class="docutils literal"><span class="pre">spin</span></code> and <code class="docutils literal"><span class="pre">band</span></code> index.
Use finite difference with accuracy <code class="docutils literal"><span class="pre">acc</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of size self.nkpt with effective masses.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.effmass_line">
<code class="descname">effmass_line</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.effmass_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.effmass_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses along a line. Requires band energies on a k-path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – integer or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object. Note that if kpoint is not an integer,
and the path contains duplicated k-points, the first k-point is selected.</li>
<li><strong>band</strong> – Band index.</li>
<li><strong>acc</strong> – accuracy</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBands.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>lpratio=5</em>, <em>knames=None</em>, <em>vertices_names=None</em>, <em>line_density=20</em>, <em>kmesh=None</em>, <em>is_shift=None</em>, <em>bstart=0</em>, <em>bstop=None</em>, <em>filter_params=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies in k-space along a k-path and, optionally, in the IBZ for DOS calculations.
Note that the interpolation will likely fail if there are symmetrical k-points in the input set of k-points
so it’s recommended to call this method with energies obtained in the IBZ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lpratio</strong> – Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</li>
<li><strong>knames</strong> – List of strings with the k-point labels for the k-path. Has precedence over vertices_names.</li>
<li><strong>vertices_names</strong> – Used to specify the k-path for the interpolated band structure
It’s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <code class="docutils literal"><span class="pre">line_density</span></code> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</li>
<li><strong>line_density</strong> – Number of points in the smallest segment of the k-path.</li>
<li><strong>kmesh</strong> – Used to activate the interpolation on the homogeneous mesh for DOS (uses <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> API).
kmesh is given by three integers and specifies mesh numbers along reciprocal primitive axis.</li>
<li><strong>is_shift</strong> – three integers (<a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
<li><strong>bstop</strong> (<em>bstart</em><em>,</em>) – Select the range of band to be used in the interpolation</li>
<li><strong>filter_params</strong> – TO BE described.</li>
<li><strong>verbose</strong> – Verbosity level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>namedtuple with the following attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ebands_kpath: |ElectronBands| with the interpolated band structure on the k-path.
ebands_kmesh: |ElectronBands| with the interpolated band structure on the k-mesh.
    None if ``kmesh`` is not given.
interpolator: |SkwInterpolator| object.
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.electrons.ebands.dataframe_from_ebands">
<code class="descclassname">abipy.electrons.ebands.</code><code class="descname">dataframe_from_ebands</code><span class="sig-paren">(</span><em>ebands_objects</em>, <em>index=None</em>, <em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#dataframe_from_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.dataframe_from_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a pandas dataframe with the most important results available in a list of band structures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ebands_objects</strong> – List of objects that can be converted to structure.
Support netcdf filenames or <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> objects
See <code class="docutils literal"><span class="pre">ElectronBands.as_ebands</span></code> for the complete list.</li>
<li><strong>index</strong> – Index of the dataframe.</li>
<li><strong>with_spglib</strong> – If True, spglib is invoked to get the spacegroup symbol and number.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronBandsPlotter</code><span class="sig-paren">(</span><em>key_ebands=None</em>, <em>key_edos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting electronic band structure and DOSes.
Supports plots on the same graph or separated plots.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;foo-label&quot;</span><span class="p">,</span> <span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;bar-label&quot;</span><span class="p">,</span> <span class="s2">&quot;bar_WFK.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<p>Dictionary with the mapping label –&gt; edos.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-9752ae92359e7dc1ce5861de48cebb5d99f7ae58.png" alt="Inheritance diagram of ElectronBandsPlotter" usemap="#inheritanceab465bca1b" class="inheritance"/>
<map id="inheritanceab465bca1b" name="inheritanceab465bca1b">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,225,29"/>
<area shape="rect" id="node2" href="#abipy.electrons.ebands.ElectronBandsPlotter" target="_top" title="Class for plotting electronic band structure and DOSes." alt="" coords="273,5,559,29"/>
</map>
<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_plotter">
<code class="descname">add_plotter</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.add_plotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two plotters, return new plotter.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>func=&lt;class 'str'&gt;</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame">
<code class="descname">get_ebands_frame</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.get_ebands_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the most important results available in the band structures.
Useful to analyze band-gaps.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.ebands_list">
<code class="descname">ebands_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.ebands_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> objects.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.edoses_list">
<code class="descname">edoses_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.edoses_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> objects.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt">
<code class="descname">iter_lineopt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.iter_lineopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates matplotlib linestyles.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_ebands">
<code class="descname">add_ebands</code><span class="sig-paren">(</span><em>label</em>, <em>bands</em>, <em>edos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.add_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a band structure and optionally an edos to the plotter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> – label for the bands. Must be unique.</li>
<li><strong>bands</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</li>
<li><strong>edos</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</li>
<li><strong>edos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal"><span class="pre">get_edos</span></code> to compute the electron DOS.
Used only if <code class="docutils literal"><span class="pre">edos</span></code> is not None and it’s not an <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff">
<code class="descname">bands_statdiff</code><span class="sig-paren">(</span><em>ref=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.bands_statdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the reference bands with index ref with the other bands stored in the plotter.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>ylims=None</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>fontsize=8</em>, <em>linestyle_dict=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS on the same figure.
Use <code class="docutils literal"><span class="pre">gridplot</span></code> to plot band structures on different figures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>- `fermie`: shift all eigenvalues to have zero energy at the Fermi energy (ebands.fermie)
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See `edos_fermie`.
- ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
   Available only if plotter contains dos objects.
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#39;t shift energies, equivalent to e0=0
</pre></div>
</div>
</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</li>
<li><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</li>
<li><strong>fontsize</strong> – fontsize for titles and legend.</li>
<li><strong>linestyle_dict</strong> – Dictionary mapping labels to matplotlib linestyle options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for combiplot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>with_dos=True</em>, <em>with_gaps=False</em>, <em>max_phfreq=None</em>, <em>ylims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple electron bandstructures and optionally DOSes on a grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>eb_objects</strong> – List of objects from which the band structures are extracted.
Each item in eb_objects is either a string with the path of the netcdf file,
or one of the abipy object with an <code class="docutils literal"><span class="pre">ebands</span></code> attribute or a <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</li>
<li><strong>edos_objects</strong> – List of objects from which the electron DOSes are extracted.
Accept filepaths or <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> objects. If edos_objects is not None,
each subplot in the grid contains a band structure with DOS else a simple bandstructure plot.</li>
<li><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>- ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See `edos_fermie`.
- ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
   Available only if edos_objects is not None
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#39;t shift energies, equivalent to e0=0
</pre></div>
</div>
</li>
<li><strong>with_dos</strong> – True if DOS should be printed.</li>
<li><strong>with_gaps</strong> – True to add markesr and arrows showing the fundamental and the direct gap.</li>
<li><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorptions/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">`(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> – fontsize for titles and legend.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.boxplot">
<code class="descname">boxplot</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>brange=None</em>, <em>swarm=False</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.boxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.
Band structures are drawn on different subplots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</li>
<li><strong>brange</strong> – Only bands such as <code class="docutils literal"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>fontsize</strong> – Fontsize for title.</li>
<li><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot">
<code class="descname">combiboxplot</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>brange=None</em>, <em>swarm=False</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiboxplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot comparing the distributions of the eigenvalues
Band structures are drawn on the same plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</li>
<li><strong>brange</strong> – Only bands such as <code class="docutils literal"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</li>
<li><strong>swarm</strong> – True to show the datapoints on top of the boxes</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>interval=500</em>, <em>savefile=None</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.animate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="http://matplotlib.org">matplotlib</a> to animate a list of band structure plots (with or without DOS).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>* ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   See `edos_fermie`.
* ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
*  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
*  None: Don&#39;t shift energies, equivalent to e0=0
</pre></div>
</div>
</li>
<li><strong>interval</strong> – draws a new frame every interval milliseconds.</li>
<li><strong>savefile</strong> – Use e.g. ‘myanimation.mp4’ to save the animation in mp4 format.</li>
<li><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</li>
<li><strong>show</strong> – True if the animation should be shown immediately</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: Animation object.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It would be nice to animate the title of the plot, unfortunately
this feature is not available in the present version of matplotlib.
See: <a class="reference external" href="http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib">http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib</a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.ipw_select_plot">
<code class="descname">ipw_select_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.ipw_select_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronDos">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronDos</code><span class="sig-paren">(</span><em>mesh</em>, <em>spin_dos</em>, <em>nelect</em>, <em>fermie=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the electronic density of states.
It is usually created by calling the get_edos method of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a>.</p>
<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.ebands.ElectronDos.as_edos">
<em class="property">classmethod </em><code class="descname">as_edos</code><span class="sig-paren">(</span><em>obj</em>, <em>edos_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.as_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.as_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> from a generic object <code class="docutils literal"><span class="pre">obj</span></code>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li>instances of cls</li>
<li>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</li>
<li>objects providing an <cite>ebands</cite> or <cite>get_edos</cite> attribute</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>edos_kwargs</strong> – optional dictionary with the options passed to <cite>get_edos</cite> to compute the electron DOS.</li>
<li><strong>when obj is not already an instance of cls.</strong> (<em>Used</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.dos_idos">
<code class="descname">dos_idos</code><span class="sig-paren">(</span><em>spin=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.dos_idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns DOS and IDOS for given spin. Total DOS and IDOS if spin is None.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.find_mu">
<code class="descname">find_mu</code><span class="sig-paren">(</span><em>nelect</em>, <em>spin=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.find_mu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.find_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the chemical potential given the number of electrons.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronDos.up_minus_down">
<code class="descname">up_minus_down</code><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.up_minus_down"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Function1D with dos_up - dos_down</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.get_e0">
<code class="descname">get_e0</code><span class="sig-paren">(</span><em>e0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.get_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt>
<dd><ul class="first last simple">
<li><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</li>
<li>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</li>
<li>None: Don’t shift energies, equivalent to e0=0</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>e0</em>, <em>spin=None</em>, <em>what='dos'</em>, <em>fact=1.0</em>, <em>exchange_xy=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the DOS data on the axis <code class="docutils literal"><span class="pre">ax</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a>.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</li>
<li><strong>spin</strong> – selects the spin component, None for total DOS, IDOS.</li>
<li><strong>what</strong> – string selecting what will be plotted. “dos” for DOS, “idos” for IDOS</li>
<li><strong>fact</strong> – Multiplication factor for DOS/IDOS. Usually +-1 for spin DOS</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>kwargs</strong> – Options passed to matplotlib <code class="docutils literal"><span class="pre">ax.plot</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: list of lines added to the axis ax.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>spin=None</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
- Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
- None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li><strong>spin</strong> – Selects the spin component, None if total DOS is wanted.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>kwargs</strong> – options passed to <code class="docutils literal"><span class="pre">ax.plot</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_dos_idos">
<code class="descname">plot_dos_idos</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>ax_list=None</em>, <em>xlims=None</em>, <em>height_ratios=(1</em>, <em>2)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_dos_idos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS and Integrated DOS on two different subplots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li><strong>ax_list</strong> – The axes for the DOS and IDOS plot. If ax_list is None, a new figure
is created and the two axes are automatically generated.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>height_ratios</strong> – </li>
<li><strong>kwargs</strong> – options passed to <code class="docutils literal"><span class="pre">plot_ax</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_up_minus_down">
<code class="descname">plot_up_minus_down</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_up_minus_down"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Dos_up -Dow_down</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>kwargs</strong> – options passed to <code class="docutils literal"><span class="pre">ax.plot</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.ebands.ElectronDosPlotter">
<em class="property">class </em><code class="descclassname">abipy.electrons.ebands.</code><code class="descname">ElectronDosPlotter</code><span class="sig-paren">(</span><em>key_edos=None</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting electronic DOSes.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronDosPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;foo dos&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;bar dos&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.edos_list">
<code class="descname">edos_list</code><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.edos_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of DOSes</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.add_edos">
<code class="descname">add_edos</code><span class="sig-paren">(</span><em>label</em>, <em>edos</em>, <em>edos_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.add_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.add_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a DOS for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> – label for the DOS. Must be unique.</li>
<li><strong>edos</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</li>
<li><strong>edos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal"><span class="pre">get_edos</span></code> to compute the electron DOS.
Used only if <code class="docutils literal"><span class="pre">edos</span></code> is not an ElectronDos instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.combiplot">
<code class="descname">combiplot</code><span class="sig-paren">(</span><em>what_list='dos'</em>, <em>spin_mode='automatic'</em>, <em>e0='fermie'</em>, <em>ax_list=None</em>, <em>xlims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.combiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the the DOSes on the same figure. Use <code class="docutils literal"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>what_list</strong> – Selects quantities to plot e.g. [“dos”, “idos”] to plot DOS and integrated DOS.
“dos” for DOS only and “idos” for IDOS only</li>
<li><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – fontsize for titles and legend</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>what_list='dos'</em>, <em>spin_mode='automatic'</em>, <em>e0='fermie'</em>, <em>ax_list=None</em>, <em>xlims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the the DOSes on the same figure. Use <code class="docutils literal"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>what_list</strong> – Selects quantities to plot e.g. [“dos”, “idos”] to plot DOS and integrated DOS.
“dos” for DOS only and “idos” for IDOS only</li>
<li><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – fontsize for titles and legend</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.gridplot">
<code class="descname">gridplot</code><span class="sig-paren">(</span><em>what='dos'</em>, <em>spin_mode='automatic'</em>, <em>e0='fermie'</em>, <em>sharex=True</em>, <em>sharey=True</em>, <em>xlims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple DOSes on a grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>what</strong> – “dos” to plot DOS, “idos” for integrated DOS.</li>
<li><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</li>
<li><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>- ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See ``edos_fermie``.
- ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
   Available only if edos_objects is not None
-  Number e.g ``e0 = 0.5``: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#39;t shift energies, equivalent to ``e0 = 0``.
</pre></div>
</div>
</li>
<li><strong>sharey</strong> (<em>sharex</em><em>,</em>) – True if x (y) axis should be shared.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> – Label and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.ipw_select_plot">
<code class="descname">ipw_select_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.ipw_select_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.fatbands">
<span id="fatbands-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">fatbands</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.fatbands" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of electronic fatbands and projected DOSes.</p>
<dl class="function">
<dt id="abipy.electrons.fatbands.gaussians_dos">
<code class="descclassname">abipy.electrons.fatbands.</code><code class="descname">gaussians_dos</code><span class="sig-paren">(</span><em>dos</em>, <em>mesh</em>, <em>width</em>, <em>values</em>, <em>energies</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#gaussians_dos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.gaussians_dos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="abipy.electrons.fatbands.FatBandsFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.fatbands.</code><code class="descname">FatBandsFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Provides methods to analyze the data stored in the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/efatbands.ipynb">FATBANDS.nc</a> file.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">abiopen</span><span class="p">(</span><span class="s2">&quot;out_FATBANDS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">fb</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
    <span class="n">fb</span><span class="o">.</span><span class="n">plot_fatbands_lview</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, one can use the <cite>abiopen.py</cite> script to open the file in an ipython notebook with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">abiopen</span><span class="o">.</span><span class="n">py</span> <span class="n">out_FATBANDS</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">nb</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-36c58467670d6917c6ae9b043dd34863804ba147.png" alt="Inheritance diagram of FatBandsFile" usemap="#inheritancedf15763410" class="inheritance"/>
<map id="inheritancedf15763410" name="inheritancedf15763410">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="252,195,448,219"/>
<area shape="rect" id="node7" href="#abipy.electrons.fatbands.FatBandsFile" target="_top" title="Provides methods to analyze the data stored in the FATBANDS.nc_ file." alt="" coords="519,100,763,124"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,195,182,219"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing electron data." alt="" coords="229,5,471,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf_ files containing the Abinit header." alt="" coords="251,53,450,76"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="245,100,455,124"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="242,147,459,171"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2color">
<code class="descname">l2color</code><em class="property"> = {0: 'red', 1: 'blue', 2: 'green', 3: 'yellow', 4: 'orange'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2tex">
<code class="descname">l2tex</code><em class="property"> = {0: '$l=s$', 1: '$l=p$', 2: '$l=d$', 3: '$l=f$', 4: '$l=g$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_spin">
<code class="descname">marker_spin</code><em class="property"> = {0: '^', 1: 'v'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spin2tex">
<code class="descname">spin2tex</code><em class="property"> = {0: '$\\sigma=\\uparrow$', 1: '$\\sigma=\\downarrow$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spin2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2tex">
<code class="descname">spinors2tex</code><em class="property"> = {'up-up': '$\\uparrow,\\uparrow$', 'up-down': '$\\uparrow,\\downarrow$', 'down-up': '$\\downarrow,\\uparrow$', 'down-down': '$\\downarrow,\\downarrow$', 'sigma_x': '$\\sigma_{x}$', 'sigma_y': '$\\sigma_{y}$', 'sigma_z': '$\\sigma_{z}$'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2color">
<code class="descname">spinors2color</code><em class="property"> = {'up-up': 'black', 'up-down': 'brown', 'down-up': 'violet', 'down-down': 'yellow', 'sigma_x': 'green', 'sigma_y': 'blue', 'sigma_z': 'red'}</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.alpha">
<code class="descname">alpha</code><em class="property"> = 0.6</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_size">
<code class="descname">marker_size</code><em class="property"> = 3.0</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linewidth">
<code class="descname">linewidth</code><em class="property"> = 0.1</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linewidth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linecolor">
<code class="descname">linecolor</code><em class="property"> = 'grey'</em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linecolor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.fatbands.FatBandsFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.wal_sbk">
<code class="descname">wal_sbk</code><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.wal_sbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.wal_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of shape [natom, mbesslang, nsppol, mband, nkpt]
with the L-contributions. Present only if prtdos == 3.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.walm_sbk">
<code class="descname">walm_sbk</code><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.walm_sbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.walm_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of shape [natom, mbesslang**2, nsppol, mband, nkpt]
with the LM-contribution. Present only if prtdos == 3 and prtdosm != 0</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of the <code class="docutils literal"><span class="pre">with</span></code> context manager.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_atom">
<code class="descname">get_wl_atom</code><span class="sig-paren">(</span><em>iatom</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for atom index <code class="docutils literal"><span class="pre">iatom</span></code>. The weights are summed over m.
If <code class="docutils literal"><span class="pre">spin</span></code> and <code class="docutils literal"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spin and bands else the contribution for (spin, band)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_symbol">
<code class="descname">get_wl_symbol</code><span class="sig-paren">(</span><em>symbol</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for a given type specified in terms of the
chemical symbol <code class="docutils literal"><span class="pre">symbol</span></code>. The weights are summed over m and over all atoms of the same type.
If <code class="docutils literal"><span class="pre">spin</span></code> and <code class="docutils literal"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_w_symbol">
<code class="descname">get_w_symbol</code><span class="sig-paren">(</span><em>symbol</em>, <em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_w_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_w_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DOS weights for a given type specified in terms of the
chemical symbol <code class="docutils literal"><span class="pre">symbol</span></code>. The weights are summed over m and lmax[symbol] and
over all atoms of the same type.
If <code class="docutils literal"><span class="pre">spin</span></code> and <code class="docutils literal"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_spilling">
<code class="descname">get_spilling</code><span class="sig-paren">(</span><em>spin=None</em>, <em>band=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_spilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_spilling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spilling parameter
If <code class="docutils literal"><span class="pre">spin</span></code> and <code class="docutils literal"><span class="pre">band</span></code> are not specified, the method returns the spilling for all states
as a [nsppol, mband, nkpt] numpy array else the spilling for (spin, band) with shape [nkpt].</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs">
<code class="descname">eb_plotax_kwargs</code><span class="sig-paren">(</span><em>spin</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.eb_plotax_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the options passed to <code class="docutils literal"><span class="pre">ebands.plot_ax</span></code>
when plotting a band line with spin index <code class="docutils literal"><span class="pre">spin</span></code>.
Subclasses can redefine the implementation to customize the plots.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview">
<code class="descname">plot_fatbands_siteview</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>view='inequivalent'</em>, <em>fact=1.0</em>, <em>fontsize=12</em>, <em>ylims=None</em>, <em>blist=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_siteview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fatbands for each atom in the unit cell. By default, only the <strong>inequivalent</strong> atoms are shown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>view</strong> – “inequivalent”, “all”</li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>fontsize</strong> – fontsize for titles and legend</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview">
<code class="descname">plot_fatbands_lview</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>fact=1.0</em>, <em>ax_mat=None</em>, <em>lmax=None</em>, <em>ylims=None</em>, <em>blist=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_lview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by L.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>ax_mat</strong> – Matrix of axes, if None a new figure is produced.</li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
<li><strong>fontsize</strong> – legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview">
<code class="descname">plot_fatbands_mview</code><span class="sig-paren">(</span><em>iatom</em>, <em>e0='fermie'</em>, <em>fact=1.0</em>, <em>lmax=None</em>, <em>ylims=None</em>, <em>blist=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_mview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by LM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iatom</strong> – Index of the atom in the structure.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview">
<code class="descname">plot_fatbands_typeview</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>fact=1.0</em>, <em>lmax=None</em>, <em>ax_mat=None</em>, <em>ylims=None</em>, <em>blist=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_typeview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by atomic type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>ax_mat</strong> – Matrix of axis. None if a new figure should be created.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
<li><strong>fontsize</strong> – legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_spilling">
<code class="descname">plot_spilling</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>fact=1.0</em>, <em>ax_list=None</em>, <em>ylims=None</em>, <em>blist=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_spilling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_spilling" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>ax_list</strong> – List of matplotlib axes for plot. If None, new figure is produced</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_dos_integrator">
<code class="descname">get_dos_integrator</code><span class="sig-paren">(</span><em>method</em>, <em>step</em>, <em>width</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_dos_integrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_dos_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>FatBandsFile can use differerent integrators that are cached in self._cached_dos_integrators</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview">
<code class="descname">plot_pjdos_lview</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>lmax=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>stacked=True</em>, <em>combined_spins=True</em>, <em>ax_mat=None</em>, <em>exchange_xy=False</em>, <em>with_info=True</em>, <em>with_spin_sign=True</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_lview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the PJ-DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>combined_spins</strong> – Define how up/down DOS components should be plotted when nsppol==2.
If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</li>
<li><strong>ax_mat</strong> – </li>
<li><strong>exchange_xy</strong> – True if the dos should be plotted on the x axis instead of y.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – Same meaning as <code class="docutils literal"><span class="pre">xlims</span></code> but for the y-axis</li>
<li><strong>fontsize</strong> – Legend and label fontsize</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview">
<code class="descname">plot_pjdos_typeview</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>lmax=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>stacked=True</em>, <em>combined_spins=True</em>, <em>ax_mat=None</em>, <em>exchange_xy=False</em>, <em>with_info=True</em>, <em>with_spin_sign=True</em>, <em>xlims=None</em>, <em>ylims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_typeview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the PJ-DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>combined_spins</strong> – Define how up/down DOS components should be plotted when nsppol==2.
If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</li>
<li><strong>ax_mat</strong> – </li>
<li><strong>exchange_xy</strong> – True if the dos should be plotted on the x axis instead of y.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>ylims</strong> – Same meaning as <code class="docutils literal"><span class="pre">xlims</span></code> but for the y-axis</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos">
<code class="descname">plot_fatbands_with_pjdos</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>fact=1.0</em>, <em>lmax=None</em>, <em>blist=None</em>, <em>view='type'</em>, <em>pjdosfile=None</em>, <em>edos_kwargs=None</em>, <em>stacked=True</em>, <em>width_ratios=(2</em>, <em>1)</em>, <em>fontsize=8</em>, <em>ylims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_with_pjdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fatbands and the PJDOS on the same figure, a.k.a the Sistine Chapel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – float used to scale the stripe size.</li>
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</li>
<li><strong>pjdosfile</strong> – FATBANDS file used to compute the PJDOS. If None, the PJDOS is taken from self.</li>
<li><strong>edos_kwargs</strong> – </li>
<li><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</li>
<li><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms">
<code class="descname">plot_pawdos_terms</code><span class="sig-paren">(</span><em>lmax=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>xlims=None</em>, <em>*kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pawdos_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot …</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</li>
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fatbands.FatBandsFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.fold2bloch">
<span id="fold2bloch-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">fold2bloch</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.fold2bloch" title="Permalink to this headline">¶</a></h2>
<p>Fold2Bloch netcdf file.</p>
<dl class="class">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile">
<em class="property">class </em><code class="descclassname">abipy.electrons.fold2bloch.</code><code class="descname">Fold2BlochNcfile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Netcdf file with output data produced by Fold2Bloch.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Fold2BlochNcfile</span><span class="p">(</span><span class="s2">&quot;foo_FOLD2BLOCH.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="n">fb</span><span class="o">.</span><span class="n">plot_unfolded</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-3cacf9444fd1d0893235082beabd41afe3d665c9.png" alt="Inheritance diagram of Fold2BlochNcfile" usemap="#inheritanceea0f982423" class="inheritance"/>
<map id="inheritanceea0f982423" name="inheritanceea0f982423">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="243,187,431,210"/>
<area shape="rect" id="node7" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile" target="_top" title="Netcdf file with output data produced by Fold2Bloch." alt="" coords="499,96,763,119"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,187,175,210"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing electron data." alt="" coords="221,5,453,28"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf_ files containing the Abinit header." alt="" coords="241,51,433,73"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="236,96,438,119"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="233,142,441,165"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.from_wfkpath">
<em class="property">classmethod </em><code class="descname">from_wfkpath</code><span class="sig-paren">(</span><em>wfkpath</em>, <em>folds</em>, <em>workdir=None</em>, <em>manager=None</em>, <em>mpi_procs=1</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.from_wfkpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.from_wfkpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Run fold2bloch in workdir.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>wfkpath</strong> – </li>
<li><strong>folds</strong> – </li>
<li><strong>workdir</strong> – Working directory of the fake task used to compute the ibz. Use None for temporary dir.</li>
<li><strong>manager</strong> – <code class="xref py py-class docutils literal"><span class="pre">TaskManager</span></code> of the task. If None, the manager is initialized from the config file.</li>
<li><strong>mpi_procs</strong> – Number of MPI processors to use.</li>
<li><strong>verbose</strong> – Verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with folded band energies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object defining the supercell.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_eigens">
<code class="descname">uf_eigens</code><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.uf_eigens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsppol, nk_unfolded, nband] <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> with unfolded eigenvalues in eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_weights">
<code class="descname">uf_weights</code><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.uf_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>[nss, nk_unfolded, nband] array with spectral weights. nss = max(nspinor, nsppol).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.get_spectral_functions">
<code class="descname">get_spectral_functions</code><span class="sig-paren">(</span><em>step=0.01</em>, <em>width=0.02</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.get_spectral_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.get_spectral_functions" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">mesh, sfw, int_sfw</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.plot_unfolded">
<code class="descname">plot_unfolded</code><span class="sig-paren">(</span><em>kbounds</em>, <em>klabels</em>, <em>ylims=None</em>, <em>dist_tol=1e-12</em>, <em>verbose=0</em>, <em>colormap='afmhot'</em>, <em>facecolor='black'</em>, <em>ax=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.plot_unfolded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.plot_unfolded" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot unfolded band structure with spectral weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>klabels</strong> – dictionary whose keys are tuple with the reduced coordinates of the k-points.
The values are the labels. e.g. <code class="docutils literal"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</li>
<li><strong>verbose</strong> – Verbosity level.</li>
<li><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></li>
<li><strong>facecolor</strong> – </li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <cite>nbpath</cite> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gsr">
<span id="gsr-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">gsr</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.gsr" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/gsr.ipynb">GSR.nc</a> file.</p>
<dl class="class">
<dt id="abipy.electrons.gsr.GsrFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.gsr.</code><code class="descname">GsrFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>File containing the results of a ground-state calculation.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">GsrFile</span><span class="p">(</span><span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gsr</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;energy: &quot;</span><span class="p">,</span> <span class="n">gsr</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">gsr</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-b6b9f59c6fafbc1b5ff782f970d00f2051314070.png" alt="Inheritance diagram of GsrFile" usemap="#inheritance7fe53e894a" class="inheritance"/>
<map id="inheritance7fe53e894a" name="inheritance7fe53e894a">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="256,197,454,221"/>
<area shape="rect" id="node7" href="#abipy.electrons.gsr.GsrFile" target="_top" title="File containing the results of a ground&#45;state calculation." alt="" coords="525,101,703,125"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,197,184,221"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing electron data." alt="" coords="232,5,477,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf_ files containing the Abinit header." alt="" coords="254,53,456,77"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="249,101,461,125"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="245,149,464,173"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.gsr.GsrFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.is_scf_run">
<code class="descname">is_scf_run</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.is_scf_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.is_scf_run" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the GSR has been produced by a SCF run.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.ecut">
<code class="descname">ecut</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.ecut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ecut" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree (Abinit input variable)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.pawecutdg">
<code class="descname">pawecutdg</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pawecutdg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pawecutdg" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree for the PAW double grid (Abinit input variable)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy">
<code class="descname">energy</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy in eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy_per_atom">
<code class="descname">energy_per_atom</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_per_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy / number_of_atoms (eV units)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.cart_forces">
<code class="descname">cart_forces</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian forces in eV / Ang</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.max_force">
<code class="descname">max_force</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.max_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.max_force" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.force_stats">
<code class="descname">force_stats</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.force_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.force_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with information on the forces.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.cart_stress_tensor">
<code class="descname">cart_stress_tensor</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_stress_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_stress_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Stress tensor in GPa.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.pressure">
<code class="descname">pressure</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Pressure in GPa.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.residm">
<code class="descname">residm</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.residm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.residm" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the residuals</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.xc">
<code class="descname">xc</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.xc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.xc" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">XcFunc</span></code> object with info on the exchange-correlation functional.
Use libxc convention <a class="reference internal" href="../zzbiblio.html#marques2012" id="id3">[Marques2012]</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.energy_terms">
<code class="descname">energy_terms</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_terms" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">EnergyTerms</span></code> with the different contributions to the total energy in eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gsr.GsrFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.get_computed_entry">
<code class="descname">get_computed_entry</code><span class="sig-paren">(</span><em>inc_structure=True</em>, <em>parameters=None</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.get_computed_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.get_computed_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pymatgen <code class="xref py py-class docutils literal"><span class="pre">ComputedStructureEntry</span></code> from the GSR file.
Same API as the one used in vasp_output.get_computed_entry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inc_structure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Set to True if you want
ComputedStructureEntries to be returned instead of ComputedEntries.</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Input parameters to include. It has to be one of
the properties supported by the GSR object. If
parameters is None, a default set of parameters that are
necessary for typical post-processing will be set.</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Output data to include. Has to be one of the properties
supported by the GSR object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ComputedStructureEntry/ComputedEntry</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gsr.GsrFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gw">
<span id="gw-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">gw</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.gw" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of GW calculations.</p>
<dl class="class">
<dt id="abipy.electrons.gw.QPState">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">QPState</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.gw.QPState</span></code></a></p>
<p>Quasi-particle result for given (spin, kpoint, band).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Energies are in eV.</p>
</div>
<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.qpeme0">
<code class="descname">qpeme0</code><a class="headerlink" href="#abipy.electrons.gw.QPState.qpeme0" title="Permalink to this definition">¶</a></dt>
<dd><p>E_QP - E_0</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.re_qpe">
<code class="descname">re_qpe</code><a class="headerlink" href="#abipy.electrons.gw.QPState.re_qpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Real part of the QP energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.imag_qpe">
<code class="descname">imag_qpe</code><a class="headerlink" href="#abipy.electrons.gw.QPState.imag_qpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Imaginay part of the QP energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.skb">
<code class="descname">skb</code><a class="headerlink" href="#abipy.electrons.gw.QPState.skb" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with (spin, kpoint, band)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Shallow copy.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.QPState.get_fields">
<em class="property">classmethod </em><code class="descname">get_fields</code><span class="sig-paren">(</span><em>exclude=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.get_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.get_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert self into a dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.QPState.to_strdict">
<code class="descname">to_strdict</code><span class="sig-paren">(</span><em>fmt=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.to_strdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.to_strdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping fields –&gt; strings.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.QPState.tips">
<code class="descname">tips</code><a class="headerlink" href="#abipy.electrons.gw.QPState.tips" title="Permalink to this definition">¶</a></dt>
<dd><p>Bound method of self that returns a dictionary with the description of the fields.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.QPState.TIPS">
<em class="property">classmethod </em><code class="descname">TIPS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.TIPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.TIPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method that returns a dictionary with the description of the fields.
The string are extracted from the class doc string.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.QPState.get_fields_for_plot">
<em class="property">classmethod </em><code class="descname">get_fields_for_plot</code><span class="sig-paren">(</span><em>with_fields</em>, <em>exclude_fields</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.get_fields_for_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.get_fields_for_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of QPState fields to plot from input arguments.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.gw.SigresFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">SigresFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Container storing the GW results reported in the SIGRES.nc file.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sigres</span> <span class="o">=</span> <span class="n">SigresFile</span><span class="p">(</span><span class="s2">&quot;foo_SIGRES.nc&quot;</span><span class="p">)</span>
<span class="n">sigres</span><span class="o">.</span><span class="n">plot_qps_vs_e0</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-e52318082be1105a9d4a349c386d81202184678b.png" alt="Inheritance diagram of SigresFile" usemap="#inheritanceeae53b786c" class="inheritance"/>
<map id="inheritanceeae53b786c" name="inheritanceeae53b786c">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="256,149,454,173"/>
<area shape="rect" id="node6" href="#abipy.electrons.gw.SigresFile" target="_top" title="Container storing the GW results reported in the SIGRES.nc file." alt="" coords="525,77,718,101"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,149,184,173"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing electron data." alt="" coords="232,5,477,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="249,53,461,77"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="245,101,464,125"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.marker_spin">
<code class="descname">marker_spin</code><em class="property"> = {0: '^', 1: 'v'}</em><a class="headerlink" href="#abipy.electrons.gw.SigresFile.marker_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.color_spin">
<code class="descname">color_spin</code><em class="property"> = {0: 'k', 1: 'r'}</em><a class="headerlink" href="#abipy.electrons.gw.SigresFile.color_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.gw.SigresFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance from file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.sigma_kpoints">
<code class="descname">sigma_kpoints</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.sigma_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>The K-points where QP corrections have been calculated.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_marker">
<code class="descname">get_marker</code><span class="sig-paren">(</span><em>qpattr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_marker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_marker" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-class docutils literal"><span class="pre">Marker</span></code> object associated to the QP attribute qpattr.
Used to prepare plots of KS bands with markers.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies e.g ecuteps</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the netcdf file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <code class="docutils literal"><span class="pre">verbose</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> with the KS energies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.has_spectral_function">
<code class="descname">has_spectral_function</code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.has_spectral_function" title="Permalink to this definition">¶</a></dt>
<dd><p>True if file contains spectral function data.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.qplist_spin">
<code class="descname">qplist_spin</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qplist_spin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qplist_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="xref py py-class docutils literal"><span class="pre">QPList</span></code> objects indexed by spin.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qplist">
<code class="descname">get_qplist</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>ignore_imag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qplist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qplist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return :class`QPList` for the given (spin, kpoint)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qpcorr">
<code class="descname">get_qpcorr</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em>, <em>ignore_imag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a> object for the given (s, k, b)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.gw.SigresFile.qpgaps">
<code class="descname">qpgaps</code><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qpgaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> of shape [nsppol, nkibz] with the QP direct gaps in eV.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_qpgap">
<code class="descname">get_qpgap</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>with_ksgap=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpgap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpgap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the QP gap in eV at the given (spin, kpoint)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.read_sigee_skb">
<code class="descname">read_sigee_skb</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.read_sigee_skb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.read_sigee_skb" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Read self-energy(w) for (spin, kpoint, band)
Return: <code class="xref py py-class docutils literal"><span class="pre">SelfEnergy</span></code> object</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.print_qps">
<code class="descname">print_qps</code><span class="sig-paren">(</span><em>precision=3</em>, <em>ignore_imag=True</em>, <em>file=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.print_qps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.print_qps" title="Permalink to this definition">¶</a></dt>
<dd><p>Print QP results to stream <code class="docutils literal"><span class="pre">file</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>precision</strong> – Number of significant digits.</li>
<li><strong>ignore_imag</strong> – True if imaginary part should be ignored.</li>
<li><strong>file</strong> – Output stream.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_points_from_ebands">
<code class="descname">get_points_from_ebands</code><span class="sig-paren">(</span><em>ebands_kpath</em>, <em>dist_tol=1e-12</em>, <em>size=24</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_points_from_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_points_from_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate object storing the QP energies lying on the k-path used by ebands_kpath.
Mainly used to plot the QP energies in ebands.plot when the QP energies are interpolated with the SKW method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ebands_kpath</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with the QP energies along an arbitrary k-path.</li>
<li><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</li>
<li><strong>size</strong> – The marker size in points**2</li>
<li><strong>verbose</strong> – Verbosity level</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return:</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sigres</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">lpratio</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                       <span class="n">ks_ebands_kpath</span><span class="o">=</span><span class="n">ks_ebands_kpath</span><span class="p">,</span>
                       <span class="n">ks_ebands_kmesh</span><span class="o">=</span><span class="n">ks_ebands_kmesh</span>
                       <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">sigres</span><span class="o">.</span><span class="n">get_points_from_ebands</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">qp_ebands_kpath</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">qp_ebands_kpath</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_qpgaps">
<code class="descname">plot_qpgaps</code><span class="sig-paren">(</span><em>ax=None</em>, <em>plot_qpmks=True</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qpgaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS and the QP direct gaps for all the k-points and spins available on file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>plot_qpmks</strong> – If False, plot QP_gap, KS_gap else (QP_gap - KS_gap)</li>
<li><strong>fontsize</strong> – legend and title fontsize.</li>
<li><strong>kwargs</strong> – Passed to ax.plot method except for marker.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_qps_vs_e0">
<code class="descname">plot_qps_vs_e0</code><span class="sig-paren">(</span><em>with_fields='all'</em>, <em>exclude_fields=None</em>, <em>e0='fermie'</em>, <em>xlims=None</em>, <em>sharey=False</em>, <em>ax_list=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qps_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qps_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot QP result in SIGRES file as function of the KS energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_fields</strong> – The names of the qp attributes to plot as function of eKS.
Accepts: List of strings or string with tokens separated by blanks.
See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a> for the list of available fields.</li>
<li><strong>exclude_fields</strong> – Similar to <code class="docutils literal"><span class="pre">with_fields</span></code> but excludes fields</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</li>
<li><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> for plot. If None, new figure is produced.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>sharey</strong> – True if y-axis should be shared.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_spectral_functions">
<code class="descname">plot_spectral_functions</code><span class="sig-paren">(</span><em>include_bands=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_spectral_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_spectral_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spectral function for all k-points, bands and spins available in the SIGRES file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>include_bands</strong> – List of bands to include. Nonee means all.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_eigvec_qp">
<code class="descname">plot_eigvec_qp</code><span class="sig-paren">(</span><em>spin=0</em>, <em>kpoint=None</em>, <em>band=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_eigvec_qp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_eigvec_qp" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index</li>
<li><strong>kpoint</strong> – K-point in self-energy. Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, vector or index.
If None, all k-points for the given <code class="docutils literal"><span class="pre">spin</span></code> are shown.</li>
<li><strong>band</strong> – band index. If None all bands are displayed else
only &lt;KS_b|QP_{b’}&gt; for the given b.</li>
<li><strong>kwargs</strong> – Passed to plot method of <code class="xref py py-class docutils literal"><span class="pre">ArrayPlotter</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_qpbands_ibz">
<code class="descname">plot_qpbands_ibz</code><span class="sig-paren">(</span><em>e0='fermie'</em>, <em>colormap='jet'</em>, <em>ylims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qpbands_ibz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qpbands_ibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS band structure in the IBZ with the QP energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</li>
<li><strong>colormap</strong> – matplotlib color map.</li>
<li><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers">
<code class="descname">plot_ksbands_with_qpmarkers</code><span class="sig-paren">(</span><em>qpattr='qpeme0'</em>, <em>e0='fermie'</em>, <em>fact=1000</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_ksbands_with_qpmarkers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS energies as function of k-points and add markers whose size
is proportional to the QPState attribute <code class="docutils literal"><span class="pre">qpattr</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpattr</strong> – Name of the QP attribute to plot. See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal"><span class="pre">QPState</span></code></a>.</li>
<li><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
<li><strong>fact</strong> – Markers are multiplied by this factor.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_dataframe">
<code class="descname">get_dataframe</code><span class="sig-paren">(</span><em>ignore_imag=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with QP results for all k-points included in the GW calculation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal"><span class="pre">ignore_imag</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.to_dataframe">
<code class="descname">to_dataframe</code><span class="sig-paren">(</span><em>ignore_imag=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.gw.SigresFile.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with QP results for all k-points included in the GW calculation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal"><span class="pre">ignore_imag</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.get_dataframe_sk">
<code class="descname">get_dataframe_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>index=None</em>, <em>ignore_imag=False</em>, <em>with_params=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_dataframe_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_dataframe_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with QP results for the given (spin, k-point).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal"><span class="pre">ignore_imag</span></code>.</li>
<li><strong>with_params</strong> – True to include convergence paramenters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>lpratio=5</em>, <em>ks_ebands_kpath=None</em>, <em>ks_ebands_kmesh=None</em>, <em>ks_degatol=0.0001</em>, <em>vertices_names=None</em>, <em>line_density=20</em>, <em>filter_params=None</em>, <em>only_corrections=False</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the GW corrections in k-space on a k-path and, optionally, on a k-mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lpratio</strong> – Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</li>
<li><strong>ks_ebands_kpath</strong> – KS <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> on a k-path. If present,
the routine interpolates the QP corrections and apply them on top of the KS band structure
This is the recommended option because QP corrections are usually smoother than the
QP energies and therefore easier to interpolate. If None, the QP energies are interpolated
along the path defined by <code class="docutils literal"><span class="pre">vertices_names</span></code> and <code class="docutils literal"><span class="pre">line_density</span></code>.</li>
<li><strong>ks_ebands_kmesh</strong> – KS <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> on a homogeneous k-mesh. If present, the routine
interpolates the corrections on the k-mesh (used to compute QP the DOS)</li>
<li><strong>ks_degatol</strong> – Energy tolerance in eV. Used when either <code class="docutils literal"><span class="pre">ks_ebands_kpath</span></code> or <code class="docutils literal"><span class="pre">ks_ebands_kmesh</span></code> are given.
KS energies are assumed to be degenerate if they differ by less than this value.
The interpolator may break band degeneracies (the error is usually smaller if QP corrections
are interpolated instead of QP energies). This problem can be partly solved by averaging
the interpolated values over the set of KS degenerate states.
A negative value disables this ad-hoc symmetrization.</li>
<li><strong>vertices_names</strong> – Used to specify the k-path for the interpolated QP band structure
when <code class="docutils literal"><span class="pre">ks_ebands_kpath</span></code> is None.
It’s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <code class="docutils literal"><span class="pre">line_density</span></code> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</li>
<li><strong>line_density</strong> – Number of points in the smallest segment of the k-path. Used with <code class="docutils literal"><span class="pre">vertices_names</span></code>.</li>
<li><strong>filter_params</strong> – TO BE DESCRIBED</li>
<li><strong>only_corrections</strong> – If True, the output contains the interpolated QP corrections instead of the QP energies.
Available only if ks_ebands_kpath and/or ks_ebands_kmesh are used.</li>
<li><strong>verbose</strong> – Verbosity level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p><code class="xref py py-class docutils literal"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>* qp_ebands_kpath: |ElectronBands| with the QP energies interpolated along the k-path.
* qp_ebands_kmesh: |ElectronBands| with the QP energies interpolated on the k-mesh.
    None if ``ks_ebands_kmesh`` is not passed.
* ks_ebands_kpath: |ElectronBands| with the KS energies interpolated along the k-path.
* ks_ebands_kmesh: |ElectronBands| with the KS energies on the k-mesh..
    None if ``ks_ebands_kmesh`` is not passed.
* interpolator: |SkwInterpolator| object.
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.gw.SigresRobot">
<em class="property">class </em><code class="descclassname">abipy.electrons.gw.</code><code class="descname">SigresRobot</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal"><span class="pre">abipy.abio.robots.Robot</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.RobotWithEbands</span></code></p>
<p>This robot analyzes the results contained in multiple SIGRES.nc files.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-d94459893393f5c0e44d48b071cd3e2c7c224f54.png" alt="Inheritance diagram of SigresRobot" usemap="#inheritance898dbfdc13" class="inheritance"/>
<map id="inheritance898dbfdc13" name="inheritance898dbfdc13">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="313,51,467,74"/>
<area shape="rect" id="node4" href="#abipy.electrons.gw.SigresRobot" target="_top" title="This robot analyzes the results contained in multiple SIGRES.nc files." alt="" coords="565,28,763,51"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,51,215,74"/>
<area shape="rect" id="node3" title="Mixin class for robots associated to files with |ElectronBands|." alt="" coords="261,5,519,28"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.gw.SigresRobot.EXT">
<code class="descname">EXT</code><em class="property"> = 'SIGRES'</em><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.merge_dataframes_sk">
<code class="descname">merge_dataframes_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.merge_dataframes_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.merge_dataframes_sk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.get_qpgaps_dataframe">
<code class="descname">get_qpgaps_dataframe</code><span class="sig-paren">(</span><em>spin=None</em>, <em>kpoint=None</em>, <em>with_geo=False</em>, <em>abspath=False</em>, <em>funcs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.get_qpgaps_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.get_qpgaps_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the QP gaps for all files in the robot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – </li>
<li><strong>with_geo</strong> – True if structure info should be added to the dataframe</li>
<li><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</li>
<li><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.electrons.gw.SigresFile" title="abipy.electrons.gw.SigresFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.gw.SigresFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.get_dataframe">
<code class="descname">get_dataframe</code><span class="sig-paren">(</span><em>spin=None</em>, <em>kpoint=None</em>, <em>with_geo=False</em>, <em>abspath=False</em>, <em>funcs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with the QP gaps for all files in the robot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – </li>
<li><strong>with_geo</strong> – True if structure info should be added to the dataframe</li>
<li><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</li>
<li><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.electrons.gw.SigresFile" title="abipy.electrons.gw.SigresFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.gw.SigresFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpgaps_convergence">
<code class="descname">plot_qpgaps_convergence</code><span class="sig-paren">(</span><em>plot_qpmks=True</em>, <em>sortby=None</em>, <em>hue=None</em>, <em>sharey=False</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpgaps_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpgaps_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the direct QP gaps for all the k-points available in the robot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>plot_qpmks</strong> – If False, plot QP_gap, KS_gap else (QP_gap - KS_gap)</li>
<li><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</li>
<li><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</li>
<li><strong>sharey</strong> – True if y-axis should be shared.</li>
<li><strong>fontsize</strong> – legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpdata_conv_skb">
<code class="descname">plot_qpdata_conv_skb</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em>, <em>sortby=None</em>, <em>hue=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpdata_conv_skb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpdata_conv_skb" title="Permalink to this definition">¶</a></dt>
<dd><p>For each file in the robot, plot the convergence of the QP results for given (spin, kpoint, band)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – K-point in self-energy. Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, vector or index.</li>
<li><strong>band</strong> – Band index.</li>
<li><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</li>
<li><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</li>
<li><strong>what_list</strong> – List of strings selecting the quantity to plot.</li>
<li><strong>fontsize</strong> – legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpfield_vs_e0">
<code class="descname">plot_qpfield_vs_e0</code><span class="sig-paren">(</span><em>field</em>, <em>sortby=None</em>, <em>hue=None</em>, <em>fontsize=8</em>, <em>sharey=False</em>, <em>colormap='jet'</em>, <em>e0='fermie'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpfield_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpfield_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>For each file in the robot, plot one of the attributes of <code class="xref py py-class docutils literal"><span class="pre">QpState</span></code>
as a function of the KS energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – String defining the attribute to plot.</li>
<li><strong>sharey</strong> – True if y-axis should be shared.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the meaning of the other arguments, see other robot methods.</p>
</div>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.plot_selfenergy_conv">
<code class="descname">plot_selfenergy_conv</code><span class="sig-paren">(</span><em>spin</em>, <em>kpoint</em>, <em>band</em>, <em>sortby=None</em>, <em>hue=None</em>, <em>colormap='jet'</em>, <em>xlims=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_selfenergy_conv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_selfenergy_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the e-e self-energy wrt to the <code class="docutils literal"><span class="pre">sortby</span></code> parameter.
Values can be optionally grouped by <cite>hue</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpoint</strong> – K-point in self-energy (can be <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, list/tuple or int)</li>
<li><strong>band</strong> – Band index.</li>
<li><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</li>
<li><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</li>
<li><strong>colormap</strong> – matplotlib color map.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.gw.SigresRobot.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.lobster">
<span id="lobster-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">lobster</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.lobster" title="Permalink to this headline">¶</a></h2>
<p>Tools to analyze the output files produced by Lobster.</p>
<dl class="class">
<dt id="abipy.electrons.lobster.CoxpFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.lobster.</code><code class="descname">CoxpFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Wrapper class for the crystal orbital projections produced by Lobster.
Wraps both a COOP and a COHP.
Can contain both the total and orbitalwise projections.</p>
<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.cop_type">
<code class="descname">cop_type</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.cop_type" title="Permalink to this definition">¶</a></dt>
<dd><p>String. Either “coop” or “cohp”.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.type_of_index">
<code class="descname">type_of_index</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.type_of_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mappping site index to element string.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.energies">
<code class="descname">energies</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>List of energies. Shifted such that the Fermi level lies at 0 eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.total">
<code class="descname">total</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.total" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the total overlap, not projected over orbitals.
The dictionary should have the following nested keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0, 1)), the spin (i.e. 0 or 1), a “single”
or “integrated” string indicating the value corresponding to the value of
the energy or to the integrated value up to that energy.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.partial">
<code class="descname">partial</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.partial" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the partial crystal orbital projections.
The dictionary should have the following nested keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0, 1)), a tuple with the string representing the
projected orbitals for that pair (e.g. (“4s”, “4p_x”)), the spin (i.e. 0 or 1),
a “single” or “integrated” string indicating the value corresponding to the value of
the energy or to the integrated value up to that energy. Each dictionary should contain a
numpy array with a list of COP values with the same size as energies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.averaged">
<code class="descname">averaged</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.averaged" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the partial crystal orbital projections
averaged over all atom pairs specified. The main key should indicate the spin (0 or 1)
and the nested dictionary should have “single” and “integrated” as keys.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.fermie">
<code class="descname">fermie</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>value of the fermi energy in eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.site_pairs_total">
<code class="descname">site_pairs_total</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.site_pairs_total" title="Permalink to this definition">¶</a></dt>
<dd><p>List of site pairs available for the total COP</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.site_pairs_partial">
<code class="descname">site_pairs_partial</code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.site_pairs_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>List of site pairs available for the partial COP</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.lobster.CoxpFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of CoxpFile from the files produce by Lobster.
Accepts gzipped files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> – path to the COHPCAR.lobster or COOPCAR.lobster.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A CoxpFile.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair_lorbitals">
<code class="descname">functions_pair_lorbitals</code><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair_lorbitals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair_lorbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, orbital, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object resolved
for l orbitals.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair_morbitals">
<code class="descname">functions_pair_morbitals</code><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair_morbitals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair_morbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, orbital, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object resolved
for l and m orbitals.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair">
<code class="descname">functions_pair</code><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object for the total COP.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>what='d'</em>, <em>spin=None</em>, <em>ax=None</em>, <em>exchange_xy=False</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP averaged values (DOS or IDOS depending on what).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>what</strong> – string selecting what will be plotted. “d” for DOS, “i” for IDOS</li>
<li><strong>spin</strong> – Select spin index if not None.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_average_pairs">
<code class="descname">plot_average_pairs</code><span class="sig-paren">(</span><em>with_site_index</em>, <em>what='single'</em>, <em>exchange_xy=False</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_average_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_average_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP total overlap for all sites containg <cite>with_site_index</cite> and average sum
(multiplied by the number of pairs)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_site_index</strong> – int of list of integers selecting the site index to be included.</li>
<li><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_site_pairs_total">
<code class="descname">plot_site_pairs_total</code><span class="sig-paren">(</span><em>from_site_index</em>, <em>what='single'</em>, <em>exchange_xy=False</em>, <em>ax=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_site_pairs_total"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_site_pairs_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP total overlap (DOS or IDOS) for all sites listed in <cite>from_site_index</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>from_site_index</strong> – int of list of integers selecting the first site of the pairs to be included.</li>
<li><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair">
<code class="descname">get_labelstyle_from_spin_pair</code><span class="sig-paren">(</span><em>spin</em>, <em>pair</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.get_labelstyle_from_spin_pair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Return label and linestyle for spin and pair indices</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_site_pairs_partial">
<code class="descname">plot_site_pairs_partial</code><span class="sig-paren">(</span><em>from_site_index</em>, <em>what='single'</em>, <em>exchange_xy=True</em>, <em>ax=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_site_pairs_partial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_site_pairs_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot partial crystal orbital projections (DOS or IDOS) for all sites listed in <cite>from_site_index</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>from_site_index</strong> – int of list of integers selecting the first site of the pairs to be included.</li>
<li><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair_orbs">
<code class="descname">get_labelstyle_from_spin_pair_orbs</code><span class="sig-paren">(</span><em>spin</em>, <em>pair</em>, <em>orbs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.get_labelstyle_from_spin_pair_orbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return label and linestyle for spin, pair indices and orbs tuple.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.CoxpFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.lobster.ICoxpFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.lobster.</code><code class="descname">ICoxpFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Wrapper class for the integrated crystal orbital projections up to the Fermi energy
produced from Lobster.
May contain the output stored in ICOHPLIST.lobster and ICOOPLIST.lobster</p>
<dl class="attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.cop_type">
<code class="descname">cop_type</code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.cop_type" title="Permalink to this definition">¶</a></dt>
<dd><p>String. Either “coop” or “cohp”.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.values">
<code class="descname">values</code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.values" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the following keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0,1)), the spin (i.e. 0 or 1)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.type_of_index">
<code class="descname">type_of_index</code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.type_of_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mappping site index to element string.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.lobster.ICoxpFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of ICoxpFile from the files produce by Lobster.
Accepts gzipped files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> – path to the ICOHPLIST.lobster or ICOOPLIST.lobster.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A ICoxpFile.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.ICoxpFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.dataframe">
<code class="descname">dataframe</code><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.24.0.dev0+461.g601d71f.dirty)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> with results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.ICoxpFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Barplot with average values.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.ICoxpFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.ICoxpFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.lobster.LobsterDoscarFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.lobster.</code><code class="descname">LobsterDoscarFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Total and partial dos extracted from lobster DOSCAR.
The fermi energy is always at the zero value.</p>
<dl class="attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.energies">
<code class="descname">energies</code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>List of energies. Shifted such that the Fermi level lies at 0 eV.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.total_dos">
<code class="descname">total_dos</code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.total_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with spin as a key (i.e. 0 or 1) and containing the values of the total DOS.
Should have the same size as energies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.pdos">
<code class="descname">pdos</code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.pdos" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the projected DOS.
The dictionary should have the following nested keys: the index of the site (0-based),
the string representing the projected orbital (e.g. “4p_x”), the spin (i.e. 0 or 1).
Each dictionary should contain a numpy array with a list of DOS values with the
same size as energies.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance from the DOSCAR.lobster file.
Accepts gzipped files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> – path to the DOSCAR.lobster.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A LobsterDoscarFile.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with Verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>spin=None</em>, <em>ax=None</em>, <em>exchange_xy=False</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot DOS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spin</strong> – </li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.plot_pdos_site">
<code class="descname">plot_pdos_site</code><span class="sig-paren">(</span><em>site_index</em>, <em>ax=None</em>, <em>exchange_xy=False</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.plot_pdos_site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.plot_pdos_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot projected DOS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>site_index</strong> – </li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.lobster.LobsterInput">
<em class="property">class </em><code class="descclassname">abipy.electrons.lobster.</code><code class="descname">LobsterInput</code><span class="sig-paren">(</span><em>basis_set=None</em>, <em>basis_functions=None</em>, <em>include_orbitals=None</em>, <em>atom_pairs=None</em>, <em>dist_range=None</em>, <em>orbitalwise=True</em>, <em>start_en=None</em>, <em>end_en=None</em>, <em>en_steps=None</em>, <em>gaussian_smearing=None</em>, <em>bwdf=None</em>, <em>advanced_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object stores the basic variables for a Lobster input and generates the lobsterin file.</p>
<dl class="attribute">
<dt id="abipy.electrons.lobster.LobsterInput.accepted_basis_sets">
<code class="descname">accepted_basis_sets</code><em class="property"> = {'koga', 'pbevaspfit2015', 'bunge'}</em><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.accepted_basis_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.lobster.LobsterInput.available_advanced_options">
<code class="descname">available_advanced_options</code><em class="property"> = {'skipReOrthonormalization', 'doNotOrthogonalizeBasis', 'doNotUseAbsoluteSpilling', 'noSymmetryCorrection', 'writeBasisFunctions', 'useDecimalPlaces', 'forceEnergyRange', 'onlyReadVasprun.xml', 'skipPAWOrthonormalityTest', 'forceV1HMatrix', 'basisRotation', 'noMemoryMappedFiles', 'doNotIgnoreExcessiveBands', 'useOriginalTetrahedronMethod', 'symmetryDetectionPrecision'}</em><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.available_advanced_options" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterInput.set_basis_functions_from_abinit_pseudos">
<code class="descname">set_basis_functions_from_abinit_pseudos</code><span class="sig-paren">(</span><em>pseudos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.set_basis_functions_from_abinit_pseudos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.set_basis_functions_from_abinit_pseudos" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the basis function used from the PAW abinit pseudopotentials</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pseudos</strong> – a list of Pseudos objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterInput.set_basis_functions_from_potcar">
<code class="descname">set_basis_functions_from_potcar</code><span class="sig-paren">(</span><em>potcar</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.set_basis_functions_from_potcar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.set_basis_functions_from_potcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the basis function used from a POTCAR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>potcar</strong> – a pymatgen.io.vasp.inputs.Potcar object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterInput.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.lobster.LobsterInput.from_dir">
<em class="property">classmethod </em><code class="descname">from_dir</code><span class="sig-paren">(</span><em>dirpath</em>, <em>dE=0.01</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.from_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of the class based on the output folder of a DFT calculation.
Reads the information from the pseudopotentials in order to determine the
basis functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dirpath</strong> – the path to the calculation directory. For abinit it should contain the
“files” file and GSR file, for vasp it should contain the vasprun.xml and the POTCAR.</li>
<li><strong>dE</strong> – The spacing of the energy sampling in eV.</li>
<li><strong>kwargs</strong> – the inputs for the init method, except for basis_functions, start_en,
end_en and en_steps.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A LobsterInput.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterInput.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>dirpath='.'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the input file ‘lobsterin’ in dirpath.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.lobster.LobsterAnalyzer">
<em class="property">class </em><code class="descclassname">abipy.electrons.lobster.</code><code class="descname">LobsterAnalyzer</code><span class="sig-paren">(</span><em>dirpath</em>, <em>prefix</em>, <em>coop_path=None</em>, <em>cohp_path=None</em>, <em>icohp_path=None</em>, <em>lobdos_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<dl class="classmethod">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.from_dir">
<em class="property">classmethod </em><code class="descname">from_dir</code><span class="sig-paren">(</span><em>dirpath</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.from_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of the class based on the output folder of a DFT calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dirpath</strong> – the path to the calculation directory.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>entries=('coop'</em>, <em>'cohp'</em>, <em>'doscar')</em>, <em>spin=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COOP + COHP + DOSCAR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>entries</strong> – “cohp” to plot COHP, “coop” for COOP</li>
<li><strong>spin</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.plot_coxp_with_dos">
<code class="descname">plot_coxp_with_dos</code><span class="sig-paren">(</span><em>from_site_index</em>, <em>what='cohp'</em>, <em>with_orbitals=False</em>, <em>exchange_xy=True</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.plot_coxp_with_dos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.plot_coxp_with_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COHP (COOP) for all sites in from_site_index and Lobster DOS on len(from_site_index) + 1 subfigures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>from_site_index</strong> – List of site indices for COHP (COOP)</li>
<li><strong>what</strong> – “cohp” to plot COHP, “coop” for COOP</li>
<li><strong>with_orbitals</strong> – True if orbital projections are wanted.</li>
<li><strong>exchange_xy</strong> – True to exchange x-y axis. By default, use x-axis for DOS-like quantities.</li>
<li><strong>fontsize</strong> – fontsize for legends and titles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.optic">
<span id="optic-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">optic</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.optic" title="Permalink to this headline">¶</a></h2>
<p>Objects to read and analyze optical properties stored in the optic.nc file produced by optic executable.</p>
<dl class="function">
<dt id="abipy.electrons.optic.reflectivity">
<code class="descclassname">abipy.electrons.optic.</code><code class="descname">reflectivity</code><span class="sig-paren">(</span><em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#reflectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.reflectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Reflectivity(w) from vacuum, at normal incidence</p>
</dd></dl>

<dl class="function">
<dt id="abipy.electrons.optic.kappa">
<code class="descclassname">abipy.electrons.optic.</code><code class="descname">kappa</code><span class="sig-paren">(</span><em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#kappa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Im(refractive index(w)) aka kappa</p>
</dd></dl>

<dl class="function">
<dt id="abipy.electrons.optic.n">
<code class="descclassname">abipy.electrons.optic.</code><code class="descname">n</code><span class="sig-paren">(</span><em>eps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Re(refractive index(w)) aka n</p>
</dd></dl>

<dl class="class">
<dt id="abipy.electrons.optic.OpticNcFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.optic.</code><code class="descname">OpticNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This file contains the results produced by optic. Provides methods to plot optical
properties and susceptibilty tensors. Used by <a class="reference internal" href="#abipy.electrons.optic.OpticRobot" title="abipy.electrons.optic.OpticRobot"><code class="xref py py-class docutils literal"><span class="pre">OpticRobot</span></code></a> to analyze multiple files.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">OpticNcFile</span><span class="p">(</span><span class="s2">&quot;out_optic.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">optic</span><span class="p">:</span>
    <span class="n">optic</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">optic</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-a3ba07137f05177910572efd5f977baff217a7e4.png" alt="Inheritance diagram of OpticNcFile" usemap="#inheritanced1888ea308" class="inheritance"/>
<map id="inheritanced1888ea308" name="inheritanced1888ea308">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="256,197,454,221"/>
<area shape="rect" id="node7" href="#abipy.electrons.optic.OpticNcFile" target="_top" title="This file contains the results produced by optic. Provides methods to plot optical" alt="" coords="525,101,740,125"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,197,184,221"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for :class:`AbinitNcFile` containing electron data." alt="" coords="232,5,477,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf_ files containing the Abinit header." alt="" coords="254,53,456,77"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="249,101,461,125"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="245,149,464,173"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.optic.OpticNcFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a netcdf file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.wmesh">
<code class="descname">wmesh</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.wmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency mesh in eV. Note that the same frequency-mesh is used
for the different optical properties.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.ebands">
<code class="descname">ebands</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.has_linopt">
<code class="descname">has_linopt</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_linopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_linopt" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains Second Harmonic Generation tensor.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.has_shg">
<code class="descname">has_shg</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_shg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_shg" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains Second Harmonic Generation tensor.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.has_leo">
<code class="descname">has_leo</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_leo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_leo" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains the Linear Electro-optic tensor</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticNcFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.electrons.optic.OpticNcFile.get_linopt_latex_label">
<em class="property">static </em><code class="descname">get_linopt_latex_label</code><span class="sig-paren">(</span><em>what</em>, <em>comp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.get_linopt_latex_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.get_linopt_latex_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return latex label for linear-optic quantities. Used in plots.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.get_chi2_latex_label">
<code class="descname">get_chi2_latex_label</code><span class="sig-paren">(</span><em>key</em>, <em>what</em>, <em>comp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.get_chi2_latex_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.get_chi2_latex_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Build latex label for chi2-related quantities. Used in plots.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_linear_epsilon">
<code class="descname">plot_linear_epsilon</code><span class="sig-paren">(</span><em>components='all'</em>, <em>what='im'</em>, <em>itemp=0</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>with_xlabel=True</em>, <em>label=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_linear_epsilon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_linear_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot components of the linear dielectric function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>what</strong> – quantity to plot. “re” for real part, “im” for imaginary. Accepts also “abs”, “angle”.</li>
<li><strong>itemp</strong> – Temperature index.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>with_xlabel</strong> – True if x-label should be added.</li>
<li><strong>label</strong> – True to add legend label to each curve.</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_linopt">
<code class="descname">plot_linopt</code><span class="sig-paren">(</span><em>select='all'</em>, <em>itemp=0</em>, <em>xlims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_linopt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_linopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Subplots with all linear optic quantities selected by <code class="docutils literal"><span class="pre">select</span></code> at temperature <code class="docutils literal"><span class="pre">itemp</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>select</strong> – </li>
<li><strong>itemp</strong> – Temperature index.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_chi2">
<code class="descname">plot_chi2</code><span class="sig-paren">(</span><em>key</em>, <em>components='all'</em>, <em>what='abs'</em>, <em>itemp=0</em>, <em>decompose=False</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>with_xlabel=True</em>, <em>label=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_chi2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-level function to plot chi2 tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – </li>
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>what</strong> – quantity to plot. “re” for real part, “im” for imaginary, Accepts also “abs”, “angle”.</li>
<li><strong>itemp</strong> – Temperature index.</li>
<li><strong>decompose</strong> – True to plot individual contributions.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
<li><strong>with_xlabel</strong> – True to add x-label.</li>
<li><strong>label</strong> – True to add legend label to each curve.</li>
<li><strong>fontsize</strong> – Legend and label fontsize.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_shg">
<code class="descname">plot_shg</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_shg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_shg" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Second Harmonic Generation. See plot_chi2 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_leo">
<code class="descname">plot_leo</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_leo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_leo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Linear Electro-optic. See plot_chi2 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticNcFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.optic.OpticReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.optic.</code><code class="descname">OpticReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronsReader</span></code></p>
<p>This object reads the results stored in the optic.nc file
It provides helper function to access the most important quantities.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-50ee041f0e94f6d86fd844c4d4d834992294c89d.png" alt="Inheritance diagram of OpticReader" usemap="#inheritance8a04e82e04" class="inheritance"/>
<map id="inheritance8a04e82e04" name="inheritance8a04e82e04">
<area shape="rect" id="node1" title="Mixin class that provides methods for reading k&#45;point data from a netcdf" alt="" coords="326,3,459,16"/>
<area shape="rect" id="node2" title="This object reads band structure data from a netcdf_ file." alt="" coords="485,16,623,28"/>
<area shape="rect" id="node4" href="#abipy.electrons.optic.OpticReader" target="_top" title="This object reads the results stored in the optic.nc file" alt="" coords="648,16,765,28"/>
<area shape="rect" id="node3" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="344,28,441,41"/>
<area shape="rect" id="node5" title="This object reads data from a file written according to the ETSF&#45;IO specifications." alt="" coords="164,28,301,41"/>
<area shape="rect" id="node6" title="Wraps and extends netCDF4.Dataset. Read only mode. Supports with statements." alt="" coords="3,28,138,41"/>
</map>
<dl class="method">
<dt id="abipy.electrons.optic.OpticReader.read_lineps">
<code class="descname">read_lineps</code><span class="sig-paren">(</span><em>components</em>, <em>itemp=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader.read_lineps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader.read_lineps" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>itemp</strong> – Temperature index.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticReader.read_tensor3_terms">
<code class="descname">read_tensor3_terms</code><span class="sig-paren">(</span><em>key</em>, <em>components</em>, <em>itemp=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader.read_tensor3_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader.read_tensor3_terms" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – Name of the netcdf variable to read.</li>
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>itemp</strong> – Temperature index.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> mapping cartesian components e.g. “xyz” to data dictionary.
Individual entries are listed in ALL_CHIS[key][“terms”]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.optic.OpticRobot">
<em class="property">class </em><code class="descclassname">abipy.electrons.optic.</code><code class="descname">OpticRobot</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal"><span class="pre">abipy.abio.robots.Robot</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.RobotWithEbands</span></code></p>
<p>This robot analyzes the results contained in multiple optic.nc files.</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-a142566af87d8596aa12ba12bc871d102cc0415c.png" alt="Inheritance diagram of OpticRobot" usemap="#inheritancee9986e91d2" class="inheritance"/>
<map id="inheritancee9986e91d2" name="inheritancee9986e91d2">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="311,51,464,74"/>
<area shape="rect" id="node4" href="#abipy.electrons.optic.OpticRobot" target="_top" title="This robot analyzes the results contained in multiple optic.nc files." alt="" coords="561,28,763,51"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,51,214,74"/>
<area shape="rect" id="node3" title="Mixin class for robots associated to files with |ElectronBands|." alt="" coords="260,5,515,28"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.optic.OpticRobot.EXT">
<code class="descname">EXT</code><em class="property"> = 'OPTIC'</em><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.optic.OpticRobot.computed_components_intersection">
<code class="descname">computed_components_intersection</code><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.computed_components_intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.computed_components_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the list of cartesian tensor components
available in each file. Use keys from ALL_CHIS.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.plot_linopt_convergence">
<code class="descname">plot_linopt_convergence</code><span class="sig-paren">(</span><em>components='all'</em>, <em>what_list=('re'</em>, <em>'im')</em>, <em>sortby='nkpt'</em>, <em>itemp=0</em>, <em>xlims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_linopt_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_linopt_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the dielectric function tensor with respect to
parameter defined by <code class="docutils literal"><span class="pre">sortby</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>what_list</strong> – List of quantities to plot. “re” for real part, “im” for imaginary.
Accepts also “abs”, “angle”.</li>
<li><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels. Can be None, string or function.
If None, no sorting is performed.
If string, it’s assumed that the ncfile has an attribute with the same name and getattr is invoked.
If callable, the output of callable(ncfile) is used.</li>
<li><strong>itemp</strong> – Temperature index.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.plot_shg_convergence">
<code class="descname">plot_shg_convergence</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_shg_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_shg_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Second Harmonic Generation. See plot_convergence_rank3 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.plot_leo_convergence">
<code class="descname">plot_leo_convergence</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_leo_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_leo_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Linear electron-optic. See plot_convergence_rank3 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.plot_convergence_rank3">
<code class="descname">plot_convergence_rank3</code><span class="sig-paren">(</span><em>key</em>, <em>components='all'</em>, <em>itemp=0</em>, <em>what_list=('abs'</em>, <em>)</em>, <em>sortby='nkpt'</em>, <em>decompose=False</em>, <em>xlims=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_convergence_rank3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_convergence_rank3" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot convergence of arbitrary rank3 tensor. This is a low-level routine used in other plot methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – Name of the quantity to analyze.</li>
<li><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</li>
<li><strong>itemp</strong> – Temperature index.</li>
<li><strong>what_list</strong> – List of quantities to plot. “re” for real part, “im” for imaginary.
Accepts also “abs”, “angle”.</li>
<li><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels. Can be None, string or function.
If None, no sorting is performed.
If string, it’s assumed that the ncfile has an attribute with the same name and <code class="docutils literal"><span class="pre">getattr</span></code> is invoked.
If callable, the output of callable(ncfile) is used.</li>
<li><strong>decompose</strong> – True to plot individual contributions.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.optic.OpticRobot.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.psps">
<span id="psps-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">psps</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.psps" title="Permalink to this headline">¶</a></h2>
<p>PSPS file with tabulated data.</p>
<dl class="function">
<dt id="abipy.electrons.psps.mklabel">
<code class="descclassname">abipy.electrons.psps.</code><code class="descname">mklabel</code><span class="sig-paren">(</span><em>fsym</em>, <em>der</em>, <em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#mklabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.mklabel" title="Permalink to this definition">¶</a></dt>
<dd><p>mklabel(f, 2, x) –&gt; $f’‘(x)$</p>
</dd></dl>

<dl class="function">
<dt id="abipy.electrons.psps.rescale">
<code class="descclassname">abipy.electrons.psps.</code><code class="descname">rescale</code><span class="sig-paren">(</span><em>arr</em>, <em>scale=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#rescale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.rescale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="abipy.electrons.psps.PspsFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">PspsFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a></p>
<p>Netcdf file with the tables used in Abinit to apply the
pseudopotential part of the KS Hamiltonian.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">PspsFile</span><span class="p">(</span><span class="s2">&quot;foo_PSPS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">psps</span><span class="p">:</span>
    <span class="n">psps</span><span class="o">.</span><span class="n">plot_tcore_rspace</span><span class="p">()</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="abipy.electrons.psps.PspsFile.linestyles_der">
<code class="descname">linestyles_der</code><em class="property"> = ['-', '--', '-.', ':', ':', ':']</em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.linestyles_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.PspsFile.color_der">
<code class="descname">color_der</code><em class="property"> = ['black', 'red', 'green', 'orange', 'cyan']</em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.color_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.psps.PspsFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.PspsFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver routine to plot several quantities on the same graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ecut_ffnl</strong> – Max cutoff energy for ffnl plot (optional)</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_rspace">
<code class="descname">plot_tcore_rspace</code><span class="sig-paren">(</span><em>ax=None</em>, <em>ders=(0</em>, <em>1</em>, <em>2</em>, <em>3)</em>, <em>rmax=3.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_rspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_rspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model core and its derivatives in real space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</li>
<li><strong>rmax</strong> – Max radius for plot in Bohr. None is full grid is wanted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_qspace">
<code class="descname">plot_tcore_qspace</code><span class="sig-paren">(</span><em>ax=None</em>, <em>ders=(0</em>, <em>)</em>, <em>with_fact=True</em>, <em>with_qn=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_qspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_qspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model core in q space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</li>
<li><strong>with_qn</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_vlocq">
<code class="descname">plot_vlocq</code><span class="sig-paren">(</span><em>ax=None</em>, <em>ders=(0</em>, <em>)</em>, <em>with_qn=0</em>, <em>with_fact=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_vlocq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_vlocq" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the local part of the pseudopotential in q space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</li>
<li><strong>with_qn</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.plot_ffspl">
<code class="descname">plot_ffspl</code><span class="sig-paren">(</span><em>ax=None</em>, <em>ecut_ffnl=None</em>, <em>ders=(0</em>, <em>)</em>, <em>with_qn=0</em>, <em>with_fact=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_ffspl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_ffspl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the nonlocal part of the pseudopotential in q-space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>ecut_ffnl</strong> – Max cutoff energy for ffnl plot (optional)</li>
<li><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</li>
<li><strong>with_qn</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsFile.compare">
<code class="descname">compare</code><span class="sig-paren">(</span><em>others</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.compare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce matplotlib plot comparing self with another list of pseudos <code class="docutils literal"><span class="pre">others</span></code>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.psps.PspsReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">PspsReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the PSPS file produced by ABINIT.
It provides helper function to access the most important quantities.</p>
<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_coresd">
<code class="descname">read_coresd</code><span class="sig-paren">(</span><em>rmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_coresd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_coresd" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the core charges and derivatives for the different types of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rmax</strong> – Maximum radius in Bohr. If None, data on the full grid is returned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of ntypat arrays. Each array contains the linear meshes in real space.
coresd: List with nytpat arrays of shape [6, npts].<p>(np.zeros. np.zeros) if core charge is not present</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">meshes</td>
</tr>
</tbody>
</table>
<p>xccc1d[ntypat6,n1xccc*(1-usepaw)]</p>
<p>Norm-conserving psps only
The component xccc1d(n1xccc,1,ntypat) is the pseudo-core charge
for each type of atom, on the radial grid. The components
xccc1d(n1xccc,ideriv,ntypat) give the ideriv-th derivative of the
pseudo-core charge with respect to the radial distance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_tcorespl">
<code class="descname">read_tcorespl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_tcorespl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_tcorespl" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Linear q-mesh in G-space
tcorespl:</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">qmesh</td>
</tr>
</tbody>
</table>
<p>tcorespl[ntypat, 2, mqgrid_vl]
Gives the pseudo core density in reciprocal space on a regular grid.
Only if has_tcore</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_vlspl">
<code class="descname">read_vlspl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_vlspl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_vlspl" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Linear q-mesh in G-space
vlspl:</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">qmesh</td>
</tr>
</tbody>
</table>
<p>vlspl[2, ntypat, mqgrid_vl]
Gives, on the radial grid, the local part of each type of psp.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.read_projectors">
<code class="descname">read_projectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_projectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_projectors" title="Permalink to this definition">¶</a></dt>
<dd><p>ffspl(ntypat, lnmax, 2, mqgrid_ff]
Gives, on the radial grid, the different non-local projectors,
in both the norm-conserving case, and the PAW case</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.psps.PspsReader.get_lnlist_for_type">
<code class="descname">get_lnlist_for_type</code><span class="sig-paren">(</span><em>itypat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.get_lnlist_for_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.get_lnlist_for_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of (l, n) indices for this atom type.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.psps.VnlProjector">
<em class="property">class </em><code class="descclassname">abipy.electrons.psps.</code><code class="descname">VnlProjector</code><span class="sig-paren">(</span><em>itypat</em>, <em>ln</em>, <em>ekb</em>, <em>qmesh</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#VnlProjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.psps.VnlProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Data and parameters associated to a non-local projector.</p>
<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.values">
<code class="descname">values</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the projector in q-space.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.der2">
<code class="descname">der2</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.der2" title="Permalink to this definition">¶</a></dt>
<dd><p>Second order derivative.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.ecuts">
<code class="descname">ecuts</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.ecuts" title="Permalink to this definition">¶</a></dt>
<dd><p>List of cutoff energies corresponding to self.qmesh.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.psps.VnlProjector.sign_sqrtekb">
<code class="descname">sign_sqrtekb</code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.sign_sqrtekb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scissors">
<span id="scissors-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">scissors</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.scissors" title="Permalink to this headline">¶</a></h2>
<p>Scissors operator.</p>
<dl class="class">
<dt id="abipy.electrons.scissors.Scissors">
<em class="property">class </em><code class="descclassname">abipy.electrons.scissors.</code><code class="descname">Scissors</code><span class="sig-paren">(</span><em>func_list</em>, <em>domains</em>, <em>residues</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object represents an energy-dependent scissors operator.
The operator is defined by a list of domains (energy intervals)
and a list of functions defined in these domains.
The domains should fulfill the constraints documented in the main constructor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">eV units are assumed.</p>
</div>
<p>The standard way to create this object is via the methods provided by the factory class <code class="xref py py-class docutils literal"><span class="pre">ScissorBuilder</span></code>.
Once the instance has been created, one can correct the band structure by calling the <cite>apply</cite> method.</p>
<dl class="attribute">
<dt id="abipy.electrons.scissors.Scissors.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.electrons.scissors.Scissors.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ScissorsError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.Scissors.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>eig</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the eigenvalue eig (eV units).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scissors.ScissorsBuilder">
<em class="property">class </em><code class="descclassname">abipy.electrons.scissors.</code><code class="descname">ScissorsBuilder</code><span class="sig-paren">(</span><em>qps_spin</em>, <em>sigres_ebands</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>This object facilitates the creation of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code></a> instances.</p>
<p>Usage:</p>
<blockquote>
<div><p>builder = ScissorsBuilder.from_file(“out_SIGRES.nc”)</p>
<p># To plot the QP results as function of the KS energy:
builder.plot_qpe_vs_e0()</p>
<p># To select the domains esplicitly (optional but highly recommended)
builder.build(domains_spin=[[-10, 6.02], [6.1, 20]])</p>
<p># To compare the fitted results with the ab-initio data:
builder.plot_fit()</p>
<p># To plot the corrected bands:
builder.plot_qpbands(abidata.ref_file(“si_nscf_WFK.nc”))</p>
</div></blockquote>
<dl class="classmethod">
<dt id="abipy.electrons.scissors.ScissorsBuilder.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate object from (SIGRES.nc) file. Main entry point for client code.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_load">
<em class="property">classmethod </em><code class="descname">pickle_load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from a pickle file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_dump">
<code class="descname">pickle_dump</code><span class="sig-paren">(</span><em>filepath</em>, <em>protocol=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object in Pickle format</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.nsppol">
<code class="descname">nsppol</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.nsppol" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spins.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0min">
<code class="descname">e0min</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0min" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0max">
<code class="descname">e0max</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0max" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scissors.ScissorsBuilder.scissors_spin">
<code class="descname">scissors_spin</code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.scissors_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal"><span class="pre">Scissors</span></code></a> indexed by the spin value.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>domains_spin=None</em>, <em>bounds_spin=None</em>, <em>k=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the scissors operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>domains_spin</strong> – list of domains in eV for each spin. If domains is None,
domains are computed automatically from the sigres bands
(two domains separated by the middle of the gap).</li>
<li><strong>bounds_spin</strong> – Options specifying the boundary conditions (not used at present)</li>
<li><strong>k</strong> – Parameter defining the order of the fit.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0">
<code class="descname">plot_qpe_vs_e0</code><span class="sig-paren">(</span><em>with_fields='all'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpe_vs_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the quasiparticle corrections as function of the KS energy.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_fit">
<code class="descname">plot_fit</code><span class="sig-paren">(</span><em>ax=None</em>, <em>fontsize=8</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare fit functions with input quasi-particle corrections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – fontsize for titles and legend.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpbands">
<code class="descname">plot_qpbands</code><span class="sig-paren">(</span><em>bands_filepath</em>, <em>bands_label=None</em>, <em>dos_filepath=None</em>, <em>dos_args=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the energies found in the netcdf file bands_filepath and plot the band energies (both the initial
and the corrected ones) with matplotlib. The plot contains the KS and the QP DOS if dos_filepath is not None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bands_filepath</strong> – Path to the netcdf file containing the initial KS energies to be corrected.</li>
<li><strong>String used to label the KS bands in the plot.</strong> (<em>bands_label</em>) – </li>
<li><strong>dos_filepath</strong> – Optional path to a netcdf file with the initial KS energies on a homogeneous k-mesh
(used to compute the KS and the QP dos)</li>
<li><strong>dos_args</strong> – Dictionary with the arguments passed to get_dos to compute the DOS
Used if dos_filepath is not None.</li>
<li><strong>kwargs</strong> – Options passed to the plotter.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scr">
<span id="scr-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal"><span class="pre">scr</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.scr" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze the screening files produced by the GW code (optdriver 3).</p>
<dl class="class">
<dt id="abipy.electrons.scr.ScrFile">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">ScrFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <code class="docutils literal"><span class="pre">SCR.nc</span></code> file produced by the GW code.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ScrFile</span><span class="p">(</span><span class="s2">&quot;foo_SCR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">plot_emacro</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-4e469f0754e39c9ee70d6491ddd23e0dd626460b.png" alt="Inheritance diagram of ScrFile" usemap="#inheritance7cf8f6d793" class="inheritance"/>
<map id="inheritance7cf8f6d793" name="inheritance7cf8f6d793">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="243,149,441,173"/>
<area shape="rect" id="node6" href="#abipy.electrons.scr.ScrFile" target="_top" title="This object provides an interface to the ``SCR.nc`` file produced by the GW code." alt="" coords="500,77,676,101"/>
<area shape="rect" id="node2" title="Abstract base class defining the methods that must be implemented" alt="" coords="5,149,184,173"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf_ files containing the Abinit header." alt="" coords="241,5,443,29"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for :class:`AbinitNcFile` containing crystallographic data." alt="" coords="236,53,448,77"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="232,101,452,125"/>
</map>
<dl class="classmethod">
<dt id="abipy.electrons.scr.ScrFile.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.kpoints">
<code class="descname">kpoints</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of k-points in the dielectric function.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.ebands">
<code class="descname">ebands</code><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with the single-particle energies used to compute the screening.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.ng">
<code class="descname">ng</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.ng" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of G-vectors in screening matrices.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.wpoints">
<code class="descname">wpoints</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.wpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of complex numbers with the frequencies of the dielectric function in Hartree.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.nw">
<code class="descname">nw</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nw" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of frequencies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.nrew">
<code class="descname">nrew</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nrew" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of real frequencies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.nimw">
<code class="descname">nimw</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nimw" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of imaginary frequencies.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.netcdf_name">
<code class="descname">netcdf_name</code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> name associated to the data on disk.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.ScrFile.params">
<code class="descname">params</code><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal"><span class="pre">monty.collections.AttrDict</span></code></a> with the most important parameters used to compute the screening
keys can be accessed with the dot notation i.e. <code class="docutils literal"><span class="pre">params.zcut</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.plot_emacro">
<code class="descname">plot_emacro</code><span class="sig-paren">(</span><em>cplx_mode='re-im'</em>, <em>ax=None</em>, <em>xlims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.plot_emacro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.plot_emacro" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macroscopic dielectric function with local-field effects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cplx_mode</strong> – string defining the data to print.
Possible choices are (case-insensitive):
“re” for the real part. “im” for the imaginary part.
“abs” for the absolute value.
“angle” will display the phase of the complex number in radians.
Options can be concatenated with <code class="docutils literal"><span class="pre">-</span></code> e.g. <code class="docutils literal"><span class="pre">re-im</span></code>.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. (left, right)
or scalar e.g. left. If left (right) is None, default values are used.</li>
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>fontsize</strong> – Legend and title fontsize.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.plot_eelf">
<code class="descname">plot_eelf</code><span class="sig-paren">(</span><em>ax=None</em>, <em>xlims=None</em>, <em>fontsize=12</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.plot_eelf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.plot_eelf" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electron energy loss function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</li>
<li><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. <code class="docutils literal"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal"><span class="pre">left</span></code>. If left (right) is None, default values are used</li>
<li><strong>fontsize</strong> – Legend and label fontsize:</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v2.2.3)"><code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>“abc.png” or “abc.eps” to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>ax_grid</td>
<td>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</td>
</tr>
<tr class="row-odd"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.yield_figs">
<code class="descname">yield_figs</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.yield_figs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrFile.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.ScrReader">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">ScrReader</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the SCR (Screening) file produced by ABINIT.
It provides helper functions to access the most important quantities.</p>
<p>double inverse_dielectric_function(number_of_qpoints_dielectric_function,
number_of_frequencies_dielectric_function, number_of_spins, number_of_spins,
number_of_coefficients_dielectric_function, number_of_coefficients_dielectric_function, complex)</p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-1e79ff02ab4f90dd562564d2e316d3cd7609bc65.png" alt="Inheritance diagram of ScrReader" usemap="#inheritance7426748bd3" class="inheritance"/>
<map id="inheritance7426748bd3" name="inheritance7426748bd3">
<area shape="rect" id="node1" href="#abipy.electrons.scr.ScrReader" target="_top" title="This object reads the results stored in the SCR (Screening) file produced by ABINIT." alt="" coords="619,4,764,21"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="450,4,584,21"/>
<area shape="rect" id="node3" title="This object reads data from a file written according to the ETSF&#45;IO specifications." alt="" coords="226,4,415,21"/>
<area shape="rect" id="node4" title="Wraps and extends netCDF4.Dataset. Read only mode. Supports with statements." alt="" coords="4,4,191,21"/>
</map>
<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_params">
<code class="descname">read_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the most important parameters used to compute the screening i.e.
the parameters that may be subject to convergence studies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal"><span class="pre">monty.collections.AttrDict</span></code></a> a dictionary whose keys can be accessed with the dot notation i.e. <code class="docutils literal"><span class="pre">d.key</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_emacro_lf">
<code class="descname">read_emacro_lf</code><span class="sig-paren">(</span><em>kpoint=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_emacro_lf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_emacro_lf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the macroscopic dielectric function <em>with</em> local field effects 1 / em1_{0,0)(kpoint, omega).</p>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_emacro_nlf">
<code class="descname">read_emacro_nlf</code><span class="sig-paren">(</span><em>kpoint=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_emacro_nlf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_emacro_nlf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the macroscopic dielectric function <em>without</em> local field effects e_{0,0)(kpoint, omega).</p>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function performs the inversion of e-1 to get e.
that can be quite expensive and memory demanding for large matrices!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_eelf">
<code class="descname">read_eelf</code><span class="sig-paren">(</span><em>kpoint=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_eelf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_eelf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read electron energy loss function</p>
<blockquote>
<div><ul class="simple">
<li>Im(1/ emacro)</li>
</ul>
</div></blockquote>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_wggmat">
<code class="descname">read_wggmat</code><span class="sig-paren">(</span><em>kpoint</em>, <em>spin1=0</em>, <em>spin2=0</em>, <em>cls=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_wggmat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_wggmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data at the given k-point and return an instance of <code class="docutils literal"><span class="pre">cls</span></code> where
<code class="docutils literal"><span class="pre">cls</span></code> is a subclass of <code class="xref py py-class docutils literal"><span class="pre">_AwggMatrix</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.find_kpoint_fileindex">
<code class="descname">find_kpoint_fileindex</code><span class="sig-paren">(</span><em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.find_kpoint_fileindex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.find_kpoint_fileindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the k-point and the index of the k-point in the netcdf file.
Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.electrons.scr.ScrReader.read_wslice">
<code class="descname">read_wslice</code><span class="sig-paren">(</span><em>kpoint</em>, <em>ig1=0</em>, <em>ig2=0</em>, <em>spin1=0</em>, <em>spin2=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_wslice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_wslice" title="Permalink to this definition">¶</a></dt>
<dd><p>Read slice along the frequency dimension.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.Polarizability">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">Polarizability</code><span class="sig-paren">(</span><em>wpoints</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord='C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#Polarizability"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.Polarizability" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-7f552492bdb6e8506b17b3ebafdd819255e269bc.png" alt="Inheritance diagram of Polarizability" usemap="#inheritancebef77cc23b" class="inheritance"/>
<map id="inheritancebef77cc23b" name="inheritancebef77cc23b">
<area shape="rect" id="node1" href="#abipy.electrons.scr.Polarizability" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,215,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.scr.Polarizability.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'polarizability'</em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.Polarizability.latex_name">
<code class="descname">latex_name</code><em class="property"> = '\\tilde chi'</em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.DielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">DielectricFunction</code><span class="sig-paren">(</span><em>wpoints</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord='C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#DielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-0023aaf16a680f3a72a2f6f39c050bee05d013ee.png" alt="Inheritance diagram of DielectricFunction" usemap="#inheritance6199a96776" class="inheritance"/>
<map id="inheritance6199a96776" name="inheritance6199a96776">
<area shape="rect" id="node1" href="#abipy.electrons.scr.DielectricFunction" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,246,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.scr.DielectricFunction.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'dielectric_function'</em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.DielectricFunction.latex_name">
<code class="descname">latex_name</code><em class="property"> = '\\epsilon'</em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.electrons.scr.InverseDielectricFunction">
<em class="property">class </em><code class="descclassname">abipy.electrons.scr.</code><code class="descname">InverseDielectricFunction</code><span class="sig-paren">(</span><em>wpoints</em>, <em>gsphere</em>, <em>wggmat</em>, <em>inord='C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#InverseDielectricFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<img src="../_images/inheritance-073ec3b618aa71f081fc9263bd4b53c146aa0a0c.png" alt="Inheritance diagram of InverseDielectricFunction" usemap="#inheritancee337708410" class="inheritance"/>
<map id="inheritancee337708410" name="inheritancee337708410">
<area shape="rect" id="node1" href="#abipy.electrons.scr.InverseDielectricFunction" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,290,29"/>
</map>
<dl class="attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'inverse_dielectric_function'</em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.latex_name">
<code class="descname">latex_name</code><em class="property"> = '\\epsilon^{-1}'</em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, M. Giantomassi and the AbiPy group.<br/>
      Last updated on Aug 14, 2018.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>