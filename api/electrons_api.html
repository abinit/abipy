

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>electrons Package &mdash; abipy 0.9.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
    <script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script> 
    
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="eph Package" href="eph_api.html" />
    <link rel="prev" title="dynamics Package" href="dynamics_api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> abipy
          

          
          </a>

          
            
            
              <div class="version">
                0.9.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphical_interface.html">Graphical interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="abilab_api.html">abilab</a></li>
<li class="toctree-l2"><a class="reference internal" href="abio_api.html">abio Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_api.html">core Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_api.html">data Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dfpt_api.html">dfpt Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="display_api.html">display Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics_api.html">dynamics Package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">electrons Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">electrons</span></code> Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.eskw"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eskw</span></code> Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.bse"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bse</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.charges"><code class="xref py py-mod docutils literal notranslate"><span class="pre">charges</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.denpot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denpot</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.ebands"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ebands</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.effmass_analyzer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">effmass_analyzer</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.fatbands"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatbands</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.fold2bloch"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fold2bloch</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.gsr"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsr</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.gw"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gw</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.lobster"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lobster</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.optic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optic</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.psps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">psps</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.scissors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scissors</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.electrons.scr"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scr</span></code> Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="eph_api.html">eph Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="flowtk_api.html">flowtk Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iotools_api.html">iotools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="panels_api.html">panels Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools_api.html">tools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="waves_api.html">waves Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wannier90_api.html">wannier90 Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guide.html">Coding guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting AbiPy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">abipy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API documentation</a> &raquo;</li>
        
      <li>electrons Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/electrons_api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="electrons-package">
<h1><a class="toc-backref" href="#contents">electrons Package</a><a class="headerlink" href="#electrons-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#electrons-package" id="id10">electrons Package</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id11"><code class="xref py py-mod docutils literal notranslate"><span class="pre">electrons</span></code> Package</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.eskw" id="id12"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eskw</span></code> Package</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.bse" id="id13"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bse</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.charges" id="id14"><code class="xref py py-mod docutils literal notranslate"><span class="pre">charges</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.denpot" id="id15"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denpot</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.ebands" id="id16"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ebands</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.effmass_analyzer" id="id17"><code class="xref py py-mod docutils literal notranslate"><span class="pre">effmass_analyzer</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.fatbands" id="id18"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatbands</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.fold2bloch" id="id19"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fold2bloch</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.gsr" id="id20"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsr</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.gw" id="id21"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gw</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.lobster" id="id22"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lobster</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.optic" id="id23"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optic</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.psps" id="id24"><code class="xref py py-mod docutils literal notranslate"><span class="pre">psps</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.scissors" id="id25"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scissors</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.electrons.scr" id="id26"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scr</span></code> Module</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">electrons</span></code> Package</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.electrons"></span><p>This module provides classes and functions for the analysis of electronic properties.</p>
</div>
<div class="section" id="module-abipy.electrons.eskw">
<span id="eskw-package"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eskw</span></code> Package</a><a class="headerlink" href="#module-abipy.electrons.eskw" title="Permalink to this headline">¶</a></h2>
<p>Interface to the ESKW.nc file storing the (star-function) interpolated band structure produced by Abinit.</p>
<dl class="py class">
<dt id="abipy.electrons.eskw.EskwFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.eskw.</span></code><code class="sig-name descname"><span class="pre">EskwFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This file contains the (star-function) interpolated band structure produced by Abinit.
It’s similar to the GSR file but it does not contain the header and energies.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">EskwFile</span><span class="p">(</span><span class="s2">&quot;foo_ESKW.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">eskw</span><span class="p">:</span>
    <span class="n">eskw</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-2cc12f1fdcbbdcdfbc740dfd46d71b05153a77ae.png" alt="Inheritance diagram of EskwFile" usemap="#inheritancee81d2a71a7" class="inheritance graphviz" /></div>
<map id="inheritancee81d2a71a7" name="inheritancee81d2a71a7">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="306,145,499,168"/>
<area shape="rect" id="node7" href="#abipy.electrons.eskw.EskwFile" target="_top" title="This file contains the (star&#45;function) interpolated band structure produced by Abinit." alt="" coords="568,75,763,98"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="296,98,509,122"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="284,5,522,28"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="300,52,506,75"/>
</map><dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.einterp">
<code class="sig-name descname"><span class="pre">einterp</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.einterp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.einterp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.band_block">
<code class="sig-name descname"><span class="pre">band_block</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.band_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.band_block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.eskw.EskwFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/eskw.html#EskwFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.eskw.EskwFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.bse">
<span id="bse-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bse</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.bse" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of BSE calculations</p>
<dl class="py class">
<dt id="abipy.electrons.bse.DielectricFunction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.bse.</span></code><code class="sig-name descname"><span class="pre">DielectricFunction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emacros_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores the frequency-dependent macroscopic dielectric function
computed for different q-directions in reciprocal space.</p>
<dl class="py method">
<dt id="abipy.electrons.bse.DielectricFunction.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.DielectricFunction.num_qpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_qpoints</span></code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.num_qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of q-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.DielectricFunction.qfrac_coords">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qfrac_coords</span></code><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the fractional coordinates of the q-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.DielectricFunction.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the MDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p>
</dd>
</dl>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>only_mean</p></td>
<td><p>True if only the averaged spectrum is wanted (default True)</p></td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.DielectricFunction.plot_ax">
<code class="sig-name descname"><span class="pre">plot_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#DielectricFunction.plot_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.DielectricFunction.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data on the axis ax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a></p></li>
<li><p><strong>qpoint</strong> – index of the q-point or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object or None to plot emacro_avg.</p></li>
<li><p><strong>kwargs</strong> – <p>Keyword arguments passed to matplotlib. Accepts also:</p>
<dl>
<dt>cplx_mode:</dt><dd><p>string defining the data to print (case-insensitive).
Possible choices are</p>
<blockquote>
<div><ul>
<li><p>”re”  for real part</p></li>
<li><p>”im” for imaginary part only.</p></li>
<li><p>”abs’ for the absolute value</p></li>
</ul>
</div></blockquote>
<p>Options can be concated with “-“.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.bse.MdfFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.bse.</span></code><code class="sig-name descname"><span class="pre">MdfFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">MdfFile</span><span class="p">(</span><span class="s2">&quot;foo_MDF.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mdf</span><span class="p">:</span>
    <span class="n">mdf</span><span class="o">.</span><span class="n">plot_mdfs</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-41b2b970bff192df50b34a52e9713ce60f9acc38.png" alt="Inheritance diagram of MdfFile" usemap="#inheritance6a7e4af0c2" class="inheritance graphviz" /></div>
<map id="inheritance6a7e4af0c2" name="inheritance6a7e4af0c2">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="303,101,501,125"/>
<area shape="rect" id="node6" href="#abipy.electrons.bse.MdfFile" target="_top" title="Usage example:" alt="" coords="560,53,742,77"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="292,53,512,77"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="296,5,508,29"/>
</map><dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.structure">
<code class="sig-name descname"><span class="pre">structure</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.exc_mdf">
<code class="sig-name descname"><span class="pre">exc_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.exc_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Excitonic macroscopic dieletric function.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.rpanlf_mdf">
<code class="sig-name descname"><span class="pre">rpanlf_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.rpanlf_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA dielectric function without local-field effects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.gwnlf_mdf">
<code class="sig-name descname"><span class="pre">gwnlf_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.gwnlf_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>RPA-GW dielectric function without local-field effects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.qpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qpoints</span></code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.qfrac_coords">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qfrac_coords</span></code><a class="headerlink" href="#abipy.electrons.bse.MdfFile.qfrac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the fractional coordinates of the q-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters that are usually tested for convergence.
Used to build Pandas dataframes in Robots.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.get_mdf">
<code class="sig-name descname"><span class="pre">get_mdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdf_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Returns the macroscopic dielectric function.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.plot_mdfs">
<code class="sig-name descname"><span class="pre">plot_mdfs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cplx_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Im'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdf_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.plot_mdfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.plot_mdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macroscopic dielectric function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cplx_mode</strong> – <p>string defining the data to print (case-insensitive).
Possible choices are</p>
<blockquote>
<div><ul>
<li><p>”re”  for real part</p></li>
<li><p>”im” for imaginary part only.</p></li>
<li><p>”abs’ for the absolute value</p></li>
</ul>
</div></blockquote>
<p>Options can be concated with “-“.</p>
</p></li>
<li><p><strong>mdf_type</strong> – <p>Select the type of macroscopic dielectric function.
Possible choices are</p>
<blockquote>
<div><ul>
<li><p>”exc” for the MDF with excitonic effects.</p></li>
<li><p>”rpa” for RPA with KS energies.</p></li>
<li><p>”gwrpa” for RPA with GW (or KS-corrected) results</p></li>
<li><p>”all” if all types are wanted.</p></li>
</ul>
</div></blockquote>
<p>Options can be concated with “-“.</p>
</p></li>
<li><p><strong>qpoint</strong> – index of the q-point or Kpoint object or None to plot emacro_avg.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.get_tensor">
<code class="sig-name descname"><span class="pre">get_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdf_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.get_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.get_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the macroscopic dielectric tensor from the MDF.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.bse.MdfReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.bse.</span></code><code class="sig-name descname"><span class="pre">MdfReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads data from the MDF.nc file produced by ABINIT.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-d2bc9c1a230ba0ead5a3089d5652aa7e3f104072.png" alt="Inheritance diagram of MdfReader" usemap="#inheritance83fb40235f" class="inheritance graphviz" /></div>
<map id="inheritance83fb40235f" name="inheritance83fb40235f">
<area shape="rect" id="node1" href="#abipy.electrons.bse.MdfReader" target="_top" title="This object reads data from the MDF.nc file produced by ABINIT." alt="" coords="615,4,764,21"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="447,4,580,21"/>
</map><dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.bse.MdfReader.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.qpoints">
<code class="sig-name descname"><span class="pre">qpoints</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.qpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-points (ndarray).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.wmesh">
<code class="sig-name descname"><span class="pre">wmesh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.wmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The frequency mesh in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.read_params">
<code class="sig-name descname"><span class="pre">read_params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the parameters of the run.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.read_exc_mdf">
<code class="sig-name descname"><span class="pre">read_exc_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_exc_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_exc_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the excitonic MDF.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.read_rpanlf_mdf">
<code class="sig-name descname"><span class="pre">read_rpanlf_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_rpanlf_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_rpanlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the KS-RPA MDF without LF effects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfReader.read_gwnlf_mdf">
<code class="sig-name descname"><span class="pre">read_gwnlf_mdf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfReader.read_gwnlf_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfReader.read_gwnlf_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the GW-RPA MDF without LF effects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.bse.MdfPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.bse.</span></code><code class="sig-name descname"><span class="pre">MdfPlotter</span></code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for plotting Macroscopic dielectric functions.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MdfPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf</span><span class="p">(</span><span class="s2">&quot;EXC&quot;</span><span class="p">,</span> <span class="n">exc_mdf</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf</span><span class="p">(</span><span class="s2">&quot;KS-RPA&quot;</span><span class="p">,</span> <span class="n">rpanlf_mdf</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="abipy.electrons.bse.MdfPlotter.add_mdf">
<code class="sig-name descname"><span class="pre">add_mdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.add_mdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.add_mdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DielectricFunction</span></code></a> for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name for the MDF. Must be unique.</p></li>
<li><p><strong>mdf</strong> – <a class="reference internal" href="#abipy.electrons.bse.DielectricFunction" title="abipy.electrons.bse.DielectricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DielectricFunction</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MdfPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cplx_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Im'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MdfPlotter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MdfPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a matplotlib plot showing the MDFs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>cplx_mode</strong> – string defining the data to print (case-insensitive).
Possible choices are <code class="docutils literal notranslate"><span class="pre">re</span></code> for the real part, <code class="docutils literal notranslate"><span class="pre">im</span></code> for imaginary part only. <code class="docutils literal notranslate"><span class="pre">abs</span></code> for the absolute value.
Options can be concated with “-“.</p></li>
<li><p><strong>qpoint</strong> – index of the q-point or <code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code> object or None to plot emacro_avg.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Same meaning as <code class="docutils literal notranslate"><span class="pre">ylims</span></code> but for the y-axis</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.bse.MultipleMdfPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.bse.</span></code><code class="sig-name descname"><span class="pre">MultipleMdfPlotter</span></code><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for plotting multipe macroscopic dielectric functions
extracted from several MDF.nc files</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MultipleMdfPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_file</span><span class="p">(</span><span class="s2">&quot;file1&quot;</span><span class="p">,</span> <span class="n">mdf_file1</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mdf_file</span><span class="p">(</span><span class="s2">&quot;file2&quot;</span><span class="p">,</span> <span class="n">mdf_file2</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPES">
<code class="sig-name descname"><span class="pre">MDF_TYPES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('exc',</span> <span class="pre">'rpa',</span> <span class="pre">'gwrpa')</span></em><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPECPLX2TEX">
<code class="sig-name descname"><span class="pre">MDF_TYPECPLX2TEX</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'exc':</span> <span class="pre">{'abs':</span> <span class="pre">'$|\\varepsilon_{exc}|$',</span> <span class="pre">'im':</span> <span class="pre">'$\\Im(\\varepsilon_{exc}$)',</span> <span class="pre">'re':</span> <span class="pre">'$\\Re(\\varepsilon_{exc})$'},</span> <span class="pre">'gwrpa':</span> <span class="pre">{'abs':</span> <span class="pre">'$|\\varepsilon_{gw-rpa}|$',</span> <span class="pre">'im':</span> <span class="pre">'$\\Im(\\varepsilon_{gw-rpa})$',</span> <span class="pre">'re':</span> <span class="pre">'$\\Re(\\varepsilon_{gw-rpa})$'},</span> <span class="pre">'rpa':</span> <span class="pre">{'abs':</span> <span class="pre">'$|\\varepsilon_{rpa}|$',</span> <span class="pre">'im':</span> <span class="pre">'$\\Im(\\varepsilon_{rpa})$',</span> <span class="pre">'re':</span> <span class="pre">'$\\Re(\\varepsilon_{rpa})$'}}</span></em><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.MDF_TYPECPLX2TEX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.add_mdf_file">
<code class="sig-name descname"><span class="pre">add_mdf_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.add_mdf_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.add_mdf_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract dielectric functions from object <code class="docutils literal notranslate"><span class="pre">obj</span></code>, store data for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – label associated to the MDF file. Must be unique.</p></li>
<li><p><strong>mdf</strong> – filepath or <a class="reference internal" href="#abipy.electrons.bse.MdfFile" title="abipy.electrons.bse.MdfFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">MdfFile</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdf_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qview</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'avg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all macroscopic dielectric functions (MDF) stored in the plotter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdf_type</strong> – Selects the type of dielectric function.
“exc” for the MDF with excitonic effects.
“rpa” for RPA with KS energies.
“gwrpa” for RPA with GW (or KS-corrected) results.</p></li>
<li><p><strong>qview</strong> – “avg” to plot the results averaged over q-points. “all” to plot q-point dependence.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Same meaning as <cite>ylims</cite> but for the y-axis</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.plot_mdftype_cplx">
<code class="sig-name descname"><span class="pre">plot_mdftype_cplx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdf_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cplx_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.plot_mdftype_cplx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.plot_mdftype_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot data corresponds to <code class="docutils literal notranslate"><span class="pre">mdf_type</span></code>, <code class="docutils literal notranslate"><span class="pre">cplx_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">qpoint</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>mdf_type</strong> – </p></li>
<li><p><strong>cplx_mode</strong> – string defining the data to print (case-insensitive).
Possible choices are <cite>re</cite> for the real part, <cite>im</cite> for imaginary part only. <cite>abs</cite> for the absolute value.</p></li>
<li><p><strong>qpoint</strong> – index of the q-point or <code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code> object or None to plot emacro_avg.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Same meaning as <cite>ylims</cite> but for the y-axis</p></li>
<li><p><strong>with_legend</strong> – True if legend should be added</p></li>
<li><p><strong>with_xlabel</strong> – </p></li>
<li><p><strong>with_ylabel</strong> – </p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.bse.MultipleMdfPlotter.ipw_select_plot">
<code class="sig-name descname"><span class="pre">ipw_select_plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/bse.html#MultipleMdfPlotter.ipw_select_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.bse.MultipleMdfPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.charges">
<span id="charges-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">charges</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.charges" title="Permalink to this headline">¶</a></h2>
<p>HirshfeldCharges.</p>
<dl class="py class">
<dt id="abipy.electrons.charges.HirshfeldCharges">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.charges.</span></code><code class="sig-name descname"><span class="pre">HirshfeldCharges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">electron_charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_charges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.charges.Charges</span></code></p>
<p>Class representing the charges obtained from the Hirshfeld analysis.
The charges refer to the total charges for each atom (i.e. Z-n_electrons).
An eccess of electron has a negative charge</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-5d013bd56a6d244821c6ac4c79844c58963b3112.png" alt="Inheritance diagram of HirshfeldCharges" usemap="#inheritancee626124432" class="inheritance graphviz" /></div>
<map id="inheritancee626124432" name="inheritancee626124432">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="5,5,208,28"/>
<area shape="rect" id="node3" href="#abipy.electrons.charges.HirshfeldCharges" target="_top" title="Class representing the charges obtained from the Hirshfeld analysis." alt="" coords="506,5,763,28"/>
</map><dl class="py method">
<dt id="abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_cut3d_outfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#HirshfeldCharges.from_cut3d_outfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.charges.HirshfeldCharges.from_cut3d_outfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a HirshfeldCharges object from the outputfile of cut3d and a structure.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.charges.BaderCharges">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.charges.</span></code><code class="sig-name descname"><span class="pre">BaderCharges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">electron_charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_charges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#BaderCharges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.charges.BaderCharges" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.charges.Charges</span></code></p>
<p>Class representing the charges obtained from the Bader analysis.
TThe charges refer to the total charges for each atom (i.e. Z-n_electrons).
An eccess of electron has a negative charge</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-5d59da4d123e8cb11b3c9e05b3c24ec54b5ca7cf.png" alt="Inheritance diagram of BaderCharges" usemap="#inheritance3e58e8140e" class="inheritance graphviz" /></div>
<map id="inheritance3e58e8140e" name="inheritance3e58e8140e">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="5,5,213,29"/>
<area shape="rect" id="node2" href="#abipy.electrons.charges.BaderCharges" target="_top" title="Class representing the charges obtained from the Bader analysis." alt="" coords="517,5,763,29"/>
</map><dl class="py method">
<dt id="abipy.electrons.charges.BaderCharges.from_files">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudopotential_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_core</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/charges.html#BaderCharges.from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.charges.BaderCharges.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the abinit density files and the <a class="reference external" href="http://theory.cm.utexas.edu/henkelman/code/bader/">bader</a> executable from Henkelmann et al. to calculate
the bader charges of the system. If pseudopotentials are given, the atomic charges will be
extracted as well. See also <a class="bibtex reference internal" href="../zzbiblio.html#henkelman2006" id="id2">[Henkelman2006]</a>.</p>
<p>The extraction of the core charges may be a time consuming calculation, depending on the
size of the system. A tuning of the parameters may be required (see Density.ae_core_density_on_mesh).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density_path</strong> – Path to the abinit density file. Can be a fortran _DEN or a netCDF DEN.nc file.
In case of fortran file, requires cut3d (version &gt;= 8.6.1) for the convertion.</p></li>
<li><p><strong>pseudopotential_paths</strong> – Dictionary {element: pseudopotential path} for all the elements present
in the system.</p></li>
<li><p><strong>with_core</strong> – Core charges will be extracted from the pseudopotentials with the
Density.ae_core_density_on_mesh method. Requires pseudopotential_paths.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>kwargs</strong> – arguments passed to the method <code class="docutils literal notranslate"><span class="pre">Density.ae_core_density_on_mesh</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of <a class="reference internal" href="#abipy.electrons.charges.BaderCharges" title="abipy.electrons.charges.BaderCharges"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaderCharges</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.denpot">
<span id="denpot-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denpot</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.denpot" title="Permalink to this headline">¶</a></h2>
<p>Density/potential files in netcdf/fortran format.</p>
<dl class="py class">
<dt id="abipy.electrons.denpot.DensityNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.denpot.</span></code><code class="sig-name descname"><span class="pre">DensityNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p>Netcdf File containing the electronic density.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DensityNcFile</span><span class="p">(</span><span class="s2">&quot;foo_DEN.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">density</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-b9326c28dda9752032569149dc9387933ee34e0e.png" alt="Inheritance diagram of DensityNcFile" usemap="#inheritancecb81189ead" class="inheritance graphviz" /></div>
<map id="inheritancecb81189ead" name="inheritancecb81189ead">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.DensityNcFile" target="_top" title="Netcdf File containing the electronic density." alt="" coords="5,5,246,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.denpot.DensityNcFile.field_name">
<code class="sig-name descname"><span class="pre">field_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'density'</span></em><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.DensityNcFile.density">
<code class="sig-name descname"><span class="pre">density</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.density" title="Permalink to this definition">¶</a></dt>
<dd><p>Density object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.DensityNcFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_chgcar">
<code class="sig-name descname"><span class="pre">write_chgcar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_chgcar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_chgcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in CHGCAR format. Return <code class="xref py py-class docutils literal notranslate"><span class="pre">ChgCar</span></code> instance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_xsf">
<code class="sig-name descname"><span class="pre">write_xsf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_xsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_xsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in XSF format (<a class="reference external" href="http://www.xcrysden.org/">xcrysden</a>)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.DensityNcFile.write_cube">
<code class="sig-name descname"><span class="pre">write_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'total'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#DensityNcFile.write_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.DensityNcFile.write_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Write density in CUBE format.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.denpot.VhartreeNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.denpot.</span></code><code class="sig-name descname"><span class="pre">VhartreeNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhartreeNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-b1f5e03542cdb15746f70a95870cdd6a4cf799af.png" alt="Inheritance diagram of VhartreeNcFile" usemap="#inheritance1dea356815" class="inheritance graphviz" /></div>
<map id="inheritance1dea356815" name="inheritance1dea356815">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VhartreeNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,252,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.denpot.VhartreeNcFile.field_name">
<code class="sig-name descname"><span class="pre">field_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vh'</span></em><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.VhartreeNcFile.vh">
<code class="sig-name descname"><span class="pre">vh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhartreeNcFile.vh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VhartreeNcFile.vh" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree potential.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.denpot.VxcNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.denpot.</span></code><code class="sig-name descname"><span class="pre">VxcNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VxcNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-764c86380cb217a8e680236ad12aa50fc6a577d2.png" alt="Inheritance diagram of VxcNcFile" usemap="#inheritancef4842e950b" class="inheritance graphviz" /></div>
<map id="inheritancef4842e950b" name="inheritancef4842e950b">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VxcNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,224,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.denpot.VxcNcFile.field_name">
<code class="sig-name descname"><span class="pre">field_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vxc'</span></em><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.VxcNcFile.vxc">
<code class="sig-name descname"><span class="pre">vxc</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VxcNcFile.vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VxcNcFile.vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>XC potential.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.denpot.VhxcNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.denpot.</span></code><code class="sig-name descname"><span class="pre">VhxcNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhxcNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-59a235e5fb0df22fc4ff005e335c3d5cbaffe5a9.png" alt="Inheritance diagram of VhxcNcFile" usemap="#inheritance0226348494" class="inheritance graphviz" /></div>
<map id="inheritance0226348494" name="inheritance0226348494">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.VhxcNcFile" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,231,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.denpot.VhxcNcFile.field_name">
<code class="sig-name descname"><span class="pre">field_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vhxc'</span></em><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.VhxcNcFile.vhxc">
<code class="sig-name descname"><span class="pre">vhxc</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#VhxcNcFile.vhxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.VhxcNcFile.vhxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree + XC potential.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.denpot.PotNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.denpot.</span></code><code class="sig-name descname"><span class="pre">PotNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#PotNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.denpot._NcFileWithField</span></code></p>
<p>POT file produced by the GS part containing the total KS potential in real space.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-b8086f1448d2f38b1edb2ba394cfd980bcc3fb02.png" alt="Inheritance diagram of PotNcFile" usemap="#inheritance0c0dcb3aa1" class="inheritance graphviz" /></div>
<map id="inheritance0c0dcb3aa1" name="inheritance0c0dcb3aa1">
<area shape="rect" id="node1" href="#abipy.electrons.denpot.PotNcFile" target="_top" title="POT file produced by the GS part containing the total KS potential in real space." alt="" coords="5,5,221,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.denpot.PotNcFile.field_name">
<code class="sig-name descname"><span class="pre">field_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vks'</span></em><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile.field_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.denpot.PotNcFile.vks">
<code class="sig-name descname"><span class="pre">vks</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/denpot.html#PotNcFile.vks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.denpot.PotNcFile.vks" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree + XC potential + sum of local pseudo-potential terms.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.ebands">
<span id="ebands-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ebands</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.ebands" title="Permalink to this headline">¶</a></h2>
<p>Classes to analyse electronic structures.</p>
<dl class="py class">
<dt id="abipy.electrons.ebands.ElectronBands">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.ebands.</span></code><code class="sig-name descname"><span class="pre">ElectronBands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occfacts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nband_sk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smearing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>Object storing the electron band structure.</p>
<dl class="py attribute">
<dt id="abipy.electrons.ebands.ElectronBands.fermie">
<code class="sig-name descname"><span class="pre">fermie</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi level in eV. Note that, if the band structure has been computed
with a NSCF run, fermie corresponds to the fermi level obtained
in the SCF run that produced the density used for the band structure calculation.</p>
</dd></dl>

<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-5f46303d656d3a4f5723fb9c242001af6d165923.png" alt="Inheritance diagram of ElectronBands" usemap="#inheritance5d51cbb43e" class="inheritance graphviz" /></div>
<map id="inheritance5d51cbb43e" name="inheritance5d51cbb43e">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="5,5,218,29"/>
<area shape="rect" id="node2" href="#abipy.electrons.ebands.ElectronBands" target="_top" title="Object storing the electron band structure." alt="" coords="266,5,514,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.ebands.ElectronBands.Error">
<code class="sig-name descname"><span class="pre">Error</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBandsError</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.ebands.ElectronBands.pad_fermie">
<code class="sig-name descname"><span class="pre">pad_fermie</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0.001</span></em><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.pad_fermie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> from the netCDF file <code class="docutils literal notranslate"><span class="pre">filepath</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.from_binary_string">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_binary_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bstring</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_binary_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_binary_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Build object from a binary string with the netcdf data.
Useful for implementing GUIs in which widgets returns binary data.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.from_dict">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct object from the dictionary in MSONable format produced by as_dict.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.as_dict">
<code class="sig-name descname"><span class="pre">as_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary with JSON serialization.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.as_ebands">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.as_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.as_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> from a generic object <cite>obj</cite>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li><p>instances of cls</p></li>
<li><p>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</p></li>
<li><p>objects providing an <cite>ebands</cite> attribute</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.from_mpid">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_mpid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timerev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspinor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_mpid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_mpid" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bandstructure data corresponding to a materials project <code class="docutils literal notranslate"><span class="pre">material_id</span></code>.
and return Abipy ElectronBands object. Return None if bands are not available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>material_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Materials Project material_id (a string, e.g., mp-1234).</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in
your .pmgrc.yaml. If so, it will use that environment
This makes easier for heavy users to simply add
this environment variable to their setups and MPRester can
then be called without any arguments.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</p></li>
<li><p><strong>nelect</strong> – Number of electrons in the unit cell.</p></li>
<li><p><strong>nspinor</strong> – Number of spinor components.</p></li>
<li><p><strong>line_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, fetch a BandStructureSymmLine object
(default). If False, return the uniform band structure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.to_json">
<code class="sig-name descname"><span class="pre">to_json</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON string representation of the MSONable object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_plotter_with">
<code class="sig-name descname"><span class="pre">get_plotter_with</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_ebands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_plotter_with"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_plotter_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and <a class="reference internal" href="#abipy.electrons.ebands.ElectronBandsPlotter" title="abipy.electrons.ebands.ElectronBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBandsPlotter</span></code></a> from self and other, use self_key and other_key as keywords</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.spins">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">spins</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spins" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin range</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.nband">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nband</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.nband" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.kidxs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kidxs</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kidxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Range with the index of the k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.eigens">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">eigens</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues in eV. <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.linewidths">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">linewidths</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>linewidths in eV. <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.has_linewidths">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_linewidths</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>True if bands with linewidths.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.occfacts">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">occfacts</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.occfacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Occupation factors. <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape [nspin, nkpt, mband].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.reciprocal_lattice">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">reciprocal_lattice</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2022.0.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.lattice.Lattice</span></code></a> with the reciprocal lattice vectors in Angstrom.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the array with the eigenvalues.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.has_metallic_scheme">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_metallic_scheme</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_metallic_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are using a metallic scheme for occupancies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie_to_vbm">
<code class="sig-name descname"><span class="pre">set_fermie_to_vbm</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie_to_vbm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie_to_vbm" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Fermi energy to the valence band maximum (VBM).
Useful when the initial fermie energy comes from a GS-SCF calculation
that may underestimate the Fermi energy because e.g. the IBZ sampling
is shifted whereas the true VMB is at Gamma.</p>
<p>Return: New fermi energy in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie_from_edos">
<code class="sig-name descname"><span class="pre">set_fermie_from_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie_from_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie_from_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Fermi level using the integrated DOS computed in edos.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>edos: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.
nelect: Number of electrons. If None, the number of electrons in self. is used</p>
</dd>
</dl>
</div></blockquote>
<p>Return: New fermi energy in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.set_fermie">
<code class="sig-name descname"><span class="pre">set_fermie</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_fermie</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.set_fermie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.set_fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the new fermi energy. Return new value</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.with_points_along_path">
<code class="sig-name descname"><span class="pre">with_points_along_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.with_points_along_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.with_points_along_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Build new <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object containing the k-points along the
input k-path specified by <cite>frac_bounds</cite>. Useful to extract energies along a path
from calculation performed in the IBZ.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frac_bounds</strong> – [M, 3] array  with the vertexes of the k-path in reduced coordinates.
If None, the k-path is automatically selected from the structure.</p></li>
<li><p><strong>knames</strong> – List of strings with the k-point labels defining the k-path. It has precedence over frac_bounds.</p></li>
<li><p><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>namedtuple with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ebands</span><span class="p">:</span> <span class="o">|</span><span class="n">ElectronBands</span><span class="o">|</span> <span class="nb">object</span><span class="o">.</span>
<span class="n">ik_new2prev</span><span class="p">:</span> <span class="n">Correspondence</span> <span class="n">between</span> <span class="n">the</span> <span class="n">k</span><span class="o">-</span><span class="n">points</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">new</span> <span class="n">ebands</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">kpoint</span>
    <span class="n">of</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">band</span> <span class="n">structure</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.empty_with_ibz">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">empty_with_ibz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngkpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mband</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shiftk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kptopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smearing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.empty_with_ibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.empty_with_ibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_dict4pandas">
<code class="sig-name descname"><span class="pre">get_dict4pandas</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_dict4pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_dict4pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the most important parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>Chemical formula and number of atoms.</p></li>
<li><p>Lattice lengths, angles and volume.</p></li>
<li><p>The spacegroup number computed by Abinit (set to None if not available).</p></li>
<li><p>The spacegroup number and symbol computed by spglib (set to None not <cite>with_spglib</cite>).</p></li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_geo</strong> – True if structure info should be added to the dataframe</p></li>
<li><p><strong>with_spglib</strong> – If True, <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> is invoked to get the spacegroup symbol and number.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzmesh">
<code class="sig-name descname"><span class="pre">has_bzmesh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_bzmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the k-point sampling is homogeneous.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.has_bzpath">
<code class="sig-name descname"><span class="pre">has_bzpath</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_bzpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_bzpath" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the bands are computed on a k-path.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.kptopt">
<code class="sig-name descname"><span class="pre">kptopt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kptopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kptopt" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of the kptopt input variable.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.has_timrev">
<code class="sig-name descname"><span class="pre">has_timrev</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.has_timrev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.has_timrev" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time-reversal symmetry is used in the BZ sampling.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.supports_fermi_surface">
<code class="sig-name descname"><span class="pre">supports_fermi_surface</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.supports_fermi_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.supports_fermi_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the kpoints used for the energies can be employed to visualize Fermi surface.
Fermi surface viewers require gamma-centered k-mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.kindex">
<code class="sig-name descname"><span class="pre">kindex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.kindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.kindex" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the k-point in the internal list of k-points.
Accepts: <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.skb_iter">
<code class="sig-name descname"><span class="pre">skb_iter</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.skb_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.skb_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over (spin, k, band) indices.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.deepcopy">
<code class="sig-name descname"><span class="pre">deepcopy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.deepcopy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy of the ElectronBands object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.degeneracies">
<code class="sig-name descname"><span class="pre">degeneracies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_ediff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.degeneracies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.degeneracies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with the indices of the degenerate bands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – K-point index or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object</p></li>
<li><p><strong>bands_range</strong> – List of band indices to analyze.</p></li>
<li><p><strong>tol_ediff</strong> – Tolerance on the energy difference (in eV)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of tuples [(e0, bands_e0), (e1, bands_e1, ….]
Each tuple stores the degenerate energy and a list with the band indices.
The band structure of silicon at Gamma, for example, will produce something like:
[(-6.3, [0]), (5.6, [1, 2, 3]), (8.1, [4, 5, 6])]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.enemin">
<code class="sig-name descname"><span class="pre">enemin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the eigenvalues.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.enemax">
<code class="sig-name descname"><span class="pre">enemax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.enemax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.enemax" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the maximum of the eigenvalues.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.dispersionless_states">
<code class="sig-name descname"><span class="pre">dispersionless_states</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltae</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kfact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.dispersionless_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.dispersionless_states" title="Permalink to this definition">¶</a></dt>
<dd><p>This function detects dispersionless states.
A state is dispersionless if there are more that (nkpt * kfact) energies
in the energy intervale [e0 - deltae, e0 + deltae]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>range to be analyzed in the form</strong><strong> [</strong><strong>emin</strong> (<em>erange=Energy</em>) – </p></li>
<li><p><strong>emax</strong><strong>]</strong> – </p></li>
<li><p><strong>deltae</strong> – Defines the energy interval in eV around the KS eigenvalue.</p></li>
<li><p><strong>kfact</strong> – Can be used to change the criterion used to detect dispersionless states.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Electron</span></code> objects. Each item contains information on
the energy, the occupation and the location of the dispersionless band.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div><p>[‘spin’, ‘kidx’, ‘band’, ‘eig’, ‘occ’, ‘kpoint’]</p>
</div></blockquote>
<p>where:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>spin</p></td>
<td><p>spin index</p></td>
</tr>
<tr class="row-odd"><td><p>kidx</p></td>
<td><p>k-point index</p></td>
</tr>
<tr class="row-even"><td><p>band</p></td>
<td><p>band index</p></td>
</tr>
<tr class="row-odd"><td><p>eig</p></td>
<td><p>KS eigenvalue in eV.</p></td>
</tr>
<tr class="row-even"><td><p>occ</p></td>
<td><p>Occupation of the state.</p></td>
</tr>
<tr class="row-odd"><td><p>kpoint</p></td>
<td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code> object</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0
The Fermi energy is saved in frame.fermie</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.boxplot">
<code class="sig-name descname"><span class="pre">boxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV.
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>brange</strong> – Only bands such as <code class="docutils literal notranslate"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.from_pymatgen">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_pymatgen</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pmg_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timerev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smearing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspinor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.from_pymatgen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.from_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pymatgen bandstructure object to an Abipy <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pmg_bands</strong> – pymatgen bandstructure object.</p></li>
<li><p><strong>nelect</strong> – Number of electrons in unit cell.</p></li>
<li><p><strong>weights</strong> – List of K-points weights (normalized to one, same order as pmg_bands.kpoints).
This argument is optional but recommended when <code class="docutils literal notranslate"><span class="pre">pmg_bands</span></code> represents an IBZ sampling.
If weights are not provided, Abipy methods requiring integrations in the BZ won’t work.</p></li>
<li><p><strong>has_timerev</strong> – True if time-reversal symmetry can be used.</p></li>
<li><p><strong>ksampling</strong> – dictionary with parameters passed to <code class="xref py py-class docutils literal notranslate"><span class="pre">KSamplingInfo</span></code> defining the k-points sampling.
If None, hard-coded values are used. This argument is recommended if IBZ sampling.</p></li>
<li><p><strong>smearing</strong> – dictionary with parameters passed to <code class="xref py py-class docutils literal notranslate"><span class="pre">Smearing</span></code>
If None, default hard-coded values are used.</p></li>
<li><p><strong>nspinor</strong> – Number of spinor components.</p></li>
<li><p><strong>nspden</strong> – Number of independent spin-density components.
If None, nspden is automatically computed from nsppol</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Abipy bandstructure contains more information than the pymatgen object so
the conversion is not complete, especially if you rely on the default values.
Please read carefylly the docstring and the code and use the optional arguments to pass
additional data required by AbiPy if you need a complete conversion.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.to_pymatgen">
<code class="sig-name descname"><span class="pre">to_pymatgen</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_pymatgen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pymatgen bandstructure object from an Abipy <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.lomos">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lomos</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomos" title="Permalink to this definition">¶</a></dt>
<dd><p>lomo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal notranslate"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.lomo_sk">
<code class="sig-name descname"><span class="pre">lomo_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lomo_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lomo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LOMO state for the given spin, kpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index</p></li>
<li><p><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.homo_sk">
<code class="sig-name descname"><span class="pre">homo_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.homo_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the HOMO state for the given spin, kpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index</p></li>
<li><p><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.lumo_sk">
<code class="sig-name descname"><span class="pre">lumo_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.lumo_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumo_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the LUMO state for the given spin, kpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index</p></li>
<li><p><strong>kpoint</strong> – Index of the kpoint or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.homos">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">homos</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.homos" title="Permalink to this definition">¶</a></dt>
<dd><p>homo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal notranslate"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.lumos">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lumos</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.lumos" title="Permalink to this definition">¶</a></dt>
<dd><p>lumo states for each spin channel as a list of nsppol <code class="xref py py-class docutils literal notranslate"><span class="pre">Electron</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.bandwidths">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">bandwidths</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.bandwidths" title="Permalink to this definition">¶</a></dt>
<dd><p>The bandwidth for each spin channel i.e. the energy difference (homo - lomo).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.fundamental_gaps">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">fundamental_gaps</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.fundamental_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronTransition</span></code> with info on the fundamental gaps for each spin.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.direct_gaps">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">direct_gaps</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.direct_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <cite>nsppol</cite> <code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronTransition</span></code> with info on the direct gaps for each spin.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_gaps_string">
<code class="sig-name descname"><span class="pre">get_gaps_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unicode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_gaps_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_gaps_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with info about fundamental and direct gap (if not metallic scheme)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_latex</strong> – True to get latex symbols for the gap names and formula else text.</p></li>
<li><p><strong>unicode</strong> – True to get unicode symbols for the formula else text.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_kpoints_and_band_range_for_edges">
<code class="sig-name descname"><span class="pre">get_kpoints_and_band_range_for_edges</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_kpoints_and_band_range_for_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_kpoints_and_band_range_for_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the reduced coordinates and the band indice associate to the band edges.
Important: Call set_fermie_to_vbm() to set the Fermi level to the VBM before calling this method.</p>
<p>Return: (k0_list, effmass_bands_f90) (Fortran notation)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_kpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful info such as band gaps, position of HOMO, LOMO…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_structure</strong> – False if structural info shoud not be displayed.</p></li>
<li><p><strong>with_kpoints</strong> – False if k-point info shoud not be displayed.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.new_with_irred_kpoints">
<code class="sig-name descname"><span class="pre">new_with_irred_kpoints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prune_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.new_with_irred_kpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.new_with_irred_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object in which only the irreducible k-points are kept.
This method is mainly used to prepare the band structure interpolation as the interpolator
will likely fail if the input k-path contains symmetrical k-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prune_step</strong> – Optional argument used to select a subset of the irreducible points found.</p></li>
<li><p><strong>prune_step is None</strong> (<em>If</em>) – </p></li>
<li><p><strong>irreducible k-points are used.</strong> (<em>all</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.spacing">
<code class="sig-name descname"><span class="pre">spacing</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.spacing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the statistical parameters of the energy spacing, i.e. e[b+1] - e[b]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the statistical parameters in eV</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.statdiff">
<code class="sig-name descname"><span class="pre">statdiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">other</span></em>, <em class="sig-param"><span class="pre">axis=None</span></em>, <em class="sig-param"><span class="pre">numpy_op=&lt;ufunc</span> <span class="pre">'absolute'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.statdiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the eigenenergies of two bands and compute the
statistical parameters: mean, standard deviation, min and max
The bands are aligned wrt to their fermi level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p></li>
<li><p><strong>axis</strong> – Axis along which the statistical parameters are computed.
The default is to compute the parameters of the flattened array.</p></li>
<li><p><strong>numpy_op</strong> – Numpy function to apply to the difference of the eigenvalues. The
default computes <code class="docutils literal notranslate"><span class="pre">|self.eigens</span> <span class="pre">-</span> <span class="pre">other.eigens|</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the statistical parameters in eV</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.ipw_edos_widget">
<code class="sig-name descname"><span class="pre">ipw_edos_widget</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.ipw_edos_widget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.ipw_edos_widget" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to compute the electron DOS.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_edos">
<code class="sig-name descname"><span class="pre">get_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS on a linear mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.compare_gauss_edos">
<code class="sig-name descname"><span class="pre">compare_gauss_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">widths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.compare_gauss_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.compare_gauss_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS with the Gaussian method for different values
of the broadening. Return plotter object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>widths</strong> – List with the tandard deviation (eV) of the gaussian.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="#abipy.electrons.ebands.ElectronDosPlotter" title="abipy.electrons.ebands.ElectronDosPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDosPlotter</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_transitions">
<code class="sig-name descname"><span class="pre">plot_transitions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_ev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_kdiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_transitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot energy bands with arrows signaling possible k –&gt; k + q indipendent-particle transitions
of energy <code class="docutils literal notranslate"><span class="pre">omega_ev</span></code> connecting occupied to empty states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_ev</strong> – Transition energy in eV.</p></li>
<li><p><strong>qpt</strong> – Q-point in reduced coordinates.</p></li>
<li><p><strong>atol_ev</strong> – Absolute tolerance for energy difference in eV</p></li>
<li><p><strong>atol_kdiff</strong> – Tolerance used to compare k-points.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_ejdos">
<code class="sig-name descname"><span class="pre">get_ejdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_ejdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_ejdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the join density of states at q == 0.</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\sum_{kbv} f_{vk} (1 - f_{ck}) \delta(\omega - E_{ck} + E_{vk})\)</span></p>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The present implementation assumes an energy gap</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>valence</strong> – Int or iterable with the valence indices.</p></li>
<li><p><strong>conduction</strong> – Int or iterable with the conduction indices.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String defining the integraion method.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>mesh</strong> – Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ejdosvc">
<code class="sig-name descname"><span class="pre">plot_ejdosvc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ejdosvc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ejdosvc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the decomposition of the joint-density of States (JDOS).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The present implementation assumes an energy gap</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vrange</strong> – Int or <cite>Iterable</cite> with the indices of the valence bands to consider.</p></li>
<li><p><strong>crange</strong> – Int or <cite>Iterable</cite> with the indices of the conduction bands to consider.</p></li>
<li><p><strong>method</strong> – String defining the method.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></p></li>
<li><p><strong>cumulative</strong> – True for cumulative plots (default).</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.apply_scissors">
<code class="sig-name descname"><span class="pre">apply_scissors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scissors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.apply_scissors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.apply_scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the band structure with the scissors operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scissors</strong> – An instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Scissors</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> with modified energies.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">klabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_phfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic band structure with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index. None to plot both spins.</p></li>
<li><p><strong>band_range</strong> – Tuple specifying the minimum and maximum band to plot (default: all bands are plotted)</p></li>
<li><p><strong>klabels</strong> – dictionary whose keys are tuple with the reduced
coordinates of the k-points. The values are the labels. e.g.
<code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives…</p></li>
<li><p><strong>with_gaps</strong> – <p>True to add markers and arrows showing the fundamental and the direct gap.
IMPORTANT: If the gaps are now showed correctly in a non-magnetic semiconductor,</p>
<blockquote>
<div><p>call <cite>ebands.set_fermie_to_vbm()</cite> to align the Fermi level at the top of the valence
bands before executing <a href="#id3"><span class="problematic" id="id4">`</span></a>ebands.plot().
The Fermi energy stored in the object, indeed, comes from the GS calculation
that produced the DEN file. If the k-mesh used for the GS and the CBM is e.g. at Gamma,
the Fermi energy will be underestimated and a manual aligment is needed.</p>
</div></blockquote>
</p></li>
<li><p><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plotly">
<code class="sig-name descname"><span class="pre">plotly</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">klabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_phfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plotly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic band structure with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index. None to plot both spins.</p></li>
<li><p><strong>band_range</strong> – Tuple specifying the minimum and maximum band to plot (default: all bands are plotted)</p></li>
<li><p><strong>klabels</strong> – dictionary whose keys are tuple with the reduced
coordinates of the k-points. The values are the labels. e.g.
<code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>fig</strong> – plotly figure or None if a new figure should be created.</p></li>
<li><p><strong>rcd</strong> – PlotlyRowColDesc object used when fig is not None to specify the (row, col) of the subplot in the grid.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code></p></li>
<li><p><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives.</p></li>
<li><p><strong>with_gaps</strong> – True to add markers and arrows showing the fundamental and the direct gap.
IMPORTANT: If the gaps are now showed correctly in a non-magnetic semiconductor,
call <cite>ebands.set_fermie_to_vbm()</cite> to align the Fermi level at the top of the valence
bands before executing <a href="#id5"><span class="problematic" id="id6">`</span></a>ebands.plot().
The Fermi energy stored in the object, indeed, comes from the GS calculation
that produced the DEN file. If the k-mesh used for the GS and the CBM is e.g. at Gamma,
the Fermi energy will be underestimated and a manual aligment is needed.</p></li>
<li><p><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
<li><p><strong>kwargs</strong> – Passed to fig.add_scatter method.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code></p>
<blockquote>
<div><p>Keyword arguments controlling the display of the figure:
================  ====================================================================
kwargs            Meaning
================  ====================================================================
title             Title of the plot (Default: None).
show              True to show the figure (default: True).
hovormode         True to show the hover info (default: False)
savefig           “abc.png” , “abc.jpeg” or “abc.webp” to save the figure to a file.
write_json        Write plotly figure to <cite>write_json</cite> JSON file.</p>
<blockquote>
<div><p>Inside jupyter-lab, one can right-click the <cite>write_json</cite> file from the file menu
and open with “Plotly Editor”.
Make some changes to the figure, then use the file menu to save the customized plotly plot.
Requires <cite>jupyter labextension install jupyterlab-chart-editor</cite>.
See <a class="reference external" href="https://github.com/plotly/jupyterlab-chart-editor">https://github.com/plotly/jupyterlab-chart-editor</a></p>
</div></blockquote>
<dl class="simple">
<dt>renderer          (str or None (default None)) –</dt><dd><p>A string containing the names of one or more registered renderers
(separated by ‘+’ characters) or None. If None, then the default
renderers specified in plotly.io.renderers.default are used.
See <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</a></p>
</dd>
</dl>
<p>config (dict)     A dict of parameters to configure the figure. The defaults are set in plotly.js.
chart_studio      True to push figure to chart_studio server. Requires authenticatios.</p>
<blockquote>
<div><p>Default: False.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_scatter3d">
<code class="sig-name descname"><span class="pre">plot_scatter3d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_scatter3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_scatter3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib <code class="docutils literal notranslate"><span class="pre">scatter3D</span></code> to produce a scatter plot of the eigenvalues in 3D.
The color of the points gives the energy of the state wrt to the Fermi level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band</strong> – Band index</p></li>
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
&lt;<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a>&gt;</p></li>
<li><p><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal notranslate"><span class="pre">Axes3D</span></code> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.decorate_ax">
<code class="sig-name descname"><span class="pre">decorate_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.decorate_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add k-labels, title and unit name to axis ax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> – </p></li>
<li><p><strong>fontsize</strong> – </p></li>
<li><p><strong>klabels</strong> – </p></li>
<li><p><strong>klabel_size</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.decorate_plotly">
<code class="sig-name descname"><span class="pre">decorate_plotly</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.decorate_plotly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.decorate_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Add q-labels and unit name to figure <code class="docutils literal notranslate"><span class="pre">fig</span></code>.
Use units=”” to add k-labels without unit name.
:param klabels:
:param klabel_size:
:param iax: An int, use iax=n to decorate the nth axis when the fig has subplots.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_e0">
<code class="sig-name descname"><span class="pre">get_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).</p></li>
<li><p>Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV</p></li>
<li><p>None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_ax">
<code class="sig-name descname"><span class="pre">plot_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the energies for (spin, band) on the axis ax with matplotlib..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</p></li>
<li><p><strong>spin</strong> – Spin index. If None, all spins are plotted.</p></li>
<li><p><strong>band</strong> – Band index, If None, all bands are plotted.</p></li>
<li><p><strong>kwargs</strong> – Passed to ax.plot</p></li>
</ul>
</dd>
</dl>
<p>Return: matplotlib lines</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plotly_traces">
<code class="sig-name descname"><span class="pre">plotly_traces</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showlegend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plotly_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plotly_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the energies for (spin, band) on figure <code class="docutils literal notranslate"><span class="pre">fig</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</p></li>
<li><p><strong>rcd</strong> – PlotlyRowColDesc object used when fig is not None to specify the (row, col) of the subplot in the grid.</p></li>
<li><p><strong>spin</strong> – Spin index. If None, all spins are plotted.</p></li>
<li><p><strong>band</strong> – Band index, If None, all bands are plotted.</p></li>
<li><p><strong>showlegend</strong> – Determines whether or not an item corresponding to this trace is shown in the legend.</p></li>
<li><p><strong>kwargs</strong> – Passed to fig.add_scatter method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_with_edos">
<code class="sig-name descname"><span class="pre">plot_with_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">klabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_phfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_with_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edos</strong> – An instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a>.</p></li>
<li><p><strong>klabels</strong> – dictionary whose keys are tuple with the reduced coordinates of the k-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>ax_list</strong> – The axes for the bandstructure plot and the DOS plot. If ax_list is None, a new figure
is created and the two axes are automatically generated.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See ``edos_fermie``.
* ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
*  Number e.g ``e0 = 0.5``: shift all eigenvalues to have zero energy at 0.5 eV
*  None: Don&#39;t shift energies, equivalent to ``e0 = 0``
</pre></div>
</div>
</p></li>
<li><p><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives…</p></li>
<li><p><strong>with_gaps</strong> – True to add markers and arrows showing the fundamental and the direct gap.</p></li>
<li><p><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plotly_with_edos">
<code class="sig-name descname"><span class="pre">plotly_with_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">klabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_phfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plotly_with_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plotly_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edos</strong> – An instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a>.</p></li>
<li><p><strong>klabels</strong> – dictionary whose keys are tuple with the reduced coordinates of the k-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>fig</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code> with two distinct plots for the bandstructure plot and the DOS plot.
If fig is None, a new figure is created.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code></p></li>
<li><p><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See ``edos_fermie``.
* ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
*  Number e.g ``e0 = 0.5``: shift all eigenvalues to have zero energy at 0.5 eV
*  None: Don&#39;t shift energies, equivalent to ``e0 = 0``
</pre></div>
</div>
</p></li>
<li><p><strong>points</strong> – Marker object with the position and the size of the marker.
Used for plotting purpose e.g. QP energies, energy derivatives…</p></li>
<li><p><strong>with_gaps</strong> – True to add markers and arrows showing the fundamental and the direct gap.</p></li>
<li><p><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorption/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code></p>
<blockquote>
<div><p>Keyword arguments controlling the display of the figure:
================  ====================================================================
kwargs            Meaning
================  ====================================================================
title             Title of the plot (Default: None).
show              True to show the figure (default: True).
hovormode         True to show the hover info (default: False)
savefig           “abc.png” , “abc.jpeg” or “abc.webp” to save the figure to a file.
write_json        Write plotly figure to <cite>write_json</cite> JSON file.</p>
<blockquote>
<div><p>Inside jupyter-lab, one can right-click the <cite>write_json</cite> file from the file menu
and open with “Plotly Editor”.
Make some changes to the figure, then use the file menu to save the customized plotly plot.
Requires <cite>jupyter labextension install jupyterlab-chart-editor</cite>.
See <a class="reference external" href="https://github.com/plotly/jupyterlab-chart-editor">https://github.com/plotly/jupyterlab-chart-editor</a></p>
</div></blockquote>
<dl class="simple">
<dt>renderer          (str or None (default None)) –</dt><dd><p>A string containing the names of one or more registered renderers
(separated by ‘+’ characters) or None. If None, then the default
renderers specified in plotly.io.renderers.default are used.
See <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</a></p>
</dd>
</dl>
<p>config (dict)     A dict of parameters to configure the figure. The defaults are set in plotly.js.
chart_studio      True to push figure to chart_studio server. Requires authenticatios.</p>
<blockquote>
<div><p>Default: False.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.plot_lws_vs_e0">
<code class="sig-name descname"><span class="pre">plot_lws_vs_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ax=None</span></em>, <em class="sig-param"><span class="pre">e0='fermie'</span></em>, <em class="sig-param"><span class="pre">function=&lt;function</span> <span class="pre">ElectronBands.&lt;lambda&gt;&gt;</span></em>, <em class="sig-param"><span class="pre">exchange_xy=False</span></em>, <em class="sig-param"><span class="pre">xlims=None</span></em>, <em class="sig-param"><span class="pre">ylims=None</span></em>, <em class="sig-param"><span class="pre">fontsize=12</span></em>, <em class="sig-param"><span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.plot_lws_vs_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.plot_lws_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic linewidths vs KS energy with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>function</strong> – Apply this function to the values before plotting</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis or the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the x-axis or the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.to_xmgrace">
<code class="sig-name descname"><span class="pre">to_xmgrace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_xmgrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_xmgrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <a class="reference external" href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> file with band structure energies and labels for high-symmetry k-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – String with filename or stream.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.to_bxsf">
<code class="sig-name descname"><span class="pre">to_bxsf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.to_bxsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.to_bxsf" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the full band structure to <code class="docutils literal notranslate"><span class="pre">filepath</span></code> in BXSF format
suitable for the visualization of isosurfaces with <a class="reference external" href="http://www.xcrysden.org/">xcrysden</a> (xcrysden –bxsf FILE).
Require k-points in IBZ and gamma-centered k-mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_ebands3d">
<code class="sig-name descname"><span class="pre">get_ebands3d</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_ebands3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_ebands3d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.derivatives">
<code class="sig-name descname"><span class="pre">derivatives</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the eigenvalues wrt to k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index</p></li>
<li><p><strong>band</strong> – Band index</p></li>
<li><p><strong>order</strong> – </p></li>
<li><p><strong>acc</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.effective_masses">
<code class="sig-name descname"><span class="pre">effective_masses</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.effective_masses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.effective_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses for the given <code class="docutils literal notranslate"><span class="pre">spin</span></code> and <code class="docutils literal notranslate"><span class="pre">band</span></code> index.
Use finite difference with accuracy <code class="docutils literal notranslate"><span class="pre">acc</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of size self.nkpt with effective masses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_effmass_line">
<code class="sig-name descname"><span class="pre">get_effmass_line</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_effmass_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_effmass_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the effective masses along a k-line. Requires band energies on a k-path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – integer, list of fractional coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>band</strong> – Band index.</p></li>
<li><p><strong>acc</strong> – accuracy</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.interpolate">
<code class="sig-name descname"><span class="pre">interpolate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lpratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies in k-space along a k-path and, optionally, in the IBZ for DOS calculations.
Note that the interpolation will likely fail if there are symmetrical k-points in the input set of k-points
so it’s recommended to call this method with energies obtained in the IBZ.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lpratio</strong> – Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</p></li>
<li><p><strong>knames</strong> – List of strings with the k-point labels for the k-path. Has precedence over <code class="docutils literal notranslate"><span class="pre">vertices_names</span></code>.</p></li>
<li><p><strong>vertices_names</strong> – Used to specify the k-path for the interpolated band structure
It’s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <code class="docutils literal notranslate"><span class="pre">line_density</span></code> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</p></li>
<li><p><strong>line_density</strong> – Number of points in the smallest segment of the k-path.
If 0, use list of k-points given in vertices_names</p></li>
<li><p><strong>kmesh</strong> – Used to activate the interpolation on the homogeneous mesh for DOS (uses <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> API).
kmesh is given by three integers and specifies mesh numbers along reciprocal primitive axis.</p></li>
<li><p><strong>is_shift</strong> – three integers (<a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</p></li>
<li><p><strong>bstart</strong> – Select the range of band to be used in the interpolation</p></li>
<li><p><strong>bstop</strong> – Select the range of band to be used in the interpolation</p></li>
<li><p><strong>filter_params</strong> – TO BE described.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>namedtuple with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ebands_kpath: |ElectronBands| with the interpolated band structure on the k-path.
ebands_kmesh: |ElectronBands| with the interpolated band structure on the k-mesh.
    None if ``kmesh`` is not given.
interpolator: |SkwInterpolator| object.
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBands.get_collinear_mag">
<code class="sig-name descname"><span class="pre">get_collinear_mag</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBands.get_collinear_mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBands.get_collinear_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total collinear magnetization in Bohr magneton as the difference
between the spin up and spin down densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the total magnetization.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.ebands.ElectronDos">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.ebands.</span></code><code class="sig-name descname"><span class="pre">ElectronDos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_dos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_idos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores the electronic density of states.
It is usually created by calling the get_edos method of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a>.</p>
<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.as_edos">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.as_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.as_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> from a generic object <code class="docutils literal notranslate"><span class="pre">obj</span></code>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li><p>instances of cls</p></li>
<li><p>files (string) that can be open with abiopen and that provide an <cite>ebands</cite> attribute.</p></li>
<li><p>objects providing an <cite>ebands</cite> or <cite>get_edos</cite> attribute</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edos_kwargs</strong> – optional dictionary with the options passed to <cite>get_edos</cite> to compute the electron DOS.</p></li>
<li><p><strong>when obj is not already an instance of cls.</strong> (<em>Used</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.dos_idos">
<code class="sig-name descname"><span class="pre">dos_idos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.dos_idos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns DOS and IDOS for given spin. Total DOS and IDOS if spin is None.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.find_mu">
<code class="sig-name descname"><span class="pre">find_mu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.find_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.find_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the chemical potential given the number of electrons.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.up_minus_down">
<code class="sig-name descname"><span class="pre">up_minus_down</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.up_minus_down"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Function1D with dos_up - dos_down</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.get_e0">
<code class="sig-name descname"><span class="pre">get_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.get_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.get_e0" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>e0: Option used to define the zero of energy in the band structure plot. Possible values:</dt><dd><ul class="simple">
<li><p><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).</p></li>
<li><p>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p></li>
<li><p>None: Don’t shift energies, equivalent to e0=0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_ax">
<code class="sig-name descname"><span class="pre">plot_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the DOS data on the matplotlib axis <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</p></li>
<li><p><strong>spin</strong> – selects the spin component, None for total DOS, IDOS.</p></li>
<li><p><strong>what</strong> – string selecting what will be plotted. “dos” for DOS, “idos” for IDOS</p></li>
<li><p><strong>fact</strong> – Multiplication factor for DOS/IDOS. Usually +-1 for spin DOS</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>kwargs</strong> – Options passed to matplotlib <code class="docutils literal notranslate"><span class="pre">ax.plot</span></code></p></li>
</ul>
</dd>
</dl>
<p>Return: list of lines added to the axis ax.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plotly_traces">
<code class="sig-name descname"><span class="pre">plotly_traces</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showlegend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plotly_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plotly_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the DOS data on the <code class="docutils literal notranslate"><span class="pre">fig</span></code> with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</p></li>
<li><p><strong>spin</strong> – selects the spin component, None for total DOS, IDOS.</p></li>
<li><p><strong>what</strong> – string selecting what will be plotted. “dos” for DOS, “idos” for IDOS</p></li>
<li><p><strong>fact</strong> – Multiplication factor for DOS/IDOS. Usually +-1 for spin DOS</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>rcd</strong> – PlotlyRowColDesc object used to specify the (row, col) of the subplot in the grid.</p></li>
<li><p><strong>trace_name</strong> – Name of the trace.</p></li>
<li><p><strong>showlegend</strong> – Determines whether or not an item corresponding to this trace is shown in the legend.</p></li>
<li><p><strong>line_opts</strong> – Dict of options passed to <a href="#id8"><span class="problematic" id="id9">|plotly.graph_objects.scatter.Line|</span></a></p></li>
<li><p><strong>kwargs</strong> – Options passed to fig.add_scatter method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
- Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
- None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>spin</strong> – Selects the spin component, None if total DOS is wanted.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Set data limits for the y-axis.</p></li>
<li><p><strong>kwargs</strong> – options passed to <code class="docutils literal notranslate"><span class="pre">ax.plot</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plotly">
<code class="sig-name descname"><span class="pre">plotly</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showlegend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plotly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
- Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
- None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>spin</strong> – Selects the spin component, None if total DOS is wanted.</p></li>
<li><p><strong>fig</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code>.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>.</p></li>
<li><p><strong>trace_name</strong> – Name of the trace.</p></li>
<li><p><strong>showlegend</strong> – Determines whether or not an item corresponding to this trace is shown in the legend.</p></li>
<li><p><strong>kwargs</strong> – Options passed to fig.add_scatter method.</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code></p>
<blockquote>
<div><p>Keyword arguments controlling the display of the figure:
================  ====================================================================
kwargs            Meaning
================  ====================================================================
title             Title of the plot (Default: None).
show              True to show the figure (default: True).
hovormode         True to show the hover info (default: False)
savefig           “abc.png” , “abc.jpeg” or “abc.webp” to save the figure to a file.
write_json        Write plotly figure to <cite>write_json</cite> JSON file.</p>
<blockquote>
<div><p>Inside jupyter-lab, one can right-click the <cite>write_json</cite> file from the file menu
and open with “Plotly Editor”.
Make some changes to the figure, then use the file menu to save the customized plotly plot.
Requires <cite>jupyter labextension install jupyterlab-chart-editor</cite>.
See <a class="reference external" href="https://github.com/plotly/jupyterlab-chart-editor">https://github.com/plotly/jupyterlab-chart-editor</a></p>
</div></blockquote>
<dl class="simple">
<dt>renderer          (str or None (default None)) –</dt><dd><p>A string containing the names of one or more registered renderers
(separated by ‘+’ characters) or None. If None, then the default
renderers specified in plotly.io.renderers.default are used.
See <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</a></p>
</dd>
</dl>
<p>config (dict)     A dict of parameters to configure the figure. The defaults are set in plotly.js.
chart_studio      True to push figure to chart_studio server. Requires authenticatios.</p>
<blockquote>
<div><p>Default: False.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_dos_idos">
<code class="sig-name descname"><span class="pre">plot_dos_idos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_dos_idos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS and Integrated DOS on two different subplots with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>ax_list</strong> – The axes for the DOS and IDOS plot. If ax_list is None, a new figure
is created and the two axes are automatically generated.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>height_ratios</strong> – </p></li>
<li><p><strong>kwargs</strong> – options passed to <code class="docutils literal notranslate"><span class="pre">plot_ax</span></code></p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plotly_dos_idos">
<code class="sig-name descname"><span class="pre">plotly_dos_idos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plotly_dos_idos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plotly_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic DOS and Integrated DOS on two different subplots with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><strong>fig</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code> with two distinct plots for the DOS and IDOS plot.
If fig is None, a new figure is created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>.</p></li>
<li><p><strong>height_ratios</strong> – </p></li>
<li><p><strong>kwargs</strong> – Options passed to plotly_traces method.</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code></p>
<blockquote>
<div><p>Keyword arguments controlling the display of the figure:
================  ====================================================================
kwargs            Meaning
================  ====================================================================
title             Title of the plot (Default: None).
show              True to show the figure (default: True).
hovormode         True to show the hover info (default: False)
savefig           “abc.png” , “abc.jpeg” or “abc.webp” to save the figure to a file.
write_json        Write plotly figure to <cite>write_json</cite> JSON file.</p>
<blockquote>
<div><p>Inside jupyter-lab, one can right-click the <cite>write_json</cite> file from the file menu
and open with “Plotly Editor”.
Make some changes to the figure, then use the file menu to save the customized plotly plot.
Requires <cite>jupyter labextension install jupyterlab-chart-editor</cite>.
See <a class="reference external" href="https://github.com/plotly/jupyterlab-chart-editor">https://github.com/plotly/jupyterlab-chart-editor</a></p>
</div></blockquote>
<dl class="simple">
<dt>renderer          (str or None (default None)) –</dt><dd><p>A string containing the names of one or more registered renderers
(separated by ‘+’ characters) or None. If None, then the default
renderers specified in plotly.io.renderers.default are used.
See <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</a></p>
</dd>
</dl>
<p>config (dict)     A dict of parameters to configure the figure. The defaults are set in plotly.js.
chart_studio      True to push figure to chart_studio server. Requires authenticatios.</p>
<blockquote>
<div><p>Default: False.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plot_up_minus_down">
<code class="sig-name descname"><span class="pre">plot_up_minus_down</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plot_up_minus_down"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plot_up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Dos_up - Dow_down with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>kwargs</strong> – options passed to <code class="docutils literal notranslate"><span class="pre">ax.plot</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDos.plotly_up_minus_down">
<code class="sig-name descname"><span class="pre">plotly_up_minus_down</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDos.plotly_up_minus_down"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDos.plotly_up_minus_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Dos_up - Dow_down with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fig</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Options passed to fig.add_scatter method.</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code></p>
<blockquote>
<div><p>Keyword arguments controlling the display of the figure:
================  ====================================================================
kwargs            Meaning
================  ====================================================================
title             Title of the plot (Default: None).
show              True to show the figure (default: True).
hovormode         True to show the hover info (default: False)
savefig           “abc.png” , “abc.jpeg” or “abc.webp” to save the figure to a file.
write_json        Write plotly figure to <cite>write_json</cite> JSON file.</p>
<blockquote>
<div><p>Inside jupyter-lab, one can right-click the <cite>write_json</cite> file from the file menu
and open with “Plotly Editor”.
Make some changes to the figure, then use the file menu to save the customized plotly plot.
Requires <cite>jupyter labextension install jupyterlab-chart-editor</cite>.
See <a class="reference external" href="https://github.com/plotly/jupyterlab-chart-editor">https://github.com/plotly/jupyterlab-chart-editor</a></p>
</div></blockquote>
<dl class="simple">
<dt>renderer          (str or None (default None)) –</dt><dd><p>A string containing the names of one or more registered renderers
(separated by ‘+’ characters) or None. If None, then the default
renderers specified in plotly.io.renderers.default are used.
See <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</a></p>
</dd>
</dl>
<p>config (dict)     A dict of parameters to configure the figure. The defaults are set in plotly.js.
chart_studio      True to push figure to chart_studio server. Requires authenticatios.</p>
<blockquote>
<div><p>Default: False.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.electrons.ebands.dataframe_from_ebands">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.ebands.</span></code><code class="sig-name descname"><span class="pre">dataframe_from_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebands_objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#dataframe_from_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.dataframe_from_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a pandas dataframe with the most important results available in a list of band structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebands_objects</strong> – List of objects that can be converted to structure.
Support netcdf filenames or <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> objects
See <code class="docutils literal notranslate"><span class="pre">ElectronBands.as_ebands</span></code> for the complete list.</p></li>
<li><p><strong>index</strong> – Index of the dataframe.</p></li>
<li><p><strong>with_spglib</strong> – If True, spglib is invoked to get the spacegroup symbol and number.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.ebands.</span></code><code class="sig-name descname"><span class="pre">ElectronBandsPlotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_ebands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_edos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting electronic band structure and DOSes.
Supports plots on the same graph or separated plots.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;foo-label&quot;</span><span class="p">,</span> <span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;bar-label&quot;</span><span class="p">,</span> <span class="s2">&quot;bar_WFK.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<p>Dictionary with the mapping label –&gt; edos.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-7e4027636f497a6c1c63b99fc43361de89422393.png" alt="Inheritance diagram of ElectronBandsPlotter" usemap="#inheritanceab465bca1b" class="inheritance graphviz" /></div>
<map id="inheritanceab465bca1b" name="inheritanceab465bca1b">
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="264,5,462,26"/>
<area shape="rect" id="node3" href="#abipy.electrons.ebands.ElectronBandsPlotter" target="_top" title="Class for plotting electronic band structure and DOSes." alt="" coords="505,5,763,26"/>
</map><dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_plotter">
<code class="sig-name descname"><span class="pre">add_plotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.add_plotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two plotters, return new plotter.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">func=&lt;class</span> <span class="pre">'str'&gt;</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame">
<code class="sig-name descname"><span class="pre">get_ebands_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.get_ebands_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.get_ebands_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the most important results available in the band structures.
Useful to analyze band-gaps.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.ebands_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands_list</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.ebands_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.edoses_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">edoses_list</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.edoses_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt">
<code class="sig-name descname"><span class="pre">iter_lineopt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.iter_lineopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.iter_lineopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates matplotlib linestyles.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.add_ebands">
<code class="sig-name descname"><span class="pre">add_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.add_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.add_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a band structure and optionally an edos to the plotter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – label for the bands. Must be unique.</p></li>
<li><p><strong>bands</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p></li>
<li><p><strong>edos</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</p></li>
<li><p><strong>edos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal notranslate"><span class="pre">get_edos</span></code> to compute the electron DOS.
Used only if <code class="docutils literal notranslate"><span class="pre">edos</span></code> is not None and it’s not an <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff">
<code class="sig-name descname"><span class="pre">bands_statdiff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.bands_statdiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.bands_statdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the reference bands with index ref with the other bands stored in the plotter.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiplot">
<code class="sig-name descname"><span class="pre">combiplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS on the same figure.
Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot band structures on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – <dl class="simple">
<dt>Option used to define the zero of energy in the band structure plot. Possible values::</dt><dd><ul>
<li><dl class="simple">
<dt><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (ebands.fermie)</dt><dd><p>Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">edos_fermie</span></code>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</dt><dd><p>Available only if plotter contains dos objects.</p>
</dd>
</dl>
</li>
<li><p>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p></li>
<li><p>None: Don’t shift energies, equivalent to e0=0</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
<li><p><strong>linestyle_dict</strong> – Dictionary mapping labels to matplotlib linestyle options.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS on the same figure.
Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot band structures on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – <dl class="simple">
<dt>Option used to define the zero of energy in the band structure plot. Possible values::</dt><dd><ul>
<li><dl class="simple">
<dt><cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (ebands.fermie)</dt><dd><p>Note that, by default, the Fermi energy is taken from the band structure object
i.e. the Fermi energy computed at the end of the SCF file that produced the density.
This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
the one used to compute the density. See <cite>edos_fermie</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">edos_fermie</span></code>: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.</dt><dd><p>Available only if plotter contains dos objects.</p>
</dd>
</dl>
</li>
<li><p>Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV</p></li>
<li><p>None: Don’t shift energies, equivalent to e0=0</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
<li><p><strong>linestyle_dict</strong> – Dictionary mapping labels to matplotlib linestyle options.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.gridplot">
<code class="sig-name descname"><span class="pre">gridplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_phfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.gridplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple electron bandstructures and optionally DOSes on a grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eb_objects</strong> – List of objects from which the band structures are extracted.
Each item in eb_objects is either a string with the path of the netcdf file,
or one of the abipy object with an <code class="docutils literal notranslate"><span class="pre">ebands</span></code> attribute or a <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p></li>
<li><p><strong>edos_objects</strong> – List of objects from which the electron DOSes are extracted.
Accept filepaths or <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> objects. If edos_objects is not None,
each subplot in the grid contains a band structure with DOS else a simple bandstructure plot.</p></li>
<li><p><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See `edos_fermie`.
- ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
   Available only if edos_objects is not None
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#39;t shift energies, equivalent to e0=0
</pre></div>
</div>
</p></li>
<li><p><strong>with_dos</strong> – True if DOS should be printed.</p></li>
<li><p><strong>with_gaps</strong> – True to add markesr and arrows showing the fundamental and the direct gap.</p></li>
<li><p><strong>max_phfreq</strong> – Max phonon frequency in eV to activate scatterplot showing
possible phonon absorptions/emission processes based on energy-conservation alone.
All final states whose energy is within +- max_phfreq of the initial state are included.
By default, the four electronic states defining the fundamental and the direct gaps
are considered as initial state (not available for metals).</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">`(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.boxplot">
<code class="sig-name descname"><span class="pre">boxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.
Band structures are drawn on different subplots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>brange</strong> – Only bands such as <code class="docutils literal notranslate"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>fontsize</strong> – Fontsize for title.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot">
<code class="sig-name descname"><span class="pre">combiboxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.combiboxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.combiboxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot comparing the distributions of the eigenvalues
Band structures are drawn on the same plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>brange</strong> – Only bands such as <code class="docutils literal notranslate"><span class="pre">brange[0]</span> <span class="pre">&lt;=</span> <span class="pre">band_index</span> <span class="pre">&lt;</span> <span class="pre">brange[1]</span></code> are included in the plot.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.plot_band_edges">
<code class="sig-name descname"><span class="pre">plot_band_edges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epad_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fermie_to_vbm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.plot_band_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.plot_band_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band edges for electrons and holes on two separated plots for all ebands in ebands_dict.
Useful for comparing band structures obtained with/without SOC or bands obtained with different settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>epad_ev</strong> – Add this energy window in eV above VBM and below CBM.</p></li>
<li><p><strong>set_fermie_to_vbm</strong> – True if Fermi energy should be recomputed and fixed at max occupied energy level.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap.</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.animate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="http://matplotlib.org">matplotlib</a> to animate a list of band structure plots (with or without DOS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   See `edos_fermie`.
* ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
*  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
*  None: Don&#39;t shift energies, equivalent to e0=0
</pre></div>
</div>
</p></li>
<li><p><strong>interval</strong> – draws a new frame every interval milliseconds.</p></li>
<li><p><strong>savefile</strong> – Use e.g. ‘myanimation.mp4’ to save the animation in mp4 format.</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</p></li>
<li><p><strong>show</strong> – True if the animation should be shown immediately</p></li>
</ul>
</dd>
</dl>
<p>Returns: Animation object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It would be nice to animate the title of the plot, unfortunately
this feature is not available in the present version of matplotlib.
See: <a class="reference external" href="http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib">http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib</a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.ipw_select_plot">
<code class="sig-name descname"><span class="pre">ipw_select_plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.ipw_select_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronBandsPlotter.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronBandsPlotter.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronBandsPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.ebands.ElectronDosPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.ebands.</span></code><code class="sig-name descname"><span class="pre">ElectronDosPlotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_edos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting multiple electronic DOSes.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronDosPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;foo dos&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_edos</span><span class="p">(</span><span class="s2">&quot;bar dos&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.edos_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">edos_list</span></code><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.edos_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of DOSes</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.add_edos">
<code class="sig-name descname"><span class="pre">add_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.add_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.add_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a DOS for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – label for the DOS. Must be unique.</p></li>
<li><p><strong>edos</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronDos" title="abipy.electrons.ebands.ElectronDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronDos</span></code></a> object.</p></li>
<li><p><strong>edos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal notranslate"><span class="pre">get_edos</span></code> to compute the electron DOS.
Used only if <code class="docutils literal notranslate"><span class="pre">edos</span></code> is not an ElectronDos instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.combiplot">
<code class="sig-name descname"><span class="pre">combiplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.combiplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the the DOSes on the same figure. Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what_list</strong> – Selects quantities to plot e.g. [“dos”, “idos”] to plot DOS and integrated DOS.
“dos” for DOS only and “idos” for IDOS only</p></li>
<li><p><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – fontsize for titles and legend</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the the DOSes on the same figure. Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what_list</strong> – Selects quantities to plot e.g. [“dos”, “idos”] to plot DOS and integrated DOS.
“dos” for DOS only and “idos” for IDOS only</p></li>
<li><p><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – fontsize for titles and legend</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.gridplot">
<code class="sig-name descname"><span class="pre">gridplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.gridplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple DOSes on a grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what</strong> – “dos” to plot DOS, “idos” for integrated DOS.</p></li>
<li><p><strong>spin_mode</strong> – “total” for total (I)DOS, “resolved” for plotting individual contributions.
Meaningful only if nsppol == 2.
“automatic” to use “resolved” if at least one DOS is polarized.</p></li>
<li><p><strong>e0</strong> – <p>Option used to define the zero of energy in the band structure plot. Possible values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- ``fermie``: shift all eigenvalues and the DOS to have zero energy at the Fermi energy.
   Note that, by default, the Fermi energy is taken from the band structure object
   i.e. the Fermi energy computed at the end of the SCF file that produced the density.
   This should be ok in semiconductors. In metals, however, a better value of the Fermi energy
   can be obtained from the DOS provided that the k-sampling for the DOS is much denser than
   the one used to compute the density. See ``edos_fermie``.
- ``edos_fermie``: Use the Fermi energy computed from the DOS to define the zero of energy in both subplots.
   Available only if edos_objects is not None
-  Number e.g ``e0 = 0.5``: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don&#39;t shift energies, equivalent to ``e0 = 0``.
</pre></div>
</div>
</p></li>
<li><p><strong>sharex</strong> – True if x (y) axis should be shared.</p></li>
<li><p><strong>sharey</strong> – True if x (y) axis should be shared.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – Label and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.ipw_select_plot">
<code class="sig-name descname"><span class="pre">ipw_select_plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.ipw_select_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.ebands.ElectronDosPlotter.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/ebands.html#ElectronDosPlotter.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.ebands.ElectronDosPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.effmass_analyzer">
<span id="effmass-analyzer-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">effmass_analyzer</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.effmass_analyzer" title="Permalink to this headline">¶</a></h2>
<p>Objects to compute electronic effective masses via finite differences starting from an <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
<dl class="py class">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.effmass_analyzer.</span></code><code class="sig-name descname"><span class="pre">EffMassAnalyzer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a></p>
<p>This objects provides a high-level API to compute electronic effective masses
via finite differences starting from an <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">emana</span> <span class="o">=</span> <span class="n">EffmassAnalyzer</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;out_GSR.nc&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">emana</span><span class="p">)</span>
<span class="n">emana</span><span class="o">.</span><span class="n">select_vbm</span><span class="p">()</span>
<span class="c1">#emana.select_kpoint_band(kpoint=[0, 0, 0], band=3)</span>
<span class="n">emans</span><span class="o">.</span><span class="n">plot_emass</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-88c0ce5f847f121dc75d798b9ed913914be377a3.png" alt="Inheritance diagram of EffMassAnalyzer" usemap="#inheritance9618d0f620" class="inheritance graphviz" /></div>
<map id="inheritance9618d0f620" name="inheritance9618d0f620">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="5,5,250,29"/>
<area shape="rect" id="node3" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer" target="_top" title="This objects provides a high&#45;level API to compute electronic effective masses" alt="" coords="298,29,619,53"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="22,53,234,77"/>
</map><dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a netcdf file with an ebands object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful info such as band gaps, position of HOMO, LOMO…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – Verbosity level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_kpoint_band">
<code class="sig-name descname"><span class="pre">select_kpoint_band</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etol_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.select_kpoint_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_kpoint_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct line segments based on the k-point <code class="docutils literal notranslate"><span class="pre">kpoint</span></code> and the band index <code class="docutils literal notranslate"><span class="pre">band</span></code>.
This is the most flexible interface and allows one to include extra bands
by increasing the value of <cite>etol_ev</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpoint</strong> – Fractional coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>band</strong> – Band index</p></li>
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>etol_ev</strong> – Include all bands at this k-point whose energy differ from the one at
(kpoint, band) less that <code class="docutils literal notranslate"><span class="pre">etol_ev</span></code> in eV.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_cbm">
<code class="sig-name descname"><span class="pre">select_cbm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etol_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.select_cbm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_cbm" title="Permalink to this definition">¶</a></dt>
<dd><p>Select conduction band minimum.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_vbm">
<code class="sig-name descname"><span class="pre">select_vbm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etol_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.select_vbm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_vbm" title="Permalink to this definition">¶</a></dt>
<dd><p>Select valence band maximum.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_band_edges">
<code class="sig-name descname"><span class="pre">select_band_edges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etol_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.select_band_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.select_band_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Select conduction band minimum and valence band maximum.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.summarize">
<code class="sig-name descname"><span class="pre">summarize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.summarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.summarize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.plot_emass">
<code class="sig-name descname"><span class="pre">plot_emass</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.plot_emass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.plot_emass" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electronic dispersion and quadratic curve based on the
effective masses computed along each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acc</strong> – </p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.EffMassAnalyzer.plot_all_segments">
<code class="sig-name descname"><span class="pre">plot_all_segments</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#EffMassAnalyzer.plot_all_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.EffMassAnalyzer.plot_all_segments" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colormap</strong> – matplotlib colormap</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.effmass_analyzer.Segment">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.effmass_analyzer.</span></code><code class="sig-name descname"><span class="pre">Segment</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#Segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt id="abipy.electrons.effmass_analyzer.Segment.Z">
<code class="sig-name descname"><span class="pre">Z</span></code><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment.Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic number</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.Segment.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#Segment.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.Segment.get_fd_emass_d2">
<code class="sig-name descname"><span class="pre">get_fd_emass_d2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enes_kline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#Segment.get_fd_emass_d2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment.get_fd_emass_d2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.Segment.get_dataframe_with_accuracies">
<code class="sig-name descname"><span class="pre">get_dataframe_with_accuracies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#Segment.get_dataframe_with_accuracies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment.get_dataframe_with_accuracies" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with effective masses computed with different accuracies (npts)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.effmass_analyzer.Segment.plot_emass">
<code class="sig-name descname"><span class="pre">plot_emass</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/effmass_analyzer.html#Segment.plot_emass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.effmass_analyzer.Segment.plot_emass" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acc</strong> – </p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.fatbands">
<span id="fatbands-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fatbands</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.fatbands" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of electronic fatbands and projected DOSes.</p>
<dl class="py function">
<dt id="abipy.electrons.fatbands.gaussians_dos">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.fatbands.</span></code><code class="sig-name descname"><span class="pre">gaussians_dos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#gaussians_dos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.gaussians_dos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="abipy.electrons.fatbands.FatBandsFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.fatbands.</span></code><code class="sig-name descname"><span class="pre">FatBandsFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Provides methods to analyze the data stored in the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/efatbands.ipynb">FATBANDS.nc</a> file.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">abiopen</span><span class="p">(</span><span class="s2">&quot;out_FATBANDS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fb</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
    <span class="n">fb</span><span class="o">.</span><span class="n">plot_fatbands_lview</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, one can use the <cite>abiopen.py</cite> script to open the file in an ipython notebook with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">abiopen</span><span class="o">.</span><span class="n">py</span> <span class="n">out_FATBANDS</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">nb</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-631d7c91b956ceafbcaadbcf346c9a5428d5eeae.png" alt="Inheritance diagram of FatBandsFile" usemap="#inheritancedf15763410" class="inheritance graphviz" /></div>
<map id="inheritancedf15763410" name="inheritancedf15763410">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="289,181,471,203"/>
<area shape="rect" id="node8" href="#abipy.electrons.fatbands.FatBandsFile" target="_top" title="Provides methods to analyze the data stored in the FATBANDS.nc_ file." alt="" coords="537,93,763,115"/>
<area shape="rect" id="node7" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="280,137,481,159"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="268,5,493,27"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf files containing the Abinit header." alt="" coords="288,49,473,71"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="283,93,478,115"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2color">
<code class="sig-name descname"><span class="pre">l2color</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'red',</span> <span class="pre">1:</span> <span class="pre">'blue',</span> <span class="pre">2:</span> <span class="pre">'green',</span> <span class="pre">3:</span> <span class="pre">'yellow',</span> <span class="pre">4:</span> <span class="pre">'orange'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.l2tex">
<code class="sig-name descname"><span class="pre">l2tex</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'$l=s$',</span> <span class="pre">1:</span> <span class="pre">'$l=p$',</span> <span class="pre">2:</span> <span class="pre">'$l=d$',</span> <span class="pre">3:</span> <span class="pre">'$l=f$',</span> <span class="pre">4:</span> <span class="pre">'$l=g$'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.l2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_spin">
<code class="sig-name descname"><span class="pre">marker_spin</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'^',</span> <span class="pre">1:</span> <span class="pre">'v'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spin2tex">
<code class="sig-name descname"><span class="pre">spin2tex</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'$\\sigma=\\uparrow$',</span> <span class="pre">1:</span> <span class="pre">'$\\sigma=\\downarrow$'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spin2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2tex">
<code class="sig-name descname"><span class="pre">spinors2tex</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'down-down':</span> <span class="pre">'$\\downarrow,\\downarrow$',</span> <span class="pre">'down-up':</span> <span class="pre">'$\\downarrow,\\uparrow$',</span> <span class="pre">'sigma_x':</span> <span class="pre">'$\\sigma_{x}$',</span> <span class="pre">'sigma_y':</span> <span class="pre">'$\\sigma_{y}$',</span> <span class="pre">'sigma_z':</span> <span class="pre">'$\\sigma_{z}$',</span> <span class="pre">'up-down':</span> <span class="pre">'$\\uparrow,\\downarrow$',</span> <span class="pre">'up-up':</span> <span class="pre">'$\\uparrow,\\uparrow$'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2tex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.spinors2color">
<code class="sig-name descname"><span class="pre">spinors2color</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'down-down':</span> <span class="pre">'yellow',</span> <span class="pre">'down-up':</span> <span class="pre">'violet',</span> <span class="pre">'sigma_x':</span> <span class="pre">'green',</span> <span class="pre">'sigma_y':</span> <span class="pre">'blue',</span> <span class="pre">'sigma_z':</span> <span class="pre">'red',</span> <span class="pre">'up-down':</span> <span class="pre">'brown',</span> <span class="pre">'up-up':</span> <span class="pre">'black'}</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.spinors2color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.alpha">
<code class="sig-name descname"><span class="pre">alpha</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0.6</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.marker_size">
<code class="sig-name descname"><span class="pre">marker_size</span></code><em class="property"> <span class="pre">=</span> <span class="pre">3.0</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.marker_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linewidth">
<code class="sig-name descname"><span class="pre">linewidth</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linewidth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.fatbands.FatBandsFile.linecolor">
<code class="sig-name descname"><span class="pre">linecolor</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'grey'</span></em><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.linecolor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.wal_sbk">
<code class="sig-name descname"><span class="pre">wal_sbk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.wal_sbk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.wal_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape [natom, mbesslang, nsppol, mband, nkpt]
with the L-contributions. Present only if prtdos == 3.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.walm_sbk">
<code class="sig-name descname"><span class="pre">walm_sbk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.walm_sbk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.walm_sbk" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape [natom, mbesslang**2, nsppol, mband, nkpt]
with the LM-contribution. Present only if prtdos == 3 and prtdosm != 0</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_atom">
<code class="sig-name descname"><span class="pre">get_wl_atom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for atom index <code class="docutils literal notranslate"><span class="pre">iatom</span></code>. The weights are summed over m.
If <code class="docutils literal notranslate"><span class="pre">spin</span></code> and <code class="docutils literal notranslate"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spin and bands else the contribution for (spin, band)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_wl_symbol">
<code class="sig-name descname"><span class="pre">get_wl_symbol</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_wl_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_wl_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the l-dependent DOS weights for a given type specified in terms of the
chemical symbol <code class="docutils literal notranslate"><span class="pre">symbol</span></code>. The weights are summed over m and over all atoms of the same type.
If <code class="docutils literal notranslate"><span class="pre">spin</span></code> and <code class="docutils literal notranslate"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_w_symbol">
<code class="sig-name descname"><span class="pre">get_w_symbol</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_w_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_w_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DOS weights for a given type specified in terms of the
chemical symbol <code class="docutils literal notranslate"><span class="pre">symbol</span></code>. The weights are summed over m and lmax[symbol] and
over all atoms of the same type.
If <code class="docutils literal notranslate"><span class="pre">spin</span></code> and <code class="docutils literal notranslate"><span class="pre">band</span></code> are not specified, the method returns the weights
for all spins and bands else the contribution for (spin, band).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_spilling">
<code class="sig-name descname"><span class="pre">get_spilling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_spilling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_spilling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the spilling parameter
If <code class="docutils literal notranslate"><span class="pre">spin</span></code> and <code class="docutils literal notranslate"><span class="pre">band</span></code> are not specified, the method returns the spilling for all states
as a [nsppol, mband, nkpt] numpy array else the spilling for (spin, band) with shape [nkpt].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs">
<code class="sig-name descname"><span class="pre">eb_plotax_kwargs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.eb_plotax_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.eb_plotax_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the options passed to <code class="docutils literal notranslate"><span class="pre">ebands.plot_ax</span></code>
when plotting a band line with spin index <code class="docutils literal notranslate"><span class="pre">spin</span></code>.
Subclasses can redefine the implementation to customize the plots.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview">
<code class="sig-name descname"><span class="pre">plot_fatbands_siteview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_siteview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_siteview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot fatbands for each atom in the unit cell. By default, only the <strong>inequivalent</strong> atoms are shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>view</strong> – “inequivalent”, “all”</p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview">
<code class="sig-name descname"><span class="pre">plot_fatbands_lview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_lview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_lview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by L.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>ax_mat</strong> – Matrix of axes, if None a new figure is produced.</p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview">
<code class="sig-name descname"><span class="pre">plot_fatbands_mview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_mview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_mview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by LM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iatom</strong> – Index of the atom in the structure.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview">
<code class="sig-name descname"><span class="pre">plot_fatbands_typeview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_typeview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_typeview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands grouped by atomic type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>ax_mat</strong> – Matrix of axis. None if a new figure should be created.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_spilling">
<code class="sig-name descname"><span class="pre">plot_spilling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_spilling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_spilling" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electronic fatbands</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>ax_list</strong> – List of matplotlib axes for plot. If None, new figure is produced</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_dos_integrator">
<code class="sig-name descname"><span class="pre">get_dos_integrator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_dos_integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_dos_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>FatBandsFile can use differerent integrators that are cached in self._cached_dos_integrators</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview">
<code class="sig-name descname"><span class="pre">plot_pjdos_lview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined_spins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spin_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_lview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_lview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the PJ-DOS on a linear mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>combined_spins</strong> – Define how up/down DOS components should be plotted when nsppol==2.
If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</p></li>
<li><p><strong>ax_mat</strong> – </p></li>
<li><p><strong>exchange_xy</strong> – True if the dos should be plotted on the x axis instead of y.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Same meaning as <code class="docutils literal notranslate"><span class="pre">xlims</span></code> but for the y-axis</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview">
<code class="sig-name descname"><span class="pre">plot_pjdos_typeview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined_spins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spin_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pjdos_typeview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pjdos_typeview" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the PJ-DOS on a linear mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>combined_spins</strong> – Define how up/down DOS components should be plotted when nsppol==2.
If True, up/down DOSes are plotted on the same figure (positive values for up,
negative values for down component)
If False, up/down components are plotted on different axes.</p></li>
<li><p><strong>ax_mat</strong> – </p></li>
<li><p><strong>exchange_xy</strong> – True if the dos should be plotted on the x axis instead of y.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – Same meaning as <code class="docutils literal notranslate"><span class="pre">xlims</span></code> but for the y-axis</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos">
<code class="sig-name descname"><span class="pre">plot_fatbands_with_pjdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pjdosfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_fatbands_with_pjdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_fatbands_with_pjdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fatbands and the PJDOS on the same figure, a.k.a the Sistine Chapel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy.
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – float used to scale the stripe size.</p></li>
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>blist</strong> – List of band indices for the fatband plot. If None, all bands are included</p></li>
<li><p><strong>pjdosfile</strong> – FATBANDS file used to compute the PJDOS. If None, the PJDOS is taken from self.</p></li>
<li><p><strong>edos_kwargs</strong> – </p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>width_ratios</strong> – Defines the ratio between the band structure plot and the dos plot.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms">
<code class="sig-name descname"><span class="pre">plot_pawdos_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.plot_pawdos_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.plot_pawdos_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmax</strong> – Maximum L included in plot. None means full set available on file.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.get_panel">
<code class="sig-name descname"><span class="pre">get_panel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.get_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.get_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build panel with widgets to interact with the <a class="reference internal" href="#abipy.electrons.fatbands.FatBandsFile" title="abipy.electrons.fatbands.FatBandsFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.fatbands.FatBandsFile</span></code></a> either in a notebook or in panel app.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fatbands.FatBandsFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fatbands.html#FatBandsFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fatbands.FatBandsFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.fold2bloch">
<span id="fold2bloch-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fold2bloch</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.fold2bloch" title="Permalink to this headline">¶</a></h2>
<p>Fold2Bloch netcdf file.</p>
<dl class="py class">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.fold2bloch.</span></code><code class="sig-name descname"><span class="pre">Fold2BlochNcfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Netcdf file with output data produced by Fold2Bloch.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Fold2BlochNcfile</span><span class="p">(</span><span class="s2">&quot;foo_FOLD2BLOCH.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="n">fb</span><span class="o">.</span><span class="n">plot_unfolded</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-f610184c909190891f8d67cd724ee0a2b91fe181.png" alt="Inheritance diagram of Fold2BlochNcfile" usemap="#inheritanceea0f982423" class="inheritance graphviz" /></div>
<map id="inheritanceea0f982423" name="inheritanceea0f982423">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="279,174,454,196"/>
<area shape="rect" id="node8" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile" target="_top" title="Netcdf file with output data produced by Fold2Bloch." alt="" coords="517,90,763,111"/>
<area shape="rect" id="node7" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="270,132,464,153"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="258,5,475,26"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf files containing the Abinit header." alt="" coords="277,47,456,68"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="273,90,460,111"/>
</map><dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.from_wfkpath">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_wfkpath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfkpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.from_wfkpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.from_wfkpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Run fold2bloch in workdir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wfkpath</strong> – </p></li>
<li><p><strong>folds</strong> – </p></li>
<li><p><strong>workdir</strong> – Working directory of the fake task used to compute the ibz. Use None for temporary dir.</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> of the task. If None, the manager is initialized from the config file.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processors to use.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with folded band energies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object defining the supercell.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_eigens">
<code class="sig-name descname"><span class="pre">uf_eigens</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.uf_eigens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_eigens" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsppol, nk_unfolded, nband] <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with unfolded eigenvalues in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_weights">
<code class="sig-name descname"><span class="pre">uf_weights</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.uf_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.uf_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>[nss, nk_unfolded, nband] array with spectral weights. nss = max(nspinor, nsppol).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.get_spectral_functions">
<code class="sig-name descname"><span class="pre">get_spectral_functions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.get_spectral_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.get_spectral_functions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mesh, sfw, int_sfw</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.plot_unfolded">
<code class="sig-name descname"><span class="pre">plot_unfolded</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kbounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">klabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'afmhot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.plot_unfolded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.plot_unfolded" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot unfolded band structure with spectral weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>klabels</strong> – dictionary whose keys are tuple with the reduced coordinates of the k-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
<li><p><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></p></li>
<li><p><strong>facecolor</strong> – </p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.fold2bloch.Fold2BlochNcfile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/fold2bloch.html#Fold2BlochNcfile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.fold2bloch.Fold2BlochNcfile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <cite>nbpath</cite> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gsr">
<span id="gsr-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsr</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.gsr" title="Permalink to this headline">¶</a></h2>
<p>Interface to the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/gsr.ipynb">GSR.nc</a> file storing the Ground-state results and the electron band structure.</p>
<dl class="py class">
<dt id="abipy.electrons.gsr.GsrFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.gsr.</span></code><code class="sig-name descname"><span class="pre">GsrFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>File containing the results of a ground-state calculation.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">GsrFile</span><span class="p">(</span><span class="s2">&quot;foo_GSR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gsr</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;energy: &quot;</span><span class="p">,</span> <span class="n">gsr</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="n">gsr</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-5bed66bb0db107e83c8b0d00ff383add04eec396.png" alt="Inheritance diagram of GsrFile" usemap="#inheritance7fe53e894a" class="inheritance graphviz" /></div>
<map id="inheritance7fe53e894a" name="inheritance7fe53e894a">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="315,197,513,221"/>
<area shape="rect" id="node8" href="#abipy.electrons.gsr.GsrFile" target="_top" title="File containing the results of a ground&#45;state calculation." alt="" coords="585,101,763,125"/>
<area shape="rect" id="node7" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="305,149,524,173"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="292,5,537,29"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf files containing the Abinit header." alt="" coords="313,53,515,77"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="308,101,520,125"/>
</map><dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.is_scf_run">
<code class="sig-name descname"><span class="pre">is_scf_run</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.is_scf_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.is_scf_run" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the GSR has been produced by a SCF run.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.ecut">
<code class="sig-name descname"><span class="pre">ecut</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.ecut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.ecut" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree (Abinit input variable)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.pawecutdg">
<code class="sig-name descname"><span class="pre">pawecutdg</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pawecutdg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pawecutdg" title="Permalink to this definition">¶</a></dt>
<dd><p>Cutoff energy in Hartree for the PAW double grid (Abinit input variable)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.energy">
<code class="sig-name descname"><span class="pre">energy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.energy_per_atom">
<code class="sig-name descname"><span class="pre">energy_per_atom</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_per_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy / number_of_atoms (eV units)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.cart_forces">
<code class="sig-name descname"><span class="pre">cart_forces</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian forces in eV / Ang</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.max_force">
<code class="sig-name descname"><span class="pre">max_force</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.max_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.max_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Max cart force in eV / Ang</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.force_stats">
<code class="sig-name descname"><span class="pre">force_stats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.force_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.force_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with information on the forces.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.cart_stress_tensor">
<code class="sig-name descname"><span class="pre">cart_stress_tensor</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.cart_stress_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.cart_stress_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Stress tensor in GPa.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.pressure">
<code class="sig-name descname"><span class="pre">pressure</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.pressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Pressure in GPa.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.residm">
<code class="sig-name descname"><span class="pre">residm</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.residm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.residm" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the residuals</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.xc">
<code class="sig-name descname"><span class="pre">xc</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.xc" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">XcFunc</span></code> object with info on the exchange-correlation functional.
Use libxc convention <a class="bibtex reference internal" href="../zzbiblio.html#marques2012" id="id7">[Marques2012]</a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.energy_terms">
<code class="sig-name descname"><span class="pre">energy_terms</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.energy_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.energy_terms" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyTerms</span></code> with the different contributions to the total energy in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.as_dict">
<code class="sig-name descname"><span class="pre">as_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.get_computed_entry">
<code class="sig-name descname"><span class="pre">get_computed_entry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inc_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.get_computed_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.get_computed_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pymatgen <code class="xref py py-class docutils literal notranslate"><span class="pre">ComputedStructureEntry</span></code> from the GSR file.
Same API as the one used in vasp_output.get_computed_entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inc_structure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Set to True if you want
ComputedStructureEntries to be returned instead of ComputedEntries.</p></li>
<li><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Input parameters to include. It has to be one of
the properties supported by the GSR object. If
parameters is None, a default set of parameters that are
necessary for typical post-processing will be set.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Output data to include. Has to be one of the properties
supported by the GSR object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ComputedStructureEntry/ComputedEntry</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.get_panel">
<code class="sig-name descname"><span class="pre">get_panel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.get_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.get_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build panel with widgets to interact with the <a class="reference internal" href="#abipy.electrons.gsr.GsrFile" title="abipy.electrons.gsr.GsrFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gsr.GsrFile</span></code></a> either in a notebook or in panel app.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.yield_plotly_figs">
<code class="sig-name descname"><span class="pre">yield_plotly_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.yield_plotly_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.yield_plotly_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of plotly figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gsr.GsrFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gsr.html#GsrFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gsr.GsrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.gw">
<span id="gw-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gw</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.gw" title="Permalink to this headline">¶</a></h2>
<p>Classes for the analysis of GW calculations.</p>
<dl class="py class">
<dt id="abipy.electrons.gw.QPState">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.gw.</span></code><code class="sig-name descname"><span class="pre">QPState</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpe_diago</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxcme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigxme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigcmee0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vUme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ze0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gw.QPState</span></code></a></p>
<p>Quasi-particle result for given (spin, kpoint, band).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Energies are in eV.</p>
</div>
<dl class="py method">
<dt id="abipy.electrons.gw.QPState.qpeme0">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qpeme0</span></code><a class="headerlink" href="#abipy.electrons.gw.QPState.qpeme0" title="Permalink to this definition">¶</a></dt>
<dd><p>E_QP - E_0</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.re_qpe">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">re_qpe</span></code><a class="headerlink" href="#abipy.electrons.gw.QPState.re_qpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Real part of the QP energy.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.imag_qpe">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">imag_qpe</span></code><a class="headerlink" href="#abipy.electrons.gw.QPState.imag_qpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Imaginay part of the QP energy.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.skb">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">skb</span></code><a class="headerlink" href="#abipy.electrons.gw.QPState.skb" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with (spin, kpoint, band)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Shallow copy.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.get_fields">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">get_fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.get_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.get_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.as_dict">
<code class="sig-name descname"><span class="pre">as_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert self into a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.to_strdict">
<code class="sig-name descname"><span class="pre">to_strdict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.to_strdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.to_strdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping fields –&gt; strings.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.tips">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tips</span></code><a class="headerlink" href="#abipy.electrons.gw.QPState.tips" title="Permalink to this definition">¶</a></dt>
<dd><p>Bound method of self that returns a dictionary with the description of the fields.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.TIPS">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">TIPS</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.TIPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.TIPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Class method that returns a dictionary with the description of the fields.
The string are extracted from the class doc string.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.QPState.get_fields_for_plot">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">get_fields_for_plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_fields</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#QPState.get_fields_for_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.QPState.get_fields_for_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of QPState fields to plot from input arguments.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.gw.SigresFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.gw.</span></code><code class="sig-name descname"><span class="pre">SigresFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Container storing the GW results reported in the SIGRES.nc file.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigres</span> <span class="o">=</span> <span class="n">SigresFile</span><span class="p">(</span><span class="s2">&quot;foo_SIGRES.nc&quot;</span><span class="p">)</span>
<span class="n">sigres</span><span class="o">.</span><span class="n">plot_qps_vs_e0</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-c2afdbfe9dc7132be39a8e6152f38ae902b9604e.png" alt="Inheritance diagram of SigresFile" usemap="#inheritanceeae53b786c" class="inheritance graphviz" /></div>
<map id="inheritanceeae53b786c" name="inheritanceeae53b786c">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="309,146,504,170"/>
<area shape="rect" id="node7" href="#abipy.electrons.gw.SigresFile" target="_top" title="Container storing the GW results reported in the SIGRES.nc file." alt="" coords="574,76,763,99"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="299,99,514,123"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="286,5,527,29"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="302,52,511,76"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.gw.SigresFile.marker_spin">
<code class="sig-name descname"><span class="pre">marker_spin</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'^',</span> <span class="pre">1:</span> <span class="pre">'v'}</span></em><a class="headerlink" href="#abipy.electrons.gw.SigresFile.marker_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.gw.SigresFile.color_spin">
<code class="sig-name descname"><span class="pre">color_spin</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{0:</span> <span class="pre">'k',</span> <span class="pre">1:</span> <span class="pre">'r'}</span></em><a class="headerlink" href="#abipy.electrons.gw.SigresFile.color_spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance from file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.sigma_kpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sigma_kpoints</span></code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.sigma_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>The K-points where QP corrections have been calculated.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_marker">
<code class="sig-name descname"><span class="pre">get_marker</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpattr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_marker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_marker" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-class docutils literal notranslate"><span class="pre">Marker</span></code> object associated to the QP attribute qpattr.
Used to prepare plots of KS bands with markers.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies e.g ecuteps</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the netcdf file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <code class="docutils literal notranslate"><span class="pre">verbose</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.ebands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> with the KS energies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.has_spectral_function">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_spectral_function</span></code><a class="headerlink" href="#abipy.electrons.gw.SigresFile.has_spectral_function" title="Permalink to this definition">¶</a></dt>
<dd><p>True if file contains spectral function data.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.qplist_spin">
<code class="sig-name descname"><span class="pre">qplist_spin</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qplist_spin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qplist_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">QPList</span></code> objects indexed by spin.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_qplist">
<code class="sig-name descname"><span class="pre">get_qplist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qplist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qplist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return :class`QPList` for the given (spin, kpoint)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_qpcorr">
<code class="sig-name descname"><span class="pre">get_qpcorr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpcorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QPState</span></code></a> object for the given (s, k, b)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.qpgaps">
<code class="sig-name descname"><span class="pre">qpgaps</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.qpgaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape [nsppol, nkibz] with the QP direct gaps in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_qpgap">
<code class="sig-name descname"><span class="pre">get_qpgap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_ksgap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_qpgap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_qpgap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the QP gap in eV at the given (spin, kpoint)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.read_sigee_skb">
<code class="sig-name descname"><span class="pre">read_sigee_skb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.read_sigee_skb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.read_sigee_skb" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Read self-energy(w) for (spin, kpoint, band)
Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">SelfEnergy</span></code> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.print_qps">
<code class="sig-name descname"><span class="pre">print_qps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">precision=3</span></em>, <em class="sig-param"><span class="pre">ignore_imag=True</span></em>, <em class="sig-param"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.print_qps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.print_qps" title="Permalink to this definition">¶</a></dt>
<dd><p>Print QP results to stream <code class="docutils literal notranslate"><span class="pre">file</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>precision</strong> – Number of significant digits.</p></li>
<li><p><strong>ignore_imag</strong> – True if imaginary part should be ignored.</p></li>
<li><p><strong>file</strong> – Output stream.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_points_from_ebands">
<code class="sig-name descname"><span class="pre">get_points_from_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebands_kpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_points_from_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_points_from_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate object storing the QP energies lying on the k-path used by ebands_kpath.
Mainly used to plot the QP energies in ebands.plot when the QP energies are interpolated with the SKW method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebands_kpath</strong> – <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with the QP energies along an arbitrary k-path.</p></li>
<li><p><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</p></li>
<li><p><strong>size</strong> – The marker size in points**2</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
</ul>
</dd>
</dl>
<p>Return:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sigres</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">lpratio</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                       <span class="n">ks_ebands_kpath</span><span class="o">=</span><span class="n">ks_ebands_kpath</span><span class="p">,</span>
                       <span class="n">ks_ebands_kmesh</span><span class="o">=</span><span class="n">ks_ebands_kmesh</span>
                       <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">sigres</span><span class="o">.</span><span class="n">get_points_from_ebands</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">qp_ebands_kpath</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">qp_ebands_kpath</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_qpgaps">
<code class="sig-name descname"><span class="pre">plot_qpgaps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_qpmks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qpgaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qpgaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS and the QP direct gaps for all the k-points and spins available on file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>plot_qpmks</strong> – If False, plot QP_gap, KS_gap else (QP_gap - KS_gap)</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
<li><p><strong>kwargs</strong> – Passed to ax.plot method except for marker.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_qps_vs_e0">
<code class="sig-name descname"><span class="pre">plot_qps_vs_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qps_vs_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qps_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot QP result in SIGRES file as function of the KS energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_fields</strong> – The names of the qp attributes to plot as function of eKS.
Accepts: List of strings or string with tokens separated by blanks.
See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QPState</span></code></a> for the list of available fields.</p></li>
<li><p><strong>exclude_fields</strong> – Similar to <code class="docutils literal notranslate"><span class="pre">with_fields</span></code> but excludes fields</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <cite>fermie</cite>: shift all eigenvalues to have zero energy at the Fermi energy (<cite>self.fermie</cite>).
-  Number e.g e0=0.5: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to e0=0</p></li>
<li><p><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> for plot. If None, new figure is produced.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>sharey</strong> – True if y-axis should be shared.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_spectral_functions">
<code class="sig-name descname"><span class="pre">plot_spectral_functions</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_spectral_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_spectral_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spectral function for all k-points, bands and spins available in the SIGRES file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_bands</strong> – List of bands to include. Nonee means all.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_eigvec_qp">
<code class="sig-name descname"><span class="pre">plot_eigvec_qp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_eigvec_qp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_eigvec_qp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index</p></li>
<li><p><strong>kpoint</strong> – K-point in self-energy. Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, vector or index.
If None, all k-points for the given <code class="docutils literal notranslate"><span class="pre">spin</span></code> are shown.</p></li>
<li><p><strong>band</strong> – band index. If None all bands are displayed else
only &lt;KS_b|QP_{b’}&gt; for the given b.</p></li>
<li><p><strong>kwargs</strong> – Passed to plot method of <code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayPlotter</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_qpbands_ibz">
<code class="sig-name descname"><span class="pre">plot_qpbands_ibz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_qpbands_ibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_qpbands_ibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS band structure in the IBZ with the QP energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot.</p></li>
<li><p><strong>colormap</strong> – matplotlib color map.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers">
<code class="sig-name descname"><span class="pre">plot_ksbands_with_qpmarkers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpattr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qpeme0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.plot_ksbands_with_qpmarkers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.plot_ksbands_with_qpmarkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the KS energies as function of k-points and add markers whose size
is proportional to the QPState attribute <code class="docutils literal notranslate"><span class="pre">qpattr</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpattr</strong> – Name of the QP attribute to plot. See <a class="reference internal" href="#abipy.electrons.gw.QPState" title="abipy.electrons.gw.QPState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QPState</span></code></a>.</p></li>
<li><p><strong>e0</strong> – Option used to define the zero of energy in the band structure plot. Possible values:
- <code class="docutils literal notranslate"><span class="pre">fermie</span></code>: shift all eigenvalues to have zero energy at the Fermi energy (<code class="docutils literal notranslate"><span class="pre">self.fermie</span></code>).
-  Number e.g <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0.5</span></code>: shift all eigenvalues to have zero energy at 0.5 eV
-  None: Don’t shift energies, equivalent to <code class="docutils literal notranslate"><span class="pre">e0</span> <span class="pre">=</span> <span class="pre">0</span></code></p></li>
<li><p><strong>fact</strong> – Markers are multiplied by this factor.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with QP results for all k-points included in the GW calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal notranslate"><span class="pre">ignore_imag</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.to_dataframe">
<code class="sig-name descname"><span class="pre">to_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.gw.SigresFile.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with QP results for all k-points included in the GW calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal notranslate"><span class="pre">ignore_imag</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.get_dataframe_sk">
<code class="sig-name descname"><span class="pre">get_dataframe_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.get_dataframe_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.get_dataframe_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with QP results for the given (spin, k-point).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ignore_imag</strong> – Only real part is returned if <code class="docutils literal notranslate"><span class="pre">ignore_imag</span></code>.</p></li>
<li><p><strong>with_params</strong> – True to include convergence paramenters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.interpolate">
<code class="sig-name descname"><span class="pre">interpolate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lpratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks_ebands_kpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks_ebands_kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks_degatol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_corrections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the GW corrections in k-space on a k-path and, optionally, on a k-mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lpratio</strong> – Ratio between the number of star functions and the number of ab-initio k-points.
The default should be OK in many systems, larger values may be required for accurate derivatives.</p></li>
<li><p><strong>ks_ebands_kpath</strong> – KS <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> on a k-path. If present,
the routine interpolates the QP corrections and apply them on top of the KS band structure
This is the recommended option because QP corrections are usually smoother than the
QP energies and therefore easier to interpolate. If None, the QP energies are interpolated
along the path defined by <code class="docutils literal notranslate"><span class="pre">vertices_names</span></code> and <code class="docutils literal notranslate"><span class="pre">line_density</span></code>.</p></li>
<li><p><strong>ks_ebands_kmesh</strong> – KS <a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> on a homogeneous k-mesh. If present, the routine
interpolates the corrections on the k-mesh (used to compute QP the DOS)</p></li>
<li><p><strong>ks_degatol</strong> – Energy tolerance in eV. Used when either <code class="docutils literal notranslate"><span class="pre">ks_ebands_kpath</span></code> or <code class="docutils literal notranslate"><span class="pre">ks_ebands_kmesh</span></code> are given.
KS energies are assumed to be degenerate if they differ by less than this value.
The interpolator may break band degeneracies (the error is usually smaller if QP corrections
are interpolated instead of QP energies). This problem can be partly solved by averaging
the interpolated values over the set of KS degenerate states.
A negative value disables this ad-hoc symmetrization.</p></li>
<li><p><strong>vertices_names</strong> – Used to specify the k-path for the interpolated QP band structure
when <code class="docutils literal notranslate"><span class="pre">ks_ebands_kpath</span></code> is None.
It’s a list of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path. <code class="docutils literal notranslate"><span class="pre">line_density</span></code> defines
the density of the sampling. If None, the k-path is automatically generated according
to the point group of the system.</p></li>
<li><p><strong>line_density</strong> – Number of points in the smallest segment of the k-path. Used with <code class="docutils literal notranslate"><span class="pre">vertices_names</span></code>.</p></li>
<li><p><strong>filter_params</strong> – TO BE DESCRIBED</p></li>
<li><p><strong>only_corrections</strong> – If True, the output contains the interpolated QP corrections instead of the QP energies.
Available only if ks_ebands_kpath and/or ks_ebands_kmesh are used.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><code class="xref py py-class docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* qp_ebands_kpath: |ElectronBands| with the QP energies interpolated along the k-path.
* qp_ebands_kmesh: |ElectronBands| with the QP energies interpolated on the k-mesh.
    None if ``ks_ebands_kmesh`` is not passed.
* ks_ebands_kpath: |ElectronBands| with the KS energies interpolated along the k-path.
* ks_ebands_kmesh: |ElectronBands| with the KS energies on the k-mesh..
    None if ``ks_ebands_kmesh`` is not passed.
* interpolator: |SkwInterpolator| object.
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.gw.SigresRobot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.gw.</span></code><code class="sig-name descname"><span class="pre">SigresRobot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.robots.Robot</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.RobotWithEbands</span></code></p>
<p>This robot analyzes the results contained in multiple SIGRES.nc files.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-8f9c75bc59c86b37cdab4793d6b4699e95b1180c.png" alt="Inheritance diagram of SigresRobot" usemap="#inheritance898dbfdc13" class="inheritance graphviz" /></div>
<map id="inheritance898dbfdc13" name="inheritance898dbfdc13">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="433,38,546,55"/>
<area shape="rect" id="node5" href="#abipy.electrons.gw.SigresRobot" target="_top" title="This robot analyzes the results contained in multiple SIGRES.nc files." alt="" coords="618,21,764,38"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="206,38,361,55"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.gw.SigresRobot.EXT">
<code class="sig-name descname"><span class="pre">EXT</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'SIGRES'</span></em><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.merge_dataframes_sk">
<code class="sig-name descname"><span class="pre">merge_dataframes_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.merge_dataframes_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.merge_dataframes_sk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.get_qpgaps_dataframe">
<code class="sig-name descname"><span class="pre">get_qpgaps_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abspath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.get_qpgaps_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.get_qpgaps_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the QP gaps for all files in the robot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – </p></li>
<li><p><strong>with_geo</strong> – True if structure info should be added to the dataframe</p></li>
<li><p><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</p></li>
<li><p><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.electrons.gw.SigresFile" title="abipy.electrons.gw.SigresFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gw.SigresFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.get_fit_gaps_vs_ecuteps">
<code class="sig-name descname"><span class="pre">get_fit_gaps_vs_ecuteps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_qpmks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.get_fit_gaps_vs_ecuteps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.get_fit_gaps_vs_ecuteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit QP direct gaps as a function of ecuteps using Eq. 16 of <a class="reference external" href="http://dx.doi.org/10.1063/1.4900447">http://dx.doi.org/10.1063/1.4900447</a>
to extrapolate results for ecuteps –&gt; +oo.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index (0 or 1)</p></li>
<li><p><strong>kpoint</strong> – K-point in self-energy. Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, vector or k-point index.</p></li>
<li><p><strong>plot_qpmks</strong> – If False, plot QP_gap else (QP_gap - KS_gap) i.e. gap correction</p></li>
<li><p><strong>slice_data</strong> – Python slice object. Used to downsample data points.
None to use all files of the SigResRobot.</p></li>
<li><p><strong>fontsize</strong> – legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: TODO</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abspath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the QP gaps for all files in the robot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – </p></li>
<li><p><strong>with_geo</strong> – True if structure info should be added to the dataframe</p></li>
<li><p><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</p></li>
<li><p><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.electrons.gw.SigresFile" title="abipy.electrons.gw.SigresFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gw.SigresFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpgaps_convergence">
<code class="sig-name descname"><span class="pre">plot_qpgaps_convergence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_qpmks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpgaps_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpgaps_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the direct QP gaps for all the k-points available in the robot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_qpmks</strong> – If False, plot QP_gap, KS_gap else (QP_gap - KS_gap)</p></li>
<li><p><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</p></li>
<li><p><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</p></li>
<li><p><strong>sharey</strong> – True if y-axis should be shared.</p></li>
<li><p><strong>fontsize</strong> – legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpdata_conv_skb">
<code class="sig-name descname"><span class="pre">plot_qpdata_conv_skb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpdata_conv_skb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpdata_conv_skb" title="Permalink to this definition">¶</a></dt>
<dd><p>For each file in the robot, plot the convergence of the QP results for given (spin, kpoint, band)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – K-point in self-energy. Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, vector or index.</p></li>
<li><p><strong>band</strong> – Band index.</p></li>
<li><p><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</p></li>
<li><p><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</p></li>
<li><p><strong>what_list</strong> – List of strings selecting the quantity to plot.</p></li>
<li><p><strong>fontsize</strong> – legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.plot_qpfield_vs_e0">
<code class="sig-name descname"><span class="pre">plot_qpfield_vs_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fermie'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_qpfield_vs_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_qpfield_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>For each file in the robot, plot one of the attributes of <code class="xref py py-class docutils literal notranslate"><span class="pre">QpState</span></code>
as a function of the KS energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String defining the attribute to plot.</p></li>
<li><p><strong>sharey</strong> – True if y-axis should be shared.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the meaning of the other arguments, see other robot methods.</p>
</div>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.plot_selfenergy_conv">
<code class="sig-name descname"><span class="pre">plot_selfenergy_conv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.plot_selfenergy_conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.plot_selfenergy_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the e-e self-energy wrt to the <code class="docutils literal notranslate"><span class="pre">sortby</span></code> parameter.
Values can be optionally grouped by <cite>hue</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpoint</strong> – K-point in self-energy (can be <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>, list/tuple or int)</p></li>
<li><p><strong>band</strong> – Band index.</p></li>
<li><p><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels.
Can be None, string or function. If None, no sorting is performed.
If string and not empty it’s assumed that the abifile has an attribute
with the same name and <cite>getattr</cite> is invoked.
If callable, the output of sortby(abifile) is used.</p></li>
<li><p><strong>hue</strong> – Variable that define subsets of the data, which will be drawn on separate lines.
Accepts callable or string
If string, it’s assumed that the abifile has an attribute with the same name and getattr is invoked.
If callable, the output of hue(abifile) is used.</p></li>
<li><p><strong>colormap</strong> – matplotlib color map.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.gw.SigresRobot.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/gw.html#SigresRobot.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.gw.SigresRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.lobster">
<span id="lobster-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lobster</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.lobster" title="Permalink to this headline">¶</a></h2>
<p>Tools to analyze the output files produced by Lobster.</p>
<dl class="py class">
<dt id="abipy.electrons.lobster.CoxpFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.lobster.</span></code><code class="sig-name descname"><span class="pre">CoxpFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Wrapper class for the crystal orbital projections produced by Lobster.
Wraps both a COOP and a COHP.
Can contain both the total and orbitalwise projections.</p>
<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.cop_type">
<code class="sig-name descname"><span class="pre">cop_type</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.cop_type" title="Permalink to this definition">¶</a></dt>
<dd><p>String. Either “coop” or “cohp”.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.type_of_index">
<code class="sig-name descname"><span class="pre">type_of_index</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.type_of_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mappping site index to element string.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.energies">
<code class="sig-name descname"><span class="pre">energies</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>List of energies. Shifted such that the Fermi level lies at 0 eV.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.total">
<code class="sig-name descname"><span class="pre">total</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.total" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the total overlap, not projected over orbitals.
The dictionary should have the following nested keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0, 1)), the spin (i.e. 0 or 1), a “single”
or “integrated” string indicating the value corresponding to the value of
the energy or to the integrated value up to that energy.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.partial">
<code class="sig-name descname"><span class="pre">partial</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.partial" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the partial crystal orbital projections.
The dictionary should have the following nested keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0, 1)), a tuple with the string representing the
projected orbitals for that pair (e.g. (“4s”, “4p_x”)), the spin (i.e. 0 or 1),
a “single” or “integrated” string indicating the value corresponding to the value of
the energy or to the integrated value up to that energy. Each dictionary should contain a
numpy array with a list of COP values with the same size as energies.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.averaged">
<code class="sig-name descname"><span class="pre">averaged</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.averaged" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the partial crystal orbital projections
averaged over all atom pairs specified. The main key should indicate the spin (0 or 1)
and the nested dictionary should have “single” and “integrated” as keys.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.CoxpFile.fermie">
<code class="sig-name descname"><span class="pre">fermie</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>value of the fermi energy in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.site_pairs_total">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">site_pairs_total</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.site_pairs_total" title="Permalink to this definition">¶</a></dt>
<dd><p>List of site pairs available for the total COP</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.site_pairs_partial">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">site_pairs_partial</span></code><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.site_pairs_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>List of site pairs available for the partial COP</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of CoxpFile from the files produce by Lobster.
Accepts gzipped files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to the COHPCAR.lobster or COOPCAR.lobster.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A CoxpFile.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair_lorbitals">
<code class="sig-name descname"><span class="pre">functions_pair_lorbitals</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair_lorbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair_lorbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, orbital, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object resolved
for l orbitals.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair_morbitals">
<code class="sig-name descname"><span class="pre">functions_pair_morbitals</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair_morbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair_morbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, orbital, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object resolved
for l and m orbitals.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.functions_pair">
<code class="sig-name descname"><span class="pre">functions_pair</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.functions_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.functions_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a dictionary with keys pair, spin and containing a <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object for the total COP.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP averaged values (DOS or IDOS depending on what).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what</strong> – string selecting what will be plotted. “d” for DOS, “i” for IDOS</p></li>
<li><p><strong>spin</strong> – Select spin index if not None.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_average_pairs">
<code class="sig-name descname"><span class="pre">plot_average_pairs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_site_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_average_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_average_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP total overlap for all sites containg <cite>with_site_index</cite> and average sum
(multiplied by the number of pairs)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_site_index</strong> – int of list of integers selecting the site index to be included.</p></li>
<li><p><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_site_pairs_total">
<code class="sig-name descname"><span class="pre">plot_site_pairs_total</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_site_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_site_pairs_total"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_site_pairs_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COXP total overlap (DOS or IDOS) for all sites listed in <cite>from_site_index</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_site_index</strong> – int of list of integers selecting the first site of the pairs to be included.</p></li>
<li><p><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair">
<code class="sig-name descname"><span class="pre">get_labelstyle_from_spin_pair</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.get_labelstyle_from_spin_pair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Return label and linestyle for spin and pair indices</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.plot_site_pairs_partial">
<code class="sig-name descname"><span class="pre">plot_site_pairs_partial</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_site_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.plot_site_pairs_partial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.plot_site_pairs_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot partial crystal orbital projections (DOS or IDOS) for all sites listed in <cite>from_site_index</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_site_index</strong> – int of list of integers selecting the first site of the pairs to be included.</p></li>
<li><p><strong>what</strong> – “single” for COXP DOS, “integrated” for IDOS.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair_orbs">
<code class="sig-name descname"><span class="pre">get_labelstyle_from_spin_pair_orbs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.get_labelstyle_from_spin_pair_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.get_labelstyle_from_spin_pair_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return label and linestyle for spin, pair indices and orbs tuple.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.CoxpFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#CoxpFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.CoxpFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.lobster.ICoxpFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.lobster.</span></code><code class="sig-name descname"><span class="pre">ICoxpFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Wrapper class for the integrated crystal orbital projections up to the Fermi energy
produced from Lobster.
May contain the output stored in ICOHPLIST.lobster and ICOOPLIST.lobster</p>
<dl class="py attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.cop_type">
<code class="sig-name descname"><span class="pre">cop_type</span></code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.cop_type" title="Permalink to this definition">¶</a></dt>
<dd><p>String. Either “coop” or “cohp”.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.values">
<code class="sig-name descname"><span class="pre">values</span></code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.values" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the following keys: a tuple with the index of the sites
considered as a pair (0-based, e.g. (0,1)), the spin (i.e. 0 or 1)</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.ICoxpFile.type_of_index">
<code class="sig-name descname"><span class="pre">type_of_index</span></code><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.type_of_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mappping site index to element string.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of ICoxpFile from the files produce by Lobster.
Accepts gzipped files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to the ICOHPLIST.lobster or ICOOPLIST.lobster.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ICoxpFile.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.dataframe">
<code class="sig-name descname"><span class="pre">dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Barplot with average values.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.ICoxpFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#ICoxpFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.ICoxpFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.lobster.LobsterDoscarFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.lobster.</span></code><code class="sig-name descname"><span class="pre">LobsterDoscarFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.lobster._LobsterFile</span></code></p>
<p>Total and partial dos extracted from lobster DOSCAR.
The fermi energy is always at the zero value.</p>
<dl class="py attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.energies">
<code class="sig-name descname"><span class="pre">energies</span></code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>List of energies. Shifted such that the Fermi level lies at 0 eV.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.total_dos">
<code class="sig-name descname"><span class="pre">total_dos</span></code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.total_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with spin as a key (i.e. 0 or 1) and containing the values of the total DOS.
Should have the same size as energies.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.pdos">
<code class="sig-name descname"><span class="pre">pdos</span></code><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.pdos" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with the values of the projected DOS.
The dictionary should have the following nested keys: the index of the site (0-based),
the string representing the projected orbital (e.g. “4p_x”), the spin (i.e. 0 or 1).
Each dictionary should contain a numpy array with a list of DOS values with the
same size as energies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance from the DOSCAR.lobster file.
Accepts gzipped files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to the DOSCAR.lobster.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A LobsterDoscarFile.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with Verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – </p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.plot_pdos_site">
<code class="sig-name descname"><span class="pre">plot_pdos_site</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.plot_pdos_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.plot_pdos_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot projected DOS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site_index</strong> – </p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterDoscarFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterDoscarFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterDoscarFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.lobster.LobsterInput">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.lobster.</span></code><code class="sig-name descname"><span class="pre">LobsterInput</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitalwise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">en_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_smearing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">advanced_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores the basic variables for a Lobster input and generates the lobsterin file.</p>
<dl class="py attribute">
<dt id="abipy.electrons.lobster.LobsterInput.accepted_basis_sets">
<code class="sig-name descname"><span class="pre">accepted_basis_sets</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'bunge',</span> <span class="pre">'koga',</span> <span class="pre">'pbevaspfit2015'}</span></em><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.accepted_basis_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.lobster.LobsterInput.available_advanced_options">
<code class="sig-name descname"><span class="pre">available_advanced_options</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'basisRotation',</span> <span class="pre">'doNotIgnoreExcessiveBands',</span> <span class="pre">'doNotOrthogonalizeBasis',</span> <span class="pre">'doNotUseAbsoluteSpilling',</span> <span class="pre">'forceEnergyRange',</span> <span class="pre">'forceV1HMatrix',</span> <span class="pre">'noMemoryMappedFiles',</span> <span class="pre">'noSymmetryCorrection',</span> <span class="pre">'onlyReadVasprun.xml',</span> <span class="pre">'skipPAWOrthonormalityTest',</span> <span class="pre">'skipReOrthonormalization',</span> <span class="pre">'symmetryDetectionPrecision',</span> <span class="pre">'useDecimalPlaces',</span> <span class="pre">'useOriginalTetrahedronMethod',</span> <span class="pre">'writeBasisFunctions'}</span></em><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.available_advanced_options" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterInput.set_basis_functions_from_abinit_pseudos">
<code class="sig-name descname"><span class="pre">set_basis_functions_from_abinit_pseudos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.set_basis_functions_from_abinit_pseudos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.set_basis_functions_from_abinit_pseudos" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the basis function used from the PAW abinit pseudopotentials</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pseudos</strong> – a list of Pseudos objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterInput.set_basis_functions_from_potcar">
<code class="sig-name descname"><span class="pre">set_basis_functions_from_potcar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potcar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.set_basis_functions_from_potcar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.set_basis_functions_from_potcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the basis function used from a POTCAR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>potcar</strong> – a pymatgen.io.vasp.inputs.Potcar object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterInput.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterInput.from_dir">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.from_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of the class based on the output folder of a DFT calculation.
Reads the information from the pseudopotentials in order to determine the
basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirpath</strong> – the path to the calculation directory. For abinit it should contain the
“files” file and GSR file, for vasp it should contain the vasprun.xml and the POTCAR.</p></li>
<li><p><strong>dE</strong> – The spacing of the energy sampling in eV.</p></li>
<li><p><strong>kwargs</strong> – the inputs for the init method, except for basis_functions, start_en,
end_en and en_steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A LobsterInput.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterInput.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterInput.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterInput.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the input file ‘lobsterin’ in dirpath.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.lobster.LobsterAnalyzer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.lobster.</span></code><code class="sig-name descname"><span class="pre">LobsterAnalyzer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coop_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohp_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icohp_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lobdos_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.from_dir">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.from_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an instance of the class based on the output folder of a DFT calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dirpath</strong> – the path to the calculation directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('coop',</span> <span class="pre">'cohp',</span> <span class="pre">'doscar')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COOP + COHP + DOSCAR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entries</strong> – “cohp” to plot COHP, “coop” for COOP</p></li>
<li><p><strong>spin</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.plot_coxp_with_dos">
<code class="sig-name descname"><span class="pre">plot_coxp_with_dos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_site_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cohp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.plot_coxp_with_dos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.plot_coxp_with_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot COHP (COOP) for all sites in from_site_index and Lobster DOS on len(from_site_index) + 1 subfigures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_site_index</strong> – List of site indices for COHP (COOP)</p></li>
<li><p><strong>what</strong> – “cohp” to plot COHP, “coop” for COOP</p></li>
<li><p><strong>with_orbitals</strong> – True if orbital projections are wanted.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis. By default, use x-axis for DOS-like quantities.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.lobster.LobsterAnalyzer.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/lobster.html#LobsterAnalyzer.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.lobster.LobsterAnalyzer.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.optic">
<span id="optic-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optic</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.optic" title="Permalink to this headline">¶</a></h2>
<p>Objects to read and analyze optical properties stored in the optic.nc file produced by optic executable.</p>
<dl class="py function">
<dt id="abipy.electrons.optic.reflectivity">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">reflectivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.reflectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Reflectivity(w) from vacuum, at normal incidence</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.electrons.optic.kappa">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">kappa</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#kappa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Im(refractive index(w)) aka kappa</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.electrons.optic.n">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">n</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Re(refractive index(w)) aka n</p>
</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.optic.OpticNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">OpticNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_ElectronBands" title="abipy.core.mixins.Has_ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_ElectronBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This file contains the results produced by optic. Provides methods to plot optical
properties and susceptibilty tensors. Used by <a class="reference internal" href="#abipy.electrons.optic.OpticRobot" title="abipy.electrons.optic.OpticRobot"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticRobot</span></code></a> to analyze multiple files.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">OpticNcFile</span><span class="p">(</span><span class="s2">&quot;out_optic.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">optic</span><span class="p">:</span>
    <span class="n">optic</span><span class="o">.</span><span class="n">ebands</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">optic</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-bef4cb4ebd494d36f0846eeadd8df0955d6aa057.png" alt="Inheritance diagram of OpticNcFile" usemap="#inheritanced1888ea308" class="inheritance graphviz" /></div>
<map id="inheritanced1888ea308" name="inheritanced1888ea308">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="301,188,490,211"/>
<area shape="rect" id="node8" href="#abipy.electrons.optic.OpticNcFile" target="_top" title="This file contains the results produced by optic. Provides methods to plot optical" alt="" coords="558,97,763,120"/>
<area shape="rect" id="node7" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="291,142,500,165"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_ElectronBands" target="_top" title="Mixin class for |AbinitNcFile| containing electron data." alt="" coords="279,5,512,28"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf files containing the Abinit header." alt="" coords="299,51,492,74"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="294,97,497,120"/>
</map><dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a netcdf file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.wmesh">
<code class="sig-name descname"><span class="pre">wmesh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.wmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency mesh in eV. Note that the same frequency-mesh is used
for the different optical properties.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.ebands">
<code class="sig-name descname"><span class="pre">ebands</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.has_linopt">
<code class="sig-name descname"><span class="pre">has_linopt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_linopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_linopt" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains Second Harmonic Generation tensor.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.has_shg">
<code class="sig-name descname"><span class="pre">has_shg</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_shg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_shg" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains Second Harmonic Generation tensor.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.has_leo">
<code class="sig-name descname"><span class="pre">has_leo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.has_leo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.has_leo" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the ncfile contains the Linear Electro-optic tensor</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.get_linopt_latex_label">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_linopt_latex_label</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.get_linopt_latex_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.get_linopt_latex_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return latex label for linear-optic quantities. Used in plots.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.get_chi2_latex_label">
<code class="sig-name descname"><span class="pre">get_chi2_latex_label</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.get_chi2_latex_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.get_chi2_latex_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Build latex label for chi2-related quantities. Used in plots.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_linear_epsilon">
<code class="sig-name descname"><span class="pre">plot_linear_epsilon</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'im'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_linear_epsilon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_linear_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot components of the linear dielectric function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>what</strong> – quantity to plot. “re” for real part, “im” for imaginary. Accepts also “abs”, “angle”.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>with_xlabel</strong> – True if x-label should be added.</p></li>
<li><p><strong>label</strong> – True to add legend label to each curve.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_linopt">
<code class="sig-name descname"><span class="pre">plot_linopt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_linopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_linopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Subplots with all linear optic quantities selected by <code class="docutils literal notranslate"><span class="pre">select</span></code> at temperature <code class="docutils literal notranslate"><span class="pre">itemp</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>select</strong> – </p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_chi2">
<code class="sig-name descname"><span class="pre">plot_chi2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-level function to plot chi2 tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – </p></li>
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>what</strong> – quantity to plot. “re” for real part, “im” for imaginary, Accepts also “abs”, “angle”.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
<li><p><strong>decompose</strong> – True to plot individual contributions.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>with_xlabel</strong> – True to add x-label.</p></li>
<li><p><strong>label</strong> – True to add legend label to each curve.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_shg">
<code class="sig-name descname"><span class="pre">plot_shg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_shg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_shg" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Second Harmonic Generation. See plot_chi2 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.plot_leo">
<code class="sig-name descname"><span class="pre">plot_leo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.plot_leo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.plot_leo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Linear Electro-optic. See plot_chi2 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticNcFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticNcFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.optic.OpticReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">OpticReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronsReader</span></code></p>
<p>This object reads the results stored in the optic.nc file
It provides helper function to access the most important quantities.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-32b6b85529b308354c41c1c7ff651d4c8270979e.png" alt="Inheritance diagram of OpticReader" usemap="#inheritance8a04e82e04" class="inheritance graphviz" /></div>
<map id="inheritance8a04e82e04" name="inheritance8a04e82e04">
<area shape="rect" id="node4" href="#abipy.electrons.optic.OpticReader" target="_top" title="This object reads the results stored in the optic.nc file" alt="" coords="648,16,765,28"/>
<area shape="rect" id="node3" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="344,28,441,41"/>
</map><dl class="py method">
<dt id="abipy.electrons.optic.OpticReader.read_lineps">
<code class="sig-name descname"><span class="pre">read_lineps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader.read_lineps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader.read_lineps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticReader.read_tensor3_terms">
<code class="sig-name descname"><span class="pre">read_tensor3_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticReader.read_tensor3_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticReader.read_tensor3_terms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – Name of the netcdf variable to read.</p></li>
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> mapping cartesian components e.g. “xyz” to data dictionary.
Individual entries are listed in ALL_CHIS[key][“terms”]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.optic.OpticRobot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.optic.</span></code><code class="sig-name descname"><span class="pre">OpticRobot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.robots.Robot</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.RobotWithEbands</span></code></p>
<p>This robot analyzes the results contained in multiple optic.nc files.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-aefabd1ab22473ebdd2e1c3adf8b6318ae14429f.png" alt="Inheritance diagram of OpticRobot" usemap="#inheritancee9986e91d2" class="inheritance graphviz" /></div>
<map id="inheritancee9986e91d2" name="inheritancee9986e91d2">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="431,37,544,54"/>
<area shape="rect" id="node5" href="#abipy.electrons.optic.OpticRobot" target="_top" title="This robot analyzes the results contained in multiple optic.nc files." alt="" coords="615,21,764,37"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="205,37,359,54"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.optic.OpticRobot.EXT">
<code class="sig-name descname"><span class="pre">EXT</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'OPTIC'</span></em><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.computed_components_intersection">
<code class="sig-name descname"><span class="pre">computed_components_intersection</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.computed_components_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.computed_components_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the list of cartesian tensor components
available in each file. Use keys from ALL_CHIS.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.plot_linopt_convergence">
<code class="sig-name descname"><span class="pre">plot_linopt_convergence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('re',</span> <span class="pre">'im')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nkpt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_linopt_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_linopt_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the convergence of the dielectric function tensor with respect to
parameter defined by <code class="docutils literal notranslate"><span class="pre">sortby</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>what_list</strong> – List of quantities to plot. “re” for real part, “im” for imaginary.
Accepts also “abs”, “angle”.</p></li>
<li><p><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels. Can be None, string or function.
If None, no sorting is performed.
If string, it’s assumed that the ncfile has an attribute with the same name and getattr is invoked.
If callable, the output of callable(ncfile) is used.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.plot_shg_convergence">
<code class="sig-name descname"><span class="pre">plot_shg_convergence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_shg_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_shg_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Second Harmonic Generation. See plot_convergence_rank3 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.plot_leo_convergence">
<code class="sig-name descname"><span class="pre">plot_leo_convergence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_leo_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_leo_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Linear electron-optic. See plot_convergence_rank3 for args supported.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.plot_convergence_rank3">
<code class="sig-name descname"><span class="pre">plot_convergence_rank3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('abs')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nkpt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.plot_convergence_rank3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.plot_convergence_rank3" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot convergence of arbitrary rank3 tensor. This is a low-level routine used in other plot methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – Name of the quantity to analyze.</p></li>
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xxx”, “xyz”].
“all” if all components available on file should be plotted on the same ax.</p></li>
<li><p><strong>itemp</strong> – Temperature index.</p></li>
<li><p><strong>what_list</strong> – List of quantities to plot. “re” for real part, “im” for imaginary.
Accepts also “abs”, “angle”.</p></li>
<li><p><strong>sortby</strong> – Define the convergence parameter, sort files and produce plot labels. Can be None, string or function.
If None, no sorting is performed.
If string, it’s assumed that the ncfile has an attribute with the same name and <code class="docutils literal notranslate"><span class="pre">getattr</span></code> is invoked.
If callable, the output of callable(ncfile) is used.</p></li>
<li><p><strong>decompose</strong> – True to plot individual contributions.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.optic.OpticRobot.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/optic.html#OpticRobot.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.optic.OpticRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.psps">
<span id="psps-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">psps</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.psps" title="Permalink to this headline">¶</a></h2>
<p>PSPS file with tabulated data.</p>
<dl class="py function">
<dt id="abipy.electrons.psps.mklabel">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">mklabel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fsym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">der</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#mklabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.mklabel" title="Permalink to this definition">¶</a></dt>
<dd><p>mklabel(f, 2, x) –&gt; $f’’(x)$</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.electrons.psps.rescale">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">rescale</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#rescale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.rescale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="abipy.electrons.psps.dataframe_from_pseudos">
<code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">dataframe_from_pseudos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#dataframe_from_pseudos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.dataframe_from_pseudos" title="Permalink to this definition">¶</a></dt>
<dd><p>Build pandas dataframe with the most important info associated to
a list of pseudos or a list of objects that can be converted into pseudos.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pseudos</strong> – List of objects that can be converted to pseudos.</p></li>
<li><p><strong>index</strong> – Index of the dataframe.</p></li>
</ul>
</dd>
</dl>
<p>Return: pandas Dataframe.</p>
</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.psps.PspsFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">PspsFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a></p>
<p>Netcdf file with the tables used in Abinit to apply the
pseudopotential part of the KS Hamiltonian.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">PspsFile</span><span class="p">(</span><span class="s2">&quot;foo_PSPS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">psps</span><span class="p">:</span>
    <span class="n">psps</span><span class="o">.</span><span class="n">plot_tcore_rspace</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="abipy.electrons.psps.PspsFile.linestyles_der">
<code class="sig-name descname"><span class="pre">linestyles_der</span></code><em class="property"> <span class="pre">=</span> <span class="pre">['-',</span> <span class="pre">'--',</span> <span class="pre">'-.',</span> <span class="pre">':',</span> <span class="pre">':',</span> <span class="pre">':']</span></em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.linestyles_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.psps.PspsFile.color_der">
<code class="sig-name descname"><span class="pre">color_der</span></code><em class="property"> <span class="pre">=</span> <span class="pre">['black',</span> <span class="pre">'red',</span> <span class="pre">'green',</span> <span class="pre">'orange',</span> <span class="pre">'cyan']</span></em><a class="headerlink" href="#abipy.electrons.psps.PspsFile.color_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Driver routine to plot several quantities on the same graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ecut_ffnl</strong> – Max cutoff energy for ffnl plot (optional)</p>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_rspace">
<code class="sig-name descname"><span class="pre">plot_tcore_rspace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_rspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_rspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model core and its derivatives in real space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</p></li>
<li><p><strong>rmax</strong> – Max radius for plot in Bohr. None is full grid is wanted.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.plot_tcore_qspace">
<code class="sig-name descname"><span class="pre">plot_tcore_qspace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_qn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_tcore_qspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_tcore_qspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model core in q space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</p></li>
<li><p><strong>with_qn</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.plot_vlocq">
<code class="sig-name descname"><span class="pre">plot_vlocq</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_qn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_vlocq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_vlocq" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the local part of the pseudopotential in q space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</p></li>
<li><p><strong>with_qn</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.plot_ffspl">
<code class="sig-name descname"><span class="pre">plot_ffspl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecut_ffnl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_qn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.plot_ffspl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.plot_ffspl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the nonlocal part of the pseudopotential in q-space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>ecut_ffnl</strong> – Max cutoff energy for ffnl plot (optional)</p></li>
<li><p><strong>ders</strong> – Tuple used to select the derivatives to be plotted.</p></li>
<li><p><strong>with_qn</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsFile.compare">
<code class="sig-name descname"><span class="pre">compare</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">others</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsFile.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsFile.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce matplotlib plot comparing self with another list of pseudos <code class="docutils literal notranslate"><span class="pre">others</span></code>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.psps.PspsReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">PspsReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the PSPS file produced by ABINIT.
It provides helper function to access the most important quantities.</p>
<dl class="py method">
<dt id="abipy.electrons.psps.PspsReader.read_coresd">
<code class="sig-name descname"><span class="pre">read_coresd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_coresd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_coresd" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the core charges and derivatives for the different types of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rmax</strong> – Maximum radius in Bohr. If None, data on the full grid is returned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>List of ntypat arrays. Each array contains the linear meshes in real space.
coresd: List with nytpat arrays of shape [6, npts].</p>
<p>(np.zeros. np.zeros) if core charge is not present</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>meshes</p>
</dd>
</dl>
<p>xccc1d[ntypat6,n1xccc*(1-usepaw)]</p>
<p>Norm-conserving psps only
The component xccc1d(n1xccc,1,ntypat) is the pseudo-core charge
for each type of atom, on the radial grid. The components
xccc1d(n1xccc,ideriv,ntypat) give the ideriv-th derivative of the
pseudo-core charge with respect to the radial distance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsReader.read_tcorespl">
<code class="sig-name descname"><span class="pre">read_tcorespl</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_tcorespl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_tcorespl" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Linear q-mesh in G-space
tcorespl:</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>qmesh</p>
</dd>
</dl>
<p>tcorespl[ntypat, 2, mqgrid_vl]
Gives the pseudo core density in reciprocal space on a regular grid.
Only if has_tcore</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsReader.read_vlspl">
<code class="sig-name descname"><span class="pre">read_vlspl</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_vlspl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_vlspl" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Linear q-mesh in G-space
vlspl:</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>qmesh</p>
</dd>
</dl>
<p>vlspl[2, ntypat, mqgrid_vl]
Gives, on the radial grid, the local part of each type of psp.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsReader.read_projectors">
<code class="sig-name descname"><span class="pre">read_projectors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.read_projectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.read_projectors" title="Permalink to this definition">¶</a></dt>
<dd><p>ffspl(ntypat, lnmax, 2, mqgrid_ff]
Gives, on the radial grid, the different non-local projectors,
in both the norm-conserving case, and the PAW case</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.PspsReader.get_lnlist_for_type">
<code class="sig-name descname"><span class="pre">get_lnlist_for_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itypat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#PspsReader.get_lnlist_for_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.PspsReader.get_lnlist_for_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of (l, n) indices for this atom type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.psps.VnlProjector">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.psps.</span></code><code class="sig-name descname"><span class="pre">VnlProjector</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itypat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ekb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/psps.html#VnlProjector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.psps.VnlProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Data and parameters associated to a non-local projector.</p>
<dl class="py method">
<dt id="abipy.electrons.psps.VnlProjector.values">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">values</span></code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the projector in q-space.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.VnlProjector.der2">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">der2</span></code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.der2" title="Permalink to this definition">¶</a></dt>
<dd><p>Second order derivative.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.VnlProjector.ecuts">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ecuts</span></code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.ecuts" title="Permalink to this definition">¶</a></dt>
<dd><p>List of cutoff energies corresponding to self.qmesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.psps.VnlProjector.sign_sqrtekb">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sign_sqrtekb</span></code><a class="headerlink" href="#abipy.electrons.psps.VnlProjector.sign_sqrtekb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scissors">
<span id="scissors-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scissors</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.scissors" title="Permalink to this headline">¶</a></h2>
<p>Scissors operator.</p>
<dl class="py class">
<dt id="abipy.electrons.scissors.Scissors">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scissors.</span></code><code class="sig-name descname"><span class="pre">Scissors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object represents an energy-dependent scissors operator.
The operator is defined by a list of domains (energy intervals)
and a list of functions defined in these domains.
The domains should fulfill the constraints documented in the main constructor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>eV units are assumed.</p>
</div>
<p>The standard way to create this object is via the methods provided by the factory class <code class="xref py py-class docutils literal notranslate"><span class="pre">ScissorBuilder</span></code>.
Once the instance has been created, one can correct the band structure by calling the <cite>apply</cite> method.</p>
<dl class="py attribute">
<dt id="abipy.electrons.scissors.Scissors.Error">
<code class="sig-name descname"><span class="pre">Error</span></code><a class="headerlink" href="#abipy.electrons.scissors.Scissors.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.scissors.ScissorsError</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.Scissors.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#Scissors.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.Scissors.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the eigenvalue eig (eV units).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.scissors.ScissorsBuilder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scissors.</span></code><code class="sig-name descname"><span class="pre">ScissorsBuilder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qps_spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigres_ebands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object facilitates the creation of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scissors</span></code></a> instances.</p>
<p>Usage:</p>
<blockquote>
<div><p>builder = ScissorsBuilder.from_file(“out_SIGRES.nc”)</p>
<p># To plot the QP results as function of the KS energy:
builder.plot_qpe_vs_e0()</p>
<p># To select the domains esplicitly (optional but highly recommended)
builder.build(domains_spin=[[-10, 6.02], [6.1, 20]])</p>
<p># To compare the fitted results with the ab-initio data:
builder.plot_fit()</p>
<p># To plot the corrected bands:
builder.plot_qpbands(abidata.ref_file(“si_nscf_WFK.nc”))</p>
</div></blockquote>
<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate object from (SIGRES.nc) file. Main entry point for client code.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_load">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">pickle_load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from a pickle file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.pickle_dump">
<code class="sig-name descname"><span class="pre">pickle_dump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.pickle_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object in Pickle format</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.nsppol">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nsppol</span></code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.nsppol" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spins.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0min">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">e0min</span></code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0min" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.e0max">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">e0max</span></code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.e0max" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum KS energy in eV (takes into account spin)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.scissors_spin">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">scissors_spin</span></code><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.scissors_spin" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of <a class="reference internal" href="#abipy.electrons.scissors.Scissors" title="abipy.electrons.scissors.Scissors"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scissors</span></code></a> indexed by the spin value.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.build">
<code class="sig-name descname"><span class="pre">build</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domains_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the scissors operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domains_spin</strong> – list of domains in eV for each spin. If domains is None,
domains are computed automatically from the sigres bands
(two domains separated by the middle of the gap).</p></li>
<li><p><strong>bounds_spin</strong> – Options specifying the boundary conditions (not used at present)</p></li>
<li><p><strong>k</strong> – Parameter defining the order of the fit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0">
<code class="sig-name descname"><span class="pre">plot_qpe_vs_e0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpe_vs_e0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpe_vs_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the quasiparticle corrections as function of the KS energy.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_fit">
<code class="sig-name descname"><span class="pre">plot_fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare fit functions with input quasi-particle corrections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scissors.ScissorsBuilder.plot_qpbands">
<code class="sig-name descname"><span class="pre">plot_qpbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scissors.html#ScissorsBuilder.plot_qpbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scissors.ScissorsBuilder.plot_qpbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the energies found in the netcdf file bands_filepath and plot the band energies (both the initial
and the corrected ones) with matplotlib. The plot contains the KS and the QP DOS if dos_filepath is not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands_filepath</strong> – Path to the netcdf file containing the initial KS energies to be corrected.</p></li>
<li><p><strong>String used to label the KS bands in the plot.</strong> (<em>bands_label</em>) – </p></li>
<li><p><strong>dos_filepath</strong> – Optional path to a netcdf file with the initial KS energies on a homogeneous k-mesh
(used to compute the KS and the QP dos)</p></li>
<li><p><strong>dos_args</strong> – Dictionary with the arguments passed to get_dos to compute the DOS
Used if dos_filepath is not None.</p></li>
<li><p><strong>kwargs</strong> – Options passed to the plotter.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.electrons.scr">
<span id="scr-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scr</span></code> Module</a><a class="headerlink" href="#module-abipy.electrons.scr" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze the screening files produced by the GW code (optdriver 3).</p>
<dl class="py class">
<dt id="abipy.electrons.scr.ScrFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scr.</span></code><code class="sig-name descname"><span class="pre">ScrFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Header" title="abipy.core.mixins.Has_Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Header</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <code class="docutils literal notranslate"><span class="pre">SCR.nc</span></code> file produced by the GW code.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ScrFile</span><span class="p">(</span><span class="s2">&quot;foo_SCR.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
    <span class="n">ncfile</span><span class="o">.</span><span class="n">plot_emacro</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-d7b3aa9f095ac199514dd5bb470987a209887a4a.png" alt="Inheritance diagram of ScrFile" usemap="#inheritance7cf8f6d793" class="inheritance graphviz" /></div>
<map id="inheritance7cf8f6d793" name="inheritance7cf8f6d793">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="303,149,501,173"/>
<area shape="rect" id="node7" href="#abipy.electrons.scr.ScrFile" target="_top" title="This object provides an interface to the ``SCR.nc`` file produced by the GW code." alt="" coords="560,77,736,101"/>
<area shape="rect" id="node6" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="292,101,512,125"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Header" target="_top" title="Mixin class for netcdf files containing the Abinit header." alt="" coords="301,5,503,29"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="296,53,508,77"/>
</map><dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.kpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kpoints</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of k-points in the dielectric function.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.ebands">
<code class="sig-name descname"><span class="pre">ebands</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object with the single-particle energies used to compute the screening.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.ng">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ng</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.ng" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of G-vectors in screening matrices.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.wpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">wpoints</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.wpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of complex numbers with the frequencies of the dielectric function in Hartree.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.nw">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nw</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nw" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of frequencies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.nrew">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nrew</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nrew" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of real frequencies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.nimw">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nimw</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.nimw" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of imaginary frequencies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.netcdf_name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">netcdf_name</span></code><a class="headerlink" href="#abipy.electrons.scr.ScrFile.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> name associated to the data on disk.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.collections.AttrDict</span></code></a> with the most important parameters used to compute the screening
keys can be accessed with the dot notation i.e. <code class="docutils literal notranslate"><span class="pre">params.zcut</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.plot_emacro">
<code class="sig-name descname"><span class="pre">plot_emacro</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cplx_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'re-im'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.plot_emacro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.plot_emacro" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the macroscopic dielectric function with local-field effects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cplx_mode</strong> – string defining the data to print.
Possible choices are (case-insensitive):
“re” for the real part. “im” for the imaginary part.
“abs” for the absolute value.
“angle” will display the phase of the complex number in radians.
Options can be concatenated with <code class="docutils literal notranslate"><span class="pre">-</span></code> e.g. <code class="docutils literal notranslate"><span class="pre">re-im</span></code>.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. (left, right)
or scalar e.g. left. If left (right) is None, default values are used.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.plot_eelf">
<code class="sig-name descname"><span class="pre">plot_eelf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.plot_eelf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.plot_eelf" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot electron energy loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize:</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.scr.ScrReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scr.</span></code><code class="sig-name descname"><span class="pre">ScrReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the SCR (Screening) file produced by ABINIT.
It provides helper functions to access the most important quantities.</p>
<p>double inverse_dielectric_function(number_of_qpoints_dielectric_function,
number_of_frequencies_dielectric_function, number_of_spins, number_of_spins,
number_of_coefficients_dielectric_function, number_of_coefficients_dielectric_function, complex)</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-59063cbdc61cba2393b05135f72364688fc795e9.png" alt="Inheritance diagram of ScrReader" usemap="#inheritance7426748bd3" class="inheritance graphviz" /></div>
<map id="inheritance7426748bd3" name="inheritance7426748bd3">
<area shape="rect" id="node1" href="#abipy.electrons.scr.ScrReader" target="_top" title="This object reads the results stored in the SCR (Screening) file produced by ABINIT." alt="" coords="619,4,764,21"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="450,4,584,21"/>
</map><dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_params">
<code class="sig-name descname"><span class="pre">read_params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the most important parameters used to compute the screening i.e.
the parameters that may be subject to convergence studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.collections.AttrDict</span></code></a> a dictionary whose keys can be accessed with the dot notation i.e. <code class="docutils literal notranslate"><span class="pre">d.key</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_emacro_lf">
<code class="sig-name descname"><span class="pre">read_emacro_lf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_emacro_lf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_emacro_lf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the macroscopic dielectric function <em>with</em> local field effects 1 / em1_{0,0)(kpoint, omega).</p>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_emacro_nlf">
<code class="sig-name descname"><span class="pre">read_emacro_nlf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_emacro_nlf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_emacro_nlf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the macroscopic dielectric function <em>without</em> local field effects e_{0,0)(kpoint, omega).</p>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function performs the inversion of e-1 to get e.
that can be quite expensive and memory demanding for large matrices!</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_eelf">
<code class="sig-name descname"><span class="pre">read_eelf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_eelf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_eelf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read electron energy loss function</p>
<blockquote>
<div><ul class="simple">
<li><p>Im(1/ emacro)</p></li>
</ul>
</div></blockquote>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_wggmat">
<code class="sig-name descname"><span class="pre">read_wggmat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_wggmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_wggmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data at the given k-point and return an instance of <code class="docutils literal notranslate"><span class="pre">cls</span></code> where
<code class="docutils literal notranslate"><span class="pre">cls</span></code> is a subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">_AwggMatrix</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.find_kpoint_fileindex">
<code class="sig-name descname"><span class="pre">find_kpoint_fileindex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.find_kpoint_fileindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.find_kpoint_fileindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the k-point and the index of the k-point in the netcdf file.
Accepts <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.electrons.scr.ScrReader.read_wslice">
<code class="sig-name descname"><span class="pre">read_wslice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ig1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ig2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#ScrReader.read_wslice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.ScrReader.read_wslice" title="Permalink to this definition">¶</a></dt>
<dd><p>Read slice along the frequency dimension.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.scr.Polarizability">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scr.</span></code><code class="sig-name descname"><span class="pre">Polarizability</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gsphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wggmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#Polarizability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.Polarizability" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-94cdfcfae566e2a115767eb6b65cdcda25b7990e.png" alt="Inheritance diagram of Polarizability" usemap="#inheritancebef77cc23b" class="inheritance graphviz" /></div>
<map id="inheritancebef77cc23b" name="inheritancebef77cc23b">
<area shape="rect" id="node1" href="#abipy.electrons.scr.Polarizability" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,215,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.scr.Polarizability.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'polarizability'</span></em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.scr.Polarizability.latex_name">
<code class="sig-name descname"><span class="pre">latex_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'\\tilde</span> <span class="pre">chi'</span></em><a class="headerlink" href="#abipy.electrons.scr.Polarizability.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.scr.DielectricFunction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scr.</span></code><code class="sig-name descname"><span class="pre">DielectricFunction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gsphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wggmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#DielectricFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-d9cee6f81dcc34cab7c678eb34ed4e43926de036.png" alt="Inheritance diagram of DielectricFunction" usemap="#inheritance6199a96776" class="inheritance graphviz" /></div>
<map id="inheritance6199a96776" name="inheritance6199a96776">
<area shape="rect" id="node1" href="#abipy.electrons.scr.DielectricFunction" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,246,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.scr.DielectricFunction.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'dielectric_function'</span></em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.scr.DielectricFunction.latex_name">
<code class="sig-name descname"><span class="pre">latex_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'\\epsilon'</span></em><a class="headerlink" href="#abipy.electrons.scr.DielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.electrons.scr.InverseDielectricFunction">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.electrons.scr.</span></code><code class="sig-name descname"><span class="pre">InverseDielectricFunction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gsphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wggmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/electrons/scr.html#InverseDielectricFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.scr._AwggMatrix</span></code></p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-f47cf1d4b1071b04aff8df80736bdc5d8c2981c0.png" alt="Inheritance diagram of InverseDielectricFunction" usemap="#inheritancee337708410" class="inheritance graphviz" /></div>
<map id="inheritancee337708410" name="inheritancee337708410">
<area shape="rect" id="node1" href="#abipy.electrons.scr.InverseDielectricFunction" target="_top" title=".. rubric:: Inheritance Diagram" alt="" coords="5,5,290,29"/>
</map><dl class="py attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'inverse_dielectric_function'</span></em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.electrons.scr.InverseDielectricFunction.latex_name">
<code class="sig-name descname"><span class="pre">latex_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'\\epsilon^{-1}'</span></em><a class="headerlink" href="#abipy.electrons.scr.InverseDielectricFunction.latex_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="eph_api.html" class="btn btn-neutral float-right" title="eph Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dynamics_api.html" class="btn btn-neutral float-left" title="dynamics Package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, M. Giantomassi and the AbiPy group.
      <span class="lastupdated">
        Last updated on Jun 16, 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>