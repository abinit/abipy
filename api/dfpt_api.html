<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dfpt Package &#8212; abipy 0.9.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="display Package" href="display_api.html" />
    <link rel="prev" title="data Package" href="data_api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          abipy</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphical_interface.html">Graphical interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guide.html">Coding guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting AbiPy</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">dfpt Package</a><ul>
<li><a class="reference internal" href="#module-abipy.dfpt"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dpft</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.anaddbnc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">anaddbnc</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.converters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">converters</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.ddb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ddb</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.elastic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">elastic</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.frozen_phonons"><code class="xref py py-mod docutils literal notranslate"><span class="pre">frozen_phonons</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.gruneisen"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.ifc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ifc</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.msqdos"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msqdos</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.phonons"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phonons</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.phtk"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phtk</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.qha"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.raman"><code class="xref py py-mod docutils literal notranslate"><span class="pre">raman</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.dfpt.vsound"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vsound</span></code> Module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="data_api.html" title="Previous Chapter: data Package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; data Package</span>
    </a>
  </li>
  <li>
    <a href="display_api.html" title="Next Chapter: display Package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">display Package &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/dfpt_api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="dfpt-package">
<h1><a class="toc-backref" href="#contents">dfpt Package</a><a class="headerlink" href="#dfpt-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dfpt-package" id="id15">dfpt Package</a></p>
<ul>
<li><p><a class="reference internal" href="#module-abipy.dfpt" id="id16"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dpft</span></code> Package</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.anaddbnc" id="id17"><code class="xref py py-mod docutils literal notranslate"><span class="pre">anaddbnc</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.converters" id="id18"><code class="xref py py-mod docutils literal notranslate"><span class="pre">converters</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.ddb" id="id19"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ddb</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.elastic" id="id20"><code class="xref py py-mod docutils literal notranslate"><span class="pre">elastic</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.frozen_phonons" id="id21"><code class="xref py py-mod docutils literal notranslate"><span class="pre">frozen_phonons</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.gruneisen" id="id22"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.ifc" id="id23"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ifc</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.msqdos" id="id24"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msqdos</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.phonons" id="id25"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phonons</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.phtk" id="id26"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phtk</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.qha" id="id27"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.raman" id="id28"><code class="xref py py-mod docutils literal notranslate"><span class="pre">raman</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.dfpt.vsound" id="id29"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vsound</span></code> Module</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-abipy.dfpt">
<span id="dpft-package"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dpft</span></code> Package</a><a class="headerlink" href="#module-abipy.dfpt" title="Permalink to this headline">¶</a></h2>
<p>This subpackage provides objects and functions for the analysis of DFPT calculations.</p>
</div>
<div class="section" id="module-abipy.dfpt.anaddbnc">
<span id="anaddbnc-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">anaddbnc</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.anaddbnc" title="Permalink to this headline">¶</a></h2>
<p>AnaddbNcFile provides a high-level interface to the data stored in the anaddb.nc file.</p>
<dl class="py class">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.anaddbnc.</span></code><code class="sig-name descname"><span class="pre">AnaddbNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>AnaddbNcFile provides a high-level interface to the data stored in the anaddb.nc file.
This object is usually instanciated with <cite>abiopen(“anaddb.nc”)</cite>.</p>
<dl class="py attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.structure">
<code class="sig-name descname"><span class="pre">structure</span></code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.epsinf">
<code class="sig-name descname"><span class="pre">epsinf</span></code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.epsinf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.epsinf" title="Permalink to this definition">¶</a></dt>
<dd><p>Macroscopic dielectric tensor. None if the file does not contain this information.</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.becs">
<code class="sig-name descname"><span class="pre">becs</span></code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.becs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Born effective charges. None if the file does not contain this inf</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.ifc">
<code class="sig-name descname"><span class="pre">ifc</span></code><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.ifc" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">InteratomicForceConstants</span></code> object with the interatomic force constants calculated by anaddb.
None, if the netcdf file does not contain the IFCs.</p>
</dd></dl>

<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-943ea0f40f550824b7450a835537e0d2d42ba93b.png" alt="Inheritance diagram of AnaddbNcFile" usemap="#inheritance8defe6c584" class="inheritance graphviz" /></div>
<map id="inheritance8defe6c584" name="inheritance8defe6c584">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="244,104,444,129"/>
<area shape="rect" id="node5" href="#abipy.dfpt.anaddbnc.AnaddbNcFile" target="_top" title="AnaddbNcFile provides a high&#45;level interface to the data stored in the anaddb.nc file." alt="" coords="503,55,732,80"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="237,5,451,31"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="233,55,455,80"/>
</map><dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<code class="sig-name descname"><span class="pre">structure</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the convergence parameters
Used to construct <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – verbosity level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id1">
<code class="sig-name descname"><span class="pre">epsinf</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.epsinf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Macroscopic electronic <a class="reference internal" href="tools_api.html#abipy.tools.tensors.DielectricTensor" title="abipy.tools.tensors.DielectricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.tools.tensors.DielectricTensor</span></code></a> in Cartesian coordinates (a.k.a. epsilon_infinity)
None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.emacro">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">emacro</span></code><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.emacro" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.eps0">
<code class="sig-name descname"><span class="pre">eps0</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.eps0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.eps0" title="Permalink to this definition">¶</a></dt>
<dd><p>Relaxed ion macroscopic <a class="reference internal" href="tools_api.html#abipy.tools.tensors.DielectricTensor" title="abipy.tools.tensors.DielectricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.tools.tensors.DielectricTensor</span></code></a> in Cartesian coordinates (a.k.a. epsilon_zero)
None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.emacro_rlx">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">emacro_rlx</span></code><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.emacro_rlx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id2">
<code class="sig-name descname"><span class="pre">becs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.becs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Born effective charges. None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="id3">
<code class="sig-name descname"><span class="pre">ifc</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>The interatomic force constants calculated by anaddb.
The following anaddb variables should be used in the run: <code class="docutils literal notranslate"><span class="pre">ifcflag</span></code>, <code class="docutils literal notranslate"><span class="pre">natifc</span></code>, <code class="docutils literal notranslate"><span class="pre">atifc</span></code>, <code class="docutils literal notranslate"><span class="pre">ifcout</span></code>.
Return None, if the <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file does not contain the IFCs,</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.dchide">
<code class="sig-name descname"><span class="pre">dchide</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.dchide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.dchide" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-linear optical susceptibility tensor.
Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">NLOpticalSusceptibilityTensor</span></code> or None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.dchidt">
<code class="sig-name descname"><span class="pre">dchidt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.dchidt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.dchidt" title="Permalink to this definition">¶</a></dt>
<dd><p>First-order change in the linear dielectric susceptibility.
Returns a list of lists of 3x3 Tensor object with shape (number of atoms, 3).
The [i][j] element of the list contains the Tensor representing the change due to the
displacement of the ith atom in the jth direction.
None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.oscillator_strength">
<code class="sig-name descname"><span class="pre">oscillator_strength</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.oscillator_strength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.oscillator_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>A complex <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> containing the oscillator strengths with shape [number of phonon modes, 3, 3],
in a.u. (1 a.u.=253.2638413 m3/s2).
None if the file does not contain this information.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.has_elastic_data">
<code class="sig-name descname"><span class="pre">has_elastic_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.has_elastic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.has_elastic_data" title="Permalink to this definition">¶</a></dt>
<dd><p>True if elastic tensors have been computed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.has_piezoelectric_data">
<code class="sig-name descname"><span class="pre">has_piezoelectric_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.has_piezoelectric_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.has_piezoelectric_data" title="Permalink to this definition">¶</a></dt>
<dd><p>True if piezoelectric tensors have been computed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.elastic_data">
<code class="sig-name descname"><span class="pre">elastic_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.elastic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.elastic_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Container with the different (piezo)elastic tensors computed by anaddb.
stored in pymatgen tensor objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.amu">
<code class="sig-name descname"><span class="pre">amu</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.amu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.amu" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with atomic_number as keys and the atomic massu units as values.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.anaddbnc.</span></code><code class="sig-name descname"><span class="pre">AnaddbNcRobot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.robots.Robot</span></code></a></p>
<p>This robot analyzes the results contained in multiple anaddb.nc files.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-72372653049479a083ad133e2925ef96c344d16f.png" alt="Inheritance diagram of AnaddbNcRobot" usemap="#inheritance78c7737bde" class="inheritance graphviz" /></div>
<map id="inheritance78c7737bde" name="inheritance78c7737bde">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="275,5,437,31"/>
<area shape="rect" id="node3" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot" target="_top" title="This robot analyzes the results contained in multiple anaddb.nc files." alt="" coords="485,5,729,31"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,227,31"/>
</map><dl class="py attribute">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.EXT">
<code class="sig-name descname"><span class="pre">EXT</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'anaddb'</span></em><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.has_elastic_data">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_elastic_data</span></code><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.has_elastic_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.get_elastic_dataframe">
<code class="sig-name descname"><span class="pre">get_elastic_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abspath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot.get_elastic_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.get_elastic_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with properties derived from the elastic tensor
and an associated structure. Filename is used as index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_geo</strong> – True if structure info should be added to the dataframe</p></li>
<li><p><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</p></li>
<li><p><strong>with_params</strong> – False to exclude calculation parameters from the dataframe.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kwargs:</dt><dd><dl class="simple">
<dt>attrs:</dt><dd><p>List of additional attributes of the <a class="reference internal" href="electrons_api.html#abipy.electrons.gsr.GsrFile" title="abipy.electrons.gsr.GsrFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gsr.GsrFile</span></code></a> to add to the DataFrame.</p>
</dd>
<dt>funcs: Function or list of functions to execute to add more data to the DataFrame.</dt><dd><p>Each function receives a <a class="reference internal" href="electrons_api.html#abipy.electrons.gsr.GsrFile" title="abipy.electrons.gsr.GsrFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.gsr.GsrFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.plot_elastic_properties">
<code class="sig-name descname"><span class="pre">plot_elastic_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot.plot_elastic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.plot_elastic_properties" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fontsize</strong> – legend and label fontsize.</p>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.anaddbnc.AnaddbNcRobot.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/anaddbnc.html#AnaddbNcRobot.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.anaddbnc.AnaddbNcRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.converters">
<span id="converters-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">converters</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.converters" title="Permalink to this headline">¶</a></h2>
<p>Converters between abinit/abipy format and other external tools.
Some portions of the code have been imported from the ConvertDDB.py script
developed by Hu Xe, Eric Bousquet and Aldo Romero.</p>
<dl class="py function">
<dt id="abipy.dfpt.converters.abinit_to_phonopy">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">abinit_to_phonopy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anaddbnc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize_tensors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_outfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_masses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#abinit_to_phonopy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.abinit_to_phonopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the interatomic force constants(IFC), born effective charges(BEC) and dielectric
tensor obtained from anaddb to the phonopy format. Optionally writes the
standard phonopy files to a selected directory: FORCE_CONSTANTS, BORN (if BECs are available)
POSCAR of the unit cell, POSCAR of the supercell.</p>
<p>The conversion is performed taking the IFC in the Wigner–Seitz supercell with weights
as produced by anaddb and reorganizes them in a standard supercell multiple of the
unit cell. Operations are vectorized using numpy. This may lead to the allocation of
large arrays in case of very large supercells.</p>
<p>Performs a check to verify if the two codes identify the same symmetries and it gives a
warning in case of failure. Mismatching symmetries may lead to incorrect conversions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anaddbnc</strong> – an instance of AnaddbNcFile. Should contain the output of the IFC analysis,
the BEC and the dielectric tensor.</p></li>
<li><p><strong>supercell_matrix</strong> – the supercell matrix used for phonopy. Any choice is acceptable, however
the best agreement between the abinit and phonopy results is obtained if this is set to
a diagonal matrix with on the diagonal the ngqpt used to generate the anaddb.nc.</p></li>
<li><p><strong>symmetrize_tensors</strong> – if True the tensors will be symmetrized in the Phonopy object and
in the output files. This will apply to IFC, BEC and dielectric tensor.</p></li>
<li><p><strong>output_dir_path</strong> – a path to a directory where the phonopy files will be created</p></li>
<li><p><strong>prefix_outfiles</strong> – a string that will be added as a prefix to the name of the written files</p></li>
<li><p><strong>symprec</strong> – distance tolerance in Cartesian coordinates to find crystal symmetry in phonopy.
It might be that the value should be tuned so that it leads to the the same symmetries
as in the abinit calculation.</p></li>
<li><p><strong>set_masses</strong> – if True the atomic masses used by abinit will be added to the PhonopyAtoms
and will be present in the returned Phonopy object. This should improve compatibility
among abinit and phonopy results if frequencies needs to be calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of a Phonopy object that contains the IFC, BEC and dieletric tensor data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.phonopy_to_abinit">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">phonopy_to_abinit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ddb_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_constants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">born</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#phonopy_to_abinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.phonopy_to_abinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the data from phonopy to an abinit DDB file. The data can be provided
in form of arrays or paths to the phonopy files that should be parsed.
The minimal input should contains the FORCE_CONSTANTS or FORCE_SETS.
If BORN is present the Born effective charges (BEC) and dielectric
tensor will also be added to the DDB.</p>
<p>The best agreement is obtained with supercell_matrix and ngqpt being
equivalent (i.e. supercell_matrix a diagonal matrix with ngqpt as diagonal
elements). Non diagonal supercell_matrix are allowed as well, but the information
encoded in the DDB will be the result of an interpolation done through phonopy.</p>
<p>Phonopy is used to convert the IFC to the dynamical matrix. However, in order to
determine the list of q-points in the irreducible Brillouin zone and to prepare the
base for the final DDB file, abinit will be called for a very short and inexpensive run.</p>
<p>Performs a check to verify if the two codes identify the same symmetries and it gives a
warning in case of failure. Mismatching symmetries may lead to incorrect conversions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_cell</strong> – a <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object that identifies the unit cell used for the phonopy
calculation.</p></li>
<li><p><strong>supercell_matrix</strong> – a 3x3 array representing the supercell matrix used to generated the
forces with phonopy.</p></li>
<li><p><strong>out_ddb_path</strong> – a full path to the file where the new DDB will be written</p></li>
<li><p><strong>ngqpt</strong> – a list of 3 elements indicating the grid of q points that will be used in the DDB.</p></li>
<li><p><strong>qpt_list</strong> – alternatively to ngqpt an explicit list of q-points can be provided here.
At least one among ngqpt and qpt_list should be defined.</p></li>
<li><p><strong>force_constants</strong> – an array with shape (num atoms unit cell, num atoms supercell, 3, 3)
containing the force constants. Alternatively a string with the path to the
FORCE_CONSTANTS file. This or force_set should be defined. If both given this
has precedence.</p></li>
<li><p><strong>force_sets</strong> – a dictionary obtained from the force sets generated with phonopy.
Alternatively a string with the path to the FORCE_SETS file. This or force_constants
should be defined.</p></li>
<li><p><strong>born</strong> – a dictionary with “dielectric” and “born” keywords as obtained from the nac_params
in phonopy. Alternatively a string with the path to the BORN file. Notice that
the “factor” attribute is not taken into account, so the values should be in
default phonopy units.</p></li>
<li><p><strong>primitive_matrix</strong> – a 3x3 array with the primitive matrix passed to Phonopy. “auto” will
use spglib to try to determine it automatically. If the DDB file should contain the
actual unit cell this should be the identity matrix.</p></li>
<li><p><strong>symprec</strong> – distance tolerance in Cartesian coordinates to find crystal symmetry in phonopy.
It might be that the value should be tuned so that it leads to the the same symmetries
as in the abinit calculation.</p></li>
<li><p><strong>tolsym</strong> – Gives the tolerance to identify symmetries in abinit. See abinit documentation for
more details.</p></li>
<li><p><strong>supercell</strong> – if given it should represent the supercell used to get the force constants,
without any perturbation. It will be used to match it to the phonopy supercell
and sort the IFC in the correct order.</p></li>
<li><p><strong>calculator</strong> – a string with the name of the calculator. Will be used to set the conversion
factor for the force constants coming from phonopy.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>pseudos</strong> – List of filenames or list of <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.Pseudo" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.Pseudo</span></code></a> objects or <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.PseudoTable" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.PseudoTable</span></code></a> object. It will be
used by abinit to generate the base DDB file. If None the abipy.data.hgh_pseudos.HGH_TABLE
table will be used.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>workdir</strong> – path to the directory where the abinit calculation will be executed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a DdbFile instance of the file written in out_ddb_path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.generate_born_deriv">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">generate_born_deriv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">born</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#generate_born_deriv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.generate_born_deriv" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to generate the portion of the derivatives in the DDB
that are related to the Born effective charges and dielectric tensor,
starting from the data available in phonopy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>born</strong> – a dictionary with “dielectric” and “born” keywords as obtained from the nac_params
in phonopy.</p></li>
<li><p><strong>zion</strong> – the ionic charge of each atom in the system. It should be in the same order
as the one present in the header of the DDB.</p></li>
<li><p><strong>structure</strong> – a pymatgen <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> of the unit cell.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a complex numpy array with shape (len(structure)+2, 3, len(structure)+2, 3). Only the
parts relative to the BECs and dielectric tensors will be filled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.get_dm">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">get_dm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phonon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#get_dm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.get_dm" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to generate the dynamical matrix in the abinit conventions
for a list of q-points from a Phonopy object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phonon</strong> – a Phonopy object with force constants.</p></li>
<li><p><strong>qpt_list</strong> – a list of fractional coordinates of q-points for which the
dynamical matrix should be generated.</p></li>
<li><p><strong>structure</strong> – a pymatgen <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> of the primitive cell.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of arrays with the dynamical matrices of the selected q-points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.add_data_ddb">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">add_data_ddb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">born_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#add_data_ddb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.add_data_ddb" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to add the blocks for the dynamical matrix and BECs to a DdbFile object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb</strong> – a DdbFile object to be modified.</p></li>
<li><p><strong>dm_list</strong> – the list of dynamical matrices to be added.</p></li>
<li><p><strong>qpt_list</strong> – the list of q-points corresponding to dm_list.</p></li>
<li><p><strong>born_data</strong> – the data corresponding to BECs and dielectric tensor. If None
these part will not be set in the DDB.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.tdep_to_abinit">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">tdep_to_abinit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ddb_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lotosplitting_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#tdep_to_abinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.tdep_to_abinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the files produced by TDEP to an abinit DDB file. If the lotosplitting
file is provided the BEC and dielectric tensor will also be added to the DDB.</p>
<p>The conversion is performed by first extracting the force constants in phonopy format
and then using phonopy_to_abinit_py to generate the DDB file. See the phonopy_to_abinit_py
docstring for further details about the second step of the conversion.
Notice that the supercell used by TDEP should be provided in order to properly
sort the IFC to match the order required by phonopy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_cell</strong> – a <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object that identifies the unit cell used for the TDEP
calculation.</p></li>
<li><p><strong>fc_path</strong> – the path to the forceconstants file produced by TDEP.</p></li>
<li><p><strong>supercell_matrix</strong> – a 3x3 array representing the supercell matrix used to generated the
forces with TDEP.</p></li>
<li><p><strong>supercell</strong> – the supercell used by TDEP to get the force constants, without any
perturbation (usually named with extension ssposcar). It will be used to match it to
the phonopy supercell and sort the IFC in the correct order.</p></li>
<li><p><strong>out_ddb_path</strong> – a full path to the file where the new DDB will be written</p></li>
<li><p><strong>ngqpt</strong> – a list of 3 elements indicating the grid of q points that will be used in the DDB.</p></li>
<li><p><strong>qpt_list</strong> – alternatively to ngqpt an explicit list of q-points can be provided here.
At least one among ngqpt and qpt_list should be defined.</p></li>
<li><p><strong>primitive_matrix</strong> – a 3x3 array with the primitive matrix passed to Phonopy. “auto” will
use spglib to try to determine it automatically. If the DDB file should contain the
actual unit cell this should be the identity matrix.</p></li>
<li><p><strong>lotosplitting_path</strong> – path to the lotosplitting file produced by TDEP. If None no BEC
contribution will be set to the DDB.</p></li>
<li><p><strong>symprec</strong> – distance tolerance in Cartesian coordinates to find crystal symmetry in phonopy.
It might be that the value should be tuned so that it leads to the the same symmetries
as in the abinit calculation.</p></li>
<li><p><strong>tolsym</strong> – Gives the tolerance to identify symmetries in abinit. See abinit documentation for
more details.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>pseudos</strong> – List of filenames or list of <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.Pseudo" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.Pseudo</span></code></a> objects or <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.PseudoTable" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.PseudoTable</span></code></a> object. It will be
used by abinit to generate the base DDB file. If None the abipy.data.hgh_pseudos.HGH_TABLE
table will be used.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>workdir</strong> – path to the directory where the abinit calculation will be executed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a DdbFile instance of the file written in out_ddb_path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.parse_tdep_fc">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">parse_tdep_fc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#parse_tdep_fc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.parse_tdep_fc" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a forceconstants file produced by TDEP an converts it to an array in the
phonopy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc_path</strong> – path to the forceconstants file</p></li>
<li><p><strong>unit_cell</strong> – a <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object with the unit cell used for the calculation
in TDEP.</p></li>
<li><p><strong>supercell</strong> – the supercell used for the calculation in TDEP.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a comple numpy array with shape (len(unit_cell), len(supercell), 3, 3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.parse_tdep_lotosplitting">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">parse_tdep_lotosplitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#parse_tdep_lotosplitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.parse_tdep_lotosplitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the lotosplitting file produced by TDEP and transforms them in
the phonopy format for Born effective charges and dielectric tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to the lotosplitting file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple with dielectric tensor and Born effective charges.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.write_tdep_lotosplitting">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">write_tdep_lotosplitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">born</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'infile.lotosplitting'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%14.10f'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#write_tdep_lotosplitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.write_tdep_lotosplitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes an lotosplitting file starting from arrays containing dielectric tensor and
Born effective charges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> – a 3x3 array with the dielectric tensor.</p></li>
<li><p><strong>born</strong> – an array with the Born effective charges.</p></li>
<li><p><strong>filepath</strong> – the path where the lotosplitting file should be written.</p></li>
<li><p><strong>fmt</strong> – the format for the float numbers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.born_to_lotosplitting">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">born_to_lotosplitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">born</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lotosplitting_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'infile.lotosplitting'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#born_to_lotosplitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.born_to_lotosplitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Converted of a file from the BORN file produced from phonopy to the lotosplitting
file used by TDEP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>born</strong> – a dictionary with “dielectric” and “born” keywords as obtained from the nac_params
in phonopy. Notice that the “factor” attribute is not taken into account, so the
values should be in default phonopy units.</p></li>
<li><p><strong>lotosplitting_path</strong> – the path where the lotosplitting file should be written.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.write_BORN">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">write_BORN</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primitive</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BORN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize_tensors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#write_BORN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.write_BORN" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function imported from phonopy.file_IO.
Contrarily to the original, it does not symmetrize the tensor.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.converters.get_BORN_lines">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.converters.</span></code><code class="sig-name descname"><span class="pre">get_BORN_lines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unitcell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize_tensors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/converters.html#get_BORN_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.converters.get_BORN_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function imported from phonopy.file_IO that exposes the
option of not symmetrizing the tensor.</p>
</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.ddb">
<span id="ddb-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ddb</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.ddb" title="Permalink to this headline">¶</a></h2>
<p>Python API for the DDB file containing the derivatives of the total Energy wrt different perturbations.</p>
<dl class="py exception">
<dt id="abipy.dfpt.ddb.DdbError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">DdbError</span></code><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Error class raised by DDB.</p>
</dd></dl>

<dl class="py exception">
<dt id="abipy.dfpt.ddb.AnaddbError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">AnaddbError</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#AnaddbError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.AnaddbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbError</span></code></a></p>
<p>Exceptions raised when we try to execute <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.AnaddbTask" title="abipy.flowtk.tasks.AnaddbTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.AnaddbTask</span></code></a> in the <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> methods</p>
<p>An <cite>AnaddbError</cite> has a reference to the task and to the <code class="xref py py-class docutils literal notranslate"><span class="pre">EventsReport</span></code> that contains
the error messages of the run.</p>
</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.ddb.DdbFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">DdbFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.TextFile</span></code>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> file produced by ABINIT
as well as methods to compute phonon band structures, phonon DOS, thermodynamic properties etc.</p>
<p>About the indices (idir, ipert) used by Abinit (Fortran notation):</p>
<ul>
<li><p>idir in [1, 2, 3] gives the direction (usually reduced direction, cart for strain)</p></li>
<li><p>ipert in [1, 2, …, mpert] where mpert = natom + 6</p>
<blockquote>
<div><ul class="simple">
<li><p>ipert in [1, …, natom] corresponds to atomic perturbations  (reduced directions)</p></li>
<li><p>ipert = natom + 1 corresponds d/dk  (reduced directions)</p></li>
<li><p>ipert = natom + 2 corresponds the electric field</p></li>
<li><p>ipert = natom + 3 corresponds the uniaxial stress (Cartesian directions)</p></li>
<li><p>ipert = natom + 4 corresponds the shear stress.   (Cartesian directions)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p class="rubric">Inheritance</p>
<div class="graphviz"><img src="../_images/inheritance-9719baef58f1645a9db88e98a1c825f04ba3fb04.png" alt="Inheritance diagram of DdbFile" usemap="#inheritancecb0cf3a7e1" class="inheritance graphviz" /></div>
<map id="inheritancecb0cf3a7e1" name="inheritancecb0cf3a7e1">
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="237,55,451,80"/>
<area shape="rect" id="node5" href="#abipy.dfpt.ddb.DdbFile" target="_top" title="This object provides an interface to the DDB_ file produced by ABINIT" alt="" coords="503,55,659,80"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="233,104,455,129"/>
</map><dl class="py attribute">
<dt id="abipy.dfpt.ddb.DdbFile.Error">
<code class="sig-name descname"><span class="pre">Error</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbError</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt id="abipy.dfpt.ddb.DdbFile.AnaddbError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-name descname"><span class="pre">AnaddbError</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.AnaddbError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.ddb.DdbError" title="abipy.dfpt.ddb.DdbError"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbError</span></code></a></p>
<p>Exceptions raised when we try to execute <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.AnaddbTask" title="abipy.flowtk.tasks.AnaddbTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.AnaddbTask</span></code></a> in the <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> methods</p>
<p>An <cite>AnaddbError</cite> has a reference to the task and to the <code class="xref py py-class docutils literal notranslate"><span class="pre">EventsReport</span></code> that contains
the error messages of the run.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Needed for the <code class="xref py py-class docutils literal notranslate"><span class="pre">TextFile</span></code> abstract interface.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.from_string">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Build object from string using temporary file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.from_mpid">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_mpid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.from_mpid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.from_mpid" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch DDB file corresponding to a materials project <code class="docutils literal notranslate"><span class="pre">material_id</span></code>,
save it to temporary file and return new DdbFile object.</p>
<p>Raises: MPRestError if DDB file is not available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>material_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Materials Project material_id (e.g., mp-1234).</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject REST interface.
If None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in your .pmgrc.yaml.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.as_ddb">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_ddb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.as_ddb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.as_ddb" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> from a generic object <cite>obj</cite>.
Accepts: DdbFile or filepath</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.get_string">
<code class="sig-name descname"><span class="pre">get_string</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with DDB content.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.natom">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">natom</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.natom" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.version">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">version</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.version" title="Permalink to this definition">¶</a></dt>
<dd><p>DDB Version number (integer).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.header">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">header</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.header" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the values reported in the header section.
Use e.g. <code class="docutils literal notranslate"><span class="pre">ddb.header.ecut</span></code> to access its values</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.computed_dynmat">
<code class="sig-name descname"><span class="pre">computed_dynmat</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.computed_dynmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.computed_dynmat" title="Permalink to this definition">¶</a></dt>
<dd><p>OrderedDict mapping q-point object to –&gt; pandas Dataframe.
The <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> contains the columns: “idir1”, “ipert1”, “idir2”, “ipert2”, “cvalue”
and (idir1, ipert1, idir2, ipert2) as index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices follow the Abinit (Fortran) notation so they start at 1.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.blocks">
<code class="sig-name descname"><span class="pre">blocks</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>DDB blocks. List of dictionaries, Each dictionary contains the following keys.
“qpt” with the reduced coordinates of the q-point.
“data” that is a list of strings with the entries of the dynamical matrix for this q-point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.qpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qpoints</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointList</span></code></a> object with the list of q-points in reduced coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_qpoint">
<code class="sig-name descname"><span class="pre">has_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains this q-point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.qindex">
<code class="sig-name descname"><span class="pre">qindex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.qindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the q-point in the internal list of q-points.
Accepts: <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.guessed_ngqpt">
<code class="sig-name descname"><span class="pre">guessed_ngqpt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.guessed_ngqpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.guessed_ngqpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess for the q-mesh divisions (ngqpt) inferred from the list of
q-points found in the DDB file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The mesh may not be correct if the DDB file contains points belonging
to different meshes and/or the Q-mesh is shifted.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.total_energy">
<code class="sig-name descname"><span class="pre">total_energy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.total_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.total_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Total energy in eV. None if not available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.cart_forces">
<code class="sig-name descname"><span class="pre">cart_forces</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.cart_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.cart_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian forces in eV / Ang
None if not available i.e. if the GS DDB has not been merged.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.cart_stress_tensor">
<code class="sig-name descname"><span class="pre">cart_stress_tensor</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.cart_stress_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.cart_stress_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="tools_api.html#abipy.tools.tensors.Stress" title="abipy.tools.tensors.Stress"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.tools.tensors.Stress</span></code></a> tensor in cartesian coordinates (GPa units). None if not available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_lo_to_data">
<code class="sig-name descname"><span class="pre">has_lo_to_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'at_least_one'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_lo_to_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_lo_to_data" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains the data required to compute the LO-TO splitting.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_at_least_one_atomic_perturbation">
<code class="sig-name descname"><span class="pre">has_at_least_one_atomic_perturbation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_at_least_one_atomic_perturbation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_at_least_one_atomic_perturbation" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on (at least one) atomic perturbation.
If the coordinates of a q point are provided only the specified qpt will be considered.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_epsinf_terms">
<code class="sig-name descname"><span class="pre">has_epsinf_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'at_least_one'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_epsinf_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_epsinf_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on the electric-field perturbation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>select</strong> – Possible values in [“at_least_one”, “at_least_one_diagoterm”, “all”]
If select == “at_least_one”, we check if there’s at least one entry
associated to the electric field and we assume that anaddb will be able
to reconstruct the full tensor by symmetry.
“at_least_one_diagoterm” is similar but it only checks for the presence of one diagonal term.
If select == “all”, all tensor components must be present in the DDB file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_emacro_terms">
<code class="sig-name descname"><span class="pre">has_emacro_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_emacro_terms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_bec_terms">
<code class="sig-name descname"><span class="pre">has_bec_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'at_least_one'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_bec_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_bec_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on the Born effective charges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>select</strong> – Possible values in [“at_least_one”, “all”]
By default, we check if there’s at least one entry associated to atomic displacement
and electric field and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all bec components must be present in the DDB file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_strain_terms">
<code class="sig-name descname"><span class="pre">has_strain_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_strain_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_strain_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains info on the (clamped-ion) strain perturbation
(i.e. 2nd order derivatives wrt strain)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>select</strong> – Possible values in [“at_least_one”, “all”]
If select == “at_least_one”, we check if there’s at least one entry associated to the strain.
and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all tensor components must be present in the DDB file.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As anaddb is not yet able to reconstruct the strain terms by symmetry,
the default value for select is “all”</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_internalstrain_terms">
<code class="sig-name descname"><span class="pre">has_internalstrain_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_internalstrain_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_internalstrain_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains internal strain terms
i.e “off-diagonal” 2nd order derivatives wrt (strain, atomic displacement)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>select</strong> – Possible values in [“at_least_one”, “all”]
If select == “at_least_one”, we check if there’s at least one entry associated to the strain.
and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all tensor components must be present in the DDB file.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As anaddb is not yet able to reconstruct the strain terms by symmetry,
the default value for select is “all”</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.has_piezoelectric_terms">
<code class="sig-name descname"><span class="pre">has_piezoelectric_terms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.has_piezoelectric_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.has_piezoelectric_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the DDB file contains piezoelectric terms
i.e “off-diagonal” 2nd order derivatives wrt (electric_field, strain)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>select</strong> – Possible values in [“at_least_one”, “all”]
If select == “at_least_one”, we check if there’s at least one entry associated to the strain.
and we assume that anaddb will be able to reconstruct the full tensor by symmetry.
If select == “all”, all tensor components must be present in the DDB file.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As anaddb is not yet able to reconstruct the (strain, electric) terms by symmetry,
the default value for select is “all”</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.view_phononwebsite">
<code class="sig-name descname"><span class="pre">view_phononwebsite</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.view_phononwebsite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.view_phononwebsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute phonon bands.
Produce JSON file that can be parsed from the <a class="reference external" href="http://henriquemiranda.github.io/phononwebsite/">phononwebsite</a> and open it in <code class="docutils literal notranslate"><span class="pre">browser</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>browser</strong> – Open webpage in <code class="docutils literal notranslate"><span class="pre">browser</span></code>. Use default $BROWSER if None.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
<li><p><strong>dryrun</strong> – Activate dryrun mode for unit testing purposes.</p></li>
<li><p><strong>kwargs</strong> – Passed to <code class="docutils literal notranslate"><span class="pre">anaget_phbst_and_phdos_files</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Return: Exit status</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoint">
<code class="sig-name descname"><span class="pre">anaget_phmodes_at_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spell_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phmodes_at_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute phonon modes at the given q-point. Non analytical contribution
can be added if qpoint is Gamma and required elements are present in the DDB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – Reduced coordinates of the qpoint where phonon modes are computed.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to False
If True the LO-TO splitting will be calculated if qpoint == Gamma and the non_anal_directions
non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>directions</strong> – list of 3D directions along which the LO-TO splitting will be calculated. If None the three
cartesian direction will be used.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
<li><p><strong>return_input</strong> – True if <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AnaddbInput" title="abipy.abio.inputs.AnaddbInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AnaddbInput</span></code></a> object should be returned as 2nd argument</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoints">
<code class="sig-name descname"><span class="pre">anaget_phmodes_at_qpoints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifcflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spell_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phmodes_at_qpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phmodes_at_qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute phonon modes at the given list of q-points. Non analytical contribution
can be added if Gamma belongs to the list and required elements are present in the DDB.
If the list of q-points contains points that are not present in the DDB the values will be
interpolated and ifcflag should be set to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoints</strong> – Reduced coordinates of a list of qpoints where phonon modes are computed.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ifcflag</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default).</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to False
If True the LO-TO splitting will be calculated if qpoint == Gamma and the non_anal_directions
non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>directions</strong> – list of 3D directions along which the LO-TO splitting will be calculated. If None the three
cartesian direction will be used.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
<li><p><strong>return_input</strong> – True if <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AnaddbInput" title="abipy.abio.inputs.AnaddbInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AnaddbInput</span></code></a> object should be returned as 2nd argument</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phbst_and_phdos_files">
<code class="sig-name descname"><span class="pre">anaget_phbst_and_phdos_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqsmall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qppa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndivsm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tetra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qptbounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spell_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phbst_and_phdos_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phbst_and_phdos_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute the phonon band structure and the phonon DOS.
Return contex manager that closes the files automatically.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Use:</p>
<blockquote>
<div><dl class="simple">
<dt>with ddb.anaget_phbst_and_phdos_files(…) as g:</dt><dd><p>phbst_file, phdos_file = g[0], g[0]</p>
</dd>
</dl>
</div></blockquote>
<p>to ensure the netcdf files are closed instead of:</p>
<blockquote>
<div><p>phbst_file, phdos_file = ddb.anaget_phbst_and_phdos_files(…)</p>
</div></blockquote>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqsmall</strong> – Defines the homogeneous q-mesh used for the DOS. Gives the number of divisions
used to sample the smallest lattice vector. If 0, DOS is not computed and
(phbst, None) is returned.</p></li>
<li><p><strong>qppa</strong> – Defines the homogeneous q-mesh used for the DOS in units of q-points per reciproval atom.
Overrides nqsmall.</p></li>
<li><p><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path.</p></li>
<li><p><strong>line_density</strong> – Defines the a density of k-points per reciprocal atom to plot the phonon dispersion.
Overrides ndivsm.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening.</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to “automatic”
If True the LO-TO splitting will be calculated and the non_anal_directions
and the non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default).</p></li>
<li><p><strong>qptbounds</strong> – Boundaries of the path. If None, the path is generated from an internal database
depending on the input structure.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file.</p></li>
<li><p><strong>return_input</strong> – True if <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AnaddbInput" title="abipy.abio.inputs.AnaddbInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AnaddbInput</span></code></a> object should be attached to the Context manager.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Context manager with two files:</dt><dd><p><a class="reference internal" href="#abipy.dfpt.phonons.PhbstFile" title="abipy.dfpt.phonons.PhbstFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhbstFile</span></code></a> with the phonon band structure.
<a class="reference internal" href="#abipy.dfpt.phonons.PhdosFile" title="abipy.dfpt.phonons.PhdosFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhdosFile</span></code></a> with the the phonon DOS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.get_coarse">
<code class="sig-name descname"><span class="pre">get_coarse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngqpt_coarse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_coarse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_coarse" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a version of this file on a coarse mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngqpt_coarse</strong> – list of ngqpt indexes that must be a sub-mesh of the original ngqpt</p></li>
<li><p><strong>filepath</strong> – Filename for coarse DDB. If None, temporary filename is used.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> on coarse mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anacompare_asr">
<code class="sig-name descname"><span class="pre">anacompare_asr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asr_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqsmall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndivsm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tetra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anacompare_asr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anacompare_asr" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute the phonon band structure and the phonon DOS with different
values of the <code class="docutils literal notranslate"><span class="pre">asr</span></code> input variable (acoustic sum rule treatment).
Build and return <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asr_list</strong> – List of <code class="docutils literal notranslate"><span class="pre">asr</span></code> values to test.</p></li>
<li><p><strong>chneut_list</strong> – List of <code class="docutils literal notranslate"><span class="pre">chneut</span></code> values to test (used by anaddb only if dipdip == 1).</p></li>
<li><p><strong>dipdip</strong> – 1 to activate treatment of dipole-dipole interaction (requires BECS and dielectric tensor).</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to “automatic”
If True the LO-TO splitting will be calculated if qpoint == Gamma and the non_anal_directions
non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>nqsmall</strong> – Defines the q-mesh for the phonon DOS in terms of
the number of divisions to be used to sample the smallest reciprocal lattice vector.
0 to disable DOS computation.</p></li>
<li><p><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path</p></li>
<li><p><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the ab-initio q-mesh in the DDB file. Auto-detected if None (default)</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes used by anaddb.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.</p>
<p>Client code can use <code class="docutils literal notranslate"><span class="pre">plotter.combiplot()</span></code> or <code class="docutils literal notranslate"><span class="pre">plotter.gridplot()</span></code> to visualize the results.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anacompare_dipdip">
<code class="sig-name descname"><span class="pre">anacompare_dipdip</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chneut_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqsmall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndivsm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tetra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anacompare_dipdip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anacompare_dipdip" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute the phonon band structure and the phonon DOS with different
values of the <code class="docutils literal notranslate"><span class="pre">dipdip</span></code> input variable (dipole-dipole treatment).
Build and return <a class="reference internal" href="#abipy.dfpt.phonons.PhononDosPlotter" title="abipy.dfpt.phonons.PhononDosPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDosPlotter</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chneut_list</strong> – List of <code class="docutils literal notranslate"><span class="pre">chneut</span></code> values to test (used for dipdip == 1).</p></li>
<li><p><strong>asr_list</strong> – Variable for acoustic sum rule treatment.</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to “automatic”
If True the LO-TO splitting will be calculated if qpoint == Gamma and the non_anal_directions
non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>nqsmall</strong> – Defines the q-mesh for the phonon DOS in terms of
the number of divisions to be used to sample the smallest reciprocal lattice vector.
0 to disable DOS computation.</p></li>
<li><p><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path</p></li>
<li><p><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the ab-initio q-mesh in the DDB file. Auto-detected if None (default)</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes used by anaddb.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononDosPlotter" title="abipy.dfpt.phonons.PhononDosPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDosPlotter</span></code></a> object.</p>
<p>Client code can use <code class="docutils literal notranslate"><span class="pre">plotter.combiplot()</span></code> or <code class="docutils literal notranslate"><span class="pre">plotter.gridplot()</span></code> to visualize the results.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anacompare_phdos">
<code class="sig-name descname"><span class="pre">anacompare_phdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nqsmalls</span></em>, <em class="sig-param"><span class="pre">asr=2</span></em>, <em class="sig-param"><span class="pre">chneut=1</span></em>, <em class="sig-param"><span class="pre">dipdip=1</span></em>, <em class="sig-param"><span class="pre">dos_method='tetra'</span></em>, <em class="sig-param"><span class="pre">ngqpt=None</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em>, <em class="sig-param"><span class="pre">num_cpus=1</span></em>, <em class="sig-param"><span class="pre">stream=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anacompare_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anacompare_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Anaddb to compute Phonon DOS with different q-meshes. The ab-initio dynamical matrix
reported in the <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> file will be Fourier-interpolated on the list of q-meshes specified
by <code class="docutils literal notranslate"><span class="pre">nqsmalls</span></code>. Useful to perform convergence studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nqsmalls</strong> – List of integers defining the q-mesh for the DOS. Each integer gives
the number of divisions to be used to sample the smallest reciprocal lattice vector.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the ab-initio q-mesh in the DDB file. Auto-detected if None (default)</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
<li><p><strong>num_cpus</strong> – Number of CPUs (threads) used to parallellize the calculation of the DOSes. Autodetected if None.</p></li>
<li><p><strong>stream</strong> – File-like object used for printing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>phdoses: List of |PhononDos| objects
plotter: |PhononDosPlotter| object.
    Client code can use ``plotter.gridplot()`` to visualize the results.
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anacompare_rifcsph">
<code class="sig-name descname"><span class="pre">anacompare_rifcsph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rifcsph_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndivsm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anacompare_rifcsph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anacompare_rifcsph" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute the phonon band structure and the phonon DOS with different
values of the <code class="docutils literal notranslate"><span class="pre">asr</span></code> input variable (acoustic sum rule treatment).
Build and return <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rifcsph_list</strong> – List of rifcsph to analyze.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – 1 to activate treatment of dipole-dipole interaction (requires BECS and dielectric tensor).</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to “automatic”
If True the LO-TO splitting will be calculated if qpoint == Gamma and the non_anal_directions
non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the ab-initio q-mesh in the DDB file. Auto-detected if None (default)</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes used by anaddb.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.</p>
<p>Client code can use <code class="docutils literal notranslate"><span class="pre">plotter.combiplot()</span></code> or <code class="docutils literal notranslate"><span class="pre">plotter.gridplot()</span></code> to visualize the results.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_epsinf_and_becs">
<code class="sig-name descname"><span class="pre">anaget_epsinf_and_becs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_epsinf_and_becs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_epsinf_and_becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Call anaddb to compute the macroscopic electronic dielectric tensor (e_inf)
and the Born effective charges in Cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Return: <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes::</dt><dd><p>epsinf: <a class="reference internal" href="tools_api.html#abipy.tools.tensors.DielectricTensor" title="abipy.tools.tensors.DielectricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.tools.tensors.DielectricTensor</span></code></a> object.
becs: Becs objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_emacro_and_becs">
<code class="sig-name descname"><span class="pre">anaget_emacro_and_becs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_emacro_and_becs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_ifc">
<code class="sig-name descname"><span class="pre">anaget_ifc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ifcout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_ifc" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute the interatomic forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ifcout</strong> – Number of neighbouring atoms for which the ifc’s will be output. If None all the atoms in the big box.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default)</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">InteratomicForceConstants</span></code> with the calculated ifc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_phonopy_ifc">
<code class="sig-name descname"><span class="pre">anaget_phonopy_ifc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize_tensors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_outfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_masses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_phonopy_ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_phonopy_ifc" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs anaddb to get the interatomic force constants(IFC), born effective charges(BEC) and dielectric
tensor obtained and converts them to the phonopy format. Optionally writes the
standard phonopy files to a selected directory: FORCE_CONSTANTS, BORN (if BECs are available)
POSCAR of the unit cell, POSCAR of the supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngqpt</strong> – the ngqpt used to generate the anaddbnc. Will be used to determine the (diagonal)
supercell matrix in phonopy. A smaller value can be used, but some information will
be lost and inconsistencies in the convertion may occour.</p></li>
<li><p><strong>supercell_matrix</strong> – the supercell matrix used for phonopy. if None it will be set to
a diagonal matrix with ngqpt on the diagonal. This should provide the best agreement between
the anaddb and phonopy results.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>symmetrize_tensors</strong> – if True the tensors will be symmetrized in the Phonopy object and
in the output files. This will apply to IFC, BEC and dielectric tensor.</p></li>
<li><p><strong>output_dir_path</strong> – a path to a directory where the phonopy files will be created</p></li>
<li><p><strong>prefix_outfiles</strong> – a string that will be added as a prefix to the name of the written files</p></li>
<li><p><strong>symprec</strong> – distance tolerance in Cartesian coordinates to find crystal symmetry in phonopy.
It might be that the value should be tuned so that it leads to the the same symmetries
as in the abinit calculation.</p></li>
<li><p><strong>set_masses</strong> – if True the atomic masses used by abinit will be added to the PhonopyAtoms
and will be present in the returned Phonopy object. This should improve compatibility
among abinit and phonopy results if frequencies needs to be calculated.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of a Phonopy object that contains the IFC, BEC and dieletric tensor data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_interpolated_ddb">
<code class="sig-name descname"><span class="pre">anaget_interpolated_ddb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_interpolated_ddb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_interpolated_ddb" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs anaddb to generate an interpolated DDB file on a list of qpt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpt_list</strong> – list of fractional coordinates of qpoints where the ddb should be interpolated.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default).</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_dielectric_tensor_generator">
<code class="sig-name descname"><span class="pre">anaget_dielectric_tensor_generator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_dielectric_tensor_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_dielectric_tensor_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to extract the quantities necessary to create a <a class="reference internal" href="#abipy.dfpt.ddb.DielectricTensorGenerator" title="abipy.dfpt.ddb.DielectricTensorGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DielectricTensorGenerator</span></code></a>.
Requires phonon perturbations at Gamma and static electric field perturbations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb</p></li>
<li><p><strong>return_input</strong> – True if <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AnaddbInput" title="abipy.abio.inputs.AnaddbInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AnaddbInput</span></code></a> object should be returned as 2nd argument</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="#abipy.dfpt.ddb.DielectricTensorGenerator" title="abipy.dfpt.ddb.DielectricTensorGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DielectricTensorGenerator</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_elastic">
<code class="sig-name descname"><span class="pre">anaget_elastic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relaxed_ion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piezo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dde</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stress_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_elastic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_elastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Call anaddb to compute elastic and piezoelectric tensors. Require DDB with strain terms.</p>
<p>By default, this method sets the anaddb input variables automatically
by looking at the 2nd-order derivatives available in the DDB file.
This behaviour can be changed by setting explicitly the value of:
<cite>relaxed_ion</cite> and <cite>piezo</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relaxed_ion</strong> – Activate computation of relaxed-ion tensors.
Allowed values are [True, False, “automatic”]. Defaults to “automatic”.
In “automatic” mode, relaxed-ion tensors are automatically computed if
internal strain terms and phonons at Gamma are present in the DDB.</p></li>
<li><p><strong>piezo</strong> – Activate computation of piezoelectric tensors.
Allowed values are [True, False, “automatic”]. Defaults to “automatic”.
In “automatic” mode, piezoelectric tensors are automatically computed if
piezoelectric terms are present in the DDB.
NB: relaxed-ion piezoelectric requires the activation of <cite>relaxed_ion</cite>.</p></li>
<li><p><strong>dde</strong> – if True, dielectric tensors will be calculated.</p></li>
<li><p><strong>stress_correction</strong> – Calculate the relaxed ion elastic tensors, considering
the stress left inside cell. The DDB must contain the stress tensor.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>retpath</strong> – True to return path to anaddb.nc file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#abipy.dfpt.elastic.ElasticData" title="abipy.dfpt.elastic.ElasticData"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.elastic.ElasticData</span></code></a> object if <code class="docutils literal notranslate"><span class="pre">retpath</span></code> is None else absolute path to anaddb.nc file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.anaget_raman">
<code class="sig-name descname"><span class="pre">anaget_raman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramansr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.anaget_raman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.anaget_raman" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute the Raman spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – Reduced coordinates of the qpoint where phonon modes are computed.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ramansr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>alphon</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>directions</strong> – list of 3D directions along which the non analytical contribution will be calculated.
If None the three cartesian direction will be used.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a href="#id13"><span class="problematic" id="id14">|Raman|</span></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the DDB file in filepath. Requires the blocks data.
Only the information stored in self.header.lines and in self.blocks will be used to produce the file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.get_block_for_qpoint">
<code class="sig-name descname"><span class="pre">get_block_for_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_block_for_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_block_for_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the block data for the selected qpoint.
Returns a list of lines containing the block information</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.replace_block_for_qpoint">
<code class="sig-name descname"><span class="pre">replace_block_for_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.replace_block_for_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.replace_block_for_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the block data for the selected qpoint. Object is modified in-place.
Data should be a list of strings representing the whole data block.
Note that the DDB file should be written and reopened in order to call methods that run anaddb.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if qpt has been found and data has been replaced.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.insert_block">
<code class="sig-name descname"><span class="pre">insert_block</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.insert_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.insert_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a block in the list. Can replace a block if already present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – a dictionary with keys “dord” (the order of the perturbation),
“qpt” (the fractional coordinates of the qpoint if dord=2),
“qpt3” (the fractional coordinates of the qpoints if dord=3),
“data” (the lines of the block of data).</p></li>
<li><p><strong>replace</strong> – if True and an equivalent block is already present it will be replaced,
otherwise the block will not be inserted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the block was inserted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.remove_block">
<code class="sig-name descname"><span class="pre">remove_block</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.remove_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.remove_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes one block from the list of blocks in the ddb
:param dord: the order of the perturbation (from 0 to 3).
:param qpt: the fractional coordinates of the q point of the block to be</p>
<blockquote>
<div><p>removed. Should be present if dord=2.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qpt3</strong> – a 3x3 matrix with the coordinates for the third order perturbations.
Should be present in dord=3.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if a matching block was found and removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.get_2nd_ord_dict">
<code class="sig-name descname"><span class="pre">get_2nd_ord_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_2nd_ord_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_2nd_ord_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an ordered dictionary with the second order derivative of the form
{qpt: {(idir1, ipert1, idir2, ipert2): complex value}}.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary with all the elements of a dynamical matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.set_2nd_ord_data">
<code class="sig-name descname"><span class="pre">set_2nd_ord_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.set_2nd_ord_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.set_2nd_ord_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the blocks corresponding to the data provided for the second
order perturbations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – a dict of the form {qpt: {(idir1, ipert1, idir2, ipert2): complex value}}.</p></li>
<li><p><strong>replace</strong> – if True and an equivalent block is already present it will be replaced,
otherwise the block will not be inserted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.get_panel">
<code class="sig-name descname"><span class="pre">get_panel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.get_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.get_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build panel with widgets to interact with the <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> either in a notebook or in panel app.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.ddb.Becs">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">Becs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">becs_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<p>This object stores the Born effective charges and provides simple tools for data analysis.</p>
<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.as_dict">
<code class="sig-name descname"><span class="pre">as_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary with JSON serialization in MSONable format.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.ddb.Becs.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.sumrule">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sumrule</span></code><a class="headerlink" href="#abipy.dfpt.ddb.Becs.sumrule" title="Permalink to this definition">¶</a></dt>
<dd><p>[3, 3] matrix with Born effective charge neutrality sum-rule.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.get_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.get_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.get_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with Voigt indices as columns and natom rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>tol</strong> – Entries are set to zero below this value</p></li>
<li><p><strong>select_symbols</strong> – String or list of strings with chemical symbols.
Used to select only atoms of this type.</p></li>
<li><p><strong>decimals</strong> – Number of decimal places to round to.
If decimals is negative, it specifies the number of positions to the left of the decimal point.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.Becs.check_site_symmetries">
<code class="sig-name descname"><span class="pre">check_site_symmetries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#Becs.check_site_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.Becs.check_site_symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Check site symmetries of the Born effective charges. Print output to terminal.
Return: max_err</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">DielectricTensorGenerator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oscillator_strength</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsinf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>Object used to generate frequency dependent dielectric tensors as obtained
from DFPT calculations. The values are calculated on the fly
based on the phonon frequencies at gamma and oscillator strengths.
The first three frequencies would be considered as acoustic modes and
ignored in the calculation. No checks would be performed.</p>
<p>See the definitions Eq.(53-54) in <a class="bibtex reference internal" href="../zzbiblio.html#gonze1997" id="id4">[Gonze1997]</a> PRB55, 10355 (1997).</p>
<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.from_files">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phbst_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddbnc_filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the object from the files that contain the phonon frequencies, oscillator strength and
static dielectric tensor, i.e. the PHBST.nc and anaddb.nc netcdf files, respectively.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.from_objects">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_objects</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phbands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddbnc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.from_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.from_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the object from the objects <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object and AnaddbNcFile</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.get_oscillator_dataframe">
<code class="sig-name descname"><span class="pre">get_oscillator_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.get_oscillator_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.get_oscillator_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with oscillator matrix elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reim</strong> – “re” for real part, “im” for imaginary part, “all” for both.</p></li>
<li><p><strong>tol</strong> – Entries are set to zero below this value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.tensor_at_frequency">
<code class="sig-name descname"><span class="pre">tensor_at_frequency</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.tensor_at_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.tensor_at_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="tools_api.html#abipy.tools.tensors.DielectricTensor" title="abipy.tools.tensors.DielectricTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.tools.tensors.DielectricTensor</span></code></a> object representing the dielectric tensor
in atomic units at the specified frequency w. Eq.(53-54) in PRB55, 10355 (1997).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – Frequency.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in</p></li>
<li><p><strong>(</strong><strong>&quot;eV&quot;</strong> – </p></li>
<li><p><strong>&quot;meV&quot;</strong> – </p></li>
<li><p><strong>&quot;Ha&quot;</strong> – </p></li>
<li><p><strong>&quot;cm-1&quot;</strong> – </p></li>
<li><p><strong>Case-insensitive.</strong> (<em>&quot;Thz&quot;</em><em>)</em><em></em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reim'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the selected components of the dielectric tensor as a function of frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_min</strong> – minimum frequency in units <cite>units</cite>.</p></li>
<li><p><strong>w_max</strong> – maximum frequency. If None it will be set to the value of the maximum frequency + 5*gamma_ev.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>num</strong> – number of values of the frequencies between w_min and w_max.</p></li>
<li><p><strong>component</strong> – <p>determine which components of the tensor will be displayed. Can be a list/tuple of two
elements, indicating the indices [i, j] of the desired component or a string among:</p>
<ul>
<li><p>’diag_av’ to plot the average of the components on the diagonal</p></li>
<li><p>’diag’ to plot the elements on diagonal</p></li>
<li><p>’all’ to plot all the components in the upper triangle.</p></li>
<li><p>’offdiag’ to plot the off-diagonal components in the upper triangle.</p></li>
</ul>
</p></li>
<li><p><strong>reim</strong> – a string with “re” will plot the real part, with “im” selects the imaginary part.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>with_phfreqs</strong> – True to show phonon frequencies with dots.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot_vs_w">
<code class="sig-name descname"><span class="pre">plot_vs_w</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reim'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot_vs_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the selected components of the dielectric tensor as a function of frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_min</strong> – minimum frequency in units <cite>units</cite>.</p></li>
<li><p><strong>w_max</strong> – maximum frequency. If None it will be set to the value of the maximum frequency + 5*gamma_ev.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>num</strong> – number of values of the frequencies between w_min and w_max.</p></li>
<li><p><strong>component</strong> – <p>determine which components of the tensor will be displayed. Can be a list/tuple of two
elements, indicating the indices [i, j] of the desired component or a string among:</p>
<ul>
<li><p>’diag_av’ to plot the average of the components on the diagonal</p></li>
<li><p>’diag’ to plot the elements on diagonal</p></li>
<li><p>’all’ to plot all the components in the upper triangle.</p></li>
<li><p>’offdiag’ to plot the off-diagonal components in the upper triangle.</p></li>
</ul>
</p></li>
<li><p><strong>reim</strong> – a string with “re” will plot the real part, with “im” selects the imaginary part.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>with_phfreqs</strong> – True to show phonon frequencies with dots.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot_all">
<code class="sig-name descname"><span class="pre">plot_all</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.plot_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot diagonal and off-diagonal elements of the dielectric tensor as a function of frequency.
Both real and imag part are show. Accepts all arguments of <cite>plot</cite> method with the exception of:
<cite>component</cite> and <cite>reim</cite>.</p>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot_e0w_qdirs">
<code class="sig-name descname"><span class="pre">plot_e0w_qdirs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qdirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reim'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'direct'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.plot_e0w_qdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot_e0w_qdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the dielectric tensor and/or -epsinf_q**2 / epsilon_q along a set of specified directions.
With epsilon_q as defined in eq. (56) in <a class="bibtex reference internal" href="../zzbiblio.html#gonze1997" id="id5">[Gonze1997]</a> PRB55, 10355 (1997).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qdirs</strong> – a list of directions along which to plot the dielectric tensor. They will be normalized
internally. If None the three cartesian directions will be shown.</p></li>
<li><p><strong>w_min</strong> – minimum frequency in units <cite>units</cite>.</p></li>
<li><p><strong>w_max</strong> – maximum frequency. If None it will be set to the value of the maximum frequency + 5*gamma_ev.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>num</strong> – number of values of the frequencies between w_min and w_max.</p></li>
<li><p><strong>reim</strong> – a string with “re” will plot the real part, with “im” selects the imaginary part.</p></li>
<li><p><strong>func</strong> – determines which functional form will be plot. Can be:
* “direct”: plot of epsilon_q
* “inverse”: plot of -epsinf_q**2 / epsilon_q
* “both”: both plots.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>with_phfreqs</strong> – True to show phonon frequencies with dots.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.reflectivity">
<code class="sig-name descname"><span class="pre">reflectivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.reflectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the reflectivity from the dielectric tensor along the specified direction
according to eq. (58) in <a class="bibtex reference internal" href="../zzbiblio.html#gonze1997" id="id6">[Gonze1997]</a> PRB55, 10355 (1997).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qdir</strong> – a list with three components defining the direction.
It will be normalized internally.</p></li>
<li><p><strong>w</strong> – frequency.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the reflectivity.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DielectricTensorGenerator.plot_reflectivity">
<code class="sig-name descname"><span class="pre">plot_reflectivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qdirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_ev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DielectricTensorGenerator.plot_reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DielectricTensorGenerator.plot_reflectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the reflectivity from the dielectric tensor along the specified directions,
according to eq. (58) in <a class="bibtex reference internal" href="../zzbiblio.html#gonze1997" id="id7">[Gonze1997]</a> PRB55, 10355 (1997).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qdirs</strong> – a list of directions along which to plot the dielectric tensor. They will be normalized
internally. If None the three cartesian directions will be shown.</p></li>
<li><p><strong>w_min</strong> – minimum frequency in units <cite>units</cite>.</p></li>
<li><p><strong>w_max</strong> – maximum frequency. If None it will be set to the value of the maximum frequency + 5*gamma_ev.</p></li>
<li><p><strong>gamma_ev</strong> – Phonon damping factor in eV (full width). Poles are shifted by phfreq * gamma_ev.
Accept scalar or [nfreq] array.</p></li>
<li><p><strong>num</strong> – number of values of the frequencies between w_min and w_max.</p></li>
<li><p><strong>units</strong> – string specifying the units used for phonon frequencies. Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>with_phfreqs</strong> – True to show phonon frequencies with dots.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.ddb.DdbRobot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">DdbRobot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abio_api.html#abipy.abio.robots.Robot" title="abipy.abio.robots.Robot"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.robots.Robot</span></code></a></p>
<p>This robot analyzes the results contained in multiple <a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/ddb.ipynb">DDB</a> files.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-22ad8e66f5f58525e3c28ba2a80613bcea4a391e.png" alt="Inheritance diagram of DdbRobot" usemap="#inheritance0460c10005" class="inheritance graphviz" /></div>
<map id="inheritance0460c10005" name="inheritance0460c10005">
<area shape="rect" id="node1" href="abio_api.html#abipy.abio.robots.Robot" target="_top" title="This is the base class from which all Robot subclasses should derive." alt="" coords="275,5,437,31"/>
<area shape="rect" id="node3" href="#abipy.dfpt.ddb.DdbRobot" target="_top" title="This robot analyzes the results contained in multiple DDB_ files." alt="" coords="485,5,655,31"/>
<area shape="rect" id="node2" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,227,31"/>
</map><dl class="py attribute">
<dt id="abipy.dfpt.ddb.DdbRobot.EXT">
<code class="sig-name descname"><span class="pre">EXT</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'DDB'</span></em><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.EXT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.class_handles_filename">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">class_handles_filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.class_handles_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.class_handles_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude DDB.nc files. Override base class.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.from_mpid_list">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_mpid_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.from_mpid_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.from_mpid_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a DdbRobot from list of materials-project ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpid_list</strong> – List of Materials Project material_ids (e.g., [“mp-1234”, “mp-1245”]).</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject REST interface.
If None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in your .pmgrc.yaml.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.get_dataframe_at_qpoint">
<code class="sig-name descname"><span class="pre">get_dataframe_at_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abspath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.get_dataframe_at_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.get_dataframe_at_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Call anaddb to compute the phonon frequencies at a single q-point using the DDB files treated
by the robot and the given anaddb input arguments. LO-TO splitting is not included.
Build and return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – Reduced coordinates of the qpoint where phonon modes are computed</p></li>
<li><p><strong>units</strong> – string specifying the units used for ph frequencies.  Possible values in
(“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>with_geo</strong> – True if structure info should be added to the dataframe</p></li>
<li><p><strong>with_spglib</strong> – True to compute spglib space group and add it to the DataFrame.</p></li>
<li><p><strong>abspath</strong> – True if paths in index should be absolute. Default: Relative to getcwd().</p></li>
<li><p><strong>funcs</strong> – Function or list of functions to execute to add more data to the DataFrame.
Each function receives a <a class="reference internal" href="#abipy.dfpt.ddb.DdbFile" title="abipy.dfpt.ddb.DdbFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.ddb.DdbFile</span></code></a> object and returns a tuple (key, value)
where key is a string with the name of column and value is the value to be inserted.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.anaget_phonon_plotters">
<code class="sig-name descname"><span class="pre">anaget_phonon_plotters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anaget_phonon_plotters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anaget_phonon_plotters" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke anaddb to compute phonon bands and DOS using the arguments passed via **kwargs.
Collect results and return <cite>namedtuple</cite> with the following attributes:</p>
<blockquote>
<div><p>phbands_plotter: <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> object.
phdos_plotter: <a class="reference internal" href="#abipy.dfpt.phonons.PhononDosPlotter" title="abipy.dfpt.phonons.PhononDosPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDosPlotter</span></code></a> object.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.anacompare_elastic">
<code class="sig-name descname"><span class="pre">anacompare_elastic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_header_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anacompare_elastic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anacompare_elastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute elastic and piezoelectric properties for all DDBs in the robot and build DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_header_keys</strong> – List of keywords in the header of the DDB file
whose value will be added to the Dataframe.</p></li>
<li><p><strong>with_structure</strong> – True to add structure parameters to the DataFrame.</p></li>
<li><p><strong>with_spglib</strong> – True to compute spglib space group and add it to the DataFrame.</p></li>
<li><p><strong>with_path</strong> – True to add DDB path to dataframe</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <cite>ddb.anaget_elastic</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Return: DataFrame and list of ElastData objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.anacompare_becs">
<code class="sig-name descname"><span class="pre">anacompare_becs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_header_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anacompare_becs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anacompare_becs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Born effective charges for all DDBs in the robot and build DataFrame.
with Voigt indices as columns + metadata. Useful for convergence studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_header_keys</strong> – List of keywords in the header of the DDB file
whose value will be added to the Dataframe.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>tol</strong> – Elements below this value are set to zero.</p></li>
<li><p><strong>with_path</strong> – True to add DDB path to dataframe</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="k">with</span> <span class="n">Voigt</span> <span class="k">as</span> <span class="n">columns</span><span class="o">.</span>
<span class="n">becs_list</span><span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">Becs</span> <span class="n">objects</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.anacompare_epsinf">
<code class="sig-name descname"><span class="pre">anacompare_epsinf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_header_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anacompare_epsinf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anacompare_epsinf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute (eps^inf) electronic dielectric tensor for all DDBs in the robot and build DataFrame.
with Voigt indices as columns + metadata. Useful for convergence studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_header_keys</strong> – List of keywords in the header of the DDB file
whose value will be added to the Dataframe.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>tol</strong> – Elements below this value are set to zero.</p></li>
<li><p><strong>with_path</strong> – True to add DDB path to dataframe</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="k">with</span> <span class="n">Voigt</span> <span class="n">indices</span> <span class="k">as</span> <span class="n">columns</span><span class="o">.</span>
<span class="n">epsinf_list</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="o">|</span><span class="n">DielectricTensor</span><span class="o">|</span> <span class="n">objects</span> <span class="k">with</span> <span class="n">eps</span><span class="o">^</span><span class="p">{</span><span class="n">inf</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.anacompare_eps0">
<code class="sig-name descname"><span class="pre">anacompare_eps0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_header_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.anacompare_eps0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.anacompare_eps0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute (eps^0) dielectric tensor for all DDBs in the robot and build DataFrame.
with Voigt indices as columns + metadata. Useful for convergence studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_header_keys</strong> – List of keywords in the header of the DDB file
whose value will be added to the Dataframe.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>tol</strong> – Elements below this value are set to zero.</p></li>
<li><p><strong>with_path</strong> – True to add DDB path to dataframe</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information</p></li>
</ul>
</dd>
</dl>
<p>Return: <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="k">with</span> <span class="n">Voigt</span> <span class="k">as</span> <span class="n">columns</span><span class="o">.</span>
<span class="n">eps0_list</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="o">|</span><span class="n">DielectricTensor</span><span class="o">|</span> <span class="n">objects</span> <span class="k">with</span> <span class="n">eps</span><span class="o">^</span><span class="mf">0.</span>
<span class="n">dgen_list</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="n">DielectricTensorGenerator</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ddb.DdbRobot.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#DdbRobot.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.DdbRobot.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporary file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.ddb.get_2nd_ord_block_string">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ddb.</span></code><code class="sig-name descname"><span class="pre">get_2nd_ord_block_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ddb.html#get_2nd_ord_block_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ddb.get_2nd_ord_block_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function providing the lines required in a DDB file for a given
q point and second order derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpt</strong> – the fractional coordinates of the q point.</p></li>
<li><p><strong>data</strong> – a dictionary of the form {qpt: {(idir1, ipert1, idir2, ipert2): complex value}}
with the data that should be given in the string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the lines that can be added to the DDB file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.elastic">
<span id="elastic-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">elastic</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.elastic" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze elastic and piezoelectric tensors computed by anaddb.</p>
<dl class="py class">
<dt id="abipy.dfpt.elastic.MyElasticTensor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.elastic.</span></code><code class="sig-name descname"><span class="pre">MyElasticTensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#MyElasticTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.MyElasticTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.elasticity.elastic.html#pymatgen.analysis.elasticity.elastic.ElasticTensor" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.analysis.elasticity.elastic.ElasticTensor</span></code></a></p>
<dl class="py method">
<dt id="abipy.dfpt.elastic.MyElasticTensor.get_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#MyElasticTensor.get_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.MyElasticTensor.get_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with Voigt indices as colums (C-indexing starting from 0).
Useful to analyze the converge of individual elements of the tensor(s)
Elements below tol are set to zero.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.elastic.MyPiezoTensor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.elastic.</span></code><code class="sig-name descname"><span class="pre">MyPiezoTensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#MyPiezoTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.MyPiezoTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.piezo.html#pymatgen.analysis.piezo.PiezoTensor" title="(in pymatgen v2022.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.analysis.piezo.PiezoTensor</span></code></a></p>
<dl class="py method">
<dt id="abipy.dfpt.elastic.MyPiezoTensor.get_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#MyPiezoTensor.get_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.MyPiezoTensor.get_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with Voigt indices as colums (C-indexing starting from 0).
Useful to analyze the converge of individual elements of the tensor(s)
Elements below tol are set to zero.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.elastic.ElasticData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.elastic.</span></code><code class="sig-name descname"><span class="pre">ElasticData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elastic_clamped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elastic_relaxed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elastic_stress_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elastic_relaxed_fixed_D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piezo_clamped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piezo_relaxed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_piezo_relaxed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_piezo_relaxed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_piezo_relaxed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<p>Container with the different elastic and piezoelectric tensors
computed by anaddb. Data is stored in pymatgen tensor objects.</p>
<p>Provides methods to analyze/tabulate data
Se also <a class="reference external" href="http://progs.coudert.name/elate/mp?query=mp-2172">http://progs.coudert.name/elate/mp?query=mp-2172</a> for a web interface.</p>
<dl class="py attribute">
<dt id="abipy.dfpt.elastic.ElasticData.ALL_ELASTIC_TENSOR_NAMES">
<code class="sig-name descname"><span class="pre">ALL_ELASTIC_TENSOR_NAMES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('elastic_relaxed',</span> <span class="pre">'elastic_clamped',</span> <span class="pre">'elastic_stress_corr',</span> <span class="pre">'elastic_relaxed_fixed_D')</span></em><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.ALL_ELASTIC_TENSOR_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.elastic.ElasticData.ALL_PIEZOELECTRIC_TENSOR_NAMES">
<code class="sig-name descname"><span class="pre">ALL_PIEZOELECTRIC_TENSOR_NAMES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('piezo_relaxed',</span> <span class="pre">'piezo_clamped',</span> <span class="pre">'d_piezo_relaxed',</span> <span class="pre">'g_piezo_relaxed',</span> <span class="pre">'h_piezo_relaxed')</span></em><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.ALL_PIEZOELECTRIC_TENSOR_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.elastic.ElasticData.ALL_TENSOR_NAMES">
<code class="sig-name descname"><span class="pre">ALL_TENSOR_NAMES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">('elastic_relaxed',</span> <span class="pre">'elastic_clamped',</span> <span class="pre">'elastic_stress_corr',</span> <span class="pre">'elastic_relaxed_fixed_D',</span> <span class="pre">'piezo_relaxed',</span> <span class="pre">'piezo_clamped',</span> <span class="pre">'d_piezo_relaxed',</span> <span class="pre">'g_piezo_relaxed',</span> <span class="pre">'h_piezo_relaxed')</span></em><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.ALL_TENSOR_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.elastic.ElasticData.TYPE2NAMES">
<code class="sig-name descname"><span class="pre">TYPE2NAMES</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'all':</span> <span class="pre">('elastic_relaxed',</span> <span class="pre">'elastic_clamped',</span> <span class="pre">'elastic_stress_corr',</span> <span class="pre">'elastic_relaxed_fixed_D',</span> <span class="pre">'piezo_relaxed',</span> <span class="pre">'piezo_clamped',</span> <span class="pre">'d_piezo_relaxed',</span> <span class="pre">'g_piezo_relaxed',</span> <span class="pre">'h_piezo_relaxed'),</span> <span class="pre">'elastic':</span> <span class="pre">('elastic_relaxed',</span> <span class="pre">'elastic_clamped',</span> <span class="pre">'elastic_stress_corr',</span> <span class="pre">'elastic_relaxed_fixed_D'),</span> <span class="pre">'piezoelectric':</span> <span class="pre">('piezo_relaxed',</span> <span class="pre">'piezo_clamped',</span> <span class="pre">'d_piezo_relaxed',</span> <span class="pre">'g_piezo_relaxed',</span> <span class="pre">'h_piezo_relaxed')}</span></em><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.TYPE2NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.elastic.ElasticData.TENSOR_META">
<code class="sig-name descname"><span class="pre">TENSOR_META</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'d_piezo_relaxed':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">piezoelectric</span> <span class="pre">d</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(3,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${d}$',</span> <span class="pre">'units':</span> <span class="pre">'pc/m^2'},</span> <span class="pre">'elastic_clamped':</span> <span class="pre">{'info':</span> <span class="pre">'clamped-ion</span> <span class="pre">elastic</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(6,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${\\xoverline(C)}$',</span> <span class="pre">'units':</span> <span class="pre">'GPa'},</span> <span class="pre">'elastic_relaxed':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">elastic</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(6,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${C}$',</span> <span class="pre">'units':</span> <span class="pre">'GPa'},</span> <span class="pre">'elastic_relaxed_fixed_D':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">elastic</span> <span class="pre">tensor</span> <span class="pre">at</span> <span class="pre">fixed</span> <span class="pre">displacement</span> <span class="pre">field</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(6,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'$C^{(D)}$',</span> <span class="pre">'units':</span> <span class="pre">'GPa'},</span> <span class="pre">'elastic_stress_corr':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">elastic</span> <span class="pre">tensor</span> <span class="pre">considering</span> <span class="pre">the</span> <span class="pre">stress</span> <span class="pre">left</span> <span class="pre">inside</span> <span class="pre">cell</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(6,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${C^{\\sigma}}$',</span> <span class="pre">'units':</span> <span class="pre">'GPa'},</span> <span class="pre">'g_piezo_relaxed':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">piezoelectric</span> <span class="pre">g</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(3,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${g}$',</span> <span class="pre">'units':</span> <span class="pre">'m^2/c'},</span> <span class="pre">'h_piezo_relaxed':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">piezoelectric</span> <span class="pre">h</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(3,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${h}$',</span> <span class="pre">'units':</span> <span class="pre">'GN/c'},</span> <span class="pre">'piezo_clamped':</span> <span class="pre">{'info':</span> <span class="pre">'clamped-ion</span> <span class="pre">piezoelectric</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(3,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${\\xoverline(e)}$',</span> <span class="pre">'units':</span> <span class="pre">'c/m^2'},</span> <span class="pre">'piezo_relaxed':</span> <span class="pre">{'info':</span> <span class="pre">'relaxed-ion</span> <span class="pre">piezoelectric</span> <span class="pre">tensor</span> <span class="pre">in</span> <span class="pre">Voigt</span> <span class="pre">notation</span> <span class="pre">(shape:</span> <span class="pre">(3,</span> <span class="pre">6))',</span> <span class="pre">'latex':</span> <span class="pre">'${e}$',</span> <span class="pre">'units':</span> <span class="pre">'c/m^2'}}</span></em><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.TENSOR_META" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the object from an anaddb.nc file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.from_ncreader">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ncreader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.from_ncreader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.from_ncreader" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the object from a ETSF_Reader</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String represention with verbosity level <cite>verbose</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_tensor">
<code class="sig-name descname"><span class="pre">get_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return tensor from its name <cite>tensor_name</cite>.
Set to zero all entries below <cite>tol</cite> if <cite>tol</cite> is not None.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.name_tensor_list">
<code class="sig-name descname"><span class="pre">name_tensor_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.name_tensor_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.name_tensor_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of (name, tensor) tuples. Only tensors stored in the object are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_names</strong> – List of tensor names to select. None means all.</p></li>
<li><p><strong>tensor_type</strong> – Select tensors by type. Must be in [“all”, “elastic”, “piezoelectric”].</p></li>
<li><p><strong>tol</strong> – Set to zero all all entries below this threshold</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.fit_to_structure">
<code class="sig-name descname"><span class="pre">fit_to_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.fit_to_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.fit_to_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new ElasticData object with tensors that are invariant with respect to symmetry
operations corresponding to <cite>structure</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> from which to generate symmetry operations
If None, the internal structure is used.</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – symmetry tolerance for the Spacegroup Analyzer
used to generate the symmetry operations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.convert_to_ieee">
<code class="sig-name descname"><span class="pre">convert_to_ieee</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.convert_to_ieee"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.convert_to_ieee" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new set of tensors in IEEE format according to the 1987 IEEE standards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – A <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> structure associated with the
tensor to be converted to the IEEE standard
If None, the internal structure is used</p></li>
<li><p><strong>initial_fit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – flag to indicate whether initial
tensor is fit to the symmetry of the structure.
Defaults to true. Note that if false, inconsistent
results may be obtained due to symmetrically
equivalent, but distinct transformations
being used in different versions of spglib.</p></li>
<li><p><strong>refine_rotation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether to refine the rotation
produced by the ieee transform generator, default True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_elastic_tensor_dataframe">
<code class="sig-name descname"><span class="pre">get_elastic_tensor_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elastic_relaxed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_elastic_tensor_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_elastic_tensor_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_name</strong> – </p></li>
<li><p><strong>tol</strong> – set to zero all entries below this threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_piezoelectric_tensor_dataframe">
<code class="sig-name descname"><span class="pre">get_piezoelectric_tensor_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'piezo_relaxed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_piezoelectric_tensor_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_piezoelectric_tensor_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_name</strong> – </p></li>
<li><p><strong>tol</strong> – set to zero all entries below this threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_elastic_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_elastic_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voigt_as_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_elastic_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_elastic_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_piezo_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_piezo_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voigt_as_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_piezo_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_piezo_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_voigt_dataframe">
<code class="sig-name descname"><span class="pre">get_voigt_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voigt_as_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_voigt_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_voigt_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with Voigt indices as colums (C-indexing starting from 0).
Useful to analyze the converge of individual elements of the tensor(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor_names</strong> – List of tensor names.</p></li>
<li><p><strong>tol</strong> – Set to zero all all entries below a certain threshold</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.elastic.ElasticData.get_elastic_properties_dataframe">
<code class="sig-name descname"><span class="pre">get_elastic_properties_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties_as_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_base_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_to_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/elastic.html#ElasticData.get_elastic_properties_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.elastic.ElasticData.get_elastic_properties_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with properties derived from the elastic tensor
and the associated structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>[</strong><strong>&quot;elastic_relaxed&quot;</strong> (<em>tensor_names=</em>) – </p></li>
<li><p><strong>&quot;elastic_clamped&quot;</strong> – </p></li>
<li><p><strong>&quot;elastic_stress_corr&quot;</strong> – </p></li>
<li><p><strong>&quot;elastic_relaxed_fixed_D&quot;</strong><strong>]</strong> – </p></li>
<li><p><strong>properties_as_index</strong> – </p></li>
<li><p><strong>include_base_props</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether to include base properties, like k_vrh, etc.</p></li>
<li><p><strong>ignore_errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if set to true, will set problem properties
that depend on a physical tensor to None, defaults to False</p></li>
<li><p><strong>fit_to_structure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, properties are computed with the orginal tensors
and symmetrized tensors. An additional column <cite>fit_to_structure</cite> is added to the dataframe.</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – symmetry tolerance for the Spacegroup Analyzer
used to generate the symmetry operations if <cite>fit_to_structure</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.frozen_phonons">
<span id="frozen-phonons-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">frozen_phonons</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.frozen_phonons" title="Permalink to this headline">¶</a></h2>
<p>Objects to run and analyze the frozen phonons generated from displacements of atoms</p>
<dl class="py function">
<dt id="abipy.dfpt.frozen_phonons.quadratic_fit_function">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.frozen_phonons.</span></code><code class="sig-name descname"><span class="pre">quadratic_fit_function</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#quadratic_fit_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.quadratic_fit_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple quadratic function used as a default for the fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> – the variable</p></li>
<li><p><strong>aa</strong> – the coefficient of the quadratic term</p></li>
<li><p><strong>bb</strong> – the constant term</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.frozen_phonons.</span></code><code class="sig-name descname"><span class="pre">FrozenPhonon</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_displ_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized_displ_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class defining a set of structures with displaced atoms.
Provides methods to generate, interpolate and plot the data.</p>
<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.energies">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">energies</span></code><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Energies in eV corresponding to the the structures.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.qpt_cart_coords">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qpt_cart_coords</span></code><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.qpt_cart_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>The cartesian coordinates of the qpoint.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.n_displ">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">n_displ</span></code><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.n_displ" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of displacements.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.ieta0">
<code class="sig-name descname"><span class="pre">ieta0</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.ieta0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.ieta0" title="Permalink to this definition">¶</a></dt>
<dd><p>The index corresponding to the structure with no displacements.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.from_phbands">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_phbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phbands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.from_phbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.from_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instace of FrozenPhonon using the eigendisplacements from a <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phbands</strong> – a <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> instance.</p></li>
<li><p><strong>qpt_frac_coords</strong> – q vector in reduced coordinate in reciprocal space or index of the qpoint.</p></li>
<li><p><strong>imode</strong> – index of the mode.</p></li>
<li><p><strong>etas</strong> – list of amplitudes of the displacement to be applied to the system. Will correspond to the
largest displacement of one atom in Angstrom.</p></li>
<li><p><strong>scale_matrix</strong> – the scaling matrix of the supercell. If None a scaling matrix suitable for
the qpoint will be determined.</p></li>
<li><p><strong>max_supercell</strong> – mandatory if scale_matrix is None, ignored otherwise. Defines the largest
supercell in the search for a scaling matrix suitable for the q point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A FrozenPhonon.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.mass_factor">
<code class="sig-name descname"><span class="pre">mass_factor</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.mass_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.mass_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>The factor accounting for the different masses and displacement of each atom</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.fit_to_frequency">
<code class="sig-name descname"><span class="pre">fit_to_frequency</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_fit_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fit_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.fit_to_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.fit_to_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the energies and the displacements to calculate the phonon frequency corresponding to the quadratic
term of the fit.
The fit is performed with scipy.optimize.curve_fit based on the function given in input and can also be
limited number to a subset of the values of the displacements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_function</strong> – a function that will be used to fit the data. The first parameter should be the coefficient
of the quadratic term. If None a simple quadratic fit will be used.</p></li>
<li><p><strong>units</strong> – units of the output frequency. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>min_fit_eta</strong> – if not None represents minimum value allowed for the (signed) eta to be used in the fit.</p></li>
<li><p><strong>max_fit_eta</strong> – if not None represents maximum value allowed for the (signed) eta to be used in the fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the values of the frequency extracted from the fit,
‘fit_params’: the parameters obtained from the fit, ‘cov’: the estimated covariance of fit_params
(see scipy.optimize.curve_fit documentation for more details).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A namedtuple with ‘freq’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.plot_fit_energies">
<code class="sig-name descname"><span class="pre">plot_fit_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_fit_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fit_eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.plot_fit_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.plot_fit_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the displacements etas to the energies. See fit_to_frequency() for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_function</strong> – a function that will be used to fit the data. The first parameter should be the coefficient
of the quadratic term. If None a simple quadratic fit will be used.</p></li>
<li><p><strong>min_fit_eta</strong> – if not None represents minimum value allowed for the (signed) eta to be used in the fit.</p></li>
<li><p><strong>max_fit_eta</strong> – if not None represents maximum value allowed for the (signed) eta to be used in the fit.</p></li>
<li><p><strong>freq</strong> – if not None the quadratic function with this frequency as a coefficient will be added to the plot.
freq in eV. Requires the 0 displacement to be present in the list of etas.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.frozen_phonons.FrozenPhonon.plot_anharmonic_contribution">
<code class="sig-name descname"><span class="pre">plot_anharmonic_contribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/frozen_phonons.html#FrozenPhonon.plot_anharmonic_contribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.frozen_phonons.FrozenPhonon.plot_anharmonic_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the the absolute relative difference between the energies extracted from the frequency as
quadratic coefficient and the calculated energies, giving an estimate of the anharmonic contribution
Requires the 0 displacement to be present in the list of etas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq</strong> – phonon frequncy in eV</p></li>
<li><p><strong>relative</strong> – if True the plot will represent the relative difference with respect to the expected value
obtained from the frequency, rather than the absolute difference.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.gruneisen">
<span id="gruneisen-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.gruneisen" title="Permalink to this headline">¶</a></h2>
<p>Objects to analyze the results stored in the GRUNS.nc file produced by anaddb.</p>
<dl class="py class">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.gruneisen.</span></code><code class="sig-name descname"><span class="pre">GrunsNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>This object provides an interface to the <code class="docutils literal notranslate"><span class="pre">GRUNS.nc</span></code> file produced by abinit.
This file contains Grunesein parameters computed via finite difference.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">GrunsNcFile</span><span class="p">(</span><span class="s2">&quot;foo_GRUNS.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-f83cee54bfe3a86a57b5bf11885a07ceae44064e.png" alt="Inheritance diagram of GrunsNcFile" usemap="#inheritance5d50b201b3" class="inheritance graphviz" /></div>
<map id="inheritance5d50b201b3" name="inheritance5d50b201b3">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="244,104,444,129"/>
<area shape="rect" id="node5" href="#abipy.dfpt.gruneisen.GrunsNcFile" target="_top" title="This object provides an interface to the ``GRUNS.nc`` file produced by abinit." alt="" coords="503,55,723,80"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="237,5,451,31"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="233,55,455,80"/>
</map><dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> corresponding to the central point V0.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.iv0">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">iv0</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.iv0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.doses">
<code class="sig-name descname"><span class="pre">doses</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.doses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the phonon doses.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.wvols_qibz">
<code class="sig-name descname"><span class="pre">wvols_qibz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.wvols_qibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.wvols_qibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Phonon frequencies on regular grid for the different volumes in eV</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.qibz">
<code class="sig-name descname"><span class="pre">qibz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.qibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.qibz" title="Permalink to this definition">¶</a></dt>
<dd><p>q-points in the irreducible brillouin zone</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.gvals_qibz">
<code class="sig-name descname"><span class="pre">gvals_qibz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.gvals_qibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.gvals_qibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Gruneisen parameters in the irreducible brillouin zone</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.phbands_qpath_vol">
<code class="sig-name descname"><span class="pre">phbands_qpath_vol</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.phbands_qpath_vol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.phbands_qpath_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> objects corresponding to the different volumes.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.structures">
<code class="sig-name descname"><span class="pre">structures</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.structures" title="Permalink to this definition">¶</a></dt>
<dd><p>List of structures</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.volumes">
<code class="sig-name descname"><span class="pre">volumes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.volumes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.volumes" title="Permalink to this definition">¶</a></dt>
<dd><p>List of volumes</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.phdispl_cart_qibz">
<code class="sig-name descname"><span class="pre">phdispl_cart_qibz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.phdispl_cart_qibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.phdispl_cart_qibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigendisplacements for the modes on the qibz</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.nvols">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nvols</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.nvols" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of volumes</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.amu_symbol">
<code class="sig-name descname"><span class="pre">amu_symbol</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.amu_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.amu_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic mass units</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.to_dataframe">
<code class="sig-name descname"><span class="pre">to_dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div><p>[‘qidx’, ‘mode’, ‘freq’, ‘qpoint’]</p>
</div></blockquote>
<p>where:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>qidx</p></td>
<td><p>q-point index.</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>phonon branch index.</p></td>
</tr>
<tr class="row-even"><td><p>grun</p></td>
<td><p>Gruneisen parameter.</p></td>
</tr>
<tr class="row-odd"><td><p>groupv</p></td>
<td><p>Group velocity.</p></td>
</tr>
<tr class="row-even"><td><p>freq</p></td>
<td><p>Phonon frequency in eV.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_doses">
<code class="sig-name descname"><span class="pre">plot_doses</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_idos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_doses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the different DOSes stored in the GRUNS.nc file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlims</strong> – Set the data limits for the x-axis in eV. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>dos_names</strong> – List of strings defining the DOSes to plot. Use “all” to plot all DOSes available.</p></li>
<li><p><strong>with_idos</strong> – True to display integrated doses.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.get_plotter">
<code class="sig-name descname"><span class="pre">get_plotter</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.get_plotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.get_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> that can be use to plot
multiple phonon bands or animate the bands</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_phbands_with_gruns">
<code class="sig-name descname"><span class="pre">plot_phbands_with_gruns</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill_with</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gruns'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_doses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_phbands_with_gruns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_phbands_with_gruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon bands corresponding to <code class="docutils literal notranslate"><span class="pre">V0</span></code> (the central point) with markers
showing the value and the sign of the Grunesein parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fill_with</strong> – Define the quantity used to plot stripes. “gruns” for Grunesein parameters, “gruns_fd” for
Grunesein parameters calculated with finite differences,  “groupv” for phonon group velocities.</p></li>
<li><p><strong>gamma_fact</strong> – Scaling factor for Grunesein parameters.
Up triangle for positive values, down triangles for negative values.</p></li>
<li><p><strong>alpha</strong> – The alpha blending value for the markers between 0 (transparent) and 1 (opaque).</p></li>
<li><p><strong>with_doses</strong> – “all” to plot all DOSes available, <code class="docutils literal notranslate"><span class="pre">None</span></code> to disable DOS plotting,
else list of strings with the name of the DOSes to plot.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis in eV. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>match_bands</strong> – if True tries to follow the band along the path based on the scalar product of the eigenvectors.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch index to plot (default: all branches are plotted).</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_gruns_scatter">
<code class="sig-name descname"><span class="pre">plot_gruns_scatter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gruns'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rainbow'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_gruns_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_gruns_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>A scatter plot of the values of the Gruneisen parameters or group velocities as a function
of the phonon frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – Define the plotted quantity. “gruns” for Grunesein parameters, “gruns_fd” for Grunesein
parameters calculated with finite differences,  “groupv” for phonon group velocities.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon frequencies. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>cmap</strong> – matplotlib colormap. If not None, points are colored according to the branch index.</p></li>
<li><p><strong>**kwargs</strong> – kwargs passed to the matplotlib function ‘scatter’. Size defaults to 10.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.split_gruns">
<code class="sig-name descname"><span class="pre">split_gruns</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.split_gruns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.split_gruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the values of the gruneisen along a path like for the phonon bands</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.split_dwdq">
<code class="sig-name descname"><span class="pre">split_dwdq</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.split_dwdq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.split_dwdq" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the values of the group velocities along a path like for the phonon bands</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.plot_gruns_bs">
<code class="sig-name descname"><span class="pre">plot_gruns_bs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gruns'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.plot_gruns_bs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.plot_gruns_bs" title="Permalink to this definition">¶</a></dt>
<dd><p>A plot of the values of the Gruneisen parameters or group velocities along the
high symmetry path.
By default only the calculated points will be displayed. If lines are required set a positive value for lw
and match_bands=True to obtained reasonable paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – Define the plotted quantity. “gruns” for Grunesein parameters, “gruns_fd” for Grunesein
parameters calculated with finite differences,  “groupv” for phonon group velocities.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch index to plot (default: all
branches are plotted).</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>match_bands</strong> – if True the bands will be matched based on the scalar product between the eigenvectors.</p></li>
<li><p><strong>**kwargs</strong> – kwargs passed to the matplotlib function ‘plot’. Marker size defaults to 4, line width to 0,
marker to ‘o’, color to black.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.phdos">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phdos</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> corresponding to iv0, if present in the file, None otherwise.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.average_gruneisen">
<code class="sig-name descname"><span class="pre">average_gruneisen</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_frequencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.average_gruneisen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.average_gruneisen" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the average of the Gruneisen based on the values on the regular grid.
If squared is True the average will use the squared value of the Gruneisen and a squared root
is performed on the final result.
Values associated to negative frequencies will be ignored.
See Scripta Materialia 129, 88 for definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – the temperature at which the average Gruneisen will be evaluated. If None the acoustic Debye
temperature is used (see acoustic_debye_temp).</p></li>
<li><p><strong>squared</strong> – if True the average is performed on the squared values of the Gruenisen.</p></li>
<li><p><strong>limit_frequencies</strong> – if None (default) no limit on the frequencies will be applied.
Possible values are “debye” (only modes with frequencies lower than the acoustic Debye
temperature) and “acoustic” (only the acoustic modes, i.e. the first three modes).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average Gruneisen parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.thermal_conductivity_slack">
<code class="sig-name descname"><span class="pre">thermal_conductivity_slack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">squared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_frequencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.thermal_conductivity_slack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.thermal_conductivity_slack" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the thermal conductivity at the acoustic Debye temperature wit the Slack formula,
using the average Gruneisen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>squared</strong> – if True the average is performed on the squared values of the Gruenisen</p></li>
<li><p><strong>limit_frequencies</strong> – if None (default) no limit on the frequencies will be applied.
Possible values are “debye” (only modes with frequencies lower than the acoustic Debye
temperature) and “acoustic” (only the acoustic modes, i.e. the first three modes).</p></li>
<li><p><strong>theta_d</strong> – the temperature used to estimate the average of the Gruneisen used in the
Slack formula. If None the  the acoustic Debye temperature is used (see
acoustic_debye_temp). Will also be considered as the Debye temperature in the
Slack formula.</p></li>
<li><p><strong>t</strong> – temperature at which the thermal conductivity is estimated. If None the value at
the calculated acoustic Debye temperature is given. The value is obtained as a
simple rescaling of the value at the Debye temperature.</p></li>
</ul>
</dd>
</dl>
<p>Returns: The value of the thermal conductivity in W/(m*K)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.debye_temp">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">debye_temp</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.debye_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Debye temperature in K obtained from the phonon DOS</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.acoustic_debye_temp">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">acoustic_debye_temp</span></code><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.acoustic_debye_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Acoustic Debye temperature in K, i.e. the Debye temperature divided by nsites**(1/3).
Obtained from the phonon DOS</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.from_ddb_list">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ddb_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nqsmall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qppa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndivsm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tetra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_to_splitting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qptbounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.from_ddb_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.from_ddb_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute anaddb to compute generate the object from a list of ddbs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_list</strong> – A list with the paths to the ddb_files at different volumes. There should be an odd number of
DDB files and the volume increment must be constant. The DDB files will be ordered according to the
volume of the unit cell and the middle one will be considered as the DDB at the relaxed volume.</p></li>
<li><p><strong>nqsmall</strong> – Defines the homogeneous q-mesh used for the DOS. Gives the number of divisions
used to sample the smallest lattice vector. If 0, DOS is not computed and
(phbst, None) is returned.</p></li>
<li><p><strong>qppa</strong> – Defines the homogeneous q-mesh used for the DOS in units of q-points per reciprocal atom.
Overrides nqsmall.</p></li>
<li><p><strong>ndivsm</strong> – Number of division used for the smallest segment of the q-path.</p></li>
<li><p><strong>line_density</strong> – Defines the a density of k-points per reciprocal atom to plot the phonon dispersion.
Overrides ndivsm.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dos_method</strong> – Technique for DOS computation in  Possible choices: “tetra”, “gaussian” or “gaussian:0.001 eV”.
In the later case, the value 0.001 eV is used as gaussian broadening.</p></li>
<li><p><strong>lo_to_splitting</strong> – Allowed values are [True, False, “automatic”]. Defaults to “automatic”
If True the LO-TO splitting will be calculated and the non_anal_directions
and the non_anal_phfreqs attributes will be addeded to the phonon band structure.
“automatic” activates LO-TO if the DDB file contains the dielectric tensor and Born effective charges.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default).</p></li>
<li><p><strong>qptbounds</strong> – Boundaries of the path. If None, the path is generated from an internal database
depending on the input structure.</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file.</p></li>
</ul>
</dd>
</dl>
<p>Returns: A GrunsNcFile object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.grun_vals_finite_differences">
<code class="sig-name descname"><span class="pre">grun_vals_finite_differences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match_eigv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.grun_vals_finite_differences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.grun_vals_finite_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Gruneisen parameters along the high symmetry path calculated with finite differences.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.split_gruns_finite_differences">
<code class="sig-name descname"><span class="pre">split_gruns_finite_differences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match_eigv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.split_gruns_finite_differences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.split_gruns_finite_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the values of the finite differences gruneisen along a path like for the phonon bands</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsNcFile.gvals_qibz_finite_differences">
<code class="sig-name descname"><span class="pre">gvals_qibz_finite_differences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match_eigv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsNcFile.gvals_qibz_finite_differences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsNcFile.gvals_qibz_finite_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Gruneisen parameters in the irreducible brillouin zone calculated with finite differences.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.gruneisen.GrunsReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.gruneisen.</span></code><code class="sig-name descname"><span class="pre">GrunsReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads the results stored in the GRUNS.nc file produced by ABINIT.
It provides helper functions to access the most important quantities.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-aa3c7237b36deda9614223eb19895b945c0a017f.png" alt="Inheritance diagram of GrunsReader" usemap="#inheritanced0ee4d5629" class="inheritance graphviz" /></div>
<map id="inheritanced0ee4d5629" name="inheritanced0ee4d5629">
<area shape="rect" id="node1" href="#abipy.dfpt.gruneisen.GrunsReader" target="_top" title="This object reads the results stored in the GRUNS.nc file produced by ABINIT." alt="" coords="604,4,764,22"/>
<area shape="rect" id="node2" href="iotools_api.html#abipy.iotools.ETSF_Reader" target="_top" title="Provides high&#45;level API to read data from netcdf files written" alt="" coords="438,4,570,22"/>
</map><dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_doses">
<code class="sig-name descname"><span class="pre">read_doses</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_doses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_doses" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.collections.AttrDict</span></code></a> with the DOSes available in the file. Empty dict if
DOSes are not available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_phbands_on_qpath">
<code class="sig-name descname"><span class="pre">read_phbands_on_qpath</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_phbands_on_qpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_phbands_on_qpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> computed at the different volumes.
The <code class="docutils literal notranslate"><span class="pre">iv0</span></code> entry corresponds to the central point used to compute Grunesein parameters
with finite differences. This object stores the Grunesein parameters in <code class="docutils literal notranslate"><span class="pre">grun_vals</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_amuz_dict">
<code class="sig-name descname"><span class="pre">read_amuz_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_amuz_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_amuz_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary that associates the atomic number to the values of the atomic
mass units used for the calculation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.gruneisen.GrunsReader.read_structures">
<code class="sig-name descname"><span class="pre">read_structures</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#GrunsReader.read_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.GrunsReader.read_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Resturns a list of structures at the different volumes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.gruneisen.calculate_gruns_finite_differences">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.gruneisen.</span></code><code class="sig-name descname"><span class="pre">calculate_gruns_finite_differences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iv0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#calculate_gruns_finite_differences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.calculate_gruns_finite_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Gruneisen parameters from finite differences on the phonon frequencies.
Uses the eigenvectors to match the frequencies at different volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phfreqs</strong> – numpy array with the phonon frequencies at different volumes. Shape (nvols, nqpts, 3*natoms)</p></li>
<li><p><strong>eig</strong> – numpy array with the phonon eigenvectors at the different volumes. Shape (nvols, nqpts, 3*natoms, 3*natoms)
If None simple ordering will be used.</p></li>
<li><p><strong>iv0</strong> – index of the 0 volume.</p></li>
<li><p><strong>volume</strong> – volume of the structure at the central volume.</p></li>
<li><p><strong>dv</strong> – volume variation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array with the gruneisen parameters. Shape (nqpts, 3*natoms)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.gruneisen.thermal_conductivity_slack">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.gruneisen.</span></code><code class="sig-name descname"><span class="pre">thermal_conductivity_slack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/gruneisen.html#thermal_conductivity_slack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.gruneisen.thermal_conductivity_slack" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function for the calculation of the thermal conductivity at the acoustic Debye
temperature with the Slack formula, based on the quantities that can be calculated.
Can be used to calculate the thermal conductivity with different definitions of
the Gruneisen parameters or of the Debye temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>average_mass</strong> – average mass in atomic units of the atoms of the system.</p></li>
<li><p><strong>volume</strong> – volume of the unit cell.</p></li>
<li><p><strong>mean_g</strong> – the mean of the Gruneisen parameters.</p></li>
<li><p><strong>theta_d</strong> – the Debye temperature in the Slack formula.</p></li>
<li><p><strong>t</strong> – temperature at which the thermal conductivity is estimated. If None theta_d is used.
The value is obtained as a simple rescaling of the value at the Debye temperature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the thermal conductivity in W/(m*K)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.ifc">
<span id="ifc-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ifc</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.ifc" title="Permalink to this headline">¶</a></h2>
<p>The interatomic force constants calculated by anaddb.</p>
<dl class="py class">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.ifc.</span></code><code class="sig-name descname"><span class="pre">InteratomicForceConstants</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbours_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifc_cart_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifc_cart_coord_short_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_cart_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifc_weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>The interatomic force constants calculated by anaddb.
Read from anaddb.nc</p>
<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.number_of_atoms">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">number_of_atoms</span></code><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.number_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms is structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.number_of_neighbours">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">number_of_neighbours</span></code><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.number_of_neighbours" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of neighbouring atoms for which the ifc are present. ifcout in anaddb.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.ifc_cart_coord_ewald">
<code class="sig-name descname"><span class="pre">ifc_cart_coord_ewald</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.ifc_cart_coord_ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.ifc_cart_coord_ewald" title="Permalink to this definition">¶</a></dt>
<dd><p>Ewald part of the ifcs in cartesian coordinates</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord">
<code class="sig-name descname"><span class="pre">ifc_local_coord</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.ifc_local_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Ifcs in local coordinates</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord_short_range">
<code class="sig-name descname"><span class="pre">ifc_local_coord_short_range</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.ifc_local_coord_short_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord_short_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Short range part of the ifcs in cartesian coordinates</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord_ewald">
<code class="sig-name descname"><span class="pre">ifc_local_coord_ewald</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.ifc_local_coord_ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.ifc_local_coord_ewald" title="Permalink to this definition">¶</a></dt>
<dd><p>Ewald part of the ifcs in local coordinates</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.get_ifc_cartesian">
<code class="sig-name descname"><span class="pre">get_ifc_cartesian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.get_ifc_cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.get_ifc_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters the IFCs in cartesian coordinates
All the arguments are optional. If None the filter will not be applied.
Returns two arrays containing the distances and the corresponding filtered ifcs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.get_ifc_local">
<code class="sig-name descname"><span class="pre">get_ifc_local</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.get_ifc_local"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.get_ifc_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters the IFCs in local coordinates
All the arguments are optional. If None the filter will not be applied.
Returns two arrays containing the distances and the corresponding filtered ifcs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.get_plot_ifc">
<code class="sig-name descname"><span class="pre">get_plot_ifc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ifc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.get_plot_ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.get_plot_ifc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the specified ifcs, filtered according to the optional arguments.
An array with shape number_of_atoms*number_of_neighbours, so only one of the components of the ifc matrix can
be plotted at a time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ifc</strong> – an array with shape number_of_atoms * number_of_neighbours of the ifc that should be plotted</p></li>
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – kwargs passed to the matplotlib function ‘plot’. Color defaults to blue, symbol to ‘o’ and lw to 0</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc">
<code class="sig-name descname"><span class="pre">plot_longitudinal_ifc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.plot_longitudinal_ifc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the total longitudinal ifcs in local coordinates, filtered according to the optional arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – kwargs passed to the matplotlib function ‘plot’. Color defaults to blue, symbol to ‘o’ and lw to 0</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc_short_range">
<code class="sig-name descname"><span class="pre">plot_longitudinal_ifc_short_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.plot_longitudinal_ifc_short_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc_short_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the short range longitudinal ifcs in local coordinates, filtered according to the optional arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – kwargs passed to the matplotlib function ‘plot’. Color defaults to blue, symbol to ‘o’ and lw to 0</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc_ewald">
<code class="sig-name descname"><span class="pre">plot_longitudinal_ifc_ewald</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbour_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/ifc.html#InteratomicForceConstants.plot_longitudinal_ifc_ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.ifc.InteratomicForceConstants.plot_longitudinal_ifc_ewald" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the Ewald part of the ifcs in local coordinates, filtered according to the optional arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> – a list of atom indices in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>atom_element</strong> – symbol of an element in the structure. Only neighbours of these atoms will be considered.</p></li>
<li><p><strong>neighbour_element</strong> – symbol of an element in the structure. Only neighbours of this specie will be considered.</p></li>
<li><p><strong>min_dist</strong> – minimum distance between atoms and neighbours.</p></li>
<li><p><strong>max_dist</strong> – maximum distance between atoms and neighbours.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – kwargs passed to the matplotlib function ‘plot’. Color defaults to blue, symbol to ‘o’ and lw to 0</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.msqdos">
<span id="msqdos-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msqdos</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.msqdos" title="Permalink to this headline">¶</a></h2>
<p>Objects related to the computation of Debye-Waller tensors from the generalized phonon DOS.</p>
<dl class="py class">
<dt id="abipy.dfpt.msqdos.MsqDos">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.msqdos.</span></code><code class="sig-name descname"><span class="pre">MsqDos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu_symbol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>This object stores the generalized phonon DOS in CARTESIAN coords.
This DOS-like quantity allows one to calculate Debye Waller factors as a function of Temperature
by integration with 1/omega and the Bose-Einstein factor.
This object is usually instanciated via the read_msq_dos method of the PhdosReader
and stored as attribute of the PhdosFile instance.</p>
<p>See <a class="bibtex reference internal" href="../zzbiblio.html#lee1995" id="id8">[Lee1995]</a> for the further details about the internal implementation and
<a class="bibtex reference internal" href="../zzbiblio.html#trueblood1996" id="id9">[Trueblood1996]</a> for the different conventions used by crystallographers.</p>
<p>See also <a class="reference external" href="http://atztogo.github.io/phonopy/formulation.html#thermal-displacement">http://atztogo.github.io/phonopy/formulation.html#thermal-displacement</a></p>
<dl class="py attribute">
<dt id="abipy.dfpt.msqdos.MsqDos.ALL_COMPS">
<code class="sig-name descname"><span class="pre">ALL_COMPS</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'trace':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'xx':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'xy':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'xz':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'yy':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'yz':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;,</span> <span class="pre">'zz':</span> <span class="pre">&lt;abipy.dfpt.msqdos._Component</span> <span class="pre">object&gt;}</span></em><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.ALL_COMPS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful information on the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – Verbosity level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.get_json_doc">
<code class="sig-name descname"><span class="pre">get_json_doc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.get_json_doc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.get_json_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary with results. Used by emmet builder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.get_msq_tmesh">
<code class="sig-name descname"><span class="pre">get_msq_tmesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iatom_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('displ',</span> <span class="pre">'vel')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.get_msq_tmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.get_msq_tmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mean square displacement for each atom in <cite>iatom_list</cite> as a function of T.
in Cartesian coordinates and atomic-units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmesh</strong> – array-like with temperatures in Kelvin.</p></li>
<li><p><strong>iatom_list</strong> – List of atom sites to compute. None if all aomts are wanted.</p></li>
<li><p><strong>what_list</strong> – “displ” for displacement, “vel” for velocity tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>namedtuple with (tmesh=tmesh, displ=msq_d, vel=msq_v)</p>
<p>msq_d = np.empty((natom, 3, 3, nt))</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.convert_ucart">
<code class="sig-name descname"><span class="pre">convert_ucart</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ucart_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.convert_ucart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.convert_ucart" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the U tensor from Cartesian coordinates to format <cite>fmt</cite>
Return new tensor. See also <a class="bibtex reference internal" href="../zzbiblio.html#grosse-kunstleve2002" id="id10">[Grosse-Kunstleve2002]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ucart_mat</strong> – (natom,3,3) array with tensor in Cartesian coords.</p></li>
<li><p><strong>fmt</strong> – Output format. Available options: “cif”, “ustar”, “beta”, “cartesian”</p></li>
</ul>
</dd>
</dl>
<p>Return: (natom, 3, 3) tensor.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cartesian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'displ'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with cartesian tensor components as columns and (inequivalent) sites along the rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – Temperature in Kelvin.</p></li>
<li><p><strong>fmt</strong> – “cartesian” for elements in Cartesian coordinates, “cif” for results in reduced coordinates</p></li>
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>what</strong> – “displ” for displament, “vel” for velocity.</p></li>
<li><p><strong>decimals</strong> – Number of decimal places to round to.
If decimals is negative, it specifies the number of positions to the left of the decimal point.</p></li>
<li><p><strong>select_symbols</strong> – String or list of strings with chemical symbols. Used to select only atoms of this type.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.write_cif_file">
<code class="sig-name descname"><span class="pre">write_cif_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.write_cif_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.write_cif_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write CIF file with structure and anisotropic U tensor in CIF format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – Name of CIF file. If None, a temporary filepath is created.</p></li>
<li><p><strong>temp</strong> – Temperature in Kelvin (used to compute U).</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – If not none, finds the symmetry of the structure
and writes the cif with symmetry information. Passes symprec to the SpacegroupAnalyzer</p></li>
</ul>
</dd>
</dl>
<p>Return: Filepath</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.vesta_open">
<code class="sig-name descname"><span class="pre">vesta_open</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.vesta_open"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.vesta_open" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize termal displacement ellipsoids at temperature <cite>temp</cite> (Kelvin) with <a class="reference external" href="http://jp-minerals.org/vesta/en/">Vesta</a> application.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.get_cif_string">
<code class="sig-name descname"><span class="pre">get_cif_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.get_cif_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.get_cif_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with structure and anisotropic U tensor in CIF format at temperature <cite>temp</cite> in Kelvin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – If not none, finds the symmetry of the structure
and writes the cif with symmetry information. Passes symprec
to the SpacegroupAnalyzer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.check_site_symmetries">
<code class="sig-name descname"><span class="pre">check_site_symmetries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.check_site_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.check_site_symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Check site symmetries of the displacement tensor at temperature <cite>temp</cite> in Kelvin.
Return maximum error.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the generalized phonon DOS g_ij(omega, atom) for each atom in the unit cell.
One subplot per atom. Each subplot shows the 9 independent components of the symmetric tensor.
as a function of frequency. By default, only “inequivalent” atoms are shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>components</strong> – List of cartesian tensor components to plot e.g. [“xx”, “xy”].
“all” for all components. “upper” for the upper triangle, “diag” for diagonal elements.</p></li>
<li><p><strong>units</strong> – Units energy axis. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>select_symbols</strong> – String or list of strings with chemical symbols. Used to select only atoms of this type.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis.</p></li>
<li><p><strong>sharey</strong> – True if y-axis should be shared.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.plot_tensor">
<code class="sig-name descname"><span class="pre">plot_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'displ'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.plot_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.plot_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot tensor(T) for each atom in the unit cell.
One subplot for each component, each subplot show all inequivalent sites.
By default, only “inequivalent” atoms are shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate.</p></li>
<li><p><strong>components</strong> – “all” for all components. “diag” for diagonal elements, “offdiag” for off-diagonal terms only.</p></li>
<li><p><strong>what</strong> – “displ” for displament, “vel” for velocity.</p></li>
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>select_symbols</strong> – String or list of strings with chemical symbols. Used to select only atoms of this type.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.msqdos.MsqDos.plot_uiso">
<code class="sig-name descname"><span class="pre">plot_uiso</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'displ'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/msqdos.html#MsqDos.plot_uiso"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.msqdos.MsqDos.plot_uiso" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phonon PJDOS for each atom in the unit cell.
One subplot for each component, each subplot show all inequivalent sites.
By default, only “inequivalent” atoms are shown.</p>
<p>comparison of Ueq values, which
are calculated as the mean of the diagonal elements of the harmonic ADP tensor, (d)
comparison of the ADP anisotropy factor, which is defined as the ratio between maximum Uii
and minimum Uii values. A ratio of 1 would correspond to an isotropic displacement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate.</p></li>
<li><p><strong>components</strong> – “all” for all components. “diag” for diagonal elements, “offdiag” for off-diagonal terms only.</p></li>
<li><p><strong>what</strong> – “displ” for displament, “vel” for velocity.</p></li>
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>select_symbols</strong> – String or list of strings with chemical symbols. Used to select only atoms of this type.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>sharey</strong> – True if y-axis should be shared.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.phonons">
<span id="phonons-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phonons</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.phonons" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="abipy.dfpt.phonons.PhononBands">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhononBands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdispl_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_ph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsinf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zcart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Container object storing the phonon band structure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Frequencies are in eV. Cartesian displacements are in Angstrom.</p>
</div>
<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object from a <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit">netcdf</a> file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.as_phbands">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_phbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.as_phbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.as_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> from a generic object <code class="docutils literal notranslate"><span class="pre">obj</span></code>.
Supports:</p>
<blockquote>
<div><ul class="simple">
<li><p>instances of cls</p></li>
<li><p>files (string) that can be open with <code class="docutils literal notranslate"><span class="pre">abiopen</span></code> and that provide a <code class="docutils literal notranslate"><span class="pre">phbands</span></code> attribute.</p></li>
<li><p>objects providing a <code class="docutils literal notranslate"><span class="pre">phbands</span></code> attribute.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.phfactor_ev2units">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">phfactor_ev2units</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.phfactor_ev2units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.phfactor_ev2units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return conversion factor eV –&gt; units (case-insensitive)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.read_non_anal_from_file">
<code class="sig-name descname"><span class="pre">read_non_anal_from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.read_non_anal_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.read_non_anal_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the non analytical directions, frequencies and displacements from the anaddb.nc file
specified and adds them to the object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.nqpt">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nqpt</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.nqpt" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for num_qpoints.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_qpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful information such as structure, q-points, …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_structure</strong> – False if structural info should not be displayed.</p></li>
<li><p><strong>with_qpoints</strong> – False if q-point info shoud not be displayed.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.displ_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">displ_shape</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.displ_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of phdispl_cart.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.minfreq">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">minfreq</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.minfreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum phonon frequency.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.maxfreq">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">maxfreq</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.maxfreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum phonon frequency in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_minfreq_mode">
<code class="sig-name descname"><span class="pre">get_minfreq_mode</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_minfreq_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_minfreq_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the frequencies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_maxfreq_mode">
<code class="sig-name descname"><span class="pre">get_maxfreq_mode</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_maxfreq_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_maxfreq_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the minimum of the frequencies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of the array with the eigenvalues.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.linewidths">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">linewidths</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>linewidths in eV. <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape [nqpt, num_branches].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.has_linewidths">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_linewidths</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.has_linewidths" title="Permalink to this definition">¶</a></dt>
<dd><p>True if bands with linewidths.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.dyn_mat_eigenvect">
<code class="sig-name descname"><span class="pre">dyn_mat_eigenvect</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.dyn_mat_eigenvect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.dyn_mat_eigenvect" title="Permalink to this definition">¶</a></dt>
<dd><p>[nqpt, 3*natom, 3*natom] array with the orthonormal eigenvectors of the dynamical matrix.
in Cartesian coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_directions">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">non_anal_directions</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian directions along which the non analytical frequencies and displacements are available</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_phfreqs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">non_anal_phfreqs</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_phfreqs" title="Permalink to this definition">¶</a></dt>
<dd><p>Phonon frequencies with non analytical contribution in eV along non_anal_directions</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_phdispl_cart">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">non_anal_phdispl_cart</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_phdispl_cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Displacement in Cartesian coordinates with non analytical contribution along non_anal_directions</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.non_anal_dyn_mat_eigenvect">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">non_anal_dyn_mat_eigenvect</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.non_anal_dyn_mat_eigenvect" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalues of the dynamical matrix with non analytical contribution along non_anal_directions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.to_xmgrace">
<code class="sig-name descname"><span class="pre">to_xmgrace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_xmgrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_xmgrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <a class="reference external" href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a> file with phonon band structure energies and labels for high-symmetry q-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – String with filename or stream.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.qindex">
<code class="sig-name descname"><span class="pre">qindex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.qindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the qpoint. Accepts integer or reduced coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.qindex_qpoint">
<code class="sig-name descname"><span class="pre">qindex_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_non_analytical_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.qindex_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.qindex_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (qindex, qpoint) from an integer or a qpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>is_non_analytical_direction</strong> – True if qpoint should be interpreted as a fractional direction for q –&gt; 0
In this case qindex refers to the index of the direction in the <code class="xref py py-class docutils literal notranslate"><span class="pre">NonAnalyticalPh</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_unstable_modes">
<code class="sig-name descname"><span class="pre">get_unstable_modes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">below_mev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_unstable_modes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_unstable_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">PhononMode</span></code> objects with the unstable modes.
A mode is unstable if its frequency is &lt; below_mev. Output list is sorted
and modes with lowest frequency come first.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_dict4pandas">
<code class="sig-name descname"><span class="pre">get_dict4pandas</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_dict4pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_dict4pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the most important parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>Chemical formula and number of atoms.</p></li>
<li><p>Lattice lengths, angles and volume.</p></li>
<li><p>The spacegroup number computed by Abinit (set to None if not available).</p></li>
<li><p>The spacegroup number and symbol computed by spglib (set to None not <cite>with_spglib</cite>).</p></li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>with_spglib</strong> – If True, <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> is invoked to get the spacegroup symbol and number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_phdos">
<code class="sig-name descname"><span class="pre">get_phdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0004</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the phonon DOS on a linear mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – String defining the method</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Requires a homogeneous sampling of the Brillouin zone.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.create_xyz_vib">
<code class="sig-name descname"><span class="pre">create_xyz_vib</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iqpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_xyz_vib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_xyz_vib" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vibration XYZ file for visualization of phonons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iqpt</strong> – index of qpoint.</p></li>
<li><p><strong>filename</strong> – name of the XYZ file that will be created.</p></li>
<li><p><strong>pre_factor</strong> – Multiplication factor of the displacements.</p></li>
<li><p><strong>do_real</strong> – True if we want only real part of the displacement, False means imaginary part.</p></li>
<li><p><strong>scale_matrix</strong> – Scaling matrix of the supercell.</p></li>
<li><p><strong>max_supercell</strong> – Maximum size of the supercell with respect to primitive cell.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.create_ascii_vib">
<code class="sig-name descname"><span class="pre">create_ascii_vib</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iqpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_ascii_vib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_ascii_vib" title="Permalink to this definition">¶</a></dt>
<dd><p>Create vibration ascii file for visualization of phonons.
This format can be read with <a class="reference external" href="http://inac.cea.fr/L_Sim/V_Sim/">v_sim</a> or ascii-phonons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iqpts</strong> – an index or a list of indices of the qpoints in self. Note that at present only V_sim supports
an ascii file with multiple qpoints.</p></li>
<li><p><strong>filename</strong> – name of the ascii file that will be created.</p></li>
<li><p><strong>pre_factor</strong> – Multiplication factor of the displacements.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.view_phononwebsite">
<code class="sig-name descname"><span class="pre">view_phononwebsite</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.view_phononwebsite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.view_phononwebsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> file that can be parsed from the <a class="reference external" href="http://henriquemiranda.github.io/phononwebsite/">phononwebsite</a> and open it in <code class="docutils literal notranslate"><span class="pre">browser</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>browser</strong> – Open webpage in <code class="docutils literal notranslate"><span class="pre">browser</span></code>. Use default $BROWSER if None.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
<li><p><strong>dryrun</strong> – Activate dryrun mode for unit testing purposes.</p></li>
<li><p><strong>kwargs</strong> – Passed to create_phononwebsite_json method</p></li>
</ul>
</dd>
</dl>
<p>Return: Exit status</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.create_phononwebsite_json">
<code class="sig-name descname"><span class="pre">create_phononwebsite_json</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repetitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highsym_qpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highsym_qpts_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'std'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.create_phononwebsite_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.create_phononwebsite_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> file that can be parsed from the <a class="reference external" href="http://henriquemiranda.github.io/phononwebsite/">phononwebsite</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of the json file that will be created</p></li>
<li><p><strong>name</strong> – name associated with the data.</p></li>
<li><p><strong>repetitions</strong> – number of repetitions of the cell. List of three integers. Defaults to [3,3,3].</p></li>
<li><p><strong>highsym_qpts</strong> – list of tuples. The first element of each tuple should be a list with the coordinates
of a high symmetry point, the second element of the tuple should be its label.</p></li>
<li><p><strong>match_bands</strong> – if True tries to follow the band along the path based on the scalar product of the eigenvectors.</p></li>
<li><p><strong>highsym_qpts_mode</strong> – if <code class="docutils literal notranslate"><span class="pre">highsym_qpts</span></code> is None, high symmetry q-points can be automatically determined.
Accepts the following values:
‘split’ will split the path based on points where the path changes direction in the Brillouin zone.
Similar to what is done in phononwebsite. Only Gamma will be labeled.
‘std’ uses the standard generation procedure for points and labels used in PhononBands.
None does not set any point.</p></li>
<li><p><strong>indent</strong> – Indentation level, passed to json.dump</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.make_isodistort_ph_dir">
<code class="sig-name descname"><span class="pre">make_isodistort_ph_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.make_isodistort_ph_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.make_isodistort_ph_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute ph-freqs for given q-point (default: Gamma),
produce CIF files for unperturbed and distorded structure
that can be used with ISODISTORT (<a class="reference external" href="https://stokes.byu.edu/iso/isodistort.php">https://stokes.byu.edu/iso/isodistort.php</a>)
to analyze the symmetry of phonon modes.
See README.me file produced in output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – </p></li>
<li><p><strong>wordir</strong> – </p></li>
<li><p><strong>select_modes</strong> – </p></li>
<li><p><strong>eta</strong> – Amplitude of the displacement to be applied to the system. Will correspond to the
largest displacement of one atom in Angstrom.</p></li>
<li><p><strong>scale_matrix</strong> – the scaling matrix of the supercell. If None a scaling matrix suitable for
the qpoint will be determined.</p></li>
<li><p><strong>max_supercell</strong> – mandatory if scale_matrix is None, ignored otherwise. Defines the largest
supercell in the search for a scaling matrix suitable for the q point.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.decorate_ax">
<code class="sig-name descname"><span class="pre">decorate_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.decorate_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.decorate_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Add q-labels, title and unit name to axis ax.
Use units=”” to add k-labels without unit name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> – </p></li>
<li><p><strong>fontsize</strong> – </p></li>
<li><p><strong>qlabels</strong> – </p></li>
<li><p><strong>qlabel_size</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch index to plot (default: all branches are plotted).</p></li>
<li><p><strong>match_bands</strong> – if True the bands will be matched based on the scalar product between the eigenvectors.</p></li>
<li><p><strong>temp</strong> – Temperature in Kelvin. If not None, a scatter plot with the Bose-Einstein occupation factor
at temperature <cite>temp</cite> is added.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_ax">
<code class="sig-name descname"><span class="pre">plot_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the frequencies for the given branches indices as a function of the q-index on axis <code class="docutils literal notranslate"><span class="pre">ax</span></code>.
If <code class="docutils literal notranslate"><span class="pre">branch</span></code> is None, all phonon branches are plotted.</p>
<p>Return: The list of matplotlib lines added.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_colored_matched">
<code class="sig-name descname"><span class="pre">plot_colored_matched</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_colored_matched"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_colored_matched" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with different colors for each line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch_i index to plot
(default: all branches are plotted).</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap to determine the colors available. The colors will be chosen not in a
sequential order to avoid difficulties in distinguishing the lines.
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></p></li>
<li><p><strong>max_colors</strong> – maximum number of colors to be used. If max_colors &lt; num_braches the colors will be reapeated.
It useful to better distinguish close bands when the number of branch is large.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_lt_character">
<code class="sig-name descname"><span class="pre">plot_lt_character</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_lt_character"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_lt_character" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with colored lines. The color of the lines indicates
the degree to which the mode is longitudinal:
Red corresponds to longitudinal modes and black to purely transverse modes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – y-axis limits.</p></li>
<li><p><strong>colormap</strong> – Matplotlib colormap.</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.split_qpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">split_qpoints</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_qpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.split_phfreqs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">split_phfreqs</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_phfreqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.split_phdispl_cart">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">split_phdispl_cart</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_phdispl_cart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.split_matched_indices">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">split_matched_indices</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.split_matched_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of numpy arrays containing the indices in which each band should be sorted in order to match the
scalar product of the eigenvectors. The shape is the same as that of split_phfreqs.
Lazy property.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_fatbands">
<code class="sig-name descname"><span class="pre">plot_fatbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_eigvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stripe_width_mev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_fatbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_fatbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phonon fatbands and, optionally, atom-projected phonon DOSes.
The width of the band is given by ||v_{type}||
where v is the (complex) phonon displacement (eigenvector) in cartesian coordinates and
v_{type} selects only the terms associated to the atomic type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_eigvec</strong> – True if the width of the phonon branch should be computed from the eigenvectors.
False to use phonon displacements. Note that the PHDOS is always decomposed in
terms of (orthonormal) eigenvectors.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>colormap</strong> – Have a look at the colormaps here and decide which one you like:
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></p></li>
<li><p><strong>phdos_file</strong> – Used to activate fatbands + PJDOS plot.
Accept string with path of PHDOS.nc file or <a class="reference internal" href="#abipy.dfpt.phonons.PhdosFile" title="abipy.dfpt.phonons.PhdosFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhdosFile</span></code></a> object.</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</p></li>
<li><p><strong>max_stripe_width_mev</strong> – The maximum width of the stripe in meV. Will be rescaled according to <code class="docutils literal notranslate"><span class="pre">units</span></code>.</p></li>
<li><p><strong>width_ratios</strong> – Ratio between the width of the fatbands plots and the DOS plots.
Used if <cite>phdos_file</cite> is not None</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_with_phdos">
<code class="sig-name descname"><span class="pre">plot_with_phdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phdos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_with_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_with_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with the phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phdos</strong> – An instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> or a netcdf file providing a PhononDos object.</p></li>
<li><p><strong>units</strong> – Units for plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>ax_list</strong> – The axes for the bandstructure plot and the DOS plot. If ax_list is None, a new figure
is created and the two axes are automatically generated.</p></li>
<li><p><strong>width_ratios</strong> – Ratio between the width of the bands plots and the DOS plots.
Used if <code class="docutils literal notranslate"><span class="pre">ax_list</span></code> is None</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_phdispl">
<code class="sig-name descname"><span class="pre">plot_phdispl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_reduced_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_non_analytical_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eigvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hatches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sqrt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.3f'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_phdispl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_phdispl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot vertical bars with the contribution of the different atoms or atomic types to all the phonon modes
at a given <code class="docutils literal notranslate"><span class="pre">qpoint</span></code>. The contribution is given by ||v_{type}||
where v is the (complex) phonon displacement (eigenvector) in cartesian coordinates and
v_{type} selects only the terms associated to the atomic type.
Options allow to specify which atoms should be taken into account and how should be reparted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>cart_dir</strong> – “x”, “y”, or “z” to select a particular Cartesian directions. or combinations separated by “+”.
Example: “x+y”. None if no projection is wanted.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon frequencies. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>is_non_analytical_direction</strong> – If True, the <code class="docutils literal notranslate"><span class="pre">qpoint</span></code> is interpreted as a direction in q-space
and the phonon (displacements/eigenvectors) for q –&gt; 0 along this direction are used.
Requires band structure with <code class="xref py py-class docutils literal notranslate"><span class="pre">NonAnalyticalPh</span></code> object.</p></li>
<li><p><strong>use_eigvec</strong> – True if eigenvectors should be used instead of displacements (eigenvectors
are orthonormal, unlike diplacements)</p></li>
<li><p><strong>colormap</strong> – Matplotlib colormap used for atom type.</p></li>
<li><p><strong>hatches</strong> – List of strings with matplotlib hatching patterns. None or empty list to disable hatching.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>normalize</strong> – if True divides by the square norm of the total eigenvector</p></li>
<li><p><strong>use_sqrt</strong> – if True the square root of the sum of the components will be taken</p></li>
<li><p><strong>use_reduced_coords</strong> – if True coordinates will be converted to reduced coordinates. So the values will be
fraction of a,b,c rather than x,y,z.</p></li>
<li><p><strong>atoms_index</strong> – list of lists. Each list contains the indices of atoms in the structure that will be
summed on a separate group. if None all the atoms will be considered and grouped by type.</p></li>
<li><p><strong>labels_groups</strong> – If atoms_index is not None will provide the labels for each of the group in atoms_index.
Should have the same length of atoms_index or be None. If None automatic labelling will be used.</p></li>
<li><p><strong>branches</strong> – list of indices for the modes that should be represented. If None all the modes will be shown.</p></li>
<li><p><strong>format_w</strong> – string used to format the values of the frequency. Default “%.3f”.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_phdispl_cartdirs">
<code class="sig-name descname"><span class="pre">plot_phdispl_cartdirs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('x',</span> <span class="pre">'y',</span> <span class="pre">'z')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_non_analytical_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eigvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hatches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sqrt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.3f'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_phdispl_cartdirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_phdispl_cartdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot three panels. Each panel shows vertical bars with the contribution of the different atomic types
to all the phonon displacements at the given <code class="docutils literal notranslate"><span class="pre">qpoint</span></code> along on the Cartesian directions in <code class="docutils literal notranslate"><span class="pre">cart_dirs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>cart_dirs</strong> – List of strings defining the Cartesian directions. “x”, “y”, or “z” to select a particular
Cartesian directions. or combinations separated by “+”. Example: “x+y”.</p></li>
<li><p><strong>units</strong> – Units for phonon frequencies. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>is_non_analytical_direction</strong> – If True, the <code class="docutils literal notranslate"><span class="pre">qpoint</span></code> is interpreted as a direction in q-space
and the phonon (displacements/eigenvectors) for q –&gt; 0 along this direction are used.
Requires band structure with <code class="xref py py-class docutils literal notranslate"><span class="pre">NonAnalyticalPh</span></code> object.</p></li>
<li><p><strong>use_eigvec</strong> – True if eigenvectors should be used instead of displacements (eigenvectors
are orthonormal, unlike diplacements)</p></li>
<li><p><strong>colormap</strong> – Matplotlib colormap used for atom type.</p></li>
<li><p><strong>hatches</strong> – List of strings with matplotlib hatching patterns. None or empty list to disable hatching.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>normalize</strong> – if True divides by the square norm of the total eigenvector</p></li>
<li><p><strong>use_sqrt</strong> – if True the square root of the sum of the components will be taken
fraction of a,b,c rather than x,y,z.</p></li>
<li><p><strong>atoms_index</strong> – list of lists. Each list contains the indices of atoms in the structure that will be
summed on a separate group. if None all the atoms will be considered and grouped by type.</p></li>
<li><p><strong>labels_groups</strong> – If atoms_index is not None will provide the labels for each of the group in atoms_index.
Should have the same length of atoms_index or be None. If None automatic labelling will be used.</p></li>
<li><p><strong>branches</strong> – list of indices for the modes that should be represented. If None all the modes will be shown.</p></li>
<li><p><strong>format_w</strong> – string used to format the values of the frequency. Default “%.3f”.</p></li>
</ul>
</dd>
</dl>
<p>See plot_phdispl for the meaning of the other arguments.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the following columns:</p>
<blockquote>
<div><p>[‘qidx’, ‘mode’, ‘freq’, ‘qpoint’]</p>
</div></blockquote>
<p>where:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>qidx</p></td>
<td><p>q-point index.</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>phonon branch index.</p></td>
</tr>
<tr class="row-even"><td><p>freq</p></td>
<td><p>Phonon frequency in eV.</p></td>
</tr>
<tr class="row-odd"><td><p>qpoint</p></td>
<td><p><a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.boxplot">
<code class="sig-name descname"><span class="pre">boxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the mode index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>mode_range</strong> – Only modes such as <cite>mode_range[0] &lt;= mode_index &lt; mode_range[1]</cite> are included in the plot.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to seaborn boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.to_pymatgen">
<code class="sig-name descname"><span class="pre">to_pymatgen</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.to_pymatgen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal notranslate"><span class="pre">PhononBandStructureSymmLine</span></code> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):&quot;L&quot;}</span></code>.
If None labels will be determined automatically.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.from_pmg_bs">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_pmg_bs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pmg_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.from_pmg_bs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.from_pmg_bs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of the object from a <code class="xref py py-class docutils literal notranslate"><span class="pre">PhononBandStructureSymmLine</span></code> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pmg_bs</strong> – the instance of PhononBandStructureSymmLine.</p></li>
<li><p><strong>structure</strong> – a <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object. Should be present if the structure attribute is
not set in pmg_bs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.acoustic_indices">
<code class="sig-name descname"><span class="pre">acoustic_indices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_on_no_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.acoustic_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.acoustic_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the indices of the three acoustic modes for a qpoint.
Acoustic modes could be reasonably identified for Gamma and points close to Gamma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – the qpoint. Accepts integer or reduced coordinates</p></li>
<li><p><strong>threshold</strong> – fractional value allowed for the matching of the displacements to identify acoustic modes.</p></li>
<li><p><strong>raise_on_no_indices</strong> – if True a RuntimeError will be raised if the acoustic mode will not be
correctly identified. If False [0, 1, 2] will be returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.asr_breaking">
<code class="sig-name descname"><span class="pre">asr_breaking</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_on_no_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.asr_breaking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.asr_breaking" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the breaking of the acoustic sum rule.
Requires the presence of Gamma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – Units for the output. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>threshold</strong> – fractional value allowed for the matching of the displacements to identify acoustic modes.</p></li>
<li><p><strong>raise_on_no_indices</strong> – if True a RuntimeError will be raised if the acoustic mode will not be
correctly identified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the three breaking of the acoustic modes
the maximum breaking with sign
the absolute value of the maximum breaking</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A namedtuple with</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_frozen_phonons">
<code class="sig-name descname"><span class="pre">get_frozen_phonons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_frozen_phonons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_frozen_phonons" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a supercell with displaced atoms for the specified q-point and mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space or index of the qpoint.</p></li>
<li><p><strong>nmode</strong> – number of the mode.</p></li>
<li><p><strong>eta</strong> – pre-factor multiplying the displacement. Gives the value in Angstrom of the
largest displacement.</p></li>
<li><p><strong>scale_matrix</strong> – the scaling matrix of the supercell. If None a scaling matrix suitable for
the qpoint will be determined.</p></li>
<li><p><strong>max_supercell</strong> – mandatory if scale_matrix is None, ignored otherwise. Defines the largest
supercell in the search for a scaling matrix suitable for the q point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A namedtuple with a Structure with the displaced atoms, a numpy array containing the
displacements applied to each atom and the scale matrix used to generate the supercell.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.get_longitudinal_fraction">
<code class="sig-name descname"><span class="pre">get_longitudinal_fraction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.get_longitudinal_fraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.get_longitudinal_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates “longitudinal” fraction of the eigendisplacements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space or index of the qpoint.</p></li>
<li><p><strong>idir</strong> – an integer with the index of the non analytical direction if qpoint is gamma.
If None all will be given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array with the longitudinal fractions for each mode of the specified q point.
If qpoint is gamma and idir is None it will be a numpy array with all the non analytical
directions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_longitudinal_fraction">
<code class="sig-name descname"><span class="pre">plot_longitudinal_fraction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.3f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_longitudinal_fraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_longitudinal_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots an histogram “longitudinal” fraction of the eigendisplacements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space or index of the qpoint.</p></li>
<li><p><strong>idir</strong> – an integer with the index of the non analytical direction if qpoint is gamma.
If None all will be plot.</p></li>
<li><p><strong>ax_list</strong> – The axes for the plot. If ax_list is None, a new figure is created and
the axes are automatically generated.</p></li>
<li><p><strong>units</strong> – Units for the output. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>branches</strong> – list of indices for the modes that should be represented. If None all the modes will be shown.</p></li>
<li><p><strong>format_w</strong> – string used to format the values of the frequency. Default “%.3f”.</p></li>
<li><p><strong>fontsize</strong> – Labels and title fontsize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_longitudinal_fatbands">
<code class="sig-name descname"><span class="pre">plot_longitudinal_fatbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_degenerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_longitudinal_fatbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_longitudinal_fatbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure with width representing the longitudinal fraction of the fatbands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch index to plot (default: all branches are plotted).</p></li>
<li><p><strong>match_bands</strong> – if True the bands will be matched based on the scalar product between the eigenvectors.</p></li>
<li><p><strong>sum_degenerate</strong> – if True modes with similar frequencies will be considered as degenerated and their
contributions will be summed (squared sum). Notice that this may end up summing contributions
from modes that are just accidentally degenerated.</p></li>
<li><p><strong>factor</strong> – a float that will used to scale the width of the fatbands.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBands.plot_qpt_distance">
<code class="sig-name descname"><span class="pre">plot_qpt_distance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shiftq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBands.plot_qpt_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBands.plot_qpt_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the phonon band structure coloring the point according to the minimum distance of
the qpoints of the path from a list of qpoints. This can be for example defined as the
q-points effectively calculated in DFPT.
Optionally plot the explicit values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpt_list</strong> – list of fractional coordinates or KpointList of the qpoints from which the minimum
distance will be calculated.</p></li>
<li><p><strong>ngqpt</strong> – the division of a regular grid of qpoints. Used to automatically fill in the qpt_list
based on abipy.core.kpoints.kmesh_from_mpdivs.</p></li>
<li><p><strong>shiftq</strong> – the shifts of a regular grid of qpoints. Used to automatically fill in the qpt_list
based on abipy.core.kpoints.kmesh_from_mpdivs.</p></li>
<li><p><strong>plot_distances</strong> – if True a second plot will be added with the explicit values of the distances.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the q-points.
The values are the labels. e.g. <code class="docutils literal notranslate"><span class="pre">qlabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>branch_range</strong> – Tuple specifying the minimum and maximum branch_i index to plot
(default: all branches are plotted).</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap to determine the colors available.
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html</a></p></li>
<li><p><strong>match_bands</strong> – if True the bands will be matched based on the scalar product between the eigenvectors.</p></li>
<li><p><strong>log_scale</strong> – if True the values will be plotted in a log scale.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhononBandsPlotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_phbands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_phdos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting phonon band structure and DOSes.
Supports plots on the same graph or separated plots.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">PhononBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phbands</span><span class="p">(</span><span class="s2">&quot;foo bands&quot;</span><span class="p">,</span> <span class="s2">&quot;foo_PHBST.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phbands</span><span class="p">(</span><span class="s2">&quot;bar bands&quot;</span><span class="p">,</span> <span class="s2">&quot;bar_PHBST.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.add_plotter">
<code class="sig-name descname"><span class="pre">add_plotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.add_plotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.add_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two plotters, return new plotter.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">func=&lt;class</span> <span class="pre">'str'&gt;</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.has_same_formula">
<code class="sig-name descname"><span class="pre">has_same_formula</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.has_same_formula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.has_same_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>True of plotter contains structures with same chemical formula.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.get_phbands_frame">
<code class="sig-name descname"><span class="pre">get_phbands_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.get_phbands_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.get_phbands_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the most important results available in the band structures.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phbands_dict">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phbands_dict</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phbands_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phbands.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.bands_dict">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">bands_dict</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.bands_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phbands.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phdoses_dict">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phdoses_dict</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phdoses_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary with the mapping label –&gt; phdos.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phbands_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phbands_list</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phbands_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.phdoses_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phdoses_list</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.phdoses_list" title="Permalink to this definition">¶</a></dt>
<dd><p>“List of <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.iter_lineopt">
<code class="sig-name descname"><span class="pre">iter_lineopt</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.iter_lineopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.iter_lineopt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates matplotlib linestyles.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.add_phbands">
<code class="sig-name descname"><span class="pre">add_phbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.add_phbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.add_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a band structure for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – label for the bands. Must be unique.</p></li>
<li><p><strong>bands</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object.</p></li>
<li><p><strong>phdos</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object.</p></li>
<li><p><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal notranslate"><span class="pre">get_phdos</span></code> to compute the phonon DOS.
Used only if <code class="docutils literal notranslate"><span class="pre">phdos</span></code> is not None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.combiplot">
<code class="sig-name descname"><span class="pre">combiplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.combiplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS on the same figure.
Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot band structures on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>qlabels</strong> – dictionary whose keys are tuples with the reduced coordinates of the k-points.
The values are the labels e.g. <code class="docutils literal notranslate"><span class="pre">klabels</span> <span class="pre">=</span> <span class="pre">{(0.0,0.0,0.0):</span> <span class="pre">&quot;$\Gamma$&quot;,</span> <span class="pre">(0.5,0,0):</span> <span class="pre">&quot;L&quot;}</span></code>.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>width_ratios</strong> – Ratio between the width of the phonon bands plots and the DOS plots.
Used if plotter has DOSes.</p></li>
<li><p><strong>fontsize</strong> – fontsize for titles and legend.</p></li>
<li><p><strong>linestyle_dict</strong> – Dictionary mapping labels to matplotlib linestyle options.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for combiplot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.gridplot">
<code class="sig-name descname"><span class="pre">gridplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.gridplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple phonon bandstructures and optionally DOSes on a grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>with_dos</strong> – True to plot phonon DOS (if available).</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.gridplot_with_hue">
<code class="sig-name descname"><span class="pre">gridplot_with_hue</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.gridplot_with_hue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.gridplot_with_hue" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple phonon bandstructures and optionally DOSes on a grid.
Group results by <code class="docutils literal notranslate"><span class="pre">hue</span></code>.</p>
<p class="rubric">Example</p>
<p>plotter.gridplot_with_hue(“tsmear”)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hue</strong> – Variable that define subsets of the phonon bands, which will be drawn on separate plots.
Accepts callable or string
If string, it’s assumed that the phbands has an attribute with the same name and getattr is invoked.
Dot notation is also supported e.g. hue=”structure.formula” –&gt; abifile.structure.formula
If callable, the output of hue(phbands) is used.</p></li>
<li><p><strong>with_dos</strong> – True to plot phonon DOS (if available).</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>width_ratios</strong> – Ratio between the width of the fatbands plots and the DOS plots.
Used if plotter has PH DOSes is not None</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.boxplot">
<code class="sig-name descname"><span class="pre">boxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.boxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot to show distributions of eigenvalues with respect to the band index.
Band structures are drawn on different subplots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode_range</strong> – Only bands such as <code class="docutils literal notranslate"><span class="pre">mode_range[0]</span> <span class="pre">&lt;=</span> <span class="pre">nu_index</span> <span class="pre">&lt;</span> <span class="pre">mode_range[1]</span></code> are included in the plot.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>kwargs</strong> – Keywork arguments passed to <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.combiboxplot">
<code class="sig-name descname"><span class="pre">combiboxplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.combiboxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.combiboxplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> to draw a box plot comparing the distributions of the frequencies.
Phonon Band structures are drawn on the same plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode_range</strong> – Only bands such as <code class="docutils literal notranslate"><span class="pre">mode_range[0]</span> <span class="pre">&lt;=</span> <span class="pre">nu_index</span> <span class="pre">&lt;</span> <span class="pre">mode_range[1]</span></code> are included in the plot.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>swarm</strong> – True to show the datapoints on top of the boxes</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> boxplot.</p></li>
</ul>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.plot_phdispl">
<code class="sig-name descname"><span class="pre">plot_phdispl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.plot_phdispl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.plot_phdispl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot vertical bars with the contribution of the different atomic types to the phonon displacements
at a given q-point. One panel for all <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> stored in the plotter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to phbands.plot_phdispl</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.animate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib to animate a list of band structure plots (with or without DOS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval</strong> – draws a new frame every interval milliseconds.</p></li>
<li><p><strong>savefile</strong> – Use e.g. ‘myanimation.mp4’ to save the animation in mp4 format.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>width_ratios</strong> – Ratio between the band structure plot and the dos plot.
Used when there are DOS stored in the plotter.</p></li>
<li><p><strong>show</strong> – True if the animation should be shown immediately.</p></li>
</ul>
</dd>
</dl>
<p>Returns: Animation object.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="http://matplotlib.org/api/animation_api.html">http://matplotlib.org/api/animation_api.html</a>
<a class="reference external" href="http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/">http://jakevdp.github.io/blog/2012/08/18/matplotlib-animation-tutorial/</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It would be nice to animate the title of the plot, unfortunately
this feature is not available in the present version of matplotlib.
See: <a class="reference external" href="http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib">http://stackoverflow.com/questions/17558096/animated-title-in-matplotlib</a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.ipw_select_plot">
<code class="sig-name descname"><span class="pre">ipw_select_plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.ipw_select_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.get_panel">
<code class="sig-name descname"><span class="pre">get_panel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.get_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.get_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return tabs with widgets to interact with the <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a> file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononBandsPlotter.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononBandsPlotter.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononBandsPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhbstFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhbstFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_PhononBands" title="abipy.core.mixins.Has_PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_PhononBands</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Object used to access data stored in the PHBST.nc file produced by ABINIT.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-1b16099399cdf96b1cb1617b50814c4f0864f596.png" alt="Inheritance diagram of PhbstFile" usemap="#inheritancee7492c30a8" class="inheritance graphviz" /></div>
<map id="inheritancee7492c30a8" name="inheritancee7492c30a8">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="255,153,455,179"/>
<area shape="rect" id="node6" href="#abipy.dfpt.phonons.PhbstFile" target="_top" title="Object used to access data stored in the PHBST.nc file produced by ABINIT." alt="" coords="525,80,719,105"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_PhononBands" target="_top" title="Mixin class for |AbinitNcFile| containing phonon data." alt="" coords="233,5,477,31"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="249,55,462,80"/>
<area shape="rect" id="node5" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="245,104,466,129"/>
</map><dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – verbosity level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.qpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">qpoints</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>List of q-point objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.phbands">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phbands</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.phbands" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with parameters that might be subject to convergence studies.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.qindex">
<code class="sig-name descname"><span class="pre">qindex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.qindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the qpoint in the PhbstFile.
Accepts integer, vector with reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.qindex_qpoint">
<code class="sig-name descname"><span class="pre">qindex_qpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_non_analytical_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.qindex_qpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.qindex_qpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (qindex, qpoint).
Accepts integer, vector with reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.get_phframe">
<code class="sig-name descname"><span class="pre">get_phframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.get_phframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.get_phframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the phonon frequencies at the given q-point and
information on the crystal structure (used for convergence studies).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – integer, vector of reduced coordinates or <a class="reference internal" href="core_api.html#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> object.</p></li>
<li><p><strong>with_structure</strong> – True to add structural parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.get_phmode">
<code class="sig-name descname"><span class="pre">get_phmode</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.get_phmode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.get_phmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-class docutils literal notranslate"><span class="pre">PhononMode</span></code> with the given qpoint and branch nu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – Either a vector with the reduced components of the q-point
or an integer giving the sequential index (C-convention).</p></li>
<li><p><strong>branch</strong> – branch index (C-convention)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PhononMode</span></code> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhbstFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhbstFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhbstFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhononDos">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhononDos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a></p>
<p>This object stores the phonon density of states.
An instance of <code class="docutils literal notranslate"><span class="pre">PhononDos</span></code> has a <code class="docutils literal notranslate"><span class="pre">mesh</span></code> (numpy array with the points of the mesh)
and another numpy array, <code class="docutils literal notranslate"><span class="pre">values</span></code>, with the DOS on the mesh.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>mesh is given in eV, values are in states/eV.</p>
</div>
<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.as_phdos">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_phdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.as_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.as_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> from a generic obj. Supports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- instances of cls
- files (string) that can be open with abiopen and that provide one of the following attributes: [`phdos`, `phbands`]
- instances of |PhononBands|.
- objects providing a ``phbands`` attribute.
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <code class="docutils literal notranslate"><span class="pre">get_phdos</span></code> to compute the phonon DOS.</p></li>
<li><p><strong>when obj is not already an instance of cls</strong><strong> or </strong><strong>when we have to compute the DOS from obj.</strong> (<em>Used</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.iw0">
<code class="sig-name descname"><span class="pre">iw0</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.iw0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.iw0" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the first point in the mesh whose value is &gt;= 0</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.idos">
<code class="sig-name descname"><span class="pre">idos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.idos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrated DOS.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.zero_point_energy">
<code class="sig-name descname"><span class="pre">zero_point_energy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.zero_point_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.zero_point_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero point energy in eV per unit cell.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.plot_dos_idos">
<code class="sig-name descname"><span class="pre">plot_dos_idos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot_dos_idos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot_dos_idos" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot DOS/IDOS on the axis <code class="docutils literal notranslate"><span class="pre">ax</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a></p></li>
<li><p><strong>what</strong> – string selecting the quantity to plot:
“d” for DOS, “i” for IDOS. chars can be concatenated
hence what=”id” plots both IDOS and DOS. (default “d”).</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange axis</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>kwargs</strong> – Options passed to matplotlib plot method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of lines added to the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Phonon DOS and IDOS on two distict plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.get_internal_energy">
<code class="sig-name descname"><span class="pre">get_internal_energy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_internal_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_internal_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the internal energy, in eV, in the harmonic approximation for different temperatures
Zero point energy is included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with U(T) + ZPE.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.get_entropy">
<code class="sig-name descname"><span class="pre">get_entropy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entropy, in eV/K, in the harmonic approximation for different temperatures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with S(T).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.get_free_energy">
<code class="sig-name descname"><span class="pre">get_free_energy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_free_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the free energy, in eV, in the harmonic approximation for different temperatures
Zero point energy is included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with F(T) = U(T) + ZPE - T x S(T)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.get_cv">
<code class="sig-name descname"><span class="pre">get_cv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the constant-volume specific heat, in eV/K, in the harmonic approximation
for different temperatures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – optional Number of samples to generate. Default is 50.</p></li>
</ul>
</dd>
</dl>
<p>Return: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a> object with C_v(T).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.plot_harmonic_thermo">
<code class="sig-name descname"><span class="pre">plot_harmonic_thermo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.plot_harmonic_thermo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.plot_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot thermodynamic properties from the phonon DOSes within the harmonic approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 50.</p></li>
<li><p><strong>quantities</strong> – List of strings specifying the thermodynamic quantities to plot.
Possible values: [“internal_energy”, “free_energy”, “entropy”, “c_v”].
None means all.</p></li>
<li><p><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</p></li>
<li><p><strong>formula_units</strong> – the number of formula units per unit cell. If unspecified, the
thermodynamic quantities will be given on a per-unit-cell basis.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.to_pymatgen">
<code class="sig-name descname"><span class="pre">to_pymatgen</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.to_pymatgen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal notranslate"><span class="pre">PmgPhononDos</span></code> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.debye_temp">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">debye_temp</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.debye_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Debye temperature in K.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDos.get_acoustic_debye_temp">
<code class="sig-name descname"><span class="pre">get_acoustic_debye_temp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsites</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDos.get_acoustic_debye_temp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDos.get_acoustic_debye_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Acoustic Debye temperature in K, i.e. the Debye temperature divided by nsites**(1/3).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nsites</strong> – the number of sites in the cell.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhononDosPlotter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhononDosPlotter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_phdos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Class for plotting multiple phonon DOSes.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">PhononDosPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phdos</span><span class="p">(</span><span class="s2">&quot;foo dos&quot;</span><span class="p">,</span> <span class="s2">&quot;foo.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_phdos</span><span class="p">(</span><span class="s2">&quot;bar dos&quot;</span><span class="p">,</span> <span class="s2">&quot;bar.nc&quot;</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">gridplot</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.phdos_list">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phdos_list</span></code><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.phdos_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of phonon DOSes</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.add_phdos">
<code class="sig-name descname"><span class="pre">add_phdos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.add_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.add_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a DOS for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – label for the phonon DOS. Must be unique.</p></li>
<li><p><strong>phdos</strong> – <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object.</p></li>
<li><p><strong>phdos_kwargs</strong> – optional dictionary with the options passed to <cite>get_phdos</cite> to compute the phonon DOS.
Used when phdos is not already an instance of <cite>cls</cite> or when we have to compute the DOS from obj.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.combiplot">
<code class="sig-name descname"><span class="pre">combiplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.combiplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.combiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot DOSes on the same figure. Use <code class="docutils literal notranslate"><span class="pre">gridplot</span></code> to plot DOSes on different figures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <cite>(left, right)</cite>
or scalar e.g. <cite>left</cite>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – y-axis limits.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for combiplot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.gridplot">
<code class="sig-name descname"><span class="pre">gridplot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.gridplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple DOSes on a grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.plot_harmonic_thermo">
<code class="sig-name descname"><span class="pre">plot_harmonic_thermo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formula_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.plot_harmonic_thermo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.plot_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot thermodynamic properties from the phonon DOS within the harmonic approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 50.</p></li>
<li><p><strong>units</strong> – eV for energies in ev/unit_cell, Jmol for results in J/mole.</p></li>
<li><p><strong>formula_units</strong> – the number of formula units per unit cell. If unspecified, the
thermodynamic quantities will be given on a per-unit-cell basis.</p></li>
<li><p><strong>quantities</strong> – List of strings specifying the thermodynamic quantities to plot.
Possible values in [“internal_energy”, “free_energy”, “entropy”, “c_v”].</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.ipw_select_plot">
<code class="sig-name descname"><span class="pre">ipw_select_plot</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.ipw_select_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.ipw_select_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to select the plot.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.ipw_harmonic_thermo">
<code class="sig-name descname"><span class="pre">ipw_harmonic_thermo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.ipw_harmonic_thermo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.ipw_harmonic_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ipython widget with controllers to plot thermodynamic properties
from the phonon DOS within the harmonic approximation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhononDosPlotter.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhononDosPlotter.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhononDosPlotter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an jupyter notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhdosReader">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhdosReader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="iotools_api.html#abipy.iotools.ETSF_Reader" title="abipy.iotools.ETSF_Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.ETSF_Reader</span></code></a></p>
<p>This object reads data from the PHDOS.nc file produced by anaddb.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Frequencies are in eV, DOSes are in states/eV.</p>
</div>
<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.structure">
<code class="sig-name descname"><span class="pre">structure</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.wmesh">
<code class="sig-name descname"><span class="pre">wmesh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.wmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.wmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>The frequency mesh for the PH-DOS in eV.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_type">
<code class="sig-name descname"><span class="pre">read_pjdos_type</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_type" title="Permalink to this definition">¶</a></dt>
<dd><p>[ntypat, nomega] array with Phonon DOS projected over atom types.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_atdir">
<code class="sig-name descname"><span class="pre">read_pjdos_atdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_atdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_atdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return [natom, three, nomega] array with Phonon DOS projected over atoms and cartesian directions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_phdos">
<code class="sig-name descname"><span class="pre">read_phdos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object with the total phonon DOS</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_xyz_dict">
<code class="sig-name descname"><span class="pre">read_pjdos_symbol_xyz_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_symbol_xyz_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_xyz_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> mapping element symbol –&gt; [3, nomega] array
with the the phonon DOSes summed over atom-types and decomposed along
the three cartesian directions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_dict">
<code class="sig-name descname"><span class="pre">read_pjdos_symbol_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_pjdos_symbol_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_pjdos_symbol_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping element symbol –&gt; <a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a>
where PhononDos is the contribution to the total DOS summed over atoms
with chemical symbol <code class="docutils literal notranslate"><span class="pre">symbol</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosReader.read_msq_dos">
<code class="sig-name descname"><span class="pre">read_msq_dos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosReader.read_msq_dos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosReader.read_msq_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>Read generalized DOS with MSQ displacement tensor in cartesian coords.</p>
<p>Return: <a class="reference internal" href="#abipy.dfpt.msqdos.MsqDos" title="abipy.dfpt.msqdos.MsqDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.msqdos.MsqDos</span></code></a> object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phonons.PhdosFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phonons.</span></code><code class="sig-name descname"><span class="pre">PhdosFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Container object storing the different DOSes stored in the
PHDOS.nc file produced by anaddb.
Provides helper function to visualize/extract data.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-12e8cc72ad913fb805a0bd24690087f21d29ad8b.png" alt="Inheritance diagram of PhdosFile" usemap="#inheritance39e463df1c" class="inheritance graphviz" /></div>
<map id="inheritance39e463df1c" name="inheritance39e463df1c">
<area shape="rect" id="node1" href="core_api.html#abipy.core.mixins.AbinitNcFile" target="_top" title="Abstract class representing a Netcdf file with data saved" alt="" coords="244,104,444,129"/>
<area shape="rect" id="node5" href="#abipy.dfpt.phonons.PhdosFile" target="_top" title="Container object storing the different DOSes stored in the" alt="" coords="503,55,700,80"/>
<area shape="rect" id="node3" href="core_api.html#abipy.core.mixins.Has_Structure" target="_top" title="Mixin class for |AbinitNcFile| containing crystallographic data." alt="" coords="237,5,451,31"/>
<area shape="rect" id="node4" href="core_api.html#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="233,55,455,80"/>
</map><dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the convergence parameters
Used to construct <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Human-readable string with useful information such as structure…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – Verbosity level.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.structure">
<code class="sig-name descname"><span class="pre">structure</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.phdos">
<code class="sig-name descname"><span class="pre">phdos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.phdos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.phdos" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.dfpt.phonons.PhononDos" title="abipy.dfpt.phonons.PhononDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononDos</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.pjdos_symbol">
<code class="sig-name descname"><span class="pre">pjdos_symbol</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.pjdos_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.pjdos_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered dictionary mapping element symbol –&gt; <cite>PhononDos</cite>
where PhononDos is the contribution to the total DOS summed over atoms
with chemical symbol <cite>symbol</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.msqd_dos">
<code class="sig-name descname"><span class="pre">msqd_dos</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.msqd_dos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.msqd_dos" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.dfpt.msqdos.MsqDos" title="abipy.dfpt.msqdos.MsqDos"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.msqdos.MsqDos</span></code></a> object with Mean square displacement tensor in cartesian coords.
Allows one to calculate Debye Waller factors by integration with 1/omega and the Bose-Einstein factor.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_type">
<code class="sig-name descname"><span class="pre">plot_pjdos_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot type-projected phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>colormap</strong> – Have a look at the colormaps
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">here</a>
and decide which one you’d like:</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque).</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange x-y axis.</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – y-axis limits.</p></li>
<li><p><strong>fontsize</strong> – legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_cartdirs_type">
<code class="sig-name descname"><span class="pre">plot_pjdos_cartdirs_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_cartdirs_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_cartdirs_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot type-projected phonon DOS decomposed along the three cartesian directions.
Three rows for each cartesian direction. Each row shows the contribution of each atomic type + Total Phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>colormap</strong> – <p>Have a look at the colormaps
<a class="reference external" href="http://matplotlib.sourceforge.net/examples/pylab_examples/show_colormaps.html">here</a>
and decide which one you’d like:</p>
</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ylims</strong> – y-axis limits.</p></li>
<li><p><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and label fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.plot_pjdos_cartdirs_site">
<code class="sig-name descname"><span class="pre">plot_pjdos_cartdirs_site</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inequivalent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.plot_pjdos_cartdirs_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.plot_pjdos_cartdirs_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phonon PJDOS for each atom in the unit cell. By default, only “inequivalent” atoms are shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> – “inequivalent” to show only inequivalent atoms. “all” for all sites.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”).
Case-insensitive.</p></li>
<li><p><strong>stacked</strong> – True if DOS partial contributions should be stacked on top of each other.</p></li>
<li><p><strong>colormap</strong> – matplotlib colormap.</p></li>
<li><p><strong>alpha</strong> – The alpha blending value, between 0 (transparent) and 1 (opaque)</p></li>
<li><p><strong>xlims</strong> – Set the data limits for the x-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used.</p></li>
<li><p><strong>ylims</strong> – Set the data limits for the y-axis. Accept tuple e.g. <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
or scalar e.g. <code class="docutils literal notranslate"><span class="pre">left</span></code>. If left (right) is None, default values are used</p></li>
<li><p><strong>ax_list</strong> – List of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If <code class="docutils literal notranslate"><span class="pre">nbpath</span></code> is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phonons.PhdosFile.to_pymatgen">
<code class="sig-name descname"><span class="pre">to_pymatgen</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phonons.html#PhdosFile.to_pymatgen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phonons.PhdosFile.to_pymatgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pymatgen <code class="xref py py-class docutils literal notranslate"><span class="pre">PmgCompletePhononDos</span></code> object.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.phtk">
<span id="phtk-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phtk</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.phtk" title="Permalink to this headline">¶</a></h2>
<p>Phonon Toolkit: This module gathers low-level tools to operate on phonons.</p>
<dl class="py function">
<dt id="abipy.dfpt.phtk.get_dyn_mat_eigenvec">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phtk.</span></code><code class="sig-name descname"><span class="pre">get_dyn_mat_eigenvec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phdispl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#get_dyn_mat_eigenvec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.get_dyn_mat_eigenvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the phonon displacements to the orthonormal eigenvectors of the dynamical matrix.
Small discrepancies with the original values may be expected due to the different values of the atomic masses in
abinit and pymatgen.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These eigenvectors are orthonormalized and should be very close to the ones computed by Abinit in a.u.
Note, however, that the output vectors are given in atomic units so dividing then by the sqrt(Mass)
won’t give the dipl_cart used in PhononBands that are in Angstrom.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phdispl</strong> – a numpy array containing the displacements in cartesian coordinates. The last index should have
size 3*(num atoms), but the rest of the shape is arbitrary. If qpts is not None the first dimension
should match the q points.</p></li>
<li><p><strong>structure</strong> – <a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p></li>
<li><p><strong>amu</strong> – dictionary that associates the atomic numbers present in the structure to the values of the atomic
mass units used for the calculation. Incompatible with amu_sumbol. If None and amu_symbol is None, values
from pymatgen will be used.  Note that this will almost always lead to inaccuracies in the conversion.</p></li>
<li><p><strong>amu_symbol</strong> – dictionary that associates the symbol present in the structure to the values of the atomic
mass units used for the calculation. Incompatible with amu. If None and amu_symbol is None, values from
pymatgen will be used. that this will almost always lead to inaccuracies in the conversion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the same shape as phdispl containing the eigenvectors of the dynamical matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.phtk.match_eigenvectors">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phtk.</span></code><code class="sig-name descname"><span class="pre">match_eigenvectors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#match_eigenvectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.match_eigenvectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two list of vectors, returns the pair matching based on the complex scalar product.
Returns the indices of the second list that match the vectors of the first list in ascending order.</p>
</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phtk.</span></code><code class="sig-name descname"><span class="pre">NonAnalyticalPh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdispl_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#NonAnalyticalPh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<p>Phonon data at gamma including non analytical contributions
Read from anaddb.nc</p>
<dl class="py method">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#NonAnalyticalPh.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the non analytical directions, frequencies and displacements from the anaddb.nc file specified.
Non existence of displacements is accepted for compatibility with abinit 8.0.6
Raises an error if the other values are not present in anaddb.nc.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh.dyn_mat_eigenvect">
<code class="sig-name descname"><span class="pre">dyn_mat_eigenvect</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#NonAnalyticalPh.dyn_mat_eigenvect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh.dyn_mat_eigenvect" title="Permalink to this definition">¶</a></dt>
<dd><p>[ndirection, 3*natom, 3*natom] array with the orthonormal eigenvectors of the dynamical matrix.
in Cartesian coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh.index_direction">
<code class="sig-name descname"><span class="pre">index_direction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#NonAnalyticalPh.index_direction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh.index_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns: the index of direction. Raises: <cite>ValueError</cite> if not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> – a 3 element list indicating the direction. Can be a generic vector</p></li>
<li><p><strong>cartesian</strong> – if True the direction are already in cartesian coordinates, if False it
will be converted to match the internal description of the directions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.phtk.NonAnalyticalPh.has_direction">
<code class="sig-name descname"><span class="pre">has_direction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#NonAnalyticalPh.has_direction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.NonAnalyticalPh.has_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the input direction is among those available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> – a 3 element list indicating the direction. Can be a generic vector</p></li>
<li><p><strong>cartesian</strong> – if True the direction are already in cartesian coordinates, if False it
will be converted to match the internal description of the directions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.phtk.open_file_phononwebsite">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.phtk.</span></code><code class="sig-name descname"><span class="pre">open_file_phononwebsite</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">website</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'http://henriquemiranda.github.io/phononwebsite'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/phtk.html#open_file_phononwebsite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.phtk.open_file_phononwebsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a file, detect the type and open it on the phonon website
Based on a similar function in &lt;<a class="reference external" href="https://github.com/henriquemiranda/phononwebsite/phononweb.py">https://github.com/henriquemiranda/phononwebsite/phononweb.py</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – file with phonon data in phononwebsite format.</p></li>
<li><p><strong>port</strong> – Initial port.</p></li>
<li><p><strong>website</strong> – Website URL</p></li>
<li><p><strong>host</strong> – localhost name.</p></li>
<li><p><strong>browser</strong> – Open webpage in <code class="docutils literal notranslate"><span class="pre">browser</span></code>. Use default if $BROWSER if None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.qha">
<span id="qha-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.qha" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="abipy.dfpt.qha.AbstractQHA">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">AbstractQHA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class for the quasi-harmonic approximation analysis.
Provides some basic methods and plotting utils, plus a converter to write input files for phonopy-qha or to
generate an instance of phonopy.qha.QHA. These can be used to obtain other quantities and plots.
Does not include electronic entropic contributions for metals.</p>
<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.fit_energies">
<code class="sig-name descname"><span class="pre">fit_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.fit_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.fit_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a fit of the energies as a function of the volume at different temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>namedtuple</cite> with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tot_en</span><span class="p">:</span> <span class="n">numpy</span> <span class="n">array</span> <span class="k">with</span> <span class="n">shape</span> <span class="p">(</span><span class="n">nvols</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="k">with</span> <span class="n">the</span> <span class="n">energies</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">fit</span>
<span class="n">fits</span><span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">subclasses</span> <span class="n">of</span> <span class="n">pymatgen</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">EOSBase</span><span class="p">,</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">the</span> <span class="nb">type</span> <span class="n">of</span>
    <span class="n">eos</span> <span class="n">chosen</span><span class="o">.</span> <span class="n">Contains</span> <span class="n">the</span> <span class="n">fit</span> <span class="k">for</span> <span class="n">the</span> <span class="n">energies</span> <span class="n">at</span> <span class="n">the</span> <span class="n">different</span> <span class="n">temperatures</span><span class="o">.</span>
<span class="n">min_en</span><span class="p">:</span> <span class="n">numpy</span> <span class="n">array</span> <span class="k">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">energies</span> <span class="k">for</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">temperatures</span>
<span class="n">min_vol</span><span class="p">:</span> <span class="n">numpy</span> <span class="n">array</span> <span class="k">with</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">volumes</span> <span class="k">for</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">temperatures</span>
<span class="n">temp</span><span class="p">:</span> <span class="n">numpy</span> <span class="n">array</span> <span class="k">with</span> <span class="n">the</span> <span class="n">temperatures</span> <span class="n">considered</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_vib_free_energies">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">get_vib_free_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_vib_free_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_vib_free_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the vibrational free energy corresponding to all the structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of <cite>num</cite> values of the vibrational contribution to the free energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_thermodynamic_properties">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">get_thermodynamic_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_thermodynamic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_thermodynamic_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates all the thermodynamic properties corresponding to all the volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tmesh: numpy array with the list of temperatures. Shape (num).
cv: constant-volume specific heat, in eV/K. Shape (nvols, num).
free_energy: free energy, in eV. Shape (nvols, num).
entropy: entropy, in eV/K. Shape (nvols, num).
zpe: zero point energy in eV. Shape (nvols).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>namedtuple</cite> with the following attributes for all the volumes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.nvols">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nvols</span></code><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.nvols" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of volumes</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.natoms">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">natoms</span></code><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.natoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in the unit cell.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.set_eos">
<code class="sig-name descname"><span class="pre">set_eos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.set_eos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.set_eos" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the EOS model used for the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eos_name</strong> – string indicating the expression used to fit the energies. See pymatgen.analysis.eos.EOS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.plot_energies">
<code class="sig-name descname"><span class="pre">plot_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.plot_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.plot_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the energies as a function of volume at different temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 10.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_thermal_expansion_coeff">
<code class="sig-name descname"><span class="pre">get_thermal_expansion_coeff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_thermal_expansion_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_thermal_expansion_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the thermal expansion coefficient as a function of temperature, using
finite difference on the fitted values of the volume as a function of temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="core_api.html#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.func1d.Function1D</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.plot_thermal_expansion_coeff">
<code class="sig-name descname"><span class="pre">plot_thermal_expansion_coeff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.plot_thermal_expansion_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.plot_thermal_expansion_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the thermal expansion coefficient as a function of the temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.plot_vol_vs_t">
<code class="sig-name descname"><span class="pre">plot_vol_vs_t</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.plot_vol_vs_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.plot_vol_vs_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the volume as a function of the temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.plot_phbs">
<code class="sig-name descname"><span class="pre">plot_phbs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phbands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperatures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plasma'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.plot_phbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.plot_phbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> plots the band structures with a color depending on
the temperature using a <a class="reference internal" href="#abipy.dfpt.phonons.PhononBandsPlotter" title="abipy.dfpt.phonons.PhononBandsPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBandsPlotter</span></code></a>.
If temperatures are not given they will be deduced inverting the dependence of volume
with respect to the temperature. If a unique volume could not be identified an error will
be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phbands</strong> – list of <a class="reference internal" href="#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> objects.</p></li>
<li><p><strong>temperatures</strong> – list of temperatures.</p></li>
<li><p><strong>t_max</strong> – maximum temperature considered for plotting.</p></li>
<li><p><strong>colormap</strong> – matplotlib color map.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_vol_at_t">
<code class="sig-name descname"><span class="pre">get_vol_at_t</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_vol_at_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_vol_at_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the volume corresponding to a specific temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> – temperature in K</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The volume</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_t_for_vols">
<code class="sig-name descname"><span class="pre">get_t_for_vols</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_t_for_vols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_t_for_vols" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the temperatures corresponding to a specific volume.
The search is performed interpolating the V(T) dependence with a spline and
finding the roots with of V(t) - v.
It may return more than one temperature for a volume in case of non monotonic behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vols</strong> – list of volumes</p></li>
<li><p><strong>t_max</strong> – maximum temperature considered for the fit</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of lists of temperatures. For each volume more than one temperature can
be identified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.write_phonopy_qha_inputs">
<code class="sig-name descname"><span class="pre">write_phonopy_qha_inputs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">211</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.write_phonopy_qha_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.write_phonopy_qha_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes nvols thermal_properties-i.yaml files that can be used as inputs for phonopy-qha.
Notice that phonopy apparently requires the value of the 300 K temperature to be present
in the list. Choose the values of tstart, tstop and num to satisfy this condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 211.</p></li>
<li><p><strong>path</strong> – a path to a folder where the files will be stored</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQHA.get_phonopy_qha">
<code class="sig-name descname"><span class="pre">get_phonopy_qha</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">211</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_plot_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQHA.get_phonopy_qha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQHA.get_phonopy_qha" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of phonopy.qha.QHA that can be used generate further plots and output data.
The object is returned right after the construction. The “run()” method should be executed
before getting results and plots.
Notice that phonopy apparently requires the value of the 300 K temperature to be present
in the list. Choose the values of tstart, tstop and num to satisfy this condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 211.</p></li>
<li><p><strong>eos</strong> – the expression used to fit the energies in phonopy. Possible values are “vinet”,
“murnaghan” and “birch_murnaghan”. Passed to phonopy’s QHA.</p></li>
<li><p><strong>t_max</strong> – maximum temperature. Passed to phonopy’s QHA.</p></li>
<li><p><strong>energy_plot_factor</strong> – factor multiplying the energies. Passed to phonopy’s QHA.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of phonopy.qha.QHA</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.qha.QHA">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">QHA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.qha.AbstractQHA" title="abipy.dfpt.qha.AbstractQHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.qha.AbstractQHA</span></code></a></p>
<p>Object to extract results in the quasi-harmonic approximation from electronic and phonon calculations
at different volumes.
Provides some basic methods and plotting utils, plus a converter to write input files for phonopy-qha or to
generate an instance of phonopy.qha.QHA. These can be used to obtain other quantities and plots.
Does not include electronic entropic contributions for metals.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-fa8df8456faa2bcdee0d1f6e5e6989a71df1f05f.png" alt="Inheritance diagram of QHA" usemap="#inheritance3d5fb7ef7d" class="inheritance graphviz" /></div>
<map id="inheritance3d5fb7ef7d" name="inheritance3d5fb7ef7d">
<area shape="rect" id="node1" href="#abipy.dfpt.qha.AbstractQHA" target="_top" title="Abstract class for the quasi&#45;harmonic approximation analysis." alt="" coords="5,5,192,31"/>
<area shape="rect" id="node2" href="#abipy.dfpt.qha.QHA" target="_top" title="Object to extract results in the quasi&#45;harmonic approximation from electronic and phonon calculations" alt="" coords="240,5,379,31"/>
</map><dl class="py method">
<dt id="abipy.dfpt.qha.QHA.from_files">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsr_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA.from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of QHA from a list of GSR files and a list of PHDOS.nc files.
The list should have the same size and the volumes should match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsr_paths</strong> – list of paths to GSR files.</p></li>
<li><p><strong>phdos_paths</strong> – list of paths to PHDOS.nc files.</p></li>
</ul>
</dd>
</dl>
<p>Returns: A new instance of QHA</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA.get_vib_free_energies">
<code class="sig-name descname"><span class="pre">get_vib_free_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA.get_vib_free_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA.get_vib_free_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the vibrational free energy from the phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of <cite>num</cite> values of the vibrational contribution to the free energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA.get_thermodynamic_properties">
<code class="sig-name descname"><span class="pre">get_thermodynamic_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA.get_thermodynamic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA.get_thermodynamic_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates all the thermodynamic properties corresponding to all the volumes using the phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tmesh: numpy array with the list of temperatures. Shape (num).
cv: constant-volume specific heat, in eV/K. Shape (nvols, num).
free_energy: free energy, in eV. Shape (nvols, num).
entropy: entropy, in eV/K. Shape (nvols, num).
zpe: zero point energy in eV. Shape (nvols).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>namedtuple</cite> with the following attributes for all the volumes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.qha.QHA3PF">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">QHA3PF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_doses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3PF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3PF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.qha.AbstractQHA" title="abipy.dfpt.qha.AbstractQHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.qha.AbstractQHA</span></code></a></p>
<p>Object to extract results in the quasi-harmonic approximation from several electronic energies at different
volumes and three phonon calculations.
Provides some basic methods and plotting utils, plus a converter to write input files for phonopy-qha or to
generate an instance of phonopy.qha.QHA. These can be used to obtain other quantities and plots.
Does not include electronic entropic contributions for metals.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-d32394034ff687d76d4522cf1ddb519c33b50f1c.png" alt="Inheritance diagram of QHA3PF" usemap="#inheritance22c36fa5e9" class="inheritance graphviz" /></div>
<map id="inheritance22c36fa5e9" name="inheritance22c36fa5e9">
<area shape="rect" id="node1" href="#abipy.dfpt.qha.AbstractQHA" target="_top" title="Abstract class for the quasi&#45;harmonic approximation analysis." alt="" coords="5,5,192,31"/>
<area shape="rect" id="node2" href="#abipy.dfpt.qha.QHA3PF" target="_top" title="Object to extract results in the quasi&#45;harmonic approximation from several electronic energies at different" alt="" coords="240,5,403,31"/>
</map><dl class="py method">
<dt id="abipy.dfpt.qha.QHA3PF.from_files">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsr_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phdos_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_doses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3PF.from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3PF.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of QHA from a list of GSR files and a list of PHDOS.nc files.
The list should have the same size and the volumes should match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsr_paths</strong> – list of paths to GSR files.</p></li>
<li><p><strong>phdos_paths</strong> – list of paths to three PHDOS.nc files.</p></li>
<li><p><strong>ind_doses</strong> – list of three values indicating, for each of the three doses, the index of the
corresponding gsr_file in “gsr_paths”.</p></li>
</ul>
</dd>
</dl>
<p>Returns: A new instance of QHA</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3PF.get_thermodynamic_properties">
<code class="sig-name descname"><span class="pre">get_thermodynamic_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3PF.get_thermodynamic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3PF.get_thermodynamic_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates all the thermodynamic properties corresponding to all the volumes using the phonon DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tmesh: numpy array with the list of temperatures. Shape (num).
cv: constant-volume specific heat, in eV/K. Shape (nvols, num).
free_energy: free energy, in eV. Shape (nvols, num).
entropy: entropy, in eV/K. Shape (nvols, num).
zpe: zero point energy in eV. Shape (nvols).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>namedtuple</cite> with the following attributes for all the volumes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3PF.get_vib_free_energies">
<code class="sig-name descname"><span class="pre">get_vib_free_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3PF.get_vib_free_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3PF.get_vib_free_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the vibrational free energy corresponding to all the structures, either from the phonon DOS
or from a fit of the known values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of <cite>num</cite> values of the vibrational contribution to the free energy</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.qha.QHA3P">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">QHA3P</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gruns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_grun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.qha.AbstractQHA" title="abipy.dfpt.qha.AbstractQHA"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.qha.AbstractQHA</span></code></a></p>
<p>Object to extract results in the quasi-harmonic approximation from several electronic energies at different
volumes and three phonon calculations.
Provides some basic methods and plotting utils, plus a converter to write input files for phonopy-qha or to
generate an instance of phonopy.qha.QHA. These can be used to obtain other quantities and plots.
Does not include electronic entropic contributions for metals.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-59d809776006cdc9641e11aae3dfe9c3795d86bc.png" alt="Inheritance diagram of QHA3P" usemap="#inheritance2ce23cbfaa" class="inheritance graphviz" /></div>
<map id="inheritance2ce23cbfaa" name="inheritance2ce23cbfaa">
<area shape="rect" id="node1" href="#abipy.dfpt.qha.AbstractQHA" target="_top" title="Abstract class for the quasi&#45;harmonic approximation analysis." alt="" coords="5,5,192,31"/>
<area shape="rect" id="node2" href="#abipy.dfpt.qha.QHA3P" target="_top" title="Object to extract results in the quasi&#45;harmonic approximation from several electronic energies at different" alt="" coords="240,5,395,31"/>
</map><dl class="py method">
<dt id="abipy.dfpt.qha.QHA3P.from_files">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_files</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsr_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grun_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_doses</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P.from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P.from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of QHA from a list of GSR files and a list PHDOS.nc files.
The list should have the same size and the volumes should match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsr_paths</strong> – list of paths to GSR files.</p></li>
<li><p><strong>phdos_paths</strong> – list of paths to three PHDOS.nc files.</p></li>
<li><p><strong>ind_doses</strong> – list of three values indicating, for each of the three doses, the index of the
corresponding gsr_file in “gsr_paths”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new instance of QHA</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3P.close">
<code class="sig-name descname"><span class="pre">close</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close files.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3P.get_thermodynamic_properties">
<code class="sig-name descname"><span class="pre">get_thermodynamic_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P.get_thermodynamic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P.get_thermodynamic_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the thermodynamic properties corresponding to all the structures, either from the phonon
frequencies or from a fit of the know values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tmesh: numpy array with the list of temperatures. Shape (num).
cv: constant-volume specific heat, in eV/K. Shape (nvols, num).
free_energy: free energy, in eV. Shape (nvols, num).
entropy: entropy, in eV/K. Shape (nvols, num).
zpe: zero point energy in eV. Shape (nvols).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>namedtuple</cite> with the following attributes for all the volumes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3P.fitted_frequencies">
<code class="sig-name descname"><span class="pre">fitted_frequencies</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P.fitted_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P.fitted_frequencies" title="Permalink to this definition">¶</a></dt>
<dd><p>A numpy array with size (nvols, nqpts_ibz, 3*natoms) containing the phonon frequencies
for all the volumes, either from the original phonon calculations or fitted</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.QHA3P.get_vib_free_energies">
<code class="sig-name descname"><span class="pre">get_vib_free_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHA3P.get_vib_free_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHA3P.get_vib_free_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the vibrational free energy corresponding to all the structures, either from the phonon DOS
or from a fit of the know values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tstart</strong> – The starting value (in Kelvin) of the temperature mesh.</p></li>
<li><p><strong>tstop</strong> – The end value (in Kelvin) of the mesh.</p></li>
<li><p><strong>num</strong> – int, optional Number of samples to generate. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of <cite>num</cite> values of the vibrational contribution to the free energy</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.qha.get_free_energy">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">get_free_energy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#get_free_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.get_free_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the free energy in eV from the phonon frequencies on a regular grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – the phonon frequencies</p></li>
<li><p><strong>weights</strong> – the weights of the q-points</p></li>
<li><p><strong>t</strong> – the temperature</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.qha.get_cv">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">get_cv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#get_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.get_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the constant-volume specific heat in eV/K from the phonon frequencies on a regular grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – the phonon frequencies</p></li>
<li><p><strong>weights</strong> – the weights of the q-points</p></li>
<li><p><strong>t</strong> – the temperature</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.qha.get_zero_point_energy">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">get_zero_point_energy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#get_zero_point_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.get_zero_point_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the zero point energy in eV from the phonon frequencies on a regular grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – the phonon frequencies</p></li>
<li><p><strong>weights</strong> – the weights of the q-points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.dfpt.qha.get_entropy">
<code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">get_entropy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#get_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.get_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the entropy in eV/K from the phonon frequencies on a regular grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> – the phonon frequencies</p></li>
<li><p><strong>weights</strong> – the weights of the q-points</p></li>
<li><p><strong>t</strong> – the temperature</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">AbstractQmeshAnalyzer</span></code><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQmeshAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract class for the analysis of the convergence wrt to the q-mesh used to compute the
phonon DOS. Relies on abstract methods implemented in AbstractQHA.</p>
<dl class="py attribute">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.fontsize">
<code class="sig-name descname"><span class="pre">fontsize</span></code><em class="property"> <span class="pre">=</span> <span class="pre">8</span></em><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.fontsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.colormap">
<code class="sig-name descname"><span class="pre">colormap</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'viridis'</span></em><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.colormap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.set_eos">
<code class="sig-name descname"><span class="pre">set_eos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQmeshAnalyzer.set_eos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.set_eos" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the EOS model used for the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eos_name</strong> – string indicating the expression used to fit the energies. See pymatgen.analysis.eos.EOS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_energies">
<code class="sig-name descname"><span class="pre">plot_energies</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQmeshAnalyzer.plot_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the energies as a function of volume at different temperatures.
kwargs are propagated to the analogous method of QHA.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_thermal_expansion_coeff">
<code class="sig-name descname"><span class="pre">plot_thermal_expansion_coeff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQmeshAnalyzer.plot_thermal_expansion_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_thermal_expansion_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the thermal expansion coefficient as a function of the temperature.
kwargs are propagated to the analogous method of QHA.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_vol_vs_t">
<code class="sig-name descname"><span class="pre">plot_vol_vs_t</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#AbstractQmeshAnalyzer.plot_vol_vs_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer.plot_vol_vs_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the volume as a function of the temperature.
kwargs are propagated to the analogous method of QHA.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.qha.QHAQmeshAnalyzer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.qha.</span></code><code class="sig-name descname"><span class="pre">QHAQmeshAnalyzer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gsr_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddb_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHAQmeshAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHAQmeshAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.dfpt.qha.AbstractQmeshAnalyzer" title="abipy.dfpt.qha.AbstractQmeshAnalyzer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.qha.AbstractQmeshAnalyzer</span></code></a></p>
<dl class="py method">
<dt id="abipy.dfpt.qha.QHAQmeshAnalyzer.run_qlist">
<code class="sig-name descname"><span class="pre">run_qlist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nqsmall_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/qha.html#QHAQmeshAnalyzer.run_qlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.qha.QHAQmeshAnalyzer.run_qlist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.raman">
<span id="raman-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">raman</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.raman" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="abipy.dfpt.raman.PowderIntensity">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.raman.</span></code><code class="sig-name descname"><span class="pre">PowderIntensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paral</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.dfpt.raman.PowderIntensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<dl class="py attribute">
<dt id="abipy.dfpt.raman.PowderIntensity.paral">
<code class="sig-name descname"><span class="pre">paral</span></code><a class="headerlink" href="#abipy.dfpt.raman.PowderIntensity.paral" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.raman.PowderIntensity.perp">
<code class="sig-name descname"><span class="pre">perp</span></code><a class="headerlink" href="#abipy.dfpt.raman.PowderIntensity.perp" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt id="abipy.dfpt.raman.PowderIntensity.tot">
<code class="sig-name descname"><span class="pre">tot</span></code><a class="headerlink" href="#abipy.dfpt.raman.PowderIntensity.tot" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.dfpt.raman.Raman">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.raman.</span></code><code class="sig-name descname"><span class="pre">Raman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">susceptibility</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_susceptibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An object that allows to obtain the Raman intensities based on the calculated
susceptibilities. The expressions used to extract the different values of the
Raman intensities can be found for example in PRB 71, 214307, Physics of the
Earth and Planetary Interiors 174, 113 or PRB 71, 125107.</p>
<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object from an anaddb.nc netcdf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – path to the netcdf file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of Raman.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.get_modes_intensities">
<code class="sig-name descname"><span class="pre">get_modes_intensities</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.get_modes_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.get_modes_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Raman intensities for each mode in arbitrary units. It is possible to use the
susceptibilities from the transverse modes only or to specify one of the directions with non
analytical contributions. By default it returns an array with shape (n modes, 3, 3) where each
component of the 3x3 matrix are those with different incoming (the first index) and outgoing
(the second index) polarization. These are along the components along the standard axes (e.g.
“xx” or “yz” components). If pol_in and pol_out an array with shape (n modes) is returned
corresponding to the selected polarizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – temperature in K.</p></li>
<li><p><strong>laser_freq</strong> – frequency of the incident laser. The units are determined the “units”
argument.</p></li>
<li><p><strong>non_anal_dir</strong> – index of the direction along which the non analytical contribution
has been calculated. Corresponds to the indices in the non_anal_directions attribute.</p></li>
<li><p><strong>relative</strong> – if True the intensities will be rescaled so that the largest value is 1.</p></li>
<li><p><strong>units</strong> – the units in which the input and the output frequencies will be given.
Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”)</p></li>
<li><p><strong>pol_in</strong> – the polarization of the incoming photon. If not None can be either either a string
with one of the cartesian components i.e. “x”, “y”, “z” or an array with 3 elements
representing the polarization direction. If not None pol_out can not be None.</p></li>
<li><p><strong>pol_out</strong> – the polarization of the outgoing photon. If not None can be either either a string
with one of the cartesian components i.e. “x”, “y”, “z” or an array with 3 elements
representing the polarization direction. If not None pol_in can not be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array with the Raman intensities. If pol_in==pol_out==None has shape (n modes, 3, 3)
with all the components. Otherwise an array with size (n modes) with the intensities of
the selected polarizations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.get_lorentz_intensity">
<code class="sig-name descname"><span class="pre">get_lorentz_intensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.get_lorentz_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.get_lorentz_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the broadened Raman intensities in arbitrary units for frequencies in an interval. It is
possible to use the susceptibilities from the transverse modes only or to specify one of the directions
with non analytical contributions. By default it returns a 3x3 matrix where each component is a
Function1D object with the Raman intensities with different incoming (the first index) and outgoing
(the second index) polarization. These are along the components along the standard axes (e.g. “xx” or
“yz” components). If pol_in and pol_out a single Function1D is returned corresponding to the selected
polarizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – temperature in K.</p></li>
<li><p><strong>laser_freq</strong> – frequency of the incident laser. The units are determined the “units”
argument.</p></li>
<li><p><strong>width</strong> – the width of the Lorentz distribution. The units are determined the “units”
argument.</p></li>
<li><p><strong>non_anal_dir</strong> – index of the direction along which the non analytical contribution
has been calculated. Corresponds to the indices in the non_anal_directions attribute.</p></li>
<li><p><strong>min_freq</strong> – minimum frequency considered. If None it will be given by the minimum
frequency with non zero intensities minus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>max_freq</strong> – maximum frequency considered. If None it will be given by the maximum
frequency with non zero intensities plus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>num</strong> – number of frequencies in the interval (min_freq, max_freq).</p></li>
<li><p><strong>relative</strong> – if True the intensities will be rescaled so that the largest value is 1.</p></li>
<li><p><strong>units</strong> – the units in which the input and the output frequencies will be given.
Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”)</p></li>
<li><p><strong>pol_in</strong> – the polarization of the incoming photon. If not None can be either either a string
with one of the cartesian components i.e. “x”, “y”, “z” or an array with 3 elements
representing the polarization direction. If not None pol_out can not be None.</p></li>
<li><p><strong>pol_out</strong> – the polarization of the outgoing photon. If not None can be either either a string
with one of the cartesian components i.e. “x”, “y”, “z” or an array with 3 elements
representing the polarization direction. If not None pol_in can not be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If pol_in==pol_out==None a 3x3 list with a Function1D corresponding to the different
components of the intensities. Otherwise a single Function1D with the  intensities of
the selected polarizations. Each Function1D has “num” points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.get_powder_intensity">
<code class="sig-name descname"><span class="pre">get_powder_intensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.get_powder_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.get_powder_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Raman intensities in arbitrary units for each mode integrated over all possible
orientation to reproduce the powder measurements. It is possible to use the susceptibilities from
transverse modes only or to specify one of the directions with non analytical contributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – temperature in K.</p></li>
<li><p><strong>laser_freq</strong> – frequency of the incident laser. The units are determined the “units”
argument.</p></li>
<li><p><strong>non_anal_dir</strong> – index of the direction along which the non analytical contribution
has been calculated. Corresponds to the indices in the non_anal_directions attribute.</p></li>
<li><p><strong>relative</strong> – if True the intensities will be rescaled so that the largest value of the
total intensity is 1.</p></li>
<li><p><strong>units</strong> – the units in which the input and the output frequencies will be given.
Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A PowderIntensity with the parallel, perpendicular and total components of the powder
intensities. Each one is an array with length n modes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.get_powder_lorentz_intensity">
<code class="sig-name descname"><span class="pre">get_powder_lorentz_intensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.get_powder_lorentz_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.get_powder_lorentz_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the broadened Raman intensities in arbitrary units integrated over all possible
orientation to reproduce the powder measurements for frequencies in an interval. It is possible to
use the susceptibilities from the transverse modes only or to specify one of the directions with non
analytical contributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – temperature in K.</p></li>
<li><p><strong>laser_freq</strong> – frequency of the incident laser. The units are determined the “units”
argument.</p></li>
<li><p><strong>width</strong> – the width of the Lorentz distribution. The units are determined the “units”
argument.</p></li>
<li><p><strong>non_anal_dir</strong> – index of the direction along which the non analytical contribution
has been calculated. Corresponds to the indices in the non_anal_directions attribute.</p></li>
<li><p><strong>min_freq</strong> – minimum frequency considered. If None it will be given by the minimum
frequency with non zero intensities minus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>max_freq</strong> – maximum frequency considered. If None it will be given by the maximum
frequency with non zero intensities plus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>num</strong> – number of frequencies in the interval (min_freq, max_freq).</p></li>
<li><p><strong>relative</strong> – if True the intensities will be rescaled so that the largest value of the
total intensity is 1.</p></li>
<li><p><strong>units</strong> – the units in which the input and the output frequencies will be given.
Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A PowderIntensity with the parallel, perpendicular and total components of the powder
intensities. Each one is a Function1D with “num” points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.raman.Raman.plot_intensity">
<code class="sig-name descname"><span class="pre">plot_intensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laser_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_anal_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/raman.html#Raman.plot_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.raman.Raman.plot_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot one representation of the broadened Raman intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> – temperature in K.</p></li>
<li><p><strong>laser_freq</strong> – frequency of the incident laser. The units are determined the “units”
argument.</p></li>
<li><p><strong>width</strong> – the width of the Lorentz distribution. The units are determined the “units”
argument. If None or 0 a plot of only the frequencies for each mode will be given.</p></li>
<li><p><strong>value</strong> – a string describing the value that should be plotted. Can be “powder” or
a string of the type “xz” with the polarization of the incoming and outgoing
phonon. All the combinations of “x”, “y” and “z” are accepted.</p></li>
<li><p><strong>non_anal_dir</strong> – index of the direction along which the non analytical contribution
has been calculated. Corresponds to the indices in the non_anal_directions attribute.</p></li>
<li><p><strong>min_freq</strong> – minimum frequency considered. If None it will be given by the minimum
frequency with non zero intensities minus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>max_freq</strong> – maximum frequency considered. If None it will be given by the maximum
frequency with non zero intensities plus 10 times the width of the distribution.
If given the units are determined by the “units” argument.</p></li>
<li><p><strong>num</strong> – number of frequencies in the interval (min_freq, max_freq).</p></li>
<li><p><strong>relative</strong> – if True the intensities will be rescaled so that the largest value of the
total intensity is 1.</p></li>
<li><p><strong>units</strong> – the units in which the input and the output frequencies will be given.
Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”)</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>plot_phfreqs</strong> – if True vertical dashed lines are added to the figure for all the
phonon modes.</p></li>
<li><p><strong>**kwargs</strong> – arguments passed to the plot function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.dfpt.vsound">
<span id="vsound-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">vsound</span></code> Module</a><a class="headerlink" href="#module-abipy.dfpt.vsound" title="Permalink to this headline">¶</a></h2>
<p>Tools to compute speed of sound.</p>
<dl class="py class">
<dt id="abipy.dfpt.vsound.SoundVelocity">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.dfpt.vsound.</span></code><code class="sig-name descname"><span class="pre">SoundVelocity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sound_velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phfreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_api.html#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a>, <a class="reference internal" href="core_api.html#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Compute the speed of sound by fitting phonon frequencies along selected directions
by linear least-squares fit.</p>
<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="core_api.html#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.n_directions">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">n_directions</span></code><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.n_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of directions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.from_ddb">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ddb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ddb_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpt_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_neg_freqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chneut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipdip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngqpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spell_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anaddb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpi_procs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.from_ddb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.from_ddb" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and instance of the object. Runs anaddb along the specified
directions or the standard directions in the standard paths given
in <a class="bibtex reference internal" href="../zzbiblio.html#setyawan2010" id="id12">[Setyawan2010]</a>. The values of the speed of sound
will be calculated as the slope of the linear fits along each direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddb_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – path to the ddb file.</p></li>
<li><p><strong>directions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of qpoints identifying the directions for the calculation
of the speed of sound. In fractional coordinates.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of string with the name of the directions.</p></li>
<li><p><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of points calculated along each direction and used to
fit the speed of sound.</p></li>
<li><p><strong>qpt_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Norm of the largest point in fractional coordinates for
each of the directions considered.</p></li>
<li><p><strong>ignore_neg_freqs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if True points with negative frequencies will not be
considered in the fit, in order to ignore inaccuracies in the long range
behavior.</p></li>
<li><p><strong>asr</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>chneut</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>dipdip</strong> – Anaddb input variable. See official documentation.</p></li>
<li><p><strong>ngqpt</strong> – Number of divisions for the q-mesh in the DDB file. Auto-detected if None (default).</p></li>
<li><p><strong>anaddb_kwargs</strong> – additional kwargs for anaddb.</p></li>
<li><p><strong>verbose</strong> – verbosity level. Set it to a value &gt; 0 to get more information.</p></li>
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>workdir</strong> – Working directory. If None, a temporary directory is created.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="flowtk_api.html#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.TaskManager</span></code></a> object. If None, the object is initialized from the configuration file.</p></li>
</ul>
</dd>
</dl>
<p>Returns: an instance of SoundVelocity</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.from_phbst">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_phbst</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phbst_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_neg_freqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.from_phbst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.from_phbst" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of the object starting interpolating the acoustic frequencies
from a PHBST netcdf file.
The file should contain a series of directions starting from gamma and with the
same number of points for each direction, as the one produced in the from_ddb method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phbst_path</strong> – path to the PHBST netcdf file.</p></li>
<li><p><strong>ignore_neg_freqs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if True points with negative frequencies will not be
considered in the fit, in order to ignore inaccuracies in the long range
behavior.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of string with the name of the directions.</p></li>
</ul>
</dd>
</dl>
<p>Returns: an instance of SoundVelocity</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.get_dataframe">
<code class="sig-name descname"><span class="pre">get_dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.get_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.get_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the data of the speed of sound.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.plot_fit_freqs_dir">
<code class="sig-name descname"><span class="pre">plot_fit_freqs_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.plot_fit_freqs_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.plot_fit_freqs_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the phonon frequencies, if available, along the specified direction.
The line representing the fitted value will be shown as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idir</strong> – index of the direction.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the phonon frequencies, if available, along all the directions.
The lines representing the fitted values will be shown as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>units</strong> – Units for phonon plots. Possible values in (“eV”, “meV”, “Ha”, “cm-1”, “Thz”). Case-insensitive.</p></li>
<li><p><strong>fontsize</strong> – fontsize for legends and titles</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.3.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.dfpt.vsound.SoundVelocity.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/dfpt/vsound.html#SoundVelocity.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.dfpt.vsound.SoundVelocity.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, M. Giantomassi and the AbiPy group.<br/>
      Last updated on Mar 13, 2021.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>