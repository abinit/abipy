<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>flowtk Package &#8212; abipy 0.7.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iotools Package" href="iotools_api.html" />
    <link rel="prev" title="eph Package" href="eph_api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          abipy</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guide.html">Coding guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting AbiPy</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">flowtk Package</a><ul>
<li><a class="reference internal" href="#id1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flowtk</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.abiinspect"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiinspect</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.abiobjects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiobjects</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.abiphonopy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiphonopy</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.abitimer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abitimer</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.dfpt_works"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dfpt_works</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.eph_flows"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eph_flows</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.events"><code class="xref py py-mod docutils literal notranslate"><span class="pre">events</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.flows"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flows</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.gruneisen"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.gs_works"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gs_works</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.launcher"><code class="xref py py-mod docutils literal notranslate"><span class="pre">launcher</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.mocks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mocks</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.netcdf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdf</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.nodes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nodes</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.pseudos"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pseudos</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.qadapters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qadapters</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.qha"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.qjobs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qjobs</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.qutils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qutils</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.tasks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tasks</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.works"><code class="xref py py-mod docutils literal notranslate"><span class="pre">works</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.flowtk.wrappers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wrappers</span></code> Module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="eph_api.html" title="Previous Chapter: eph Package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; eph Package</span>
    </a>
  </li>
  <li>
    <a href="iotools_api.html" title="Next Chapter: iotools Package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">iotools Package &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/flowtk_api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="flowtk-package">
<h1><a class="toc-backref" href="#contents">flowtk Package</a><a class="headerlink" href="#flowtk-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#flowtk-package" id="id2">flowtk Package</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id3"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flowtk</span></code> Package</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.abiinspect" id="id4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiinspect</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.abiobjects" id="id5"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiobjects</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.abiphonopy" id="id6"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiphonopy</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.abitimer" id="id7"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abitimer</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.dfpt_works" id="id8"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dfpt_works</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.eph_flows" id="id9"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eph_flows</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.events" id="id10"><code class="xref py py-mod docutils literal notranslate"><span class="pre">events</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.flows" id="id11"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flows</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.gruneisen" id="id12"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.gs_works" id="id13"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gs_works</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.launcher" id="id14"><code class="xref py py-mod docutils literal notranslate"><span class="pre">launcher</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.mocks" id="id15"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mocks</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.netcdf" id="id16"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdf</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.nodes" id="id17"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nodes</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.pseudos" id="id18"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pseudos</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.qadapters" id="id19"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qadapters</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.qha" id="id20"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.qjobs" id="id21"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qjobs</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.qutils" id="id22"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qutils</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.tasks" id="id23"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tasks</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.utils" id="id24"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.works" id="id25"><code class="xref py py-mod docutils literal notranslate"><span class="pre">works</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.flowtk.wrappers" id="id26"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wrappers</span></code> Module</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flowtk</span></code> Package</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.flowtk"></span><dl class="function">
<dt id="abipy.flowtk.flow_main">
<code class="sig-prename descclassname">abipy.flowtk.</code><code class="sig-name descname">flow_main</code><span class="sig-paren">(</span><em class="sig-param">main</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk.html#flow_main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flow_main" title="Permalink to this definition">¶</a></dt>
<dd><p>This decorator is used to decorate main functions producing <cite>Flows</cite>.
It adds the initialization of the logger and an argument parser that allows one to select
the loglevel, the workdir of the flow as well as the YAML file with the parameters of the <cite>TaskManager</cite>.
The main function shall have the signature:</p>
<blockquote>
<div><p>main(options)</p>
</div></blockquote>
<p>where options in the container with the command line options generated by <cite>ArgumentParser</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>main</strong> – main function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.build_flow_main_parser">
<code class="sig-prename descclassname">abipy.flowtk.</code><code class="sig-name descname">build_flow_main_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk.html#build_flow_main_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.build_flow_main_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and return the parser used in the abipy/data/runs scripts.</p>
</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.abiinspect">
<span id="abiinspect-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiinspect</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.abiinspect" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.flowtk.abiobjects">
<span id="abiobjects-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiobjects</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.abiobjects" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="abipy.flowtk.abiobjects.LujForSpecie">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.abiobjects.</code><code class="sig-name descname">LujForSpecie</code><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LujForSpecie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LujForSpecie" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.abiobjects.LdauForSpecie</span></code></p>
<p>This object stores the value of l, u, j used for a single atomic specie.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.abiobjects.LdauParams">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.abiobjects.</code><code class="sig-name descname">LdauParams</code><span class="sig-paren">(</span><em class="sig-param">usepawu</em>, <em class="sig-param">structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LdauParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LdauParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores the parameters for LDA+U calculations with the PAW method
It facilitates the specification of the U-J parameters in the Abinit input file.
(see <cite>to_abivars</cite>). The U-J operator will be applied only on the atomic species
that have been selected by calling <cite>lui_for_symbol</cite>.</p>
<p>To setup the Abinit variables for a LDA+U calculation in NiO with a
U value of 5 eV applied on the nickel atoms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">luj_params</span> <span class="o">=</span> <span class="n">LdauParams</span><span class="p">(</span><span class="n">usepawu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">nio_structure</span><span class="p">)</span>
<span class="c1"># Apply U-J on Ni only.</span>
<span class="n">u</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">luj_params</span><span class="o">.</span><span class="n">luj_for_symbol</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">u</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;eV&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">luj_params</span><span class="o">.</span><span class="n">to_abivars</span><span class="p">())</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.flowtk.abiobjects.LdauParams.symbols_by_typat">
<em class="property">property </em><code class="sig-name descname">symbols_by_typat</code><a class="headerlink" href="#abipy.flowtk.abiobjects.LdauParams.symbols_by_typat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiobjects.LdauParams.luj_for_symbol">
<code class="sig-name descname">luj_for_symbol</code><span class="sig-paren">(</span><em class="sig-param">symbol</em>, <em class="sig-param">l</em>, <em class="sig-param">u</em>, <em class="sig-param">j</em>, <em class="sig-param">unit='eV'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LdauParams.luj_for_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LdauParams.luj_for_symbol" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> – Chemical symbol of the atoms on which LDA+U should be applied.</p></li>
<li><p><strong>l</strong> – Angular momentum.</p></li>
<li><p><strong>u</strong> – Value of U.</p></li>
<li><p><strong>j</strong> – Value of J.</p></li>
<li><p><strong>unit</strong> – Energy unit of U and J.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiobjects.LdauParams.to_abivars">
<code class="sig-name descname">to_abivars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LdauParams.to_abivars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LdauParams.to_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with the Abinit variables.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.abiobjects.LexxParams">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.abiobjects.</code><code class="sig-name descname">LexxParams</code><span class="sig-paren">(</span><em class="sig-param">structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LexxParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LexxParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores the parameters for local exact exchange calculations with the PAW method
It facilitates the specification of the LEXX parameters in the Abinit input file.
(see <cite>to_abivars</cite>). The LEXX operator will be applied only on the atomic species
that have been selected by calling <cite>lexx_for_symbol</cite>.</p>
<p>To perform a LEXX calculation for NiO in which the LEXX is computed only for the l=2
channel of the nickel atoms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lexx_params</span> <span class="o">=</span> <span class="n">LexxParams</span><span class="p">(</span><span class="n">nio_structure</span><span class="p">)</span>
<span class="n">lexx_params</span><span class="o">.</span><span class="n">lexx_for_symbol</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">lexc_params</span><span class="o">.</span><span class="n">to_abivars</span><span class="p">())</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.flowtk.abiobjects.LexxParams.symbols_by_typat">
<em class="property">property </em><code class="sig-name descname">symbols_by_typat</code><a class="headerlink" href="#abipy.flowtk.abiobjects.LexxParams.symbols_by_typat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiobjects.LexxParams.lexx_for_symbol">
<code class="sig-name descname">lexx_for_symbol</code><span class="sig-paren">(</span><em class="sig-param">symbol</em>, <em class="sig-param">l</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LexxParams.lexx_for_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LexxParams.lexx_for_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable LEXX for the given chemical symbol and the angular momentum l</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> – Chemical symbol of the atoms on which LEXX should be applied.</p></li>
<li><p><strong>l</strong> – Angular momentum.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiobjects.LexxParams.to_abivars">
<code class="sig-name descname">to_abivars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiobjects.html#LexxParams.to_abivars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiobjects.LexxParams.to_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with the Abinit variables.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.abiphonopy">
<span id="abiphonopy-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abiphonopy</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.abiphonopy" title="Permalink to this headline">¶</a></h2>
<p>Interface between phonopy and abipy workflow model.</p>
<dl class="function">
<dt id="abipy.flowtk.abiphonopy.atoms_from_structure">
<code class="sig-prename descclassname">abipy.flowtk.abiphonopy.</code><code class="sig-name descname">atoms_from_structure</code><span class="sig-paren">(</span><em class="sig-param">structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#atoms_from_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.atoms_from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pymatgen Structure into a phonopy Atoms object.</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.abiphonopy.structure_from_atoms">
<code class="sig-prename descclassname">abipy.flowtk.abiphonopy.</code><code class="sig-name descname">structure_from_atoms</code><span class="sig-paren">(</span><em class="sig-param">atoms</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#structure_from_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.structure_from_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a phonopy Atoms object into a pymatgen Structure.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.abiphonopy.</code><code class="sig-name descname">PhonopyWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>This work computes the inter-atomic force constants with phonopy.</p>
<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.scdims">
<code class="sig-name descname">scdims</code><span class="sig-paren">(</span><em class="sig-param">3</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.scdims" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy arrays with the number of cells in the supercell along the three reduced directions</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.phonon">
<code class="sig-name descname">phonon</code><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.phonon" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Phonopy</span></code> object used to construct the supercells with displaced atoms.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.phonopy_tasks">
<code class="sig-name descname">phonopy_tasks</code><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.phonopy_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">ScfTask</span></code>. Each task compute the forces in one perturbed supercell.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.bec_tasks">
<code class="sig-name descname">bec_tasks</code><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.bec_tasks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.cpdata2dst">
<code class="sig-name descname">cpdata2dst</code><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.cpdata2dst" title="Permalink to this definition">¶</a></dt>
<dd><p>If not None, the work will copy the output results to the outdir of the flow
once all_ok is invoked. Note that cpdata2dst must be an absolute path.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.from_gs_input">
<em class="property">classmethod </em><code class="sig-name descname">from_gs_input</code><span class="sig-paren">(</span><em class="sig-param">gsinp</em>, <em class="sig-param">scdims</em>, <em class="sig-param">phonopy_kwargs=None</em>, <em class="sig-param">displ_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyWork.from_gs_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.from_gs_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the work from an <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsinp</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculation in the initial unit cell.</p></li>
<li><p><strong>scdims</strong> – Number of unit cell replicas along the three reduced directions.</p></li>
<li><p><strong>phonopy_kwargs</strong> – (Optional) dictionary with arguments passed to Phonopy constructor.</p></li>
<li><p><strong>displ_kwargs</strong> – (Optional) dictionary with arguments passed to generate_displacements.</p></li>
</ul>
</dd>
</dl>
<p>Return: PhonopyWork instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiphonopy.PhonopyWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called once the <cite>Work</cite> is completed i.e. when all the tasks
have reached status S_OK. Here we get the forces from the output files, and
we call phonopy to compute the inter-atomic force constants.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.abiphonopy.PhonopyGruneisenWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.abiphonopy.</code><code class="sig-name descname">PhonopyGruneisenWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyGruneisenWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyGruneisenWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>This work computes the Grüneisen parameters with phonopy. The workflow is as follows:</p>
<p>It is necessary to run three phonon calculations.
One is calculated at the equilibrium volume and the remaining two are calculated
at the slightly larger volume and smaller volume than the equilibrium volume.
The unitcells at these volumes have to be fully relaxed under the constraint of each volume.</p>
<dl class="attribute">
<dt id="abipy.flowtk.abiphonopy.PhonopyGruneisenWork.scdims">
<code class="sig-name descname">scdims</code><span class="sig-paren">(</span><em class="sig-param">3</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyGruneisenWork.scdims" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy arrays with the number of cells in the supercell along the three reduced directions.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiphonopy.PhonopyGruneisenWork.from_gs_input">
<em class="property">classmethod </em><code class="sig-name descname">from_gs_input</code><span class="sig-paren">(</span><em class="sig-param">gsinp</em>, <em class="sig-param">voldelta</em>, <em class="sig-param">scdims</em>, <em class="sig-param">phonopy_kwargs=None</em>, <em class="sig-param">displ_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyGruneisenWork.from_gs_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyGruneisenWork.from_gs_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the work from an <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsinp</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculation in the initial unit cell.</p></li>
<li><p><strong>voldelta</strong> – Absolute increment for unit cell volume. The three volumes are:
[v0 - voldelta, v0, v0 + voldelta] where v0 is taken from gsinp.structure.</p></li>
<li><p><strong>scdims</strong> – Number of unit cell replicas along the three reduced directions.</p></li>
<li><p><strong>phonopy_kwargs</strong> – (Optional) dictionary with arguments passed to Phonopy constructor.</p></li>
<li><p><strong>displ_kwargs</strong> – (Optional) dictionary with arguments passed to generate_displacements.</p></li>
</ul>
</dd>
</dl>
<p>Return: <cite>PhonopyGruneisenWork</cite> instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiphonopy.PhonopyGruneisenWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyGruneisenWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyGruneisenWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called once the <cite>Work</cite> is completed i.e. when all the tasks
have reached status S_OK.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.abiphonopy.PhonopyGruneisenWork.add_phonopy_works_and_build">
<code class="sig-name descname">add_phonopy_works_and_build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/abiphonopy.html#PhonopyGruneisenWork.add_phonopy_works_and_build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.abiphonopy.PhonopyGruneisenWork.add_phonopy_works_and_build" title="Permalink to this definition">¶</a></dt>
<dd><p>Get relaxed structures from the tasks, build Phonopy works with supercells
constructed from the new structures, add them to the flow and build new directories.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.abitimer">
<span id="abitimer-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abitimer</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.abitimer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.flowtk.dfpt_works">
<span id="dfpt-works-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dfpt_works</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.dfpt_works" title="Permalink to this headline">¶</a></h2>
<p>Work subclasses related to DFTP.</p>
<dl class="class">
<dt id="abipy.flowtk.dfpt_works.ElasticWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.dfpt_works.</code><code class="sig-name descname">ElasticWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/dfpt_works.html#ElasticWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.dfpt_works.ElasticWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>This Work computes the elastic constants and (optionally) the piezoelectric tensor.
It consists of Response function calculations for:</p>
<blockquote>
<div><ul class="simple">
<li><p>rigid-atom elastic tensor</p></li>
<li><p>rigid-atom piezoelectric tensor</p></li>
<li><p>interatomic force constants at gamma</p></li>
<li><p>Born effective charges</p></li>
</ul>
</div></blockquote>
<p>The structure is assumed to be already relaxed</p>
<p>Create a <cite>Flow</cite> for phonon calculations. The flow has one works with:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 GS Task</p></li>
<li><p>3 DDK Task</p></li>
<li><p>4 Phonon Tasks (Gamma point)</p></li>
<li><p>6 Elastic tasks (3 uniaxial + 3 shear strain)</p></li>
</ul>
</div></blockquote>
<p>The Phonon tasks and the elastic task will read the DDK produced at the beginning</p>
<dl class="method">
<dt id="abipy.flowtk.dfpt_works.ElasticWork.from_scf_input">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_input</code><span class="sig-paren">(</span><em class="sig-param">scf_input</em>, <em class="sig-param">with_relaxed_ion=True</em>, <em class="sig-param">with_piezo=False</em>, <em class="sig-param">with_dde=False</em>, <em class="sig-param">tolerances=None</em>, <em class="sig-param">den_deps=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/dfpt_works.html#ElasticWork.from_scf_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.dfpt_works.ElasticWork.from_scf_input" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_input</strong> – </p></li>
<li><p><strong>with_relaxed_ion</strong> – </p></li>
<li><p><strong>with_piezo</strong> – </p></li>
<li><p><strong>with_dde</strong> – Compute electric field perturbations.</p></li>
<li><p><strong>tolerances</strong> – Dict of tolerances</p></li>
<li><p><strong>den_deps</strong> – </p></li>
<li><p><strong>manager</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Similar to <cite>from_scf_task</cite>, the difference is that this method requires
an input for SCF calculation instead of a ScfTask. All the tasks (Scf + Phonon)
are packed in a single Work whereas in the previous case we usually have multiple works.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.dfpt_works.ElasticWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/dfpt_works.html#ElasticWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.dfpt_works.ElasticWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the tasks of the Work reach S_OK.
Ir runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.dfpt_works.NscfDdksWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.dfpt_works.</code><code class="sig-name descname">NscfDdksWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/dfpt_works.html#NscfDdksWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.dfpt_works.NscfDdksWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>This work requires a DEN file and computes the KS energies with a non self-consistent task
with a dense k-mesh and empty states.
This task is then followed by the computation of the DDK matrix elements with nstep = 1
(the first order change of the wavefunctions is not converged but we only need the matrix elements)
Mainly used to prepare optic calculations or other post-processing steps requiring the DDKs.</p>
<dl class="method">
<dt id="abipy.flowtk.dfpt_works.NscfDdksWork.from_scf_task">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_task</code><span class="sig-paren">(</span><em class="sig-param">scf_task</em>, <em class="sig-param">ddk_ngkpt</em>, <em class="sig-param">ddk_shiftk</em>, <em class="sig-param">ddk_nband</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/dfpt_works.html#NscfDdksWork.from_scf_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.dfpt_works.NscfDdksWork.from_scf_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Build NscfDdksWork from a scf_task.
:param scf_task: GS task. Must produce the DEN file required for the NSCF run.
:param ddk_ngkpt: k-mesh used for the NSCF run and the non self-consistent DDK tasks.
:param ddk_shiftk: k-mesh shifts
:param ddk_nband: Number of bands (occupied + empty) used in the NSCF task and the DDKs tasks.
:param manager: TaskManager instance. Use default if None.</p>
<p>Return: NscfDdksWork instance</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.eph_flows">
<span id="eph-flows-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eph_flows</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.eph_flows" title="Permalink to this headline">¶</a></h2>
<p>Flows for electron-phonon calculations (high-level interface)</p>
<dl class="class">
<dt id="abipy.flowtk.eph_flows.GkqPathFlow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.eph_flows.</code><code class="sig-name descname">GkqPathFlow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/eph_flows.html#GkqPathFlow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.eph_flows.GkqPathFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
<p>This flow computes the gkq e-ph matrix elements &lt;k+q|Delta V_q|k&gt; for a list of q-points (usually a q-path).
The results stored in the GKQ.nc files for the different q-points can be used to analyze the behaviour
of the e-ph matrix elements as a function of q with the the objects provided by the abipy.eph.gkq module.
It is also possible to compute the e-ph matrix elements using the interpolated DFPT potentials
if test_ft_interpolation is set to True.</p>
<dl class="method">
<dt id="abipy.flowtk.eph_flows.GkqPathFlow.from_scf_input">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_input</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">scf_input</em>, <em class="sig-param">ngqpt</em>, <em class="sig-param">qbounds</em>, <em class="sig-param">ndivsm=5</em>, <em class="sig-param">with_becs=True</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">test_ft_interpolation=False</em>, <em class="sig-param">prepgkk=0</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/eph_flows.html#GkqPathFlow.from_scf_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.eph_flows.GkqPathFlow.from_scf_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the flow from an input file representing a GS calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workdir</strong> – Path to the working directory.</p></li>
<li><p><strong>scf_input</strong> – Input for the GS SCF run.</p></li>
<li><p><strong>ngqpt</strong> – 3 integers defining the q-mesh.</p></li>
<li><p><strong>qbounds</strong> – List of boundaries defining the q-path used for the computation of the GKQ files.
The q-path is automatically generated using <cite>ndivsm</cite> and the reciprocal-space metric.
If <cite>ndivsm</cite> is negative, the code assumes that <cite>qbounds</cite> contains the full list of q-points
and no pre-processing is performed.</p></li>
<li><p><strong>with_becs</strong> – Activate calculation of Electric field and Born effective charges.</p></li>
<li><p><strong>ddk_tolerance</strong> – dict {“varname”: value} with the tolerance used in the DDK run if <cite>with_becs</cite>.</p></li>
<li><p><strong>test_ft_interpolation</strong> – True to add an extra Work in which the GKQ files are computed
using the interpolated DFPT potentials and the q-mesh defined by <cite>ngqpt</cite>.
The quality of the interpolation depends on the convergence of the BECS, epsinf and <cite>ngqpt</cite>.</p></li>
<li><p><strong>prepgkk</strong> – 1 to activate computation of all 3*natom perts (debugging option).</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.tasks.TaskManager</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.events">
<span id="events-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">events</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.events" title="Permalink to this headline">¶</a></h2>
<p>This module defines the events signaled by abinit during the execution. It also
provides a parser to extract these events form the main output file and the log file.</p>
<dl class="class">
<dt id="abipy.flowtk.events.ScfConvergenceWarning">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">ScfConvergenceWarning</code><span class="sig-paren">(</span><em class="sig-param">src_file</em>, <em class="sig-param">src_line</em>, <em class="sig-param">message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#ScfConvergenceWarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.ScfConvergenceWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.events.AbinitCriticalWarning</span></code></p>
<p>Warning raised when the GS SCF cycle did not converge.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.ScfConvergenceWarning.yaml_tag">
<code class="sig-name descname">yaml_tag</code><em class="property"> = '!ScfConvergenceWarning'</em><a class="headerlink" href="#abipy.flowtk.events.ScfConvergenceWarning.yaml_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.NscfConvergenceWarning">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">NscfConvergenceWarning</code><span class="sig-paren">(</span><em class="sig-param">src_file</em>, <em class="sig-param">src_line</em>, <em class="sig-param">message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#NscfConvergenceWarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.NscfConvergenceWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.events.AbinitCriticalWarning</span></code></p>
<p>Warning raised when the GS NSCF cycle did not converge.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.NscfConvergenceWarning.yaml_tag">
<code class="sig-name descname">yaml_tag</code><em class="property"> = '!NscfConvergenceWarning'</em><a class="headerlink" href="#abipy.flowtk.events.NscfConvergenceWarning.yaml_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.RelaxConvergenceWarning">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">RelaxConvergenceWarning</code><span class="sig-paren">(</span><em class="sig-param">src_file</em>, <em class="sig-param">src_line</em>, <em class="sig-param">message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#RelaxConvergenceWarning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.RelaxConvergenceWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.events.AbinitCriticalWarning</span></code></p>
<p>Warning raised when the structural relaxation did not converge.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.RelaxConvergenceWarning.yaml_tag">
<code class="sig-name descname">yaml_tag</code><em class="property"> = '!RelaxConvergenceWarning'</em><a class="headerlink" href="#abipy.flowtk.events.RelaxConvergenceWarning.yaml_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.EventsParser">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">EventsParser</code><a class="reference internal" href="../_modules/abipy/flowtk/events.html#EventsParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.EventsParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Parses the output or the log file produced by ABINIT and extract the list of events.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.EventsParser.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.events.EventsParser.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">EventsParserError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.EventsParser.parse">
<code class="sig-name descname">parse</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#EventsParser.parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.EventsParser.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the given file. Return <code class="xref py py-class docutils literal notranslate"><span class="pre">EventReport</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.EventsParser.report_exception">
<code class="sig-name descname">report_exception</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">exc</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#EventsParser.report_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.EventsParser.report_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is used when self.parser raises an Exception so that
we can report a customized <code class="xref py py-class docutils literal notranslate"><span class="pre">EventReport</span></code> object with info the exception.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.Correction">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">Correction</code><span class="sig-paren">(</span><em class="sig-param">handler</em>, <em class="sig-param">actions</em>, <em class="sig-param">event</em>, <em class="sig-param">reset=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#Correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.Correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.events.Correction.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#Correction.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.Correction.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A JSON serializable dict representation of an object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.Correction.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#Correction.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.Correction.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> – Dict representation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MSONable class.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.events.get_event_handler_classes">
<code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">get_event_handler_classes</code><span class="sig-paren">(</span><em class="sig-param">categories=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#get_event_handler_classes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.get_event_handler_classes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of handler classes.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.DilatmxError">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">DilatmxError</code><span class="sig-paren">(</span><em class="sig-param">src_file</em>, <em class="sig-param">src_line</em>, <em class="sig-param">message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.events.AbinitError</span></code></p>
<p>This Error occurs in variable cell calculations when the increase in the
unit cell volume is too large.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.DilatmxError.yaml_tag">
<code class="sig-name descname">yaml_tag</code><em class="property"> = '!DilatmxError'</em><a class="headerlink" href="#abipy.flowtk.events.DilatmxError.yaml_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.events.DilatmxErrorHandler">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.events.</code><code class="sig-name descname">DilatmxErrorHandler</code><span class="sig-paren">(</span><em class="sig-param">max_dilatmx=1.3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxErrorHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.events.ErrorHandler</span></code></p>
<p>Handle DilatmxError. Abinit produces a netcdf file with the last structure before aborting
The handler changes the structure in the input with the last configuration and modify the value of dilatmx.</p>
<dl class="attribute">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.event_class">
<code class="sig-name descname">event_class</code><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.event_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.flowtk.events.DilatmxError" title="abipy.flowtk.events.DilatmxError"><code class="xref py py-class docutils literal notranslate"><span class="pre">DilatmxError</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.can_change_physics">
<code class="sig-name descname">can_change_physics</code><em class="property"> = False</em><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.can_change_physics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxErrorHandler.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic implementation of as_dict if __init__ has no arguments. Subclasses may need to overwrite.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxErrorHandler.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic implementation of from_dict if __init__ has no arguments. Subclasses may need to overwrite.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.handle_task_event">
<code class="sig-name descname">handle_task_event</code><span class="sig-paren">(</span><em class="sig-param">task</em>, <em class="sig-param">event</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxErrorHandler.handle_task_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.handle_task_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to handle Abinit events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> object.</p></li>
<li><p><strong>event</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitEvent</span></code> found in the log file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 if no action has been applied, 1 if the problem has been fixed.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.events.DilatmxErrorHandler.handle_input_event">
<code class="sig-name descname">handle_input_event</code><span class="sig-paren">(</span><em class="sig-param">abiinput</em>, <em class="sig-param">outdir</em>, <em class="sig-param">event</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/events.html#DilatmxErrorHandler.handle_input_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.events.DilatmxErrorHandler.handle_input_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.flows">
<span id="flows-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">flows</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.flows" title="Permalink to this headline">¶</a></h2>
<p>A Flow is a container for Works, and works consist of tasks.
Flows are the final objects that can be dumped directly to a pickle file on disk
Flows are executed using abirun (abipy).</p>
<dl class="class">
<dt id="abipy.flowtk.flows.Flow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.flows.</code><code class="sig-name descname">Flow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.nodes.Node</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.NodeContainer</span></code>, <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<p>This object is a container of work. Its main task is managing the
possible inter-dependencies among the work and the creation of
dynamic workflows that are generated by callbacks registered by the user.</p>
<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.creation_date">
<code class="sig-name descname">creation_date</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.creation_date" title="Permalink to this definition">¶</a></dt>
<dd><p>String with the creation_date</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.pickle_protocol">
<code class="sig-name descname">pickle_protocol</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Protocol for Pickle database (default: -1 i.e. latest protocol)</p>
</dd></dl>

<p>Important methods for constructing flows:</p>
<blockquote>
<div><p>register_work: register (add) a work to the flow
resister_task: register a work that contains only this task returns the work
allocate: propagate the workdir and manager of the flow to all the registered tasks
build:
build_and_pickle_dump:</p>
</div></blockquote>
<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.VERSION">
<code class="sig-name descname">VERSION</code><em class="property"> = '0.1'</em><a class="headerlink" href="#abipy.flowtk.flows.Flow.VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.PICKLE_FNAME">
<code class="sig-name descname">PICKLE_FNAME</code><em class="property"> = '__AbinitFlow__.pickle'</em><a class="headerlink" href="#abipy.flowtk.flows.Flow.PICKLE_FNAME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowError</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.flows.Flow.Results">
<code class="sig-name descname">Results</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.Results" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowResults</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.from_inputs">
<em class="property">classmethod </em><code class="sig-name descname">from_inputs</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">inputs</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">task_class=&lt;class 'abipy.flowtk.tasks.ScfTask'&gt;</em>, <em class="sig-param">work_class=&lt;class 'abipy.flowtk.works.Work'&gt;</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.from_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.from_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a simple flow from a list of inputs. The flow contains a single Work with
tasks whose class is given by task_class.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t use this interface if you have dependencies among the tasks.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workdir</strong> – String specifying the directory where the works will be produced.</p></li>
<li><p><strong>inputs</strong> – List of inputs.</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object responsible for the submission of the jobs.
If manager is None, the object is initialized from the yaml file
located either in the working directory or in the user configuration dir.</p></li>
<li><p><strong>pickle_protocol</strong> – Pickle protocol version used for saving the status of the object.
-1 denotes the latest version supported by the python interpreter.</p></li>
<li><p><strong>task_class</strong> – The class of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>.</p></li>
<li><p><strong>work_class</strong> – The class of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code>.</p></li>
<li><p><strong>remove</strong> – attempt to remove working directory <cite>workdir</cite> if directory already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.as_flow">
<em class="property">classmethod </em><code class="sig-name descname">as_flow</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.as_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.as_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a Flow. Accepts filepath, dict, or Flow object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON serialization, note that we only need to save
a string with the working directory since the object will be
reconstructed from the pickle file located in workdir</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.flowtk.flows.Flow.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON serialization, note that we only need to save
a string with the working directory since the object will be
reconstructed from the pickle file located in workdir</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct the flow from the pickle file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.temporary_flow">
<em class="property">classmethod </em><code class="sig-name descname">temporary_flow</code><span class="sig-paren">(</span><em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.temporary_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.temporary_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Flow in a temporary directory. Useful for unit tests.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.set_workdir">
<code class="sig-name descname">set_workdir</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">chroot=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.set_workdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.set_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the working directory. Cannot be set more than once unless chroot is True</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.reload">
<code class="sig-name descname">reload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.reload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the flow from the pickle file. Used when we are monitoring the flow
executed by the scheduler. In this case, indeed, the flow might have been changed
by the scheduler and we have to reload the new flow in memory.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pickle_load">
<em class="property">classmethod </em><code class="sig-name descname">pickle_load</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">spectator_mode=True</em>, <em class="sig-param">remove_lock=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.pickle_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file and performs initial setup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – Filename or directory name. It filepath is a directory, we
scan the directory tree starting from filepath and we
read the first pickle database. Raise RuntimeError if multiple
databases are found.</p></li>
<li><p><strong>spectator_mode</strong> – If True, the nodes of the flow are not connected by signals.
This option is usually used when we want to read a flow
in read-only mode and we want to avoid callbacks that can change the flow.</p></li>
<li><p><strong>remove_lock</strong> – True to remove the file lock if any (use it carefully).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">spectator_mode=True</em>, <em class="sig-param">remove_lock=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.flowtk.flows.Flow.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file and performs initial setup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> – Filename or directory name. It filepath is a directory, we
scan the directory tree starting from filepath and we
read the first pickle database. Raise RuntimeError if multiple
databases are found.</p></li>
<li><p><strong>spectator_mode</strong> – If True, the nodes of the flow are not connected by signals.
This option is usually used when we want to read a flow
in read-only mode and we want to avoid callbacks that can change the flow.</p></li>
<li><p><strong>remove_lock</strong> – True to remove the file lock if any (use it carefully).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pickle_loads">
<em class="property">classmethod </em><code class="sig-name descname">pickle_loads</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.pickle_loads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct the flow from a string.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.set_pyfile">
<code class="sig-name descname">set_pyfile</code><span class="sig-paren">(</span><em class="sig-param">pyfile</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.set_pyfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.set_pyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the path of the python script used to generate the flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pyfile">
<em class="property">property </em><code class="sig-name descname">pyfile</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.pyfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the python script used to generate the flow. Set by <cite>set_pyfile</cite></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pid_file">
<em class="property">property </em><code class="sig-name descname">pid_file</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.pid_file" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the pid file created by PyFlowScheduler.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.has_scheduler">
<em class="property">property </em><code class="sig-name descname">has_scheduler</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.has_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>True if there’s a scheduler running the flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.check_pid_file">
<code class="sig-name descname">check_pid_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.check_pid_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.check_pid_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks if we are already running the <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> with a <code class="xref py py-class docutils literal notranslate"><span class="pre">PyFlowScheduler</span></code>.
Raises: Flow.Error if the pid file of the scheduler exists.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pickle_file">
<em class="property">property </em><code class="sig-name descname">pickle_file</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_file" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the pickle file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.mongo_id">
<em class="property">property </em><code class="sig-name descname">mongo_id</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.mongo_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.validate_json_schema">
<code class="sig-name descname">validate_json_schema</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.validate_json_schema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.validate_json_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate the JSON schema. Return list of errors.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_mongo_info">
<code class="sig-name descname">get_mongo_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_mongo_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_mongo_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a JSON dictionary with information on the flow.
Mainly used for constructing the info section in <cite>FlowEntry</cite>.
The default implementation is empty. Subclasses must implement it</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.mongo_assimilate">
<code class="sig-name descname">mongo_assimilate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.mongo_assimilate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.mongo_assimilate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called by client code when the flow is completed
Return a JSON dictionary with the most important results produced
by the flow. The default implementation is empty. Subclasses must implement it</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.works">
<em class="property">property </em><code class="sig-name descname">works</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.works" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> objects contained in self..</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.all_ok">
<em class="property">property </em><code class="sig-name descname">all_ok</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>True if all the tasks in works have reached <cite>S_OK</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.num_tasks">
<em class="property">property </em><code class="sig-name descname">num_tasks</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.num_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of tasks</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.errored_tasks">
<em class="property">property </em><code class="sig-name descname">errored_tasks</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.errored_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>List of errored tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.num_errored_tasks">
<em class="property">property </em><code class="sig-name descname">num_errored_tasks</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.num_errored_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks whose status is <cite>S_ERROR</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.unconverged_tasks">
<em class="property">property </em><code class="sig-name descname">unconverged_tasks</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.unconverged_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>List of unconverged tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.num_unconverged_tasks">
<em class="property">property </em><code class="sig-name descname">num_unconverged_tasks</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.num_unconverged_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of tasks whose status is <cite>S_UNCONVERGED</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.status_counter">
<em class="property">property </em><code class="sig-name descname">status_counter</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.status_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">Counter</span></code> object that counts the number of tasks with
given status (use the string representation of the status as key).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.ncores_reserved">
<em class="property">property </em><code class="sig-name descname">ncores_reserved</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.ncores_reserved" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of cores reserved in this moment.
A core is reserved if the task is not running but
we have submitted the task to the queue manager.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.ncores_allocated">
<em class="property">property </em><code class="sig-name descname">ncores_allocated</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.ncores_allocated" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of cores allocated in this moment.
A core is allocated if it’s running a task or if we have
submitted a task to the queue manager but the job is still pending.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.ncores_used">
<em class="property">property </em><code class="sig-name descname">ncores_used</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.ncores_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of cores used in this moment.
A core is used if there’s a job that is running on it.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.has_chrooted">
<em class="property">property </em><code class="sig-name descname">has_chrooted</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.has_chrooted" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string that evaluates to True if we have changed
the workdir for visualization purposes e.g. we are using sshfs.
to mount the remote directory where the <cite>Flow</cite> is located.
The string gives the previous workdir of the flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.chroot">
<code class="sig-name descname">chroot</code><span class="sig-paren">(</span><em class="sig-param">new_workdir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.chroot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.chroot" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the workir of the <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a>. Mainly used for
allowing the user to open the GUI on the local host
and access the flow from remote via sshfs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling this method will make the flow go in read-only mode.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.groupby_status">
<code class="sig-name descname">groupby_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.groupby_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.groupby_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a ordered dictionary mapping the task status to
the list of named tuples (task, work_index, task_index).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.groupby_task_class">
<code class="sig-name descname">groupby_task_class</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.groupby_task_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.groupby_task_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary mapping the task class to the list of tasks in the flow</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.iflat_nodes">
<code class="sig-name descname">iflat_nodes</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">op='=='</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.iflat_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.iflat_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Generators that produces a flat sequence of nodes.
if status is not None, only the tasks with the specified status are selected.
nids is an optional list of node identifiers used to filter the nodes.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.node_from_nid">
<code class="sig-name descname">node_from_nid</code><span class="sig-paren">(</span><em class="sig-param">nid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.node_from_nid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.node_from_nid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the node in the <cite>Flow</cite> with the given <cite>nid</cite> identifier</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.iflat_tasks_wti">
<code class="sig-name descname">iflat_tasks_wti</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">op='=='</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.iflat_tasks_wti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.iflat_tasks_wti" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator to iterate over all the tasks of the <cite>Flow</cite>.
:Yields: (task, work_index, task_index)</p>
<p>If status is not None, only the tasks whose status satisfies
the condition (task.status op status) are selected
status can be either one of the flags defined in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class
(e.g Task.S_OK) or a string e.g “S_OK”
nids is an optional list of node identifiers used to filter the tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.iflat_tasks">
<code class="sig-name descname">iflat_tasks</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">op='=='</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.iflat_tasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.iflat_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator to iterate over all the tasks of the <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a>.</p>
<p>If status is not None, only the tasks whose status satisfies
the condition (task.status op status) are selected
status can be either one of the flags defined in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class
(e.g Task.S_OK) or a string e.g “S_OK”
nids is an optional list of node identifiers used to filter the tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.abivalidate_inputs">
<code class="sig-name descname">abivalidate_inputs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.abivalidate_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.abivalidate_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Run ABINIT in dry mode to validate all the inputs of the flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>(isok, tuples)</p>
<p>isok is True if all inputs are ok.
tuples is List of <cite>namedtuple</cite> objects, one for each task in the flow.
Each namedtuple has the following attributes:</p>
<blockquote>
<div><p>retcode: Return code. 0 if OK.
log_file:  log file of the Abinit run, use log_file.read() to access its content.
stderr_file: stderr file of the Abinit run. use stderr_file.read() to access its content.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.8)"><strong>RuntimeError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.check_dependencies">
<code class="sig-name descname">check_dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.check_dependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.check_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the dependencies of the nodes for possible deadlocks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.find_deadlocks">
<code class="sig-name descname">find_deadlocks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.find_deadlocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.find_deadlocks" title="Permalink to this definition">¶</a></dt>
<dd><p>This function detects deadlocks</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>deadlocks, runnables, running</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>named tuple with the tasks grouped in</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.check_status">
<code class="sig-name descname">check_status</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.check_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.check_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status of the works in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> – True to show the status of the flow.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to show_status</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.status">
<em class="property">property </em><code class="sig-name descname">status</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.status" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> i.e. the minimum of the status of its tasks and its works</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.fix_abicritical">
<code class="sig-name descname">fix_abicritical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.fix_abicritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.fix_abicritical" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tries to fix critical events originating from ABINIT.
Returns the number of tasks that have been fixed.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.fix_queue_critical">
<code class="sig-name descname">fix_queue_critical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.fix_queue_critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.fix_queue_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tries to fix critical events originating from the queue submission system.</p>
<p>Returns the number of tasks that have been fixed.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_info">
<code class="sig-name descname">show_info</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print info on the flow i.e. total number of tasks, works, tasks grouped by class.</p>
<p class="rubric">Example</p>
<p>Task Class      Number
————  ——–
ScfTask              1
NscfTask             1
ScrTask              2
SigmaTask            6</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_summary">
<code class="sig-name descname">show_summary</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a short summary with the status of the flow and a counter task_status –&gt; number_of_tasks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stream</strong> – File-like object, Default: sys.stdout</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Status       Count
———  ——-
Completed       10</p>
<p>&lt;Flow, node_id=27163, workdir=flow_gwconv_ecuteps&gt;, num_tasks=10, all_ok=True</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_status">
<code class="sig-name descname">show_status</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the status of the works and the status  of the different tasks on the specified stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> – File-like object, Default: sys.stdout</p></li>
<li><p><strong>nids</strong> – List of node identifiers. By defaults all nodes are shown</p></li>
<li><p><strong>wslice</strong> – Slice object used to select works.</p></li>
<li><p><strong>verbose</strong> – Verbosity level (default 0). &gt; 0 to show only the works that are not finalized.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_events">
<code class="sig-name descname">show_events</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the Abinit events (ERRORS, WARNIING, COMMENTS) to stdout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> – if not None, only the tasks with this status are select</p></li>
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_corrections">
<code class="sig-name descname">show_corrections</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_corrections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the corrections applied to the flow at run-time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> – if not None, only the tasks with this status are select.</p></li>
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
</ul>
</dd>
</dl>
<p>Return: The number of corrections found.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_history">
<code class="sig-name descname">show_history</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">nids=None</em>, <em class="sig-param">full_history=False</em>, <em class="sig-param">metadata=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the history of the flow to stdout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> – if not None, only the tasks with this status are select</p></li>
<li><p><strong>full_history</strong> – Print full info set, including nodes with an empty history.</p></li>
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
<li><p><strong>metadata</strong> – print history metadata (experimental)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_inputs">
<code class="sig-name descname">show_inputs</code><span class="sig-paren">(</span><em class="sig-param">varnames=None</em>, <em class="sig-param">nids=None</em>, <em class="sig-param">wslice=None</em>, <em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the input of the tasks to the given stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>varnames</strong> – List of Abinit variables. If not None, only the variable in varnames
are selected and printed.</p></li>
<li><p><strong>nids</strong> – List of node identifiers. By defaults all nodes are shown</p></li>
<li><p><strong>wslice</strong> – Slice object used to select works.</p></li>
<li><p><strong>stream</strong> – File-like object, Default: sys.stdout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.listext">
<code class="sig-name descname">listext</code><span class="sig-paren">(</span><em class="sig-param">ext</em>, <em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.listext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.listext" title="Permalink to this definition">¶</a></dt>
<dd><p>Print to the given <cite>stream</cite> a table with the list of the output files
with the given <cite>ext</cite> produced by the flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.select_tasks">
<code class="sig-name descname">select_tasks</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em>, <em class="sig-param">wslice=None</em>, <em class="sig-param">task_class=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.select_tasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.select_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with a subset of tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nids</strong> – List of node identifiers.</p></li>
<li><p><strong>wslice</strong> – Slice object used to select works.</p></li>
<li><p><strong>task_class</strong> – String or class used to select tasks. Ignored if None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>nids and wslice are mutually exclusive.
If no argument is provided, the full list of tasks is returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_task_scfcycles">
<code class="sig-name descname">get_task_scfcycles</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em>, <em class="sig-param">wslice=None</em>, <em class="sig-param">task_class=None</em>, <em class="sig-param">exclude_ok_tasks=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_task_scfcycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_task_scfcycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of (taks, scfcycle) tuples for all the tasks in the flow with a SCF algorithm
e.g. electronic GS-SCF iteration, DFPT-SCF iterations etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nids</strong> – List of node identifiers.</p></li>
<li><p><strong>wslice</strong> – Slice object used to select works.</p></li>
<li><p><strong>task_class</strong> – String or class used to select tasks. Ignored if None.</p></li>
<li><p><strong>exclude_ok_tasks</strong> – True if only running tasks should be considered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of <cite>ScfCycle</cite> subclass instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_tricky_tasks">
<code class="sig-name descname">show_tricky_tasks</code><span class="sig-paren">(</span><em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_tricky_tasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_tricky_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Print list of tricky tasks i.e. tasks that have been restarted or
launched more than once or tasks with corrections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – Verbosity level. If &gt; 0, task history and corrections (if any) are printed.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.inspect">
<code class="sig-name descname">inspect</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em>, <em class="sig-param">wslice=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.inspect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.inspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspect the tasks (SCF iterations, Structural relaxation …) and
produces matplotlib plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nids</strong> – List of node identifiers.</p></li>
<li><p><strong>wslice</strong> – Slice object used to select works.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <cite>task.inspect</cite> method.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>nids and wslice are mutually exclusive.
If nids and wslice are both None, all tasks in self are inspected.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of <cite>matplotlib</cite> figures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_dict_for_mongodb_queries">
<code class="sig-name descname">get_dict_for_mongodb_queries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_dict_for_mongodb_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_dict_for_mongodb_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns a dictionary with the attributes that will be
put in the mongodb document to facilitate the query.
Subclasses may want to replace or extend the default behaviour.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.look_before_you_leap">
<code class="sig-name descname">look_before_you_leap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.look_before_you_leap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.look_before_you_leap" title="Permalink to this definition">¶</a></dt>
<dd><p>This method should be called before running the calculation to make
sure that the most important requirements are satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of strings with inconsistencies/errors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.has_db">
<em class="property">property </em><code class="sig-name descname">has_db</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.has_db" title="Permalink to this definition">¶</a></dt>
<dd><p>True if flow uses <cite>MongoDB</cite> to store the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.db_insert">
<code class="sig-name descname">db_insert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.db_insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.db_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert results in the <cite>MongDB</cite> database.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.tasks_from_nids">
<code class="sig-name descname">tasks_from_nids</code><span class="sig-paren">(</span><em class="sig-param">nids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.tasks_from_nids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.tasks_from_nids" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of tasks associated to the given list of node identifiers (nids).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Invalid ids are ignored</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.wti_from_nids">
<code class="sig-name descname">wti_from_nids</code><span class="sig-paren">(</span><em class="sig-param">nids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.wti_from_nids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.wti_from_nids" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of (w, t) indices from the list of node identifiers nids.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.open_files">
<code class="sig-name descname">open_files</code><span class="sig-paren">(</span><em class="sig-param">what='o'</em>, <em class="sig-param">status=None</em>, <em class="sig-param">op='=='</em>, <em class="sig-param">nids=None</em>, <em class="sig-param">editor=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.open_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.open_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the files of the flow inside an editor (command line interface).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what</strong> – <p>string with the list of characters selecting the file type
Possible choices:</p>
<blockquote>
<div><p>i ==&gt; input_file,
o ==&gt; output_file,
f ==&gt; files_file,
j ==&gt; job_file,
l ==&gt; log_file,
e ==&gt; stderr_file,
q ==&gt; qout_file,
all ==&gt; all files.</p>
</div></blockquote>
</p></li>
<li><p><strong>status</strong> – if not None, only the tasks with this status are select</p></li>
<li><p><strong>op</strong> – status operator. Requires status. A task is selected
if task.status op status evaluates to true.</p></li>
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
<li><p><strong>editor</strong> – Select the editor. None to use the default editor ($EDITOR shell env var)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.parse_timing">
<code class="sig-name descname">parse_timing</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.parse_timing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.parse_timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the timer data in the main output file(s) of Abinit.
Requires timopt /= 0 in the input file (usually timopt = -1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p>
</dd>
</dl>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTimerParser</span></code> instance, None if error.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_abierrors">
<code class="sig-name descname">show_abierrors</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em>, <em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_abierrors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_abierrors" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to the given stream the list of ABINIT errors for all tasks whose status is S_ABICRITICAL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
<li><p><strong>stream</strong> – File-like object. Default: sys.stdout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_qouts">
<code class="sig-name descname">show_qouts</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em>, <em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_qouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_qouts" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to the given stream the content of the queue output file for all tasks whose status is S_QCRITICAL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
<li><p><strong>stream</strong> – File-like object. Default: sys.stdout</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.debug">
<code class="sig-name descname">debug</code><span class="sig-paren">(</span><em class="sig-param">status=None</em>, <em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.debug"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is usually used when the flow didn’t completed succesfully
It analyzes the files produced the tasks to facilitate debugging.
Info are printed to stdout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> – If not None, only the tasks with this status are selected</p></li>
<li><p><strong>nids</strong> – optional list of node identifiers used to filter the tasks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.cancel">
<code class="sig-name descname">cancel</code><span class="sig-paren">(</span><em class="sig-param">nids=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel all the tasks that are in the queue.
nids is an optional list of node identifiers used to filter the tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of jobs cancelled, negative value if error</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_njobs_in_queue">
<code class="sig-name descname">get_njobs_in_queue</code><span class="sig-paren">(</span><em class="sig-param">username=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_njobs_in_queue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_njobs_in_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the number of jobs in the queue, None when the number of jobs cannot be determined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>username</strong> – (str) the username of the jobs to count (default is to autodetect)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.rmtree">
<code class="sig-name descname">rmtree</code><span class="sig-paren">(</span><em class="sig-param">ignore_errors=False</em>, <em class="sig-param">onerror=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.rmtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.rmtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove workdir (same API as shutil.rmtree).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.rm_and_build">
<code class="sig-name descname">rm_and_build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.rm_and_build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.rm_and_build" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the workdir and rebuild the flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Make directories and files of the <cite>Flow</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.build_and_pickle_dump">
<code class="sig-name descname">build_and_pickle_dump</code><span class="sig-paren">(</span><em class="sig-param">abivalidate=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.build_and_pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.build_and_pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Build dirs and file of the <cite>Flow</cite> and save the object in pickle format.
Returns 0 if success</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>abivalidate</strong> – If True, all the input files are validate by calling
the abinit parser. If the validation fails, ValueError is raise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pickle_dump">
<code class="sig-name descname">pickle_dump</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the status of the object in pickle format.
Returns 0 if success</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.pickle_dumps">
<code class="sig-name descname">pickle_dumps</code><span class="sig-paren">(</span><em class="sig-param">protocol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.pickle_dumps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.pickle_dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with the pickle representation.
<cite>protocol</cite> selects the pickle protocol. self.pickle_protocol is used if <cite>protocol</cite> is None</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.register_task">
<code class="sig-name descname">register_task</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">deps=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">task_class=None</em>, <em class="sig-param">append=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.register_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.register_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function that generates a <cite>Work</cite> made of a single task</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code></p></li>
<li><p><strong>deps</strong> – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code> objects specifying the dependency of this node.
An empy list of deps implies that this node has no dependencies.</p></li>
<li><p><strong>manager</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> responsible for the submission of the task.
If manager is None, we use the <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> specified during the creation of the work.</p></li>
<li><p><strong>task_class</strong> – Task subclass to instantiate. Default: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTask</span></code></p></li>
<li><p><strong>append</strong> – If true, the task is added to the last work (a new Work is created if flow is empty)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The generated <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> for the task, work[0] is the actual task.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.register_work">
<code class="sig-name descname">register_work</code><span class="sig-paren">(</span><em class="sig-param">work</em>, <em class="sig-param">deps=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">workdir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.register_work"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.register_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> and add it to the internal list, taking into account possible dependencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>work</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> object.</p></li>
<li><p><strong>deps</strong> – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code> objects specifying the dependency of this node.
An empy list of deps implies that this node has no dependencies.</p></li>
<li><p><strong>manager</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> responsible for the submission of the task.
If manager is None, we use the <cite>TaskManager</cite> specified during the creation of the work.</p></li>
<li><p><strong>workdir</strong> – The name of the directory used for the <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The registered <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.register_work_from_cbk">
<code class="sig-name descname">register_work_from_cbk</code><span class="sig-paren">(</span><em class="sig-param">cbk_name</em>, <em class="sig-param">cbk_data</em>, <em class="sig-param">deps</em>, <em class="sig-param">work_class</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.register_work_from_cbk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.register_work_from_cbk" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a callback function that will generate the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cbk_name</strong> – Name of the callback function (must be a bound method of self)</p></li>
<li><p><strong>cbk_data</strong> – Additional data passed to the callback function.</p></li>
<li><p><strong>deps</strong> – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code> objects specifying the dependency of the work.</p></li>
<li><p><strong>work_class</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> class to instantiate.</p></li>
<li><p><strong>manager</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> responsible for the submission of the task.
If manager is None, we use the <cite>TaskManager</cite> specified during the creation of the <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> that will be finalized by the callback.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.allocated">
<em class="property">property </em><code class="sig-name descname">allocated</code><a class="headerlink" href="#abipy.flowtk.flows.Flow.allocated" title="Permalink to this definition">¶</a></dt>
<dd><p>Numer of allocations. Set by <cite>allocate</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.allocate">
<code class="sig-name descname">allocate</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">use_smartio=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.allocate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.allocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the <cite>Flow</cite> i.e. assign the <cite>workdir</cite> and (optionally)
the <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> to the different tasks in the Flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>workdir</strong> – Working directory of the flow. Must be specified here
if we haven’t initialized the workdir in the __init__.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.use_smartio">
<code class="sig-name descname">use_smartio</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.use_smartio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.use_smartio" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be called when the entire <cite>Flow</cite> has been built.
It tries to reduce the pressure on the hard disk by using Abinit smart-io
capabilities for those files that are not needed by other nodes.
Smart-io means that big files (e.g. WFK) are written only if the calculation
is unconverged so that we can restart from it. No output is produced if
convergence is achieved.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_dependencies">
<code class="sig-name descname">show_dependencies</code><span class="sig-paren">(</span><em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_dependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes to the given stream the ASCII representation of the dependency tree.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.on_dep_ok">
<code class="sig-name descname">on_dep_ok</code><span class="sig-paren">(</span><em class="sig-param">signal</em>, <em class="sig-param">sender</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.on_dep_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.on_dep_ok" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.finalize">
<code class="sig-name descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when the flow is completed.
Return 0 if success</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.set_garbage_collector">
<code class="sig-name descname">set_garbage_collector</code><span class="sig-paren">(</span><em class="sig-param">exts=None</em>, <em class="sig-param">policy='task'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.set_garbage_collector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.set_garbage_collector" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable the garbage collector that will remove the big output files that are not needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exts</strong> – string or list with the Abinit file extensions to be removed. A default is
provided if exts is None</p></li>
<li><p><strong>policy</strong> – Either <cite>flow</cite> or <cite>task</cite>. If policy is set to ‘task’, we remove the output
files as soon as the task reaches S_OK. If ‘flow’, the files are removed
only when the flow is finalized. This option should be used when we are dealing
with a dynamic flow with callbacks generating other tasks since a <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>
might not be aware of its children when it reached S_OK.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.connect_signals">
<code class="sig-name descname">connect_signals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.connect_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.connect_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect the signals within the <cite>Flow</cite>.
The <cite>Flow</cite> is responsible for catching the important signals raised from its works.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.disconnect_signals">
<code class="sig-name descname">disconnect_signals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.disconnect_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.disconnect_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable the signals within the <cite>Flow</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.show_receivers">
<code class="sig-name descname">show_receivers</code><span class="sig-paren">(</span><em class="sig-param">sender=None</em>, <em class="sig-param">signal=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.show_receivers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.show_receivers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.set_spectator_mode">
<code class="sig-name descname">set_spectator_mode</code><span class="sig-paren">(</span><em class="sig-param">mode=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.set_spectator_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.set_spectator_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>When the flow is in spectator_mode, we have to disable signals, pickle dump and possible callbacks
A spectator can still operate on the flow but the new status of the flow won’t be saved in
the pickle file. Usually the flow is in spectator mode when we are already running it via
the scheduler or other means and we should not interfere with its evolution.
This is the reason why signals and callbacks must be disabled.
Unfortunately preventing client-code from calling methods with side-effects when
the flow is in spectator mode is not easy (e.g. flow.cancel will cancel the tasks submitted to the
queue and the flow used by the scheduler won’t see this change!</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.rapidfire">
<code class="sig-name descname">rapidfire</code><span class="sig-paren">(</span><em class="sig-param">check_status=True</em>, <em class="sig-param">max_nlaunch=-1</em>, <em class="sig-param">max_loops=1</em>, <em class="sig-param">sleep_time=5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.rapidfire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.rapidfire" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="xref py py-class docutils literal notranslate"><span class="pre">PyLauncher</span></code> to submits tasks in rapidfire mode.
kwargs contains the options passed to the launcher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>check_status</strong> – </p></li>
<li><p><strong>max_nlaunch</strong> – Maximum number of launches. default: no limit.</p></li>
<li><p><strong>max_loops</strong> – Maximum number of loops</p></li>
<li><p><strong>sleep_time</strong> – seconds to sleep between rapidfire loop iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of tasks submitted.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.single_shot">
<code class="sig-name descname">single_shot</code><span class="sig-paren">(</span><em class="sig-param">check_status=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.single_shot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.single_shot" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="xref py py-class docutils literal notranslate"><span class="pre">PyLauncher</span></code> to submits one task.
kwargs contains the options passed to the launcher.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of tasks submitted.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.make_scheduler">
<code class="sig-name descname">make_scheduler</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.make_scheduler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.make_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and return a <code class="xref py py-class docutils literal notranslate"><span class="pre">PyFlowScheduler</span></code> to run the flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – if empty we use the user configuration file.
if <cite>filepath</cite> in kwargs we init the scheduler from filepath.
else pass kwargs to <code class="xref py py-class docutils literal notranslate"><span class="pre">PyFlowScheduler</span></code> __init__ method.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.batch">
<code class="sig-name descname">batch</code><span class="sig-paren">(</span><em class="sig-param">timelimit=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the flow in batch mode, return exit status of the job script.
Requires a manager.yml file and a batch_adapter adapter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timelimit</strong> – Time limit (int with seconds or string with time given with the slurm convention:</p></li>
<li><p><strong>&quot;days-hours</strong> – minutes:seconds”). If timelimit is None, the default value specified in the</p></li>
<li><p><strong>entry of manager.yml is used.</strong> (<em>batch_adapter</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.make_light_tarfile">
<code class="sig-name descname">make_light_tarfile</code><span class="sig-paren">(</span><em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.make_light_tarfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.make_light_tarfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Lightweight tarball file. Mainly used for debugging. Return the name of the tarball file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.make_tarfile">
<code class="sig-name descname">make_tarfile</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">max_filesize=None</em>, <em class="sig-param">exclude_exts=None</em>, <em class="sig-param">exclude_dirs=None</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.make_tarfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.make_tarfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a tarball file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the tarball file. Set to os.path.basename(<cite>flow.workdir</cite>) + “tar.gz”` if name is None.</p></li>
<li><p><strong>max_filesize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>string with unit</em>) – a file is included in the tar file if its size &lt;= max_filesize
Can be specified in bytes e.g. <cite>max_files=1024</cite> or with a string with unit e.g. <cite>max_filesize=”1 Mb”</cite>.
No check is done if max_filesize is None.</p></li>
<li><p><strong>exclude_exts</strong> – List of file extensions to be excluded from the tar file.</p></li>
<li><p><strong>exclude_dirs</strong> – List of directory basenames to be excluded.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Verbosity level.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">TarFile</span></code> constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of the tarfile.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.get_graphviz">
<code class="sig-name descname">get_graphviz</code><span class="sig-paren">(</span><em class="sig-param">engine='automatic'</em>, <em class="sig-param">graph_attr=None</em>, <em class="sig-param">node_attr=None</em>, <em class="sig-param">edge_attr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.get_graphviz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.get_graphviz" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate flow graph in the DOT language.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> – Layout command used. [‘dot’, ‘neato’, ‘twopi’, ‘circo’, ‘fdp’, ‘sfdp’, ‘patchwork’, ‘osage’]</p></li>
<li><p><strong>graph_attr</strong> – Mapping of (attribute, value) pairs for the graph.</p></li>
<li><p><strong>node_attr</strong> – Mapping of (attribute, value) pairs set for all nodes.</p></li>
<li><p><strong>edge_attr</strong> – Mapping of (attribute, value) pairs set for all edges.</p></li>
</ul>
</dd>
</dl>
<p>Returns: graphviz.Digraph &lt;<a class="reference external" href="https://graphviz.readthedocs.io/en/stable/api.html#digraph">https://graphviz.readthedocs.io/en/stable/api.html#digraph</a>&gt;</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.graphviz_imshow">
<code class="sig-name descname">graphviz_imshow</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">figsize=None</em>, <em class="sig-param">dpi=300</em>, <em class="sig-param">fmt='png'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.graphviz_imshow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.graphviz_imshow" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate flow graph in the DOT language and plot it with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code> or None if a new figure should be created.</p></li>
<li><p><strong>figsize</strong> – matplotlib figure size (None to use default)</p></li>
<li><p><strong>dpi</strong> – DPI value.</p></li>
<li><p><strong>fmt</strong> – Select format for output image</p></li>
</ul>
</dd>
</dl>
<p>Return: matplotlib Figure</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.flows.Flow.plot_networkx">
<code class="sig-name descname">plot_networkx</code><span class="sig-paren">(</span><em class="sig-param">mode='network'</em>, <em class="sig-param">with_edge_labels=False</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">arrows=False</em>, <em class="sig-param">node_size='num_cores'</em>, <em class="sig-param">node_label='name_class'</em>, <em class="sig-param">layout_type='spring'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#Flow.plot_networkx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.Flow.plot_networkx" title="Permalink to this definition">¶</a></dt>
<dd><p>Use networkx to draw the flow with the connections among the nodes and
the status of the tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> – <cite>networkx</cite> to show connections, <cite>status</cite> to group tasks by status.</p></li>
<li><p><strong>with_edge_labels</strong> – True to draw edge labels.</p></li>
<li><p><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code> or None if a new figure should be created.</p></li>
<li><p><strong>arrows</strong> – if True draw arrowheads.</p></li>
<li><p><strong>node_size</strong> – By default, the size of the node is proportional to the number of cores used.</p></li>
<li><p><strong>node_label</strong> – By default, the task class is used to label node.</p></li>
<li><p><strong>layout_type</strong> – Get positions for all nodes using <cite>layout_type</cite>. e.g. pos = nx.spring_layout(g)</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Requires networkx package.</p>
</div>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.flows.G0W0WithQptdmFlow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.flows.</code><code class="sig-name descname">G0W0WithQptdmFlow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">scf_input</em>, <em class="sig-param">nscf_input</em>, <em class="sig-param">scr_input</em>, <em class="sig-param">sigma_inputs</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#G0W0WithQptdmFlow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.G0W0WithQptdmFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.flows.G0W0WithQptdmFlow.cbk_qptdm_workflow">
<code class="sig-name descname">cbk_qptdm_workflow</code><span class="sig-paren">(</span><em class="sig-param">cbk</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#G0W0WithQptdmFlow.cbk_qptdm_workflow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.G0W0WithQptdmFlow.cbk_qptdm_workflow" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is executed by the flow when bands_work.nscf_task reaches S_OK.</p>
<p>It computes the list of q-points for the W(q,G,G’), creates nqpt tasks
in the second work (QptdmWork), and connect the signals.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.flows.bandstructure_flow">
<code class="sig-prename descclassname">abipy.flowtk.flows.</code><code class="sig-name descname">bandstructure_flow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">scf_input</em>, <em class="sig-param">nscf_input</em>, <em class="sig-param">dos_inputs=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">flow_class=&lt;class 'abipy.flowtk.flows.Flow'&gt;</em>, <em class="sig-param">allocate=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#bandstructure_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.bandstructure_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> for band structure calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workdir</strong> – Working directory.</p></li>
<li><p><strong>scf_input</strong> – Input for the GS SCF run.</p></li>
<li><p><strong>nscf_input</strong> – Input for the NSCF run (band structure run).</p></li>
<li><p><strong>dos_inputs</strong> – Input(s) for the NSCF run (dos run).</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object used to submit the jobs
Initialized from manager.yml if manager is None.</p></li>
<li><p><strong>flow_class</strong> – Flow subclass</p></li>
<li><p><strong>allocate</strong> – True if the flow should be allocated before returning.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.flows.g0w0_flow">
<code class="sig-prename descclassname">abipy.flowtk.flows.</code><code class="sig-name descname">g0w0_flow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">scf_input</em>, <em class="sig-param">nscf_input</em>, <em class="sig-param">scr_input</em>, <em class="sig-param">sigma_inputs</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">flow_class=&lt;class 'abipy.flowtk.flows.Flow'&gt;</em>, <em class="sig-param">allocate=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/flows.html#g0w0_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.flows.g0w0_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> for one-shot $G_0W_0$ calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workdir</strong> – Working directory.</p></li>
<li><p><strong>scf_input</strong> – Input for the GS SCF run.</p></li>
<li><p><strong>nscf_input</strong> – Input for the NSCF run (band structure run).</p></li>
<li><p><strong>scr_input</strong> – Input for the SCR run.</p></li>
<li><p><strong>sigma_inputs</strong> – List of inputs for the SIGMA run.</p></li>
<li><p><strong>flow_class</strong> – Flow class</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object used to submit the jobs.
Initialized from manager.yml if manager is None.</p></li>
<li><p><strong>allocate</strong> – True if the flow should be allocated before returning.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.gruneisen">
<span id="gruneisen-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gruneisen</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.gruneisen" title="Permalink to this headline">¶</a></h2>
<p>Flow for the computation of Grunesein parameters with Abinit DFPT and finite differences.</p>
<p>WARNING: This code must be tested more carefully.</p>
<dl class="class">
<dt id="abipy.flowtk.gruneisen.GruneseinenFlow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.gruneisen.</code><code class="sig-name descname">GruneseinenFlow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gruneisen.html#GruneseinenFlow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gruneisen.GruneseinenFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
<p>This work compute the Grüneisen parameters with the DFPT part of Abinit and
finite differences in anaddb.</p>
<p>It is necessary to run three phonon calculations with DFPT.
One is calculated at the equilibrium volume and the remaining two are calculated
at the slightly larger volume and smaller volume than the equilibrium volume.
The unitcells at these volumes have to be fully relaxed under the constraint of each volume.</p>
<dl class="method">
<dt id="abipy.flowtk.gruneisen.GruneseinenFlow.from_gs_input">
<em class="property">classmethod </em><code class="sig-name descname">from_gs_input</code><span class="sig-paren">(</span><em class="sig-param">gsinp</em>, <em class="sig-param">voldelta</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gruneisen.html#GruneseinenFlow.from_gs_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gruneisen.GruneseinenFlow.from_gs_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the work from an <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsinp</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> object representing a GS calculation in the initial unit cell.</p></li>
<li><p><strong>voldelta</strong> – Absolute increment for unit cell volume. The three volumes are:
[v0 - voldelta, v0, v0 + voldelta] where v0 is taken from gsinp.structure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.gruneisen.GruneseinenWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.gruneisen.</code><code class="sig-name descname">GruneseinenWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gruneisen.html#GruneseinenWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gruneisen.GruneseinenWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.gruneisen.GruneseinenWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gruneisen.html#GruneseinenWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gruneisen.GruneseinenWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called once the <cite>Work</cite> is completed i.e. when all the tasks
have reached status S_OK.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.gruneisen.GruneseinenWork.add_phonopy_works_and_build">
<code class="sig-name descname">add_phonopy_works_and_build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gruneisen.html#GruneseinenWork.add_phonopy_works_and_build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gruneisen.GruneseinenWork.add_phonopy_works_and_build" title="Permalink to this definition">¶</a></dt>
<dd><p>Get relaxed structures from the tasks, build Phonopy works with supercells
constructed from the new structures, add them to the flow and build new directories.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.gs_works">
<span id="gs-works-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gs_works</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.gs_works" title="Permalink to this headline">¶</a></h2>
<p>Work subclasses related to GS calculations.</p>
<dl class="class">
<dt id="abipy.flowtk.gs_works.EosWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.gs_works.</code><code class="sig-name descname">EosWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gs_works.html#EosWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gs_works.EosWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for the computation of the Equation of State
The EOS is obtained by computing E(V) for several volumes around the input V0,
The initial volumes are obtained by rescaling the input lattice vectors so that
length proportions and angles are preserved.
This guess is exact for cubic materials while other Bravais lattices require
a constant-volume optimization of the cell geometry.</p>
<p>If lattice_type==”cubic” and atomic positions are fixed by symmetry.
use can use move_atoms=False to perform standard GS-SCF calculations.
In all the other cases, E(V) is obtained by relaxing the atomic positions at fixed volume.</p>
<p>The E(V) points are fitted at the end of the work and the results are saved in the
<cite>eos_data.json</cite> file produced in the <cite>outdata</cite> directory.
The file contains the energies, the volumes and the values of V0, B0, B1 obtained
with different EOS models.</p>
<dl class="method">
<dt id="abipy.flowtk.gs_works.EosWork.from_scf_input">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_input</code><span class="sig-paren">(</span><em class="sig-param">scf_input</em>, <em class="sig-param">npoints=4</em>, <em class="sig-param">deltap_vol=0.25</em>, <em class="sig-param">ecutsm=0.5</em>, <em class="sig-param">move_atoms=True</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gs_works.html#EosWork.from_scf_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gs_works.EosWork.from_scf_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a EosWork from an AbinitInput representing a SCF-GS calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_input</strong> – AbinitInput for SCF-GS used as template to generate the other inputs.</p></li>
<li><p><strong>npoints</strong> – Number of volumes generated on the right (left) of the equilibrium volume
The total number of points is therefore 2 * n + 1.</p></li>
<li><p><strong>deltap_vol</strong> – Step of the linear mesh given in relative percentage of the equilibrium volume
The step is thus: v0 * deltap_vol / 100.</p></li>
<li><p><strong>ecutsm</strong> – Value of ecutsm input variable. If <cite>scf_input</cite> does not provide ecutsm, this
value will be used else the vale in <cite>scf_input</cite>.</p></li>
<li><p><strong>move_atoms</strong> – If True, a structural relaxation of ions is performed for each volume
This is needed if the atomic positions are non fixed by symmetry.</p></li>
<li><p><strong>manager</strong> – TaskManager instance. Use default if None.</p></li>
</ul>
</dd>
</dl>
<p>Return: EosWork instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.gs_works.EosWork.getnwrite_eosdata">
<code class="sig-name descname">getnwrite_eosdata</code><span class="sig-paren">(</span><em class="sig-param">write_json=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gs_works.html#EosWork.getnwrite_eosdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gs_works.EosWork.getnwrite_eosdata" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all tasks reach S_OK. It reads the energies
and the volumes from the GSR file, computes the EOS and produce a
JSON file <cite>eos_data.json</cite> in outdata.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.gs_works.EosWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/gs_works.html#EosWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.gs_works.EosWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all tasks reach S_OK. It reads the energies
and the volumes from the GSR file, computes the EOS and produce a
JSON file <cite>eos_data.json</cite> in outdata.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.launcher">
<span id="launcher-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">launcher</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.launcher" title="Permalink to this headline">¶</a></h2>
<p>Tools for the submission of Tasks.</p>
<dl class="class">
<dt id="abipy.flowtk.launcher.ScriptEditor">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.launcher.</code><code class="sig-name descname">ScriptEditor</code><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Simple editor that simplifies the writing of shell scripts</p>
<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.shell">
<em class="property">property </em><code class="sig-name descname">shell</code><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.shell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the editor.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.shebang">
<code class="sig-name descname">shebang</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.shebang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.shebang" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the shebang line.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.declare_var">
<code class="sig-name descname">declare_var</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.declare_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.declare_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Declare a env variable. If val is None the variable is unset.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.declare_vars">
<code class="sig-name descname">declare_vars</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.declare_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.declare_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Declare the variables defined in the dictionary d.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.export_envar">
<code class="sig-name descname">export_envar</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.export_envar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.export_envar" title="Permalink to this definition">¶</a></dt>
<dd><p>Export an environment variable.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.export_envars">
<code class="sig-name descname">export_envars</code><span class="sig-paren">(</span><em class="sig-param">env</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.export_envars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.export_envars" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the environment variables contained in the dict env.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.add_emptyline">
<code class="sig-name descname">add_emptyline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.add_emptyline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.add_emptyline" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an empty line.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.add_comment">
<code class="sig-name descname">add_comment</code><span class="sig-paren">(</span><em class="sig-param">comment</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.add_comment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.add_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a comment</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.load_modules">
<code class="sig-name descname">load_modules</code><span class="sig-paren">(</span><em class="sig-param">modules</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.load_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.load_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the list of specified modules.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.load_module">
<code class="sig-name descname">load_module</code><span class="sig-paren">(</span><em class="sig-param">module</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.load_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.load_module" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.add_line">
<code class="sig-name descname">add_line</code><span class="sig-paren">(</span><em class="sig-param">line</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.add_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.add_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.add_lines">
<code class="sig-name descname">add_lines</code><span class="sig-paren">(</span><em class="sig-param">lines</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.add_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.add_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.ScriptEditor.get_script_str">
<code class="sig-name descname">get_script_str</code><span class="sig-paren">(</span><em class="sig-param">reset=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#ScriptEditor.get_script_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.ScriptEditor.get_script_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with the script and reset the editor if reset is True</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.launcher.PyLauncher">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.launcher.</code><code class="sig-name descname">PyLauncher</code><span class="sig-paren">(</span><em class="sig-param">flow</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyLauncher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyLauncher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object handle the submission of the tasks contained in a <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></p>
<dl class="attribute">
<dt id="abipy.flowtk.launcher.PyLauncher.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.launcher.PyLauncher.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">PyLauncherError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyLauncher.single_shot">
<code class="sig-name descname">single_shot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyLauncher.single_shot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyLauncher.single_shot" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the first <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> than is ready for execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Number of jobs launched.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyLauncher.rapidfire">
<code class="sig-name descname">rapidfire</code><span class="sig-paren">(</span><em class="sig-param">max_nlaunch=-1</em>, <em class="sig-param">max_loops=1</em>, <em class="sig-param">sleep_time=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyLauncher.rapidfire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyLauncher.rapidfire" title="Permalink to this definition">¶</a></dt>
<dd><p>Keeps submitting <cite>Tasks</cite> until we are out of jobs or no job is ready to run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_nlaunch</strong> – Maximum number of launches. default: no limit.</p></li>
<li><p><strong>max_loops</strong> – Maximum number of loops</p></li>
<li><p><strong>sleep_time</strong> – seconds to sleep between rapidfire loop iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of tasks launched.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyLauncher.fetch_tasks_to_run">
<code class="sig-name descname">fetch_tasks_to_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyLauncher.fetch_tasks_to_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyLauncher.fetch_tasks_to_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of tasks that can be submitted.
Empty list if no task has been found.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.launcher.PyFlowScheduler">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.launcher.</code><code class="sig-name descname">PyFlowScheduler</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object schedules the submission of the tasks in a <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code>.
There are two types of errors that might occur during the execution of the jobs:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Python exceptions</p></li>
<li><p>Errors in the ab-initio code</p></li>
</ol>
</div></blockquote>
<p>Python exceptions are easy to detect and are usually due to a bug in the python code or random errors such as IOError.
The set of errors in the ab-initio is much much broader. It includes wrong input data, segmentation
faults, problems with the resource manager, etc. The flow tries to handle the most common cases
but there’s still a lot of room for improvement.
Note, in particular, that <cite>PyFlowScheduler</cite> will shutdown automatically in the following cases:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The number of python exceptions is &gt; max_num_pyexcs</p></li>
<li><p>The number of task errors (i.e. the number of tasks whose status is S_ERROR) is &gt; max_num_abierrs</p></li>
<li><p>The number of jobs launched becomes greater than (<cite>safety_ratio</cite> * total_number_of_tasks).</p></li>
<li><p>The scheduler will send an email to the user (specified by <cite>mailto</cite>) every <cite>remindme_s</cite> seconds.
If the mail cannot be sent, the scheduler will shutdown automatically.
This check prevents the scheduler from being trapped in an infinite loop.</p></li>
</ol>
</div></blockquote>
<dl class="attribute">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.YAML_FILE">
<code class="sig-name descname">YAML_FILE</code><em class="property"> = 'scheduler.yml'</em><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.YAML_FILE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.USER_CONFIG_DIR">
<code class="sig-name descname">USER_CONFIG_DIR</code><em class="property"> = '/Users/gmatteo/.abinit/abipy'</em><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.USER_CONFIG_DIR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">PyFlowSchedulerError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.autodoc">
<em class="property">classmethod </em><code class="sig-name descname">autodoc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.autodoc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.autodoc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the configuration parameters from a Yaml file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.from_string">
<em class="property">classmethod </em><code class="sig-name descname">from_string</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an istance from string s containing a YAML dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.from_user_config">
<em class="property">classmethod </em><code class="sig-name descname">from_user_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.from_user_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.from_user_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the <a class="reference internal" href="#abipy.flowtk.launcher.PyFlowScheduler" title="abipy.flowtk.launcher.PyFlowScheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyFlowScheduler</span></code></a> from the YAML file ‘scheduler.yml’.
Search first in the working directory and then in the configuration directory of abipy.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.8)"><strong>RuntimeError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.pid">
<em class="property">property </em><code class="sig-name descname">pid</code><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.pid" title="Permalink to this definition">¶</a></dt>
<dd><p>The pid of the process associated to the scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.pid_file">
<em class="property">property </em><code class="sig-name descname">pid_file</code><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.pid_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the file with the pid.
The file is located in the workdir of the flow</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.flow">
<em class="property">property </em><code class="sig-name descname">flow</code><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.flow" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>Flow</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.num_excs">
<em class="property">property </em><code class="sig-name descname">num_excs</code><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.num_excs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of exceptions raised so far.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.get_delta_etime">
<code class="sig-name descname">get_delta_etime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.get_delta_etime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.get_delta_etime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>timedelta</cite> object representing with the elapsed time.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.add_flow">
<code class="sig-name descname">add_flow</code><span class="sig-paren">(</span><em class="sig-param">flow</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.add_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.add_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code> flow to the scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the scheduler in a new thread. Returns 0 if success.
In standalone mode, this method will block until there are no more scheduled jobs.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.callback">
<code class="sig-name descname">callback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.callback" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that will be executed by the scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.cleanup">
<code class="sig-name descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup routine: remove the pid file and save the pickle database</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.shutdown">
<code class="sig-name descname">shutdown</code><span class="sig-paren">(</span><em class="sig-param">msg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.shutdown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Shutdown the scheduler.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.launcher.PyFlowScheduler.send_email">
<code class="sig-name descname">send_email</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/launcher.html#PyFlowScheduler.send_email"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.launcher.PyFlowScheduler.send_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an e-mail before completing the shutdown.
Returns 0 if success.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.mocks">
<span id="mocks-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mocks</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.mocks" title="Permalink to this headline">¶</a></h2>
<p>Mock objects for unit tests.</p>
<dl class="function">
<dt id="abipy.flowtk.mocks.change_task_start">
<code class="sig-prename descclassname">abipy.flowtk.mocks.</code><code class="sig-name descname">change_task_start</code><span class="sig-paren">(</span><em class="sig-param">task</em>, <em class="sig-param">mocked_status='Error'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#change_task_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.change_task_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a AbinitTaskMockedStart object.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.mocks.AbinitTaskMockedStart">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.mocks.</code><code class="sig-name descname">AbinitTaskMockedStart</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#AbinitTaskMockedStart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.AbinitTaskMockedStart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.tasks.AbinitTask" title="abipy.flowtk.tasks.AbinitTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.AbinitTask</span></code></a></p>
<p>A Task whose status is always self.mocked_status.</p>
<dl class="method">
<dt id="abipy.flowtk.mocks.AbinitTaskMockedStart.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#AbinitTaskMockedStart.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.AbinitTaskMockedStart.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the calculation by performing the following steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>build dirs and files</p></li>
<li><p>call the _setup method</p></li>
<li><p>execute the job file by executing/submitting the job script.</p></li>
</ul>
</div></blockquote>
<p>Main entry point for the <cite>Launcher</cite>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>autoparal</p></td>
<td><p>False to skip the autoparal step (default True)</p></td>
</tr>
<tr class="row-odd"><td><p>exec_args</p></td>
<td><p>List of arguments passed to executable.</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1 if task was started, 0 otherwise.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.mocks.infinite_flow">
<code class="sig-prename descclassname">abipy.flowtk.mocks.</code><code class="sig-name descname">infinite_flow</code><span class="sig-paren">(</span><em class="sig-param">flow</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#infinite_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.infinite_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an InfiniteFlow.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.mocks.InfiniteFlow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.mocks.</code><code class="sig-name descname">InfiniteFlow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#InfiniteFlow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.InfiniteFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
<p>A Flow that will never reach <cite>all_ok</cite></p>
<dl class="method">
<dt id="abipy.flowtk.mocks.InfiniteFlow.check_status">
<code class="sig-name descname">check_status</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/mocks.html#InfiniteFlow.check_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.mocks.InfiniteFlow.check_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status of the works in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> – True to show the status of the flow.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to show_status</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.netcdf">
<span id="netcdf-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdf</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.netcdf" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.flowtk.nodes">
<span id="nodes-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nodes</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.nodes" title="Permalink to this headline">¶</a></h2>
<p>This module defines the Node class that is inherited by Task, Work and Flow objects.</p>
<dl class="class">
<dt id="abipy.flowtk.nodes.Status">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">Status</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Status" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
<p>This object is an integer representing the status of the <cite>Node</cite>.</p>
<dl class="method">
<dt id="abipy.flowtk.nodes.Status.as_status">
<em class="property">classmethod </em><code class="sig-name descname">as_status</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Status.as_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Status.as_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into Status.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Status.from_string">
<em class="property">classmethod </em><code class="sig-name descname">from_string</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Status.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Status.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <cite>Status</cite> instance from its string representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Status.all_status_strings">
<em class="property">classmethod </em><code class="sig-name descname">all_status_strings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Status.all_status_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Status.all_status_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>List of strings with all possible values status.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Status.is_critical">
<em class="property">property </em><code class="sig-name descname">is_critical</code><a class="headerlink" href="#abipy.flowtk.nodes.Status.is_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>True if status is critical.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Status.color_opts">
<em class="property">property </em><code class="sig-name descname">color_opts</code><a class="headerlink" href="#abipy.flowtk.nodes.Status.color_opts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Status.colored">
<em class="property">property </em><code class="sig-name descname">colored</code><a class="headerlink" href="#abipy.flowtk.nodes.Status.colored" title="Permalink to this definition">¶</a></dt>
<dd><p>Return colorized text used to print the status if the stream supports it.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.Dependency">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">Dependency</code><span class="sig-paren">(</span><em class="sig-param">node</em>, <em class="sig-param">exts=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Dependency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Dependency" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object describes the dependencies among the nodes of a calculation.</p>
<p>A <cite>Dependency</cite> consists of a <cite>Node</cite> that produces a list of products (files)
that are used by the other nodes (<cite>Task</cite> or <cite>Work</cite>) to start the calculation.
One usually creates the object by calling work.register</p>
<p class="rubric">Example</p>
<p># Register the SCF task in work.
scf_task = work.register(scf_strategy)</p>
<p># Register the NSCF calculation and its dependency on the SCF run via deps.
nscf_task = work.register(nscf_strategy, deps={scf_task: “DEN”})</p>
<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.info">
<em class="property">property </em><code class="sig-name descname">info</code><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.node">
<em class="property">property </em><code class="sig-name descname">node</code><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.node" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> associated to the dependency.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.status">
<em class="property">property </em><code class="sig-name descname">status</code><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.status" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the dependency, i.e. the status of the <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Dependency.products">
<code class="sig-name descname">products</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Dependency.products"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.products" title="Permalink to this definition">¶</a></dt>
<dd><p>List of output files produces by self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.apply_getters">
<code class="sig-name descname">apply_getters</code><span class="sig-paren">(</span><em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Dependency.apply_getters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.apply_getters" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called when we specify the task dependencies with the syntax:</p>
<blockquote>
<div><p>deps={node: “&#64;property”}</p>
</div></blockquote>
<p>In this case the task has to the get <cite>property</cite> from <cite>node</cite> before starting the calculation.</p>
<p>At present, the following properties are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p>&#64;structure</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.connecting_vars">
<code class="sig-name descname">connecting_vars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Dependency.connecting_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.connecting_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary with the variables that must be added to the
input file in order to connect this <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> to its dependencies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Dependency.get_filepaths_and_exts">
<code class="sig-name descname">get_filepaths_and_exts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Dependency.get_filepaths_and_exts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Dependency.get_filepaths_and_exts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the paths of the output files produced by self and its extensions</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.Product">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">Product</code><span class="sig-paren">(</span><em class="sig-param">ext</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Product" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A product represents an output file produced by ABINIT instance.
This file is needed to start another <cite>Task</cite> or another <cite>Work</cite>.</p>
<dl class="method">
<dt id="abipy.flowtk.nodes.Product.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Product.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Product.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.flowtk.nodes.Product" title="abipy.flowtk.nodes.Product"><code class="xref py py-class docutils literal notranslate"><span class="pre">Product</span></code></a> instance from a filepath.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Product.filepath">
<em class="property">property </em><code class="sig-name descname">filepath</code><a class="headerlink" href="#abipy.flowtk.nodes.Product.filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Product.connecting_vars">
<code class="sig-name descname">connecting_vars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Product.connecting_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Product.connecting_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary with the ABINIT variables that
must be used to make the code use this file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.GridFsFile">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">GridFsFile</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">fs_id=None</em>, <em class="sig-param">mode='b'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#GridFsFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.GridFsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.collections.AttrDict</span></code></a></p>
<p>Information on a file that will stored in the MongoDb gridfs collection.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.NodeResults">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">NodeResults</code><span class="sig-paren">(</span><em class="sig-param">node</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<p>Dictionary used to store the most important results produced by a <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>.</p>
<dl class="attribute">
<dt id="abipy.flowtk.nodes.NodeResults.JSON_SCHEMA">
<code class="sig-name descname">JSON_SCHEMA</code><em class="property"> = {'properties': {'exceptions': {'required': True, 'type': 'array'}, 'files': {'required': True, 'type': 'object'}, 'in': {'description': 'dictionary with input parameters', 'required': True, 'type': 'object'}, 'node_class': {'required': True, 'type': 'string'}, 'node_finalized': {'required': True, 'type': 'boolean'}, 'node_history': {'required': True, 'type': 'array'}, 'node_id': {'required': True, 'type': 'integer'}, 'node_name': {'required': True, 'type': 'string'}, 'node_status': {'required': True, 'type': 'string'}, 'out': {'description': 'dictionary with the output results', 'required': True, 'type': 'object'}}, 'type': 'object'}</em><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.JSON_SCHEMA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.from_node">
<em class="property">classmethod </em><code class="sig-name descname">from_node</code><span class="sig-paren">(</span><em class="sig-param">node</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.from_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.from_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance of <cite>NodeResults</cite> from a <cite>Node</cite> subclass.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.exceptions">
<em class="property">property </em><code class="sig-name descname">exceptions</code><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.exceptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.gridfs_files">
<em class="property">property </em><code class="sig-name descname">gridfs_files</code><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.gridfs_files" title="Permalink to this definition">¶</a></dt>
<dd><p>List with the absolute paths of the files to be put in GridFs.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.register_gridfs_files">
<code class="sig-name descname">register_gridfs_files</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.register_gridfs_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.register_gridfs_files" title="Permalink to this definition">¶</a></dt>
<dd><p>This function registers the files that will be saved in GridFS.
kwargs is a dictionary mapping the key associated to the file (usually the extension)
to the absolute path. By default, files are assumed to be in binary form, for formatted files
one should pass a tuple (“filepath”, “t”).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">register_gridfs</span><span class="p">(</span><span class="n">GSR</span><span class="o">=</span><span class="s2">&quot;path/to/GSR.nc&quot;</span><span class="p">,</span> <span class="n">text_file</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;/path/to/txt_file&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The GSR file is a binary file, whereas text_file is a text file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.push_exceptions">
<code class="sig-name descname">push_exceptions</code><span class="sig-paren">(</span><em class="sig-param">*exceptions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.push_exceptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.push_exceptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A JSON serializable dict representation of an object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> – Dict representation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MSONable class.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.json_dump">
<code class="sig-name descname">json_dump</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.json_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.json_dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.json_load">
<em class="property">classmethod </em><code class="sig-name descname">json_load</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.json_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.json_load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.validate_json_schema">
<code class="sig-name descname">validate_json_schema</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.validate_json_schema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.validate_json_schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeResults.update_collection">
<code class="sig-name descname">update_collection</code><span class="sig-paren">(</span><em class="sig-param">collection</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeResults.update_collection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeResults.update_collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a mongodb collection.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.nodes.check_spectator">
<code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">check_spectator</code><span class="sig-paren">(</span><em class="sig-param">node_method</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#check_spectator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.check_spectator" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> methods. Raise <cite>SpectatorNodeError</cite>.</p>
</dd></dl>

<dl class="exception">
<dt id="abipy.flowtk.nodes.NodeError">
<em class="property">exception </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">NodeError</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Base Exception raised by <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> subclasses</p>
</dd></dl>

<dl class="exception">
<dt id="abipy.flowtk.nodes.SpectatorNodeError">
<em class="property">exception </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">SpectatorNodeError</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#SpectatorNodeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.SpectatorNodeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.nodes.NodeError" title="abipy.flowtk.nodes.NodeError"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.nodes.NodeError</span></code></a></p>
<p>Exception raised by <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> methods when the node is in spectator mode
and we are calling a method with side effects.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.Node">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">Node</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class defining the interface that must be
implemented by the nodes of the calculation.</p>
<p>Nodes are hashable and can be tested for equality</p>
<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.Results">
<code class="sig-name descname">Results</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.Results" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.flowtk.nodes.NodeResults" title="abipy.flowtk.nodes.NodeResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.flowtk.nodes.NodeError" title="abipy.flowtk.nodes.NodeError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeError</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.SpectatorError">
<code class="sig-name descname">SpectatorError</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.SpectatorError" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#abipy.flowtk.nodes.SpectatorNodeError" title="abipy.flowtk.nodes.SpectatorNodeError"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpectatorNodeError</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_INIT">
<code class="sig-name descname">S_INIT</code><em class="property"> = &lt;Status: Initialized, at 4764990152&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_INIT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_LOCKED">
<code class="sig-name descname">S_LOCKED</code><em class="property"> = &lt;Status: Locked, at 4764990472&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_LOCKED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_READY">
<code class="sig-name descname">S_READY</code><em class="property"> = &lt;Status: Ready, at 4761973320&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_READY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_SUB">
<code class="sig-name descname">S_SUB</code><em class="property"> = &lt;Status: Submitted, at 4761973256&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_SUB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_RUN">
<code class="sig-name descname">S_RUN</code><em class="property"> = &lt;Status: Running, at 4761973128&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_RUN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_DONE">
<code class="sig-name descname">S_DONE</code><em class="property"> = &lt;Status: Done, at 4761973064&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_DONE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_ABICRITICAL">
<code class="sig-name descname">S_ABICRITICAL</code><em class="property"> = &lt;Status: AbiCritical, at 4761973000&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_ABICRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_QCRITICAL">
<code class="sig-name descname">S_QCRITICAL</code><em class="property"> = &lt;Status: QCritical, at 4761972936&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_QCRITICAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_UNCONVERGED">
<code class="sig-name descname">S_UNCONVERGED</code><em class="property"> = &lt;Status: Unconverged, at 4761972872&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_UNCONVERGED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_ERROR">
<code class="sig-name descname">S_ERROR</code><em class="property"> = &lt;Status: Error, at 4761972808&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_ERROR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.S_OK">
<code class="sig-name descname">S_OK</code><em class="property"> = &lt;Status: Completed, at 4762719304&gt;</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.S_OK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.ALL_STATUS">
<code class="sig-name descname">ALL_STATUS</code><em class="property"> = [&lt;Status: Initialized, at 4764990152&gt;, &lt;Status: Locked, at 4764990472&gt;, &lt;Status: Ready, at 4761973320&gt;, &lt;Status: Submitted, at 4761973256&gt;, &lt;Status: Running, at 4761973128&gt;, &lt;Status: Done, at 4761973064&gt;, &lt;Status: AbiCritical, at 4761973000&gt;, &lt;Status: QCritical, at 4761972936&gt;, &lt;Status: Unconverged, at 4761972872&gt;, &lt;Status: Error, at 4761972808&gt;, &lt;Status: Completed, at 4762719304&gt;]</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.ALL_STATUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0.41176471, 0.41176471, 0.41176471])</em><a class="headerlink" href="#abipy.flowtk.nodes.Node.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.Node.color_hex">
<code class="sig-name descname">color_hex</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.color_hex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.color_hex" title="Permalink to this definition">¶</a></dt>
<dd><p>//en.wikipedia.org/wiki/Web_colors#Hex_triplet</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Node color as Hex Triplet https</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.isinstance">
<code class="sig-name descname">isinstance</code><span class="sig-paren">(</span><em class="sig-param">class_or_string</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.isinstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.isinstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the node is a instance of <cite>class_or_string</cite>.
Unlinke the standard isinstance builtin, the method accepts either a class or a string.
In the later case, the string is compared with self.__class__.__name__ (case insensitive).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.as_node">
<em class="property">classmethod </em><code class="sig-name descname">as_node</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.as_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.as_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a Node instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>obj if obj is a Node instance,
cast obj to <a class="reference internal" href="#abipy.flowtk.nodes.FileNode" title="abipy.flowtk.nodes.FileNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileNode</span></code></a> instance of obj is a string.
None if obj is None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the node
(only used for facilitating its identification in the user interface).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.relworkdir">
<em class="property">property </em><code class="sig-name descname">relworkdir</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.relworkdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a relative version of the workdir</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.set_name">
<code class="sig-name descname">set_name</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.set_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the Node.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.node_id">
<em class="property">property </em><code class="sig-name descname">node_id</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.node_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Node identifier.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.set_node_id">
<code class="sig-name descname">set_node_id</code><span class="sig-paren">(</span><em class="sig-param">node_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.set_node_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.set_node_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the node identifier. Use it carefully!</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.finalized">
<em class="property">property </em><code class="sig-name descname">finalized</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.finalized" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the <cite>Node</cite> has been finalized.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.in_spectator_mode">
<em class="property">property </em><code class="sig-name descname">in_spectator_mode</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.in_spectator_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.corrections">
<em class="property">property </em><code class="sig-name descname">corrections</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>List of dictionaries with infornation on the actions performed to solve <cite>AbiCritical</cite> Events.
Each dictionary contains the <cite>AbinitEvent</cite> who triggered the correction and
a human-readable message with the description of the operation performed.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.num_corrections">
<em class="property">property </em><code class="sig-name descname">num_corrections</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.num_corrections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.log_correction">
<code class="sig-name descname">log_correction</code><span class="sig-paren">(</span><em class="sig-param">event</em>, <em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.log_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.log_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>This method should be called once we have fixed the problem associated to this event.
It adds a new entry in the correction history of the node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitEvent</span></code> that triggered the correction.</p></li>
<li><p><strong>action</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Human-readable string with info on the action perfomed to solve the problem.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.is_file">
<em class="property">property </em><code class="sig-name descname">is_file</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.is_file" title="Permalink to this definition">¶</a></dt>
<dd><p>True if this node is a file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.is_task">
<em class="property">property </em><code class="sig-name descname">is_task</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.is_task" title="Permalink to this definition">¶</a></dt>
<dd><p>True if this node is a Task</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.is_work">
<em class="property">property </em><code class="sig-name descname">is_work</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.is_work" title="Permalink to this definition">¶</a></dt>
<dd><p>True if this node is a Work</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.is_flow">
<em class="property">property </em><code class="sig-name descname">is_flow</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.is_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>True if this node is a Flow</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.deps">
<em class="property">property </em><code class="sig-name descname">deps</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.deps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <a class="reference internal" href="#abipy.flowtk.nodes.Dependency" title="abipy.flowtk.nodes.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> objects defining the dependencies
of this <cite>Node</cite>. Empty list if this <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> does not have dependencies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.add_deps">
<code class="sig-name descname">add_deps</code><span class="sig-paren">(</span><em class="sig-param">deps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.add_deps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.add_deps" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of dependencies to the <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deps</strong> – List of <a class="reference internal" href="#abipy.flowtk.nodes.Dependency" title="abipy.flowtk.nodes.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> objects specifying the dependencies of the node.
or dictionary mapping nodes to file extensions e.g. {task: “DEN”}</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.remove_deps">
<code class="sig-name descname">remove_deps</code><span class="sig-paren">(</span><em class="sig-param">deps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.remove_deps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.remove_deps" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a list of dependencies from the <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deps</strong> – List of <a class="reference internal" href="#abipy.flowtk.nodes.Dependency" title="abipy.flowtk.nodes.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> objects specifying the  dependencies of the node.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.deps_status">
<em class="property">property </em><code class="sig-name descname">deps_status</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.deps_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with the status of the dependencies.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.depends_on">
<code class="sig-name descname">depends_on</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.depends_on"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.depends_on" title="Permalink to this definition">¶</a></dt>
<dd><p>True if this node depends on the other node.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.get_parents">
<code class="sig-name descname">get_parents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.get_parents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.get_parents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of nodes in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code> required by this <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.get_children">
<code class="sig-name descname">get_children</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.get_children"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.get_children" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of nodes in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code> that depends on this <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This routine assumes the entire flow has been allocated.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.str_deps">
<code class="sig-name descname">str_deps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.str_deps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.str_deps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the string representation of the dependencies of the node.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.get_vars_dataframe">
<code class="sig-name descname">get_vars_dataframe</code><span class="sig-paren">(</span><em class="sig-param">*varnames</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.get_vars_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.get_vars_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pandas DataFrame with the value of the variables specified in <cite>varnames</cite>.
Can be used for task/works/flow. It’s recursive!</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.get_graphviz_dirtree">
<code class="sig-name descname">get_graphviz_dirtree</code><span class="sig-paren">(</span><em class="sig-param">engine='automatic'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.get_graphviz_dirtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.get_graphviz_dirtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate directory graph in the DOT language. The graph show the files and directories
in the node workdir.</p>
<p>Returns: graphviz.Digraph &lt;<a class="reference external" href="https://graphviz.readthedocs.io/en/stable/api.html#digraph">https://graphviz.readthedocs.io/en/stable/api.html#digraph</a>&gt;</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.set_gc">
<code class="sig-name descname">set_gc</code><span class="sig-paren">(</span><em class="sig-param">gc</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.set_gc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.set_gc" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the garbage collector.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.gc">
<em class="property">property </em><code class="sig-name descname">gc</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.gc" title="Permalink to this definition">¶</a></dt>
<dd><p>Garbage collector. None if garbage collection is deactivated.
Use flow.set_garbage_collector to initialize the object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.event_handlers">
<em class="property">property </em><code class="sig-name descname">event_handlers</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.event_handlers" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of handlers registered for this node.
If the node is not a <cite>Flow</cite> and does not have its own list of
<cite>handlers</cite> the handlers registered at the level of the flow are returned.</p>
<p>This trick allows one to registered different handlers at the level of the Task
for testing purposes. By default, we have a common list of handlers for all the nodes in the flow.
This choice facilitates the automatic installation of the handlers when we use callbacks to generate
new Works and Tasks!</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.install_event_handlers">
<code class="sig-name descname">install_event_handlers</code><span class="sig-paren">(</span><em class="sig-param">categories=None</em>, <em class="sig-param">handlers=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.install_event_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.install_event_handlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Install the <cite>EventHandlers for this `Node</cite>. If no argument is provided
the default list of handlers is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>categories</strong> – List of categories to install e.g. base + can_change_physics</p></li>
<li><p><strong>handlers</strong> – explicit list of <code class="xref py py-class docutils literal notranslate"><span class="pre">EventHandler</span></code> instances.
This is the most flexible way to install handlers.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>categories and handlers are mutually exclusive.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.show_event_handlers">
<code class="sig-name descname">show_event_handlers</code><span class="sig-paren">(</span><em class="sig-param">stream=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.show_event_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.show_event_handlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Print to <cite>stream</cite> the event handlers installed for this flow.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.send_signal">
<code class="sig-name descname">send_signal</code><span class="sig-paren">(</span><em class="sig-param">signal</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.send_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.send_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Send signal from this node to all connected receivers unless the node is in spectator mode.</p>
<p>signal – (hashable) signal value, see <cite>dispatcher</cite> connect for details</p>
<p>Return a list of tuple pairs [(receiver, response), … ]
or None if the node is in spectator mode.</p>
<p>if any receiver raises an error, the error propagates back
through send, terminating the dispatch loop, so it is quite
possible to not have all receivers called if a raises an error.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.status">
<em class="property">abstract property </em><code class="sig-name descname">status</code><a class="headerlink" href="#abipy.flowtk.nodes.Node.status" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the <cite>Node</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.Node.check_status">
<em class="property">abstract </em><code class="sig-name descname">check_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#Node.check_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.Node.check_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status of the <cite>Node</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.FileNode">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">FileNode</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.nodes.Node" title="abipy.flowtk.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.nodes.Node</span></code></a></p>
<p>A Node that consists of a file. May be not yet existing</p>
<p>Mainly used to connect <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> objects to external files produced in previous runs.</p>
<dl class="attribute">
<dt id="abipy.flowtk.nodes.FileNode.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0.4, 0.2, 1. ])</em><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.FileNode.basename">
<code class="sig-name descname">basename</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.basename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.basename" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.products">
<em class="property">property </em><code class="sig-name descname">products</code><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.products" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.opath_from_ext">
<code class="sig-name descname">opath_from_ext</code><span class="sig-paren">(</span><em class="sig-param">ext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.opath_from_ext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.opath_from_ext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.status">
<em class="property">property </em><code class="sig-name descname">status</code><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.status" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the <cite>Node</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.check_status">
<code class="sig-name descname">check_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.check_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.check_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status of the <cite>Node</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.get_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.add_filechild">
<code class="sig-name descname">add_filechild</code><span class="sig-paren">(</span><em class="sig-param">node</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.add_filechild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.add_filechild" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a node (usually Task) to the children of this FileNode.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.filechildren">
<em class="property">property </em><code class="sig-name descname">filechildren</code><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.filechildren" title="Permalink to this definition">¶</a></dt>
<dd><p>List with the children (nodes) of this FileNode.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.abiopen">
<code class="sig-name descname">abiopen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.abiopen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.abiopen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.FileNode.open_gsr">
<code class="sig-name descname">open_gsr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#FileNode.open_gsr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.FileNode.open_gsr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.HistoryRecord">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">HistoryRecord</code><span class="sig-paren">(</span><em class="sig-param">level</em>, <em class="sig-param">pathname</em>, <em class="sig-param">lineno</em>, <em class="sig-param">msg</em>, <em class="sig-param">args</em>, <em class="sig-param">exc_info</em>, <em class="sig-param">func=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#HistoryRecord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A <cite>HistoryRecord</cite> instance represents an entry in the <a class="reference internal" href="#abipy.flowtk.nodes.NodeHistory" title="abipy.flowtk.nodes.NodeHistory"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeHistory</span></code></a>.</p>
<p><cite>HistoryRecord</cite> instances are created every time something is logged.
They contain all the information pertinent to the event being logged.
The main information passed in is in msg and args, which are combined
using str(msg) % args to create the message field of the record.
The record also includes information such as when the record was created,
the source line where the logging call was made</p>
<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.levelno">
<code class="sig-name descname">levelno</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.levelno" title="Permalink to this definition">¶</a></dt>
<dd><p>Numeric logging level for the message (DEBUG, INFO, WARNING, ERROR, CRITICAL)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.levelname">
<code class="sig-name descname">levelname</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.levelname" title="Permalink to this definition">¶</a></dt>
<dd><p>Text logging level for the message (“DEBUG”, “INFO”, “WARNING”, “ERROR”, “CRITICAL”)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.pathname">
<code class="sig-name descname">pathname</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.pathname" title="Permalink to this definition">¶</a></dt>
<dd><p>Full pathname of the source file where the logging call was issued (if available)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.filename">
<code class="sig-name descname">filename</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Filename portion of pathname</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.module">
<code class="sig-name descname">module</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.module" title="Permalink to this definition">¶</a></dt>
<dd><p>Module (name portion of filename)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.lineno">
<code class="sig-name descname">lineno</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.lineno" title="Permalink to this definition">¶</a></dt>
<dd><p>Source line number where the logging call was issued (if available)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.func_name">
<code class="sig-name descname">func_name</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.func_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Function name</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.created">
<code class="sig-name descname">created</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Time when the HistoryRecord was created (time.time() return value)</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.asctime">
<code class="sig-name descname">asctime</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.asctime" title="Permalink to this definition">¶</a></dt>
<dd><p>Textual time when the HistoryRecord was created</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.nodes.HistoryRecord.message">
<code class="sig-name descname">message</code><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.message" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">The result of record.getMessage(), computed just as the record is emitted</code></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.HistoryRecord.get_message">
<code class="sig-name descname">get_message</code><span class="sig-paren">(</span><em class="sig-param">metadata=False</em>, <em class="sig-param">asctime=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#HistoryRecord.get_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.get_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the message after merging any user-supplied arguments with the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> – True if function and module name should be added.</p></li>
<li><p><strong>asctime</strong> – True if time string should be added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.HistoryRecord.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#HistoryRecord.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.HistoryRecord.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#HistoryRecord.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.HistoryRecord.from_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.NodeHistory">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">NodeHistory</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeHistory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.deque" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.deque</span></code></a></p>
<p>Logger-like object</p>
<dl class="method">
<dt id="abipy.flowtk.nodes.NodeHistory.to_string">
<code class="sig-name descname">to_string</code><span class="sig-paren">(</span><em class="sig-param">metadata=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeHistory.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeHistory.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns  a string with the history. Set metadata to True to have info on function and module.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeHistory.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeHistory.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeHistory.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with the info severity level</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeHistory.warning">
<code class="sig-name descname">warning</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeHistory.warning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeHistory.warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with the warning severity level</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.nodes.NodeHistory.critical">
<code class="sig-name descname">critical</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeHistory.critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeHistory.critical" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with the critical severity level</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.NodeCorrections">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">NodeCorrections</code><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#NodeCorrections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.NodeCorrections" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></p>
<p>Iterable storing the correctios performed by the <code class="xref py py-class docutils literal notranslate"><span class="pre">EventHandler</span></code></p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.nodes.GarbageCollector">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">GarbageCollector</code><span class="sig-paren">(</span><em class="sig-param">exts</em>, <em class="sig-param">policy</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#GarbageCollector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.GarbageCollector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores information on the</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.nodes.init_counter">
<code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">init_counter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#init_counter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.init_counter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="abipy.flowtk.nodes.get_newnode_id">
<code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">get_newnode_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#get_newnode_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.get_newnode_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new node identifier used for <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code> objects.</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.nodes.save_lastnode_id">
<code class="sig-prename descclassname">abipy.flowtk.nodes.</code><code class="sig-name descname">save_lastnode_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/nodes.html#save_lastnode_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.nodes.save_lastnode_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the id of the last node created.</p>
</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.pseudos">
<span id="pseudos-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pseudos</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.pseudos" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.flowtk.qadapters">
<span id="qadapters-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qadapters</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.qadapters" title="Permalink to this headline">¶</a></h2>
<p>The initial version of this module was based on a similar implementation
present in FireWorks (<a class="reference external" href="https://pypi.python.org/pypi/FireWorks">https://pypi.python.org/pypi/FireWorks</a>).
Work done by D. Waroquiers, A. Jain, and M. Kocher.</p>
<p>The main difference wrt the Fireworks implementation is that the QueueAdapter
objects provide a programmatic interface for setting important attributes
such as the number of MPI nodes, the number of OMP threads and the memory requirements.
This programmatic interface is used by the <cite>TaskManager</cite> for optimizing the parameters
of the run before submitting the job (Abinit provides the autoparal option that
allows one to get a list of parallel configuration and their expected efficiency).</p>
<dl class="function">
<dt id="abipy.flowtk.qadapters.make_qadapter">
<code class="sig-prename descclassname">abipy.flowtk.qadapters.</code><code class="sig-name descname">make_qadapter</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qadapters.html#make_qadapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qadapters.make_qadapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the concrete <code class="xref py py-class docutils literal notranslate"><span class="pre">QueueAdapter</span></code> class from a string.
Note that one can register a customized version with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qadapters</span> <span class="kn">import</span> <span class="n">SlurmAdapter</span>

<span class="k">class</span> <span class="nc">MyAdapter</span><span class="p">(</span><span class="n">SlurmAdapter</span><span class="p">):</span>
    <span class="n">QTYPE</span> <span class="o">=</span> <span class="s2">&quot;myslurm&quot;</span>
    <span class="c1"># Add your customized code here</span>

<span class="c1"># Register your class.</span>
<span class="n">SlurmAdapter</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyAdapter</span><span class="p">)</span>

<span class="n">make_qadapter</span><span class="p">(</span><span class="n">qtype</span><span class="o">=</span><span class="s2">&quot;myslurm&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>MyAdapter should be pickleable, hence one should declare it
at the module level so that pickle can import it at run-time.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.qha">
<span id="qha-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qha</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.qha" title="Permalink to this headline">¶</a></h2>
<p>Tools and workflows for calculations within the quasi-harmonic approximation.</p>
<p>WARNING: This code is still under development.</p>
<dl class="class">
<dt id="abipy.flowtk.qha.RelaxAndPhononWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qha.</code><code class="sig-name descname">RelaxAndPhononWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#RelaxAndPhononWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.RelaxAndPhononWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>This work perform a structural relaxation and use the relaxed structure to
compute phonon frequencies with DFPT.</p>
<dl class="method">
<dt id="abipy.flowtk.qha.RelaxAndPhononWork.from_gsinp">
<em class="property">classmethod </em><code class="sig-name descname">from_gsinp</code><span class="sig-paren">(</span><em class="sig-param">gsinp</em>, <em class="sig-param">ngqpt</em>, <em class="sig-param">optcell</em>, <em class="sig-param">ionmov</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#RelaxAndPhononWork.from_gsinp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.RelaxAndPhononWork.from_gsinp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qha.RelaxAndPhononWork.add_phonon_tasks_and_build">
<code class="sig-name descname">add_phonon_tasks_and_build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#RelaxAndPhononWork.add_phonon_tasks_and_build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.RelaxAndPhononWork.add_phonon_tasks_and_build" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by on_all_ok when the structural relaxation is completed.
Here the phonon tasks with the relaxed structure and constructed
and added to the work.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qha.RelaxAndPhononWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#RelaxAndPhononWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.RelaxAndPhononWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the task reach S_OK.
The first time we enter here, we construct the phonon tasks.
The second call runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qha.QhaFlow">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qha.</code><code class="sig-name descname">QhaFlow</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">pickle_protocol=-1</em>, <em class="sig-param">remove=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#QhaFlow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.QhaFlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.qha.QhaFlow.from_gsinp">
<em class="property">classmethod </em><code class="sig-name descname">from_gsinp</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">gsinp</em>, <em class="sig-param">volumes</em>, <em class="sig-param">ngqpt</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#QhaFlow.from_gsinp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.QhaFlow.from_gsinp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workdir</strong> – </p></li>
<li><p><strong>gsinp</strong> – </p></li>
<li><p><strong>volumes</strong> – </p></li>
<li><p><strong>ngqpt</strong> – </p></li>
<li><p><strong>manager</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qha.QhaFlow.finalize">
<code class="sig-name descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qha.html#QhaFlow.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qha.QhaFlow.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when the flow is completed.
It transfer the most important results to flow/outdir and perform
some basic post-processing of the results to facilitate further analysis.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.qjobs">
<span id="qjobs-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qjobs</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.qjobs" title="Permalink to this headline">¶</a></h2>
<p>Objects and methods to contact the resource manager to get info on the status of the job and useful statistics.
Note that this is not a wrapper for the C API but a collection of simple wrappers around the shell commands
provided by the resource manager  (qsub, qdel and qstat for PBS, sinfo, squeue… for Slurm).
The main goal indeed is providing a simplified common interface for different resource managers without
having to rely on external libraries.</p>
<dl class="class">
<dt id="abipy.flowtk.qjobs.JobStatus">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">JobStatus</code><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#JobStatus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.JobStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
<p>This object is an integer representing the status of a <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueueJob</span></code></a>.</p>
<p>Slurm API, see <cite>man squeue</cite>.</p>
<dl>
<dt>JOB STATE CODES</dt><dd><p>Jobs typically pass through several states in the course of their execution. The typical states are
PENDING, RUNNING, SUSPENDED, COMPLETING, and COMPLETED. An explanation of each state follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BF</span>  <span class="n">BOOT_FAIL</span>       <span class="n">Job</span>  <span class="n">terminated</span>  <span class="n">due</span>  <span class="n">to</span> <span class="n">launch</span> <span class="n">failure</span><span class="p">,</span> <span class="n">typically</span> <span class="n">due</span> <span class="n">to</span> <span class="n">a</span> <span class="n">hardware</span> <span class="n">failure</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span>
                    <span class="n">unable</span> <span class="n">to</span> <span class="n">boot</span> <span class="n">the</span> <span class="n">node</span> <span class="ow">or</span> <span class="n">block</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">job</span> <span class="n">can</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">requeued</span><span class="p">)</span><span class="o">.</span>
<span class="n">CA</span>  <span class="n">CANCELLED</span>       <span class="n">Job</span> <span class="n">was</span> <span class="n">explicitly</span> <span class="n">cancelled</span> <span class="n">by</span> <span class="n">the</span> <span class="n">user</span> <span class="ow">or</span> <span class="n">system</span> <span class="n">administrator</span><span class="o">.</span>
                    <span class="n">The</span> <span class="n">job</span> <span class="n">may</span> <span class="ow">or</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">been</span> <span class="n">initiated</span><span class="o">.</span>
<span class="n">CD</span>  <span class="n">COMPLETED</span>       <span class="n">Job</span> <span class="n">has</span> <span class="n">terminated</span> <span class="nb">all</span> <span class="n">processes</span> <span class="n">on</span> <span class="nb">all</span> <span class="n">nodes</span><span class="o">.</span>
<span class="n">CF</span>  <span class="n">CONFIGURING</span>     <span class="n">Job</span> <span class="n">has</span> <span class="n">been</span> <span class="n">allocated</span> <span class="n">resources</span><span class="p">,</span> <span class="n">but</span> <span class="n">are</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">them</span> <span class="n">to</span> <span class="n">become</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">use</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">booting</span><span class="p">)</span><span class="o">.</span>
<span class="n">CG</span>  <span class="n">COMPLETING</span>      <span class="n">Job</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">process</span> <span class="n">of</span> <span class="n">completing</span><span class="o">.</span> <span class="n">Some</span> <span class="n">processes</span> <span class="n">on</span> <span class="n">some</span>  <span class="n">nodes</span> <span class="n">may</span> <span class="n">still</span> <span class="n">be</span> <span class="n">active</span><span class="o">.</span>
<span class="n">F</span>   <span class="n">FAILED</span>          <span class="n">Job</span> <span class="n">terminated</span> <span class="k">with</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">exit</span> <span class="n">code</span> <span class="ow">or</span> <span class="n">other</span> <span class="n">failure</span> <span class="n">condition</span><span class="o">.</span>
<span class="n">NF</span>  <span class="n">NODE_FAIL</span>       <span class="n">Job</span> <span class="n">terminated</span> <span class="n">due</span> <span class="n">to</span> <span class="n">failure</span> <span class="n">of</span> <span class="n">one</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">allocated</span> <span class="n">nodes</span><span class="o">.</span>
<span class="n">PD</span>  <span class="n">PENDING</span>         <span class="n">Job</span> <span class="ow">is</span> <span class="n">awaiting</span> <span class="n">resource</span> <span class="n">allocation</span><span class="o">.</span>
<span class="n">PR</span>  <span class="n">PREEMPTED</span>       <span class="n">Job</span> <span class="n">terminated</span> <span class="n">due</span> <span class="n">to</span> <span class="n">preemption</span><span class="o">.</span>
<span class="n">R</span>   <span class="n">RUNNING</span>         <span class="n">Job</span> <span class="n">currently</span> <span class="n">has</span> <span class="n">an</span> <span class="n">allocation</span><span class="o">.</span>
<span class="n">S</span>   <span class="n">SUSPENDED</span>       <span class="n">Job</span> <span class="n">has</span> <span class="n">an</span> <span class="n">allocation</span><span class="p">,</span> <span class="n">but</span> <span class="n">execution</span> <span class="n">has</span> <span class="n">been</span> <span class="n">suspended</span><span class="o">.</span>
<span class="n">TO</span>  <span class="n">TIMEOUT</span>         <span class="n">Job</span> <span class="n">terminated</span> <span class="n">upon</span> <span class="n">reaching</span> <span class="n">its</span> <span class="n">time</span> <span class="n">limit</span><span class="o">.</span>
<span class="n">SE</span> <span class="n">SPECIAL_EXIT</span>     <span class="n">The</span> <span class="n">job</span> <span class="n">was</span> <span class="n">requeued</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">special</span> <span class="n">state</span><span class="o">.</span> <span class="n">This</span> <span class="n">state</span> <span class="n">can</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">by</span> <span class="n">users</span><span class="p">,</span> <span class="n">typically</span>
                    <span class="ow">in</span> <span class="n">EpilogSlurmctld</span><span class="p">,</span> <span class="k">if</span> <span class="n">the</span> <span class="n">job</span> <span class="n">has</span> <span class="n">terminated</span> <span class="k">with</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">exit</span> <span class="n">value</span><span class="o">.</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="abipy.flowtk.qjobs.JobStatus.from_string">
<em class="property">classmethod </em><code class="sig-name descname">from_string</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#JobStatus.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.JobStatus.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#abipy.flowtk.qjobs.JobStatus" title="abipy.flowtk.qjobs.JobStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">JobStatus</span></code></a> instance from its string representation.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.QueueJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">QueueJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object provides methods to contact the resource manager to get info on the status
of the job and useful statistics. This is an abstract class.</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = None</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_UNKNOWN">
<code class="sig-name descname">S_UNKNOWN</code><em class="property"> = &lt;JobStatus: UNKNOWN, at 4765255240&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_UNKNOWN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_PENDING">
<code class="sig-name descname">S_PENDING</code><em class="property"> = &lt;JobStatus: PENDING, at 4765254280&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_PENDING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_RUNNING">
<code class="sig-name descname">S_RUNNING</code><em class="property"> = &lt;JobStatus: RUNNING, at 4763605128&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_RUNNING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_RESIZING">
<code class="sig-name descname">S_RESIZING</code><em class="property"> = &lt;JobStatus: RESIZING, at 4763708552&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_RESIZING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_SUSPENDED">
<code class="sig-name descname">S_SUSPENDED</code><em class="property"> = &lt;JobStatus: SUSPENDED, at 4763708680&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_SUSPENDED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_COMPLETED">
<code class="sig-name descname">S_COMPLETED</code><em class="property"> = &lt;JobStatus: COMPLETED, at 4763709320&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_COMPLETED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_CANCELLED">
<code class="sig-name descname">S_CANCELLED</code><em class="property"> = &lt;JobStatus: CANCELLED, at 4765044936&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_CANCELLED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_FAILED">
<code class="sig-name descname">S_FAILED</code><em class="property"> = &lt;JobStatus: FAILED, at 4764897928&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_FAILED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_TIMEOUT">
<code class="sig-name descname">S_TIMEOUT</code><em class="property"> = &lt;JobStatus: TIMEOUT, at 4764897864&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_TIMEOUT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_PREEMPTED">
<code class="sig-name descname">S_PREEMPTED</code><em class="property"> = &lt;JobStatus: PREEMPTED, at 4764897608&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_PREEMPTED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.QueueJob.S_NODEFAIL">
<code class="sig-name descname">S_NODEFAIL</code><em class="property"> = &lt;JobStatus: NODEFAIL, at 4764897544&gt;</em><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.S_NODEFAIL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.from_qtype_and_id">
<em class="property">static </em><code class="sig-name descname">from_qtype_and_id</code><span class="sig-paren">(</span><em class="sig-param">qtype</em>, <em class="sig-param">queue_id</em>, <em class="sig-param">qname=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.from_qtype_and_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.from_qtype_and_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new istance of the appropriate subclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qtype</strong> – String specifying the Resource manager type.</p></li>
<li><p><strong>queue_id</strong> – Job identifier.</p></li>
<li><p><strong>qname</strong> – Name of the queue (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.is_completed">
<em class="property">property </em><code class="sig-name descname">is_completed</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.is_completed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.is_running">
<em class="property">property </em><code class="sig-name descname">is_running</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.is_running" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.is_failed">
<em class="property">property </em><code class="sig-name descname">is_failed</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.is_failed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.timeout">
<em class="property">property </em><code class="sig-name descname">timeout</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.timeout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.has_node_failures">
<em class="property">property </em><code class="sig-name descname">has_node_failures</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.has_node_failures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.unknown_status">
<em class="property">property </em><code class="sig-name descname">unknown_status</code><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.unknown_status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.set_status_exitcode_signal">
<code class="sig-name descname">set_status_exitcode_signal</code><span class="sig-paren">(</span><em class="sig-param">status</em>, <em class="sig-param">exitcode</em>, <em class="sig-param">signal</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.set_status_exitcode_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.set_status_exitcode_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.likely_code_error">
<code class="sig-name descname">likely_code_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.likely_code_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.likely_code_error" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference external" href="http://man7.org/linux/man-pages/man7/signal.7.html">http://man7.org/linux/man-pages/man7/signal.7.html</a></p>
<p>SIGHUP        1       Term    Hangup detected on controlling terminal or death of controlling process
SIGINT        2       Term    Interrupt from keyboard
SIGQUIT       3       Core    Quit from keyboard
SIGILL        4       Core    Illegal Instruction
SIGABRT       6       Core    Abort signal from abort(3)
SIGFPE        8       Core    Floating point exception
SIGKILL       9       Term    Kill signal
SIGSEGV      11       Core    Invalid memory reference
SIGPIPE      13       Term    Broken pipe: write to pipe with no readers
SIGALRM      14       Term    Timer signal from alarm(2)
SIGTERM      15       Term    Termination signal
SIGUSR1   30,10,16    Term    User-defined signal 1
SIGUSR2   31,12,17    Term    User-defined signal 2
SIGCHLD   20,17,18    Ign     Child stopped or terminated
SIGCONT   19,18,25    Cont    Continue if stopped
SIGSTOP   17,19,23    Stop    Stop process
SIGTSTP   18,20,24    Stop    Stop typed at terminal
SIGTTIN   21,21,26    Stop    Terminal input for background process
SIGTTOU   22,22,27    Stop    Terminal output for background process</p>
<p>The signals SIGKILL and SIGSTOP cannot be caught, blocked, or ignored.</p>
<p>Next the signals not in the POSIX.1-1990 standard but described in SUSv2 and POSIX.1-2001.</p>
<p>Signal       Value     Action   Comment
SIGBUS      10,7,10     Core    Bus error (bad memory access)
SIGPOLL                 Term    Pollable event (Sys V).</p>
<blockquote>
<div><p>Synonym for SIGIO</p>
</div></blockquote>
<p>SIGPROF     27,27,29    Term    Profiling timer expired
SIGSYS      12,31,12    Core    Bad argument to routine (SVr4)
SIGTRAP        5        Core    Trace/breakpoint trap
SIGURG      16,23,21    Ign     Urgent condition on socket (4.2BSD)
SIGVTALRM   26,26,28    Term    Virtual alarm clock (4.2BSD)
SIGXCPU     24,24,30    Core    CPU time limit exceeded (4.2BSD)
SIGXFSZ     25,25,31    Core    File size limit exceeded (4.2BSD)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.received_signal">
<code class="sig-name descname">received_signal</code><span class="sig-paren">(</span><em class="sig-param">sig_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.received_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.received_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.estimated_start_time">
<code class="sig-name descname">estimated_start_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.estimated_start_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.estimated_start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return date with estimated start time. None if it cannot be detected</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.get_info">
<code class="sig-name descname">get_info</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.get_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.get_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.get_nodes">
<code class="sig-name descname">get_nodes</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.get_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.get_nodes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.QueueJob.get_stats">
<code class="sig-name descname">get_stats</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#QueueJob.get_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.QueueJob.get_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.ShellJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">ShellJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#ShellJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.ShellJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Handler for Shell jobs.</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.ShellJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'shell'</em><a class="headerlink" href="#abipy.flowtk.qjobs.ShellJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.SlurmJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">SlurmJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#SlurmJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.SlurmJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Handler for Slurm jobs.</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.SlurmJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'slurm'</em><a class="headerlink" href="#abipy.flowtk.qjobs.SlurmJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.SlurmJob.estimated_start_time">
<code class="sig-name descname">estimated_start_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#SlurmJob.estimated_start_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.SlurmJob.estimated_start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return date with estimated start time. None if it cannot be detected</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.SlurmJob.get_info">
<code class="sig-name descname">get_info</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#SlurmJob.get_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.SlurmJob.get_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.SlurmJob.get_stats">
<code class="sig-name descname">get_stats</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#SlurmJob.get_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.SlurmJob.get_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.PbsProJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">PbsProJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#PbsProJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.PbsProJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Handler for PbsPro Jobs.</p>
<p>See also <a class="reference external" href="https://github.com/plediii/pbs_util">https://github.com/plediii/pbs_util</a> for a similar project.</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.PbsProJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'pbspro'</em><a class="headerlink" href="#abipy.flowtk.qjobs.PbsProJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.qjobs.PbsProJob.PBSSTAT_TO_SLURM">
<code class="sig-name descname">PBSSTAT_TO_SLURM</code><em class="property"> = {'E': &lt;JobStatus: FAILED, at 4764897928&gt;, 'F': &lt;JobStatus: COMPLETED, at 4763709320&gt;, 'Q': &lt;JobStatus: PENDING, at 4765254280&gt;, 'R': &lt;JobStatus: RUNNING, at 4763605128&gt;, 'S': &lt;JobStatus: SUSPENDED, at 4763708680&gt;}</em><a class="headerlink" href="#abipy.flowtk.qjobs.PbsProJob.PBSSTAT_TO_SLURM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.PbsProJob.estimated_start_time">
<code class="sig-name descname">estimated_start_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#PbsProJob.estimated_start_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.PbsProJob.estimated_start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return date with estimated start time. None if it cannot be detected</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.qjobs.PbsProJob.get_info">
<code class="sig-name descname">get_info</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#PbsProJob.get_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.PbsProJob.get_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.TorqueJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">TorqueJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#TorqueJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.TorqueJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Not supported</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.TorqueJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'torque'</em><a class="headerlink" href="#abipy.flowtk.qjobs.TorqueJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.SgeJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">SgeJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#SgeJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.SgeJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Not supported</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.SgeJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'sge'</em><a class="headerlink" href="#abipy.flowtk.qjobs.SgeJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.MoabJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">MoabJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#MoabJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.MoabJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Not supported</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.MoabJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'moab'</em><a class="headerlink" href="#abipy.flowtk.qjobs.MoabJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.qjobs.BlueGeneJob">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.qjobs.</code><code class="sig-name descname">BlueGeneJob</code><span class="sig-paren">(</span><em class="sig-param">queue_id</em>, <em class="sig-param">qname='UnknownQueue'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qjobs.html#BlueGeneJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qjobs.BlueGeneJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.qjobs.QueueJob" title="abipy.flowtk.qjobs.QueueJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.qjobs.QueueJob</span></code></a></p>
<p>Not supported</p>
<dl class="attribute">
<dt id="abipy.flowtk.qjobs.BlueGeneJob.QTYPE">
<code class="sig-name descname">QTYPE</code><em class="property"> = 'bluegene'</em><a class="headerlink" href="#abipy.flowtk.qjobs.BlueGeneJob.QTYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.qutils">
<span id="qutils-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qutils</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.qutils" title="Permalink to this headline">¶</a></h2>
<p>Collection of low-level tools that faciliate the interface with resource managers.</p>
<p>The preferred way of importing this module is:</p>
<blockquote>
<div><p>import qutils as qu</p>
</div></blockquote>
<dl class="function">
<dt id="abipy.flowtk.qutils.slurm_parse_timestr">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">slurm_parse_timestr</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#slurm_parse_timestr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.slurm_parse_timestr" title="Permalink to this definition">¶</a></dt>
<dd><p>A slurm time parser. Accepts a string in one the following forms:</p>
<blockquote>
<div><p># “days-hours”,
# “days-hours:minutes”,
# “days-hours:minutes:seconds”.
# “minutes”,
# “minutes:seconds”,
# “hours:minutes:seconds”,</p>
</div></blockquote>
<p>Returns: Time in seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – </p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.qutils.time2slurm">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">time2slurm</code><span class="sig-paren">(</span><em class="sig-param">timeval</em>, <em class="sig-param">unit='s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#time2slurm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.time2slurm" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a number representing a time value in the given unit (Default: seconds)
to a string following the slurm convention: “days-hours:minutes:seconds”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">time2slurm</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0-0:1:1&#39;</span> <span class="ow">and</span> <span class="n">time2slurm</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0-1:0:1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">time2slurm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0-0:30:0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.qutils.time2pbspro">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">time2pbspro</code><span class="sig-paren">(</span><em class="sig-param">timeval</em>, <em class="sig-param">unit='s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#time2pbspro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.time2pbspro" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a number representing a time value in the given unit (Default: seconds)
to a string following the PbsPro convention: “hours:minutes:seconds”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">time2pbspro</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;48:0:0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.qutils.time2loadlever">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">time2loadlever</code><span class="sig-paren">(</span><em class="sig-param">timeval</em>, <em class="sig-param">unit='s'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#time2loadlever"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.time2loadlever" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a number representing a time value in the given unit (Default: seconds)
to a string following the LoadLever convention. format hh:mm:ss (hours:minutes:seconds)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">time2loadlever</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;48:00:00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.qutils.timelimit_parser">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">timelimit_parser</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#timelimit_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.timelimit_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a float or a string into time in seconds.</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.qutils.any2mb">
<code class="sig-prename descclassname">abipy.flowtk.qutils.</code><code class="sig-name descname">any2mb</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/qutils.html#any2mb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.qutils.any2mb" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert string or number to memory in megabytes.</p>
</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.tasks">
<span id="tasks-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tasks</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.tasks" title="Permalink to this headline">¶</a></h2>
<p>This module provides functions and classes related to Task objects.</p>
<dl class="class">
<dt id="abipy.flowtk.tasks.ParalHintsParser">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">ParalHintsParser</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHintsParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHintsParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHintsParser.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.tasks.ParalHintsParser.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ParalHintsError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHintsParser.add_error">
<code class="sig-name descname">add_error</code><span class="sig-paren">(</span><em class="sig-param">errmsg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHintsParser.add_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHintsParser.add_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHintsParser.parse">
<code class="sig-name descname">parse</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHintsParser.parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHintsParser.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the <cite>AutoParal</cite> section (YAML format) from filename.
Assumes the file contains only one section.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.ParalHints">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">ParalHints</code><span class="sig-paren">(</span><em class="sig-param">info</em>, <em class="sig-param">confs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Iterable</span></code></a></p>
<p>Iterable with the hints for the parallel execution reported by ABINIT.</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHints.Error">
<code class="sig-name descname">Error</code><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ParalHintsError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.from_mpi_omp_lists">
<em class="property">classmethod </em><code class="sig-name descname">from_mpi_omp_lists</code><span class="sig-paren">(</span><em class="sig-param">mpi_procs</em>, <em class="sig-param">omp_threads</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.from_mpi_omp_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.from_mpi_omp_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a list of Parallel configurations from two lists
containing the number of MPI processes and the number of OpenMP threads
i.e. product(mpi_procs, omp_threads).
The configuration have parallel efficiency set to 1.0 and no input variables.
Mainly used for preparing benchmarks.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHints.max_cores">
<code class="sig-name descname">max_cores</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.max_cores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.max_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of cores.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHints.max_mem_per_proc">
<code class="sig-name descname">max_mem_per_proc</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.max_mem_per_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.max_mem_per_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum memory per MPI process.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHints.max_speedup">
<code class="sig-name descname">max_speedup</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.max_speedup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.max_speedup" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum speedup.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.ParalHints.max_efficiency">
<code class="sig-name descname">max_efficiency</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.max_efficiency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.max_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum parallel efficiency.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.as_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.from_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow copy of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.select_with_condition">
<code class="sig-name descname">select_with_condition</code><span class="sig-paren">(</span><em class="sig-param">condition</em>, <em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.select_with_condition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.select_with_condition" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all the configurations that do not satisfy the given condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> – dict or <code class="xref py py-class docutils literal notranslate"><span class="pre">Condition</span></code> object with operators expressed with a Mongodb-like syntax</p></li>
<li><p><strong>key</strong> – Selects the sub-dictionary on which condition is applied, e.g. key=”vars”
if we have to filter the configurations depending on the values in vars</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.sort_by_efficiency">
<code class="sig-name descname">sort_by_efficiency</code><span class="sig-paren">(</span><em class="sig-param">reverse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.sort_by_efficiency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.sort_by_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the configurations in place. items with highest efficiency come first</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.sort_by_speedup">
<code class="sig-name descname">sort_by_speedup</code><span class="sig-paren">(</span><em class="sig-param">reverse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.sort_by_speedup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.sort_by_speedup" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the configurations in place. items with highest speedup come first</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.sort_by_mem_per_proc">
<code class="sig-name descname">sort_by_mem_per_proc</code><span class="sig-paren">(</span><em class="sig-param">reverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.sort_by_mem_per_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.sort_by_mem_per_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the configurations in place. items with lowest memory per proc come first.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.multidimensional_optimization">
<code class="sig-name descname">multidimensional_optimization</code><span class="sig-paren">(</span><em class="sig-param">priorities=('speedup'</em>, <em class="sig-param">'efficiency')</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.multidimensional_optimization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.multidimensional_optimization" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ParalHints.get_ordered_with_policy">
<code class="sig-name descname">get_ordered_with_policy</code><span class="sig-paren">(</span><em class="sig-param">policy</em>, <em class="sig-param">max_ncpus</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ParalHints.get_ordered_with_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ParalHints.get_ordered_with_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort and return a new list of configurations ordered according to the <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskPolicy</span></code> policy.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.tasks.set_user_config_taskmanager">
<code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">set_user_config_taskmanager</code><span class="sig-paren">(</span><em class="sig-param">manager</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#set_user_config_taskmanager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.set_user_config_taskmanager" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the default manager returned by TaskManager.from_user_config.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.TaskManager">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">TaskManager</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.json.MSONable" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></a></p>
<p>A <cite>TaskManager</cite> is responsible for the generation of the job script and the submission
of the task, as well as for the specification of the parameters passed to the resource manager
(e.g. Slurm, PBS …) and/or the run-time specification of the ABINIT variables governing the parallel execution.
A <cite>TaskManager</cite> delegates the generation of the submission script and the submission of the task to the <code class="xref py py-class docutils literal notranslate"><span class="pre">QueueAdapter</span></code>.
A <cite>TaskManager</cite> has a <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskPolicy</span></code> that governs the specification of the parameters for the parallel executions.
Ideally, the TaskManager should be the <strong>main entry point</strong> used by the task to deal with job submission/optimization</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.TaskManager.YAML_FILE">
<code class="sig-name descname">YAML_FILE</code><em class="property"> = 'manager.yml'</em><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.YAML_FILE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.TaskManager.USER_CONFIG_DIR">
<code class="sig-name descname">USER_CONFIG_DIR</code><em class="property"> = '/Users/gmatteo/.abinit/abipy'</em><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.USER_CONFIG_DIR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.TaskManager.ENTRIES">
<code class="sig-name descname">ENTRIES</code><em class="property"> = {'batch_adapter', 'db_connector', 'policy', 'qadapters'}</em><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.ENTRIES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.autodoc">
<em class="property">classmethod </em><code class="sig-name descname">autodoc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.autodoc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.autodoc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.from_user_config">
<em class="property">classmethod </em><code class="sig-name descname">from_user_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.from_user_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.from_user_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the <a class="reference internal" href="#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code></a> from the YAML file ‘manager.yaml’.
Search first in the working directory and then in the AbiPy configuration directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>RuntimeError if file is not found.</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the configuration parameters from the Yaml file filename.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.from_string">
<em class="property">classmethod </em><code class="sig-name descname">from_string</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance from string s containing a YAML dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.as_manager">
<em class="property">classmethod </em><code class="sig-name descname">as_manager</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.as_manager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.as_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into TaskManager instance. Accepts string, filepath, dictionary, <cite>TaskManager</cite> object.
If obj is None, the manager is initialized from the user config file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.from_dict">
<em class="property">classmethod </em><code class="sig-name descname">from_dict</code><span class="sig-paren">(</span><em class="sig-param">d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance from a dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A JSON serializable dict representation of an object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.TaskManager.abinit_build">
<code class="sig-name descname">abinit_build</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.abinit_build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.abinit_build" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.flowtk.tasks.AbinitBuild" title="abipy.flowtk.tasks.AbinitBuild"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitBuild</span></code></a> object with Abinit version and options used to build the code</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.to_shell_manager">
<code class="sig-name descname">to_shell_manager</code><span class="sig-paren">(</span><em class="sig-param">mpi_procs=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.to_shell_manager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.to_shell_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new <cite>TaskManager</cite> with the same parameters as self but replace the <code class="xref py py-class docutils literal notranslate"><span class="pre">QueueAdapter</span></code>
with a <code class="xref py py-class docutils literal notranslate"><span class="pre">ShellAdapter</span></code> with mpi_procs so that we can submit the job without passing through the queue.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.new_with_fixed_mpi_omp">
<code class="sig-name descname">new_with_fixed_mpi_omp</code><span class="sig-paren">(</span><em class="sig-param">mpi_procs</em>, <em class="sig-param">omp_threads</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.new_with_fixed_mpi_omp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.new_with_fixed_mpi_omp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <cite>TaskManager</cite> in which autoparal has been disabled.
The jobs will be executed with <cite>mpi_procs</cite> MPI processes and <cite>omp_threads</cite> OpenMP threads.
Useful for generating input files for benchmarks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.has_queue">
<em class="property">property </em><code class="sig-name descname">has_queue</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.has_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are submitting jobs via a queue manager.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.qads">
<em class="property">property </em><code class="sig-name descname">qads</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.qads" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">QueueAdapter</span></code> objects sorted according to priorities (highest comes first)</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.qadapter">
<em class="property">property </em><code class="sig-name descname">qadapter</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.qadapter" title="Permalink to this definition">¶</a></dt>
<dd><p>The qadapter used to submit jobs.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.select_qadapter">
<code class="sig-name descname">select_qadapter</code><span class="sig-paren">(</span><em class="sig-param">pconfs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.select_qadapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.select_qadapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of parallel configurations, pconfs, this method select an <cite>optimal</cite> configuration
according to some criterion as well as the <code class="xref py py-class docutils literal notranslate"><span class="pre">QueueAdapter</span></code> to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pconfs</strong> – <a class="reference internal" href="#abipy.flowtk.tasks.ParalHints" title="abipy.flowtk.tasks.ParalHints"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParalHints</span></code></a> object with the list of parallel configurations</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelConf</span></code> object with the <cite>optimal</cite> configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.has_db">
<em class="property">property </em><code class="sig-name descname">has_db</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.has_db" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are using MongoDB database</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.has_omp">
<em class="property">property </em><code class="sig-name descname">has_omp</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.has_omp" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are using OpenMP parallelization.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.num_cores">
<em class="property">property </em><code class="sig-name descname">num_cores</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.num_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of CPUs used to run the task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.mpi_procs">
<em class="property">property </em><code class="sig-name descname">mpi_procs</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.mpi_procs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of MPI processes.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.mem_per_proc">
<em class="property">property </em><code class="sig-name descname">mem_per_proc</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.mem_per_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory per MPI process.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.omp_threads">
<em class="property">property </em><code class="sig-name descname">omp_threads</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.omp_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of OpenMP threads</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.deepcopy">
<code class="sig-name descname">deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.set_mpi_procs">
<code class="sig-name descname">set_mpi_procs</code><span class="sig-paren">(</span><em class="sig-param">mpi_procs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.set_mpi_procs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.set_mpi_procs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of MPI processes to use.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.set_omp_threads">
<code class="sig-name descname">set_omp_threads</code><span class="sig-paren">(</span><em class="sig-param">omp_threads</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.set_omp_threads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.set_omp_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of OpenMp threads to use.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.set_mem_per_proc">
<code class="sig-name descname">set_mem_per_proc</code><span class="sig-paren">(</span><em class="sig-param">mem_mb</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.set_mem_per_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.set_mem_per_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the memory (in Megabytes) per CPU.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.max_cores">
<em class="property">property </em><code class="sig-name descname">max_cores</code><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.max_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of cores that can be used.
This value is mainly used in the autoparal part to get the list of possible configurations.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.get_njobs_in_queue">
<code class="sig-name descname">get_njobs_in_queue</code><span class="sig-paren">(</span><em class="sig-param">username=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.get_njobs_in_queue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.get_njobs_in_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the number of jobs in the queue,
returns None when the number of jobs cannot be determined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>username</strong> – (str) the username of the jobs to count (default is to autodetect)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.cancel">
<code class="sig-name descname">cancel</code><span class="sig-paren">(</span><em class="sig-param">job_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel the job. Returns exit status.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.write_jobfile">
<code class="sig-name descname">write_jobfile</code><span class="sig-paren">(</span><em class="sig-param">task</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.write_jobfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.write_jobfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the submission script. Return the path of the script</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>exec_args</p></td>
<td><p>List of arguments passed to task.executable.
Default: no arguments.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.launch">
<code class="sig-name descname">launch</code><span class="sig-paren">(</span><em class="sig-param">task</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.launch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.launch" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the input files and submit the task via the <code class="xref py py-class docutils literal notranslate"><span class="pre">Qadapter</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>task</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskObject</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Process object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.get_collection">
<code class="sig-name descname">get_collection</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.get_collection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.get_collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the MongoDB collection used to store the results.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.increase_mem">
<code class="sig-name descname">increase_mem</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.increase_mem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.increase_mem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.increase_ncpus">
<code class="sig-name descname">increase_ncpus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.increase_ncpus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.increase_ncpus" title="Permalink to this definition">¶</a></dt>
<dd><p>increase the number of cpus, first ask the current qadapter, if that one raises a QadapterIncreaseError
switch to the next qadapter. If all fail raise an ManagerIncreaseError</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.increase_resources">
<code class="sig-name descname">increase_resources</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.increase_resources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.increase_resources" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.exclude_nodes">
<code class="sig-name descname">exclude_nodes</code><span class="sig-paren">(</span><em class="sig-param">nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.exclude_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.exclude_nodes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.TaskManager.increase_time">
<code class="sig-name descname">increase_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#TaskManager.increase_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.TaskManager.increase_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.AbinitBuild">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">AbinitBuild</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitBuild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object stores information on the options used to build Abinit</p>
<blockquote>
<div><dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.info">
<code class="sig-name descname">info</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.info" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">String with build information as produced by `abinit -b`</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.version">
<code class="sig-name descname">version</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.version" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">Abinit version number e.g 8.0.1 (string)</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.has_netcdf">
<code class="sig-name descname">has_netcdf</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.has_netcdf" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">True if netcdf is enabled.</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.has_omp">
<code class="sig-name descname">has_omp</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.has_omp" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">True if OpenMP is enabled.</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.has_mpi">
<code class="sig-name descname">has_mpi</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.has_mpi" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">True if MPI is enabled.</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitBuild.has_mpiio">
<code class="sig-name descname">has_mpiio</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.has_mpiio" title="Permalink to this definition">¶</a></dt>
<dt>
<code class="sig-name descname">True if MPI-IO is supported.</code></dt>
<dd></dd></dl>

</div></blockquote>
<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitBuild.version_ge">
<code class="sig-name descname">version_ge</code><span class="sig-paren">(</span><em class="sig-param">version_string</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitBuild.version_ge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.version_ge" title="Permalink to this definition">¶</a></dt>
<dd><p>True is Abinit version is &gt;= version_string</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitBuild.compare_version">
<code class="sig-name descname">compare_version</code><span class="sig-paren">(</span><em class="sig-param">version_string</em>, <em class="sig-param">op</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitBuild.compare_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitBuild.compare_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare Abinit version to <cite>version_string</cite> with operator <cite>op</cite></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.AbinitTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">AbinitTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.Task</span></code></p>
<p>Base class defining an ABINIT calculation</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitTask.Results">
<code class="sig-name descname">Results</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.Results" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskResults</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.from_input">
<em class="property">classmethod </em><code class="sig-name descname">from_input</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.from_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.from_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of <cite>AbinitTask</cite> from an ABINIT input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ainput</strong> – <cite>AbinitInput</cite> object.</p></li>
<li><p><strong>workdir</strong> – Path to the working directory.</p></li>
<li><p><strong>manager</strong> – <a class="reference internal" href="#abipy.flowtk.tasks.TaskManager" title="abipy.flowtk.tasks.TaskManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code></a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.temp_shell_task">
<em class="property">classmethod </em><code class="sig-name descname">temp_shell_task</code><span class="sig-paren">(</span><em class="sig-param">inp</em>, <em class="sig-param">mpi_procs=1</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.temp_shell_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.temp_shell_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a Task with a temporary workdir. The task is executed via the shell with 1 MPI proc.
Mainly used for invoking Abinit to get important parameters needed to prepare the real task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Abinit has the very <em>bad</em> habit of changing the file extension by appending the characters in [A,B …, Z]
to the output file, and this breaks a lot of code that relies of the use of a unique file extension.
Here we fix this issue by renaming run.abo to run.abo_[number] if the output file “run.abo” already
exists. A few lines of code in python, a lot of problems if you try to implement this trick in Fortran90.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.executable">
<em class="property">property </em><code class="sig-name descname">executable</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.executable" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the executable required for running the Task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.pseudos">
<em class="property">property </em><code class="sig-name descname">pseudos</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.pseudos" title="Permalink to this definition">¶</a></dt>
<dd><p>List of pseudos used in the calculation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.isnc">
<em class="property">property </em><code class="sig-name descname">isnc</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.isnc" title="Permalink to this definition">¶</a></dt>
<dd><p>True if norm-conserving calculation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.ispaw">
<em class="property">property </em><code class="sig-name descname">ispaw</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.ispaw" title="Permalink to this definition">¶</a></dt>
<dd><p>True if PAW calculation</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.is_gs_task">
<em class="property">property </em><code class="sig-name descname">is_gs_task</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.is_gs_task" title="Permalink to this definition">¶</a></dt>
<dd><p>True if task is GsTask subclass.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.is_dfpt_task">
<em class="property">property </em><code class="sig-name descname">is_dfpt_task</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.is_dfpt_task" title="Permalink to this definition">¶</a></dt>
<dd><p>True if task is a DftpTask subclass.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.AbinitTask.cycle_class">
<code class="sig-name descname">cycle_class</code><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.cycle_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.cycle_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subclass of ScfCycle associated to the task or
None if no SCF algorithm if associated to the task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.filesfile_string">
<em class="property">property </em><code class="sig-name descname">filesfile_string</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.filesfile_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String with the list of files and prefixes needed to execute ABINIT.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.set_pconfs">
<code class="sig-name descname">set_pconfs</code><span class="sig-paren">(</span><em class="sig-param">pconfs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.set_pconfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.set_pconfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the list of autoparal configurations.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.pconfs">
<em class="property">property </em><code class="sig-name descname">pconfs</code><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.pconfs" title="Permalink to this definition">¶</a></dt>
<dd><p>List of autoparal configurations.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.uses_paral_kgb">
<code class="sig-name descname">uses_paral_kgb</code><span class="sig-paren">(</span><em class="sig-param">value=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.uses_paral_kgb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.uses_paral_kgb" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the task is a GS Task and uses paral_kgb with the given value.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.autoparal_run">
<code class="sig-name descname">autoparal_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.autoparal_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.autoparal_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an optimal set of parameters for the execution of the task
This method can change the ABINIT input variables and/or the
submission parameters e.g. the number of CPUs for MPI and OpenMp.</p>
<dl class="simple">
<dt>Set:</dt><dd><p>self.pconfs where pconfs is a <a class="reference internal" href="#abipy.flowtk.tasks.ParalHints" title="abipy.flowtk.tasks.ParalHints"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParalHints</span></code></a> object with the configuration reported by
autoparal and optimal is the optimal configuration selected.
Returns 0 if success</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.find_optconf">
<code class="sig-name descname">find_optconf</code><span class="sig-paren">(</span><em class="sig-param">pconfs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.find_optconf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.find_optconf" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the optimal Parallel configuration.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.select_files">
<code class="sig-name descname">select_files</code><span class="sig-paren">(</span><em class="sig-param">what='o'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.select_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.select_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to select the files of a task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>what</strong> – string with the list of characters selecting the file type
Possible choices:
i ==&gt; input_file,
o ==&gt; output_file,
f ==&gt; files_file,
j ==&gt; job_file,
l ==&gt; log_file,
e ==&gt; stderr_file,
q ==&gt; qout_file,
all ==&gt; all files.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.restart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>general restart used when scheduler problems have been taken care of</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.reset_from_scratch">
<code class="sig-name descname">reset_from_scratch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.reset_from_scratch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.reset_from_scratch" title="Permalink to this definition">¶</a></dt>
<dd><p>Restart from scratch, this is to be used if a job is restarted with more resources after a crash</p>
<p>Move output files produced in workdir to _reset otherwise check_status continues
to see the task as crashed even if the job did not run</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.fix_abicritical">
<code class="sig-name descname">fix_abicritical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.fix_abicritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.fix_abicritical" title="Permalink to this definition">¶</a></dt>
<dd><p>method to fix crashes/error caused by abinit</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1 if task has been fixed else 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.fix_queue_critical">
<code class="sig-name descname">fix_queue_critical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.fix_queue_critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.fix_queue_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tries to fix critical events originating from the queue submission system.</p>
<p>General strategy, first try to increase resources in order to fix the problem,
if this is not possible, call a task specific method to attempt to decrease the demands.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1 if task has been fixed else 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AbinitTask.parse_timing">
<code class="sig-name descname">parse_timing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AbinitTask.parse_timing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AbinitTask.parse_timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the timer data in the main output file of Abinit.
Requires timopt /= 0 in the input file (usually timopt = -1)</p>
<p>Return: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTimerParser</span></code> instance, None if error.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.ScfTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">ScfTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ScfTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.GsTask</span></code></p>
<p>Self-consistent ground-state calculations.
Provide support for in-place restart via (WFK|DEN) files</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.ScfTask.CRITICAL_EVENTS">
<code class="sig-name descname">CRITICAL_EVENTS</code><em class="property"> = [&lt;class 'abipy.flowtk.events.ScfConvergenceWarning'&gt;]</em><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask.CRITICAL_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.ScfTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([1., 0., 0.])</em><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ScfTask.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ScfTask.restart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>SCF calculations can be restarted if we have either the WFK file or the DEN file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ScfTask.inspect">
<code class="sig-name descname">inspect</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ScfTask.inspect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask.inspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the SCF cycle results with matplotlib.</p>
<dl class="simple">
<dt>Returns</dt><dd><p><cite>matplotlib</cite> figure, None if some error occurred.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.ScfTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ScfTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ScfTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.NscfTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">NscfTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#NscfTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.GsTask</span></code></p>
<p>Non-Self-consistent GS calculation. Provide in-place restart via WFK files</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.NscfTask.CRITICAL_EVENTS">
<code class="sig-name descname">CRITICAL_EVENTS</code><em class="property"> = [&lt;class 'abipy.flowtk.events.NscfConvergenceWarning'&gt;]</em><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask.CRITICAL_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.NscfTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0.78431373, 0.31372549, 0.39215686])</em><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.NscfTask.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#NscfTask.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>NSCF calculations should use the same FFT mesh as the one employed in the GS task
(in principle, it’s possible to interpolate inside Abinit but tests revealed some numerical noise
Here we change the input file of the NSCF task to have the same FFT mesh.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.NscfTask.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#NscfTask.restart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>NSCF calculations can be restarted only if we have the WFK file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.NscfTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#NscfTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.NscfTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.RelaxTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">RelaxTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.GsTask</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.ProduceHist</span></code></p>
<p>Task for structural optimizations.</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.RelaxTask.CRITICAL_EVENTS">
<code class="sig-name descname">CRITICAL_EVENTS</code><em class="property"> = [&lt;class 'abipy.flowtk.events.RelaxConvergenceWarning'&gt;]</em><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.CRITICAL_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.RelaxTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([1.        , 0.23921569, 1.        ])</em><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.get_final_structure">
<code class="sig-name descname">get_final_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.get_final_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.get_final_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the final structure from the GSR file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.restart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>Restart the structural relaxation.</p>
<p>Structure relaxations can be restarted only if we have the WFK file or the DEN or the GSR file
from which we can read the last structure (mandatory) and the wavefunctions (not mandatory but useful).
Prefer WFK over other files since we can reuse the wavefunctions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The problem in the present approach is that some parameters in the input
are computed from the initial structure and may not be consistent with
the modification of the structure done during the structure relaxation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.inspect">
<code class="sig-name descname">inspect</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.inspect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.inspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the evolution of the structural relaxation with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>what</strong> – Either “hist” or “scf”. The first option (default) extracts data
from the HIST file and plot the evolution of the structural
parameters, forces, pressures and energies.
The second option, extracts data from the main output file and
plot the evolution of the SCF cycles (etotal, residuals, etc).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>matplotlib</cite> figure, None if some error occurred.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.reduce_dilatmx">
<code class="sig-name descname">reduce_dilatmx</code><span class="sig-paren">(</span><em class="sig-param">target=1.01</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.reduce_dilatmx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.reduce_dilatmx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.RelaxTask.fix_ofiles">
<code class="sig-name descname">fix_ofiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#RelaxTask.fix_ofiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.RelaxTask.fix_ofiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Note that ABINIT produces lots of out_TIM1_DEN files for each step.
Here we list all TIM*_DEN files, we select the last one and we rename it in out_DEN</p>
<p>This change is needed so that we can specify dependencies with the syntax {node: “DEN”}
without having to know the number of iterations needed to converge the run in node!</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.DdkTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">DdkTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#DdkTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.DdkTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.DfptTask</span></code></p>
<p>Task for DDK calculations.</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.DdkTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0. , 0.8, 0.8])</em><a class="headerlink" href="#abipy.flowtk.tasks.DdkTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.DdkTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#DdkTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.DdkTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.PhononTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">PhononTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#PhononTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.PhononTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.DfptTask</span></code></p>
<p>DFPT calculations for a single atomic perturbation.
Provide support for in-place restart via (1WF|1DEN) files</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.PhononTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0.        , 0.58823529, 0.98039216])</em><a class="headerlink" href="#abipy.flowtk.tasks.PhononTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.PhononTask.inspect">
<code class="sig-name descname">inspect</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#PhononTask.inspect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.PhononTask.inspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Phonon SCF cycle results with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>matplotlib</cite> figure, None if some error occurred.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.PhononTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#PhononTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.PhononTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.ElasticTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">ElasticTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#ElasticTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.ElasticTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.DfptTask</span></code></p>
<p>DFPT calculations for a single strain perturbation (uniaxial or shear strain).
Provide support for in-place restart via (1WF|1DEN) files</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.ElasticTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([1. , 0.8, 1. ])</em><a class="headerlink" href="#abipy.flowtk.tasks.ElasticTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.EphTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">EphTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#EphTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.EphTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.tasks.AbinitTask" title="abipy.flowtk.tasks.AbinitTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.AbinitTask</span></code></a></p>
<p>Class for electron-phonon calculations.</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.EphTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([1.        , 0.50196078, 0.        ])</em><a class="headerlink" href="#abipy.flowtk.tasks.EphTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.SigmaTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">SigmaTask</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">deps=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#SigmaTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.ManyBodyTask</span></code></p>
<p>Tasks for SIGMA calculations. Provides support for in-place restart via QPS files</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.SigmaTask.CRITICAL_EVENTS">
<code class="sig-name descname">CRITICAL_EVENTS</code><em class="property"> = [&lt;class 'abipy.flowtk.events.QPSConvergenceWarning'&gt;]</em><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.CRITICAL_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.tasks.SigmaTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0., 1., 0.])</em><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.SigmaTask.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#SigmaTask.restart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>general restart used when scheduler problems have been taken care of</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.SigmaTask.sigres_path">
<em class="property">property </em><code class="sig-name descname">sigres_path</code><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.sigres_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the SIGRES file. Empty string if file is not present.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.SigmaTask.open_sigres">
<code class="sig-name descname">open_sigres</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#SigmaTask.open_sigres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.open_sigres" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the SIGRES file located in the in self.outdir.
Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">SigresFile</span></code> object, None if file could not be found or file is not readable.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.SigmaTask.get_scissors_builder">
<code class="sig-name descname">get_scissors_builder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#SigmaTask.get_scissors_builder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.get_scissors_builder" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">ScissorsBuilder</span></code> from the SIGRES file.</p>
<dl class="simple">
<dt>Raise:</dt><dd><p><cite>RuntimeError</cite> if SIGRES file is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.SigmaTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#SigmaTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.SigmaTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.OpticTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">OpticTask</code><span class="sig-paren">(</span><em class="sig-param">optic_input</em>, <em class="sig-param">nscf_node</em>, <em class="sig-param">ddk_nodes</em>, <em class="sig-param">use_ddknc=False</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.Task</span></code></p>
<p>Task for the computation of optical spectra with optic i.e.
RPA without local-field effects and velocity operator computed from DDK files.</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.OpticTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([1. , 0.8, 0.4])</em><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.set_workdir">
<code class="sig-name descname">set_workdir</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">chroot=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.set_workdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.set_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the working directory of the task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.set_vars">
<code class="sig-name descname">set_vars</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.set_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.set_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Optic does not use <cite>get</cite> or <cite>ird</cite> variables hence we should never try
to change the input when we connect this task</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.executable">
<em class="property">property </em><code class="sig-name descname">executable</code><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.executable" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the executable required for running the <a class="reference internal" href="#abipy.flowtk.tasks.OpticTask" title="abipy.flowtk.tasks.OpticTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticTask</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.filesfile_string">
<em class="property">property </em><code class="sig-name descname">filesfile_string</code><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.filesfile_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String with the list of files and prefixes needed to execute ABINIT.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.wfk_filepath">
<em class="property">property </em><code class="sig-name descname">wfk_filepath</code><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.wfk_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the WFK file produced by the NSCF run.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.ddk_filepaths">
<em class="property">property </em><code class="sig-name descname">ddk_filepaths</code><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.ddk_filepaths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the DDK files produced by the DDK runs.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.make_input">
<code class="sig-name descname">make_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.make_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.make_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and write the input file of the calculation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Public method called before submitting the task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.make_links">
<code class="sig-name descname">make_links</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.make_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.make_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Optic allows the user to specify the paths of the input file.
hence we don’t need to create symbolic links.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.fix_abicritical">
<code class="sig-name descname">fix_abicritical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.fix_abicritical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.fix_abicritical" title="Permalink to this definition">¶</a></dt>
<dd><p>Cannot fix abicritical errors for optic</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.reset_from_scratch">
<code class="sig-name descname">reset_from_scratch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.reset_from_scratch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.reset_from_scratch" title="Permalink to this definition">¶</a></dt>
<dd><p>restart from scratch, this is to be used if a job is restarted with more resources after a crash</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.fix_queue_critical">
<code class="sig-name descname">fix_queue_critical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.fix_queue_critical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.fix_queue_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tries to fix critical events originating from the queue submission system.</p>
<p>General strategy, first try to increase resources in order to fix the problem,
if this is not possible, call a task specific method to attempt to decrease the demands.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1 if task has been fixed else 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.OpticTask.autoparal_run">
<code class="sig-name descname">autoparal_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#OpticTask.autoparal_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.OpticTask.autoparal_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an optimal set of parameters for the execution of the Optic task
This method can change the submission parameters e.g. the number of CPUs for MPI and OpenMp.</p>
<p>Returns 0 if success</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.tasks.AnaddbTask">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.tasks.</code><code class="sig-name descname">AnaddbTask</code><span class="sig-paren">(</span><em class="sig-param">anaddb_input</em>, <em class="sig-param">ddb_node</em>, <em class="sig-param">gkk_node=None</em>, <em class="sig-param">md_node=None</em>, <em class="sig-param">ddk_node=None</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.tasks.Task</span></code></p>
<p>Task for Anaddb runs (post-processing of DFPT calculations).</p>
<dl class="attribute">
<dt id="abipy.flowtk.tasks.AnaddbTask.color_rgb">
<code class="sig-name descname">color_rgb</code><em class="property"> = array([0.8, 0.4, 1. ])</em><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.color_rgb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.temp_shell_task">
<em class="property">classmethod </em><code class="sig-name descname">temp_shell_task</code><span class="sig-paren">(</span><em class="sig-param">inp</em>, <em class="sig-param">ddb_node</em>, <em class="sig-param">mpi_procs=1</em>, <em class="sig-param">gkk_node=None</em>, <em class="sig-param">md_node=None</em>, <em class="sig-param">ddk_node=None</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.temp_shell_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.temp_shell_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.flowtk.tasks.AnaddbTask" title="abipy.flowtk.tasks.AnaddbTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnaddbTask</span></code></a> with a temporary workdir. The task is executed via
the shell with 1 MPI proc. Mainly used for post-processing the DDB files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpi_procs</strong> – Number of MPI processes to use.</p></li>
<li><p><strong>anaddb_input</strong> – string with the anaddb variables.</p></li>
<li><p><strong>ddb_node</strong> – The node that will produce the DDB file. Accept <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code> or filepath.</p></li>
</ul>
</dd>
</dl>
<p>See <cite>AnaddbInit</cite> for the meaning of the other arguments.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.executable">
<em class="property">property </em><code class="sig-name descname">executable</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.executable" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the executable required for running the <a class="reference internal" href="#abipy.flowtk.tasks.AnaddbTask" title="abipy.flowtk.tasks.AnaddbTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnaddbTask</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.filesfile_string">
<em class="property">property </em><code class="sig-name descname">filesfile_string</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.filesfile_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String with the list of files and prefixes needed to execute ABINIT.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.ddb_filepath">
<em class="property">property </em><code class="sig-name descname">ddb_filepath</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.ddb_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the input DDB file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.md_filepath">
<em class="property">property </em><code class="sig-name descname">md_filepath</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.md_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the input MD file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.gkk_filepath">
<em class="property">property </em><code class="sig-name descname">gkk_filepath</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.gkk_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the input GKK file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.ddk_filepath">
<em class="property">property </em><code class="sig-name descname">ddk_filepath</code><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.ddk_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (at runtime) the absolute path of the input DKK file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Public method called before submitting the task.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.make_links">
<code class="sig-name descname">make_links</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.make_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.make_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Anaddb allows the user to specify the paths of the input file.
hence we don’t need to create symbolic links.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.open_phbst">
<code class="sig-name descname">open_phbst</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.open_phbst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.open_phbst" title="Permalink to this definition">¶</a></dt>
<dd><p>Open PHBST file produced by Anaddb and returns <code class="xref py py-class docutils literal notranslate"><span class="pre">PhbstFile</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.open_phdos">
<code class="sig-name descname">open_phdos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.open_phdos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.open_phdos" title="Permalink to this definition">¶</a></dt>
<dd><p>Open PHDOS file produced by Anaddb and returns <code class="xref py py-class docutils literal notranslate"><span class="pre">PhdosFile</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.tasks.AnaddbTask.get_results">
<code class="sig-name descname">get_results</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/tasks.html#AnaddbTask.get_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.tasks.AnaddbTask.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-class docutils literal notranslate"><span class="pre">NodeResults</span></code> instance.
Subclasses should extend this method (if needed) by adding
specialized code that performs some kind of post-processing.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.utils">
<span id="utils-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.utils" title="Permalink to this headline">¶</a></h2>
<p>Tools and helper functions for abinit calculations</p>
<dl class="function">
<dt id="abipy.flowtk.utils.as_bool">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">as_bool</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#as_bool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.as_bool" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string into a boolean.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">as_bool</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">as_bool</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">as_bool</span><span class="p">(</span><span class="s2">&quot;false&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.File">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">File</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Very simple class used to store file basenames, absolute paths and directory names.
Provides wrappers for the most commonly used functions defined in os.path.</p>
<dl class="method">
<dt id="abipy.flowtk.utils.File.path">
<em class="property">property </em><code class="sig-name descname">path</code><a class="headerlink" href="#abipy.flowtk.utils.File.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.basename">
<em class="property">property </em><code class="sig-name descname">basename</code><a class="headerlink" href="#abipy.flowtk.utils.File.basename" title="Permalink to this definition">¶</a></dt>
<dd><p>File basename.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.relpath">
<em class="property">property </em><code class="sig-name descname">relpath</code><a class="headerlink" href="#abipy.flowtk.utils.File.relpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Relative path.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.dirname">
<em class="property">property </em><code class="sig-name descname">dirname</code><a class="headerlink" href="#abipy.flowtk.utils.File.dirname" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the directory where the file is located.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.exists">
<em class="property">property </em><code class="sig-name descname">exists</code><a class="headerlink" href="#abipy.flowtk.utils.File.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>True if file exists.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.isncfile">
<em class="property">property </em><code class="sig-name descname">isncfile</code><a class="headerlink" href="#abipy.flowtk.utils.File.isncfile" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self is a NetCDF file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.chmod">
<code class="sig-name descname">chmod</code><span class="sig-paren">(</span><em class="sig-param">mode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.chmod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.chmod" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the access permissions of a file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.readlines">
<code class="sig-name descname">readlines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.readlines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.readlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Read lines from files.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write string to file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.writelines">
<code class="sig-name descname">writelines</code><span class="sig-paren">(</span><em class="sig-param">lines</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.writelines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.writelines" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a list of strings to file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.make_dir">
<code class="sig-name descname">make_dir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.make_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.make_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the directory where the file is located.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.move">
<code class="sig-name descname">move</code><span class="sig-paren">(</span><em class="sig-param">dst</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively move a file or directory to another location. This is
similar to the Unix “mv” command.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.get_stat">
<code class="sig-name descname">get_stat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.get_stat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.get_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Results from os.stat</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.File.getsize">
<code class="sig-name descname">getsize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#File.getsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.File.getsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size, in bytes, of path.
Return 0 if the file is empty or it does not exist.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.Directory">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">Directory</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Very simple class that provides helper functions
wrapping the most commonly used functions defined in os.path.</p>
<dl class="method">
<dt id="abipy.flowtk.utils.Directory.path">
<em class="property">property </em><code class="sig-name descname">path</code><a class="headerlink" href="#abipy.flowtk.utils.Directory.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute path of the directory.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.relpath">
<em class="property">property </em><code class="sig-name descname">relpath</code><a class="headerlink" href="#abipy.flowtk.utils.Directory.relpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Relative path.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.basename">
<em class="property">property </em><code class="sig-name descname">basename</code><a class="headerlink" href="#abipy.flowtk.utils.Directory.basename" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory basename.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.path_join">
<code class="sig-name descname">path_join</code><span class="sig-paren">(</span><em class="sig-param">*p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.path_join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.path_join" title="Permalink to this definition">¶</a></dt>
<dd><p>Join two or more pathname components, inserting ‘/’ as needed.
If any component is an absolute path, all previous path components will be discarded.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.exists">
<em class="property">property </em><code class="sig-name descname">exists</code><a class="headerlink" href="#abipy.flowtk.utils.Directory.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>True if file exists.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.makedirs">
<code class="sig-name descname">makedirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.makedirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.makedirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Super-mkdir; create a leaf directory and all intermediate ones.
Works like mkdir, except that any intermediate path segment (not
just the rightmost) will be created if it does not exist.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.rmtree">
<code class="sig-name descname">rmtree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.rmtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.rmtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively delete the directory tree</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.copy_r">
<code class="sig-name descname">copy_r</code><span class="sig-paren">(</span><em class="sig-param">dst</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.copy_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.copy_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a recursive copy function similar to Unix’s “cp -r” command.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all files in the directory tree while preserving the directory</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.path_in">
<code class="sig-name descname">path_in</code><span class="sig-paren">(</span><em class="sig-param">file_basename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.path_in"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.path_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute path of filename in the directory.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.list_filepaths">
<code class="sig-name descname">list_filepaths</code><span class="sig-paren">(</span><em class="sig-param">wildcard=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.list_filepaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.list_filepaths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of absolute filepaths in the directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wildcard</strong> – <p>String of tokens separated by “|”. Each token represents a pattern.
If wildcard is not None, we return only those files that match
the given shell pattern (uses fnmatch).
.. rubric:: Example</p>
<p>wildcard=”<em>.nc|</em>.pdf” selects only those files that end with .nc or .pdf</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.has_abiext">
<code class="sig-name descname">has_abiext</code><span class="sig-paren">(</span><em class="sig-param">ext</em>, <em class="sig-param">single_file=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.has_abiext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.has_abiext" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the absolute path of the ABINIT file with extension ext.
Support both Fortran files and netcdf files. In the later case,
we check whether a file with extension ext + “.nc” is present
in the directory. Returns empty string is file is not present.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – </p></li>
<li><p><strong>This implies that this method is not compatible with multiple datasets.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.symlink_abiext">
<code class="sig-name descname">symlink_abiext</code><span class="sig-paren">(</span><em class="sig-param">inext</em>, <em class="sig-param">outext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.symlink_abiext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.symlink_abiext" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simbolic link (outext –&gt; inext). The file names are implicitly
given by the ABINIT file extension.</p>
<p class="rubric">Example</p>
<p>outdir.symlink_abiext(‘1WF’, ‘DDK’)</p>
<p>creates the link out_DDK that points to out_1WF</p>
<p>Return: 0 if success.</p>
<p>Raise: RuntimeError</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.rename_abiext">
<code class="sig-name descname">rename_abiext</code><span class="sig-paren">(</span><em class="sig-param">inext</em>, <em class="sig-param">outext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.rename_abiext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.rename_abiext" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename the Abinit file with extension inext with the new extension outext</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.copy_abiext">
<code class="sig-name descname">copy_abiext</code><span class="sig-paren">(</span><em class="sig-param">inext</em>, <em class="sig-param">outext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.copy_abiext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.copy_abiext" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy the Abinit file with extension inext to a new file withw extension outext</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.remove_exts">
<code class="sig-name descname">remove_exts</code><span class="sig-paren">(</span><em class="sig-param">exts</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.remove_exts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.remove_exts" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the files with the given extensions. Unlike rmtree, this function preserves the directory path.
Return list with the absolute paths of the files that have been removed.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.find_last_timden_file">
<code class="sig-name descname">find_last_timden_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.find_last_timden_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.find_last_timden_file" title="Permalink to this definition">¶</a></dt>
<dd><p>ABINIT produces lots of out_TIM1_DEN files for each step and we need to find the lat
one in order to prepare the restart or to connect other tasks to the structural relaxation.</p>
<p>This function finds all the TIM?_DEN files in self and return a namedtuple (path, step)
where <cite>path</cite> is the path of the last TIM?_DEN file and step is the iteration number.
Returns None if the directory does not contain TIM?_DEN files.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.find_1wf_files">
<code class="sig-name descname">find_1wf_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.find_1wf_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.find_1wf_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Abinit adds the idir-ipert index at the end of the 1WF file and this breaks the extension
e.g. out_1WF4. This method scans the files in the directories and returns a list of namedtuple
Each named tuple gives the <cite>path</cite> of the 1FK file and the <cite>pertcase</cite> index.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Directory.find_1den_files">
<code class="sig-name descname">find_1den_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Directory.find_1den_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Directory.find_1den_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Abinit adds the idir-ipert index at the end of the 1DEN file and this breaks the extension
e.g. out_DEN1. This method scans the files in the directories and returns a list of namedtuple
Each named tuple gives the <cite>path</cite> of the 1DEN file and the <cite>pertcase</cite> index.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.utils.irdvars_for_ext">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">irdvars_for_ext</code><span class="sig-paren">(</span><em class="sig-param">ext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#irdvars_for_ext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.irdvars_for_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary with the ABINIT variables
that must be used to read the file with extension ext.</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.utils.abi_extensions">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">abi_extensions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#abi_extensions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.abi_extensions" title="Permalink to this definition">¶</a></dt>
<dd><p>List with all the ABINIT extensions that are registered.</p>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.utils.abi_splitext">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">abi_splitext</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#abi_splitext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.abi_splitext" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the ABINIT extension from a filename.
“Extension” are found by searching in an internal database.</p>
<p>Returns “(root, ext)” where ext is the registered ABINIT extension
The final “.nc” is included (if any)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">abi_splitext</span><span class="p">(</span><span class="s2">&quot;foo_WFK&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;foo_&#39;</span><span class="p">,</span> <span class="s1">&#39;WFK&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">abi_splitext</span><span class="p">(</span><span class="s2">&quot;/home/guido/foo_bar_WFK.nc&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;foo_bar_&#39;</span><span class="p">,</span> <span class="s1">&#39;WFK.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.FilepathFixer">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">FilepathFixer</code><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#FilepathFixer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.FilepathFixer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object modifies the names of particular output files
produced by ABINIT so that the file extension is preserved.
Having a one-to-one mapping between file extension and data format
is indeed fundamental for the correct behaviour of abinit since:</p>
<blockquote>
<div><ul class="simple">
<li><p>We locate the output file by just inspecting the extension</p></li>
<li><p>We select the variables that must be added to the input file
on the basis of the extension specified by the user during
the initialization of the <cite>AbinitFlow</cite>.</p></li>
</ul>
</div></blockquote>
<p>Unfortunately, ABINIT developers like to append extra stuff
to the initial extension and therefore we have to call
<cite>FilepathFixer</cite> to fix the output files produced by the run.</p>
<p class="rubric">Example</p>
<p>fixer = FilepathFixer()
fixer.fix_paths(‘/foo/out_1WF17’) == {‘/foo/out_1WF17’: ‘/foo/out_1WF’}
fixer.fix_paths(‘/foo/out_1WF5.nc’) == {‘/foo/out_1WF5.nc’: ‘/foo/out_1WF.nc’}</p>
<dl class="method">
<dt id="abipy.flowtk.utils.FilepathFixer.fix_paths">
<code class="sig-name descname">fix_paths</code><span class="sig-paren">(</span><em class="sig-param">paths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#FilepathFixer.fix_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.FilepathFixer.fix_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the filenames in the iterable paths</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mapping old_path –&gt; new_path</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>old2new</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.utils.map2rpn">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">map2rpn</code><span class="sig-paren">(</span><em class="sig-param">map</em>, <em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#map2rpn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.map2rpn" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Mongodb-like dictionary to a RPN list of operands and operators.</p>
<p>Reverse Polish notation (RPN) is a mathematical notation in which every
operator follows all of its operands, e.g.</p>
<p>3 - 4 + 5 –&gt;   3 4 - 5 +</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mf">2.0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$eq&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">map2rpn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;$eq&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.flowtk.utils.evaluate_rpn">
<code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">evaluate_rpn</code><span class="sig-paren">(</span><em class="sig-param">rpn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#evaluate_rpn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.evaluate_rpn" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the RPN form produced my map2rpn.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.Condition">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">Condition</code><span class="sig-paren">(</span><em class="sig-param">cmap=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Condition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Condition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This object receives a dictionary that defines a boolean condition whose syntax is similar
to the one used in mongodb (albeit not all the operators available in mongodb are supported here).</p>
<p>Example:</p>
<p>$gt: {field: {$gt: value} }</p>
<p>$gt selects those documents where the value of the field is greater than (i.e. &gt;) the specified value.</p>
<p>$and performs a logical AND operation on an array of two or more expressions (e.g. &lt;expression1&gt;, &lt;expression2&gt;, etc.)
and selects the documents that satisfy all the expressions in the array.</p>
<p>{ $and: [ { &lt;expression1&gt; }, { &lt;expression2&gt; } , … , { &lt;expressionN&gt; } ] }</p>
<p>Consider the following example:</p>
<p>db.inventory.find( { qty: { $gt: 20 } } )
This query will select all documents in the inventory collection where the qty field value is greater than 20.
Consider the following example:</p>
<p>db.inventory.find( { qty: { $gt: 20 } } )
db.inventory.find({ $and: [ { price: 1.99 }, { qty: { $lt: 20 } }, { sale: true } ] } )</p>
<dl class="method">
<dt id="abipy.flowtk.utils.Condition.as_condition">
<em class="property">classmethod </em><code class="sig-name descname">as_condition</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Condition.as_condition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Condition.as_condition" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into <a class="reference internal" href="#abipy.flowtk.utils.Condition" title="abipy.flowtk.utils.Condition"><code class="xref py py-class docutils literal notranslate"><span class="pre">Condition</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.Editor">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">Editor</code><span class="sig-paren">(</span><em class="sig-param">editor=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Editor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Editor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wrapper class that calls the editor specified by the user
or the one specified in the $EDITOR env variable.</p>
<dl class="method">
<dt id="abipy.flowtk.utils.Editor.edit_files">
<code class="sig-name descname">edit_files</code><span class="sig-paren">(</span><em class="sig-param">fnames</em>, <em class="sig-param">ask_for_exit=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Editor.edit_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Editor.edit_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Editor.edit_file">
<code class="sig-name descname">edit_file</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Editor.edit_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Editor.edit_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.utils.Editor.user_wants_to_exit">
<em class="property">static </em><code class="sig-name descname">user_wants_to_exit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Editor.user_wants_to_exit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Editor.user_wants_to_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Show an interactive prompt asking if exit is wanted.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.SparseHistogram">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">SparseHistogram</code><span class="sig-paren">(</span><em class="sig-param">items</em>, <em class="sig-param">key=None</em>, <em class="sig-param">num=None</em>, <em class="sig-param">step=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#SparseHistogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.SparseHistogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.utils.SparseHistogram.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#SparseHistogram.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.SparseHistogram.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the histogram with matplotlib, returns <cite>matplotlib</cite> figure.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.utils.Dirviz">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.utils.</code><code class="sig-name descname">Dirviz</code><span class="sig-paren">(</span><em class="sig-param">top</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Dirviz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Dirviz" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="abipy.flowtk.utils.Dirviz.get_cluster_graph">
<code class="sig-name descname">get_cluster_graph</code><span class="sig-paren">(</span><em class="sig-param">engine='fdp'</em>, <em class="sig-param">graph_attr=None</em>, <em class="sig-param">node_attr=None</em>, <em class="sig-param">edge_attr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/utils.html#Dirviz.get_cluster_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.utils.Dirviz.get_cluster_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate directory graph in the DOT language. Directories are shown as clusters</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function scans the entire directory tree starting from top so the resulting
graph can be really big.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> – Layout command used. [‘dot’, ‘neato’, ‘twopi’, ‘circo’, ‘fdp’, ‘sfdp’, ‘patchwork’, ‘osage’]</p></li>
<li><p><strong>graph_attr</strong> – Mapping of (attribute, value) pairs for the graph.</p></li>
<li><p><strong>node_attr</strong> – Mapping of (attribute, value) pairs set for all nodes.</p></li>
<li><p><strong>edge_attr</strong> – Mapping of (attribute, value) pairs set for all edges.</p></li>
</ul>
</dd>
</dl>
<p>Returns: graphviz.Digraph &lt;<a class="reference external" href="https://graphviz.readthedocs.io/en/stable/api.html#digraph">https://graphviz.readthedocs.io/en/stable/api.html#digraph</a>&gt;</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.works">
<span id="works-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">works</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.works" title="Permalink to this headline">¶</a></h2>
<p>Works for Abinit</p>
<dl class="class">
<dt id="abipy.flowtk.works.Work">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">Work</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.BaseWork</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.NodeContainer</span></code></p>
<p>A Work is a list of (possibly connected) tasks.</p>
<dl class="method">
<dt id="abipy.flowtk.works.Work.set_manager">
<code class="sig-name descname">set_manager</code><span class="sig-paren">(</span><em class="sig-param">manager</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.set_manager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.set_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> to use to launch the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.flow">
<em class="property">property </em><code class="sig-name descname">flow</code><a class="headerlink" href="#abipy.flowtk.works.Work.flow" title="Permalink to this definition">¶</a></dt>
<dd><p>The flow containing this <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.set_flow">
<code class="sig-name descname">set_flow</code><span class="sig-paren">(</span><em class="sig-param">flow</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.set_flow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.set_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the flow associated to this <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.flowtk.works.Work.pos">
<code class="sig-name descname">pos</code><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>The position of self in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Flow</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.pos_str">
<em class="property">property </em><code class="sig-name descname">pos_str</code><a class="headerlink" href="#abipy.flowtk.works.Work.pos_str" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation of self.pos</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.set_workdir">
<code class="sig-name descname">set_workdir</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">chroot=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.set_workdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.set_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the working directory. Cannot be set more than once unless chroot is True</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.chroot">
<code class="sig-name descname">chroot</code><span class="sig-paren">(</span><em class="sig-param">new_workdir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.chroot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.chroot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.chunks">
<code class="sig-name descname">chunks</code><span class="sig-paren">(</span><em class="sig-param">chunk_size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield successive chunks of tasks of lenght chunk_size.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.ipath_from_ext">
<code class="sig-name descname">ipath_from_ext</code><span class="sig-paren">(</span><em class="sig-param">ext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.ipath_from_ext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.ipath_from_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path of the output file with extension ext.
Use it when the file does not exist yet.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.opath_from_ext">
<code class="sig-name descname">opath_from_ext</code><span class="sig-paren">(</span><em class="sig-param">ext</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.opath_from_ext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.opath_from_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path of the output file with extension ext.
Use it when the file does not exist yet.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.processes">
<em class="property">property </em><code class="sig-name descname">processes</code><a class="headerlink" href="#abipy.flowtk.works.Work.processes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of objects that support the <cite>subprocess.Popen</cite> protocol.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.all_done">
<em class="property">property </em><code class="sig-name descname">all_done</code><a class="headerlink" href="#abipy.flowtk.works.Work.all_done" title="Permalink to this definition">¶</a></dt>
<dd><p>True if all the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> objects in the <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a> are done.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.isnc">
<em class="property">property </em><code class="sig-name descname">isnc</code><a class="headerlink" href="#abipy.flowtk.works.Work.isnc" title="Permalink to this definition">¶</a></dt>
<dd><p>True if norm-conserving calculation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.ispaw">
<em class="property">property </em><code class="sig-name descname">ispaw</code><a class="headerlink" href="#abipy.flowtk.works.Work.ispaw" title="Permalink to this definition">¶</a></dt>
<dd><p>True if PAW calculation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.status_counter">
<em class="property">property </em><code class="sig-name descname">status_counter</code><a class="headerlink" href="#abipy.flowtk.works.Work.status_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>Counter</cite> object that counts the number of task with
given status (use the string representation of the status as key).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.allocate">
<code class="sig-name descname">allocate</code><span class="sig-paren">(</span><em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.allocate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.allocate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called once we have completed the initialization
of the <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a>. It sets the manager of each task (if not already done)
and defines the working directories of the tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object or None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.register">
<code class="sig-name descname">register</code><span class="sig-paren">(</span><em class="sig-param">obj</em>, <em class="sig-param">deps=None</em>, <em class="sig-param">required_files=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">task_class=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.register"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> and add it to the internal list, taking into account possible dependencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> instance or <cite>Task</cite> object.</p></li>
<li><p><strong>deps</strong> – Dictionary specifying the dependency of this node or list of dependencies
None means that this obj has no dependency.</p></li>
<li><p><strong>required_files</strong> – List of strings with the path of the files used by the task.
Note that the files must exist when the task is registered.
Use the standard approach based on Works, Tasks and deps
if the files will be produced in the future.</p></li>
<li><p><strong>manager</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> responsible for the submission of the task. If manager is None, we use
the <cite>TaskManager</cite> specified during the creation of the <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a>.</p></li>
<li><p><strong>task_class</strong> – Task subclass to instantiate. Default: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTask</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.register_task">
<code class="sig-name descname">register_task</code><span class="sig-paren">(</span><em class="sig-param">obj</em>, <em class="sig-param">deps=None</em>, <em class="sig-param">required_files=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">task_class=None</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.flowtk.works.Work.register_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a new <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> and add it to the internal list, taking into account possible dependencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitInput</span></code> instance or <cite>Task</cite> object.</p></li>
<li><p><strong>deps</strong> – Dictionary specifying the dependency of this node or list of dependencies
None means that this obj has no dependency.</p></li>
<li><p><strong>required_files</strong> – List of strings with the path of the files used by the task.
Note that the files must exist when the task is registered.
Use the standard approach based on Works, Tasks and deps
if the files will be produced in the future.</p></li>
<li><p><strong>manager</strong> – The <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> responsible for the submission of the task. If manager is None, we use
the <cite>TaskManager</cite> specified during the creation of the <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">Work</span></code></a>.</p></li>
<li><p><strong>task_class</strong> – Task subclass to instantiate. Default: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTask</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.path_in_workdir">
<code class="sig-name descname">path_in_workdir</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.path_in_workdir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.path_in_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the absolute path of filename in the working directory.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Method called before running the calculations.
The default implementation is empty.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the top level directory.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.status">
<em class="property">property </em><code class="sig-name descname">status</code><a class="headerlink" href="#abipy.flowtk.works.Work.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the status of the work i.e. the minimum of the status of the tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.get_all_status">
<code class="sig-name descname">get_all_status</code><span class="sig-paren">(</span><em class="sig-param">only_min=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.get_all_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.get_all_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with the status of the tasks in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>only_min</strong> – If True, the minimum of the status is returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.check_status">
<code class="sig-name descname">check_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.check_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.check_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the status of the tasks.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.rmtree">
<code class="sig-name descname">rmtree</code><span class="sig-paren">(</span><em class="sig-param">exclude_wildcard=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.rmtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.rmtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all files and directories in the working directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exclude_wildcard</strong> – Optional string with regular expressions separated by <cite>|</cite>.
Files matching one of the regular expressions will be preserved.
example: exclude_wildard=”<em>.nc|</em>.txt” preserves all the files
whose extension is in [“nc”, “txt”].</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.rm_indatadir">
<code class="sig-name descname">rm_indatadir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.rm_indatadir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.rm_indatadir" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all the indata directories.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.rm_outdatadir">
<code class="sig-name descname">rm_outdatadir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.rm_outdatadir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.rm_outdatadir" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all the indata directories.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.rm_tmpdatadir">
<code class="sig-name descname">rm_tmpdatadir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.rm_tmpdatadir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.rm_tmpdatadir" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all the tmpdata directories.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.move">
<code class="sig-name descname">move</code><span class="sig-paren">(</span><em class="sig-param">dest</em>, <em class="sig-param">isabspath=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively move self.workdir to another location. This is similar to the Unix “mv” command.
The destination path must not already exist. If the destination already exists
but is not a directory, it may be overwritten depending on os.rename() semantics.</p>
<p>Be default, dest is located in the parent directory of self.workdir, use isabspath=True
to specify an absolute path.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.submit_tasks">
<code class="sig-name descname">submit_tasks</code><span class="sig-paren">(</span><em class="sig-param">wait=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.submit_tasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.submit_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Submits the task in self and wait.
TODO: change name.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the work. Calls build and _setup first, then submit the tasks.
Non-blocking call unless wait is set to True</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.read_etotals">
<code class="sig-name descname">read_etotals</code><span class="sig-paren">(</span><em class="sig-param">unit='Ha'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.read_etotals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.read_etotals" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the total energy from the GSR file produced by the task.</p>
<p>Return a numpy array with the total energies in Hartree
The array element is set to np.inf if an exception is raised while reading the GSR file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.Work.parse_timers">
<code class="sig-name descname">parse_timers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#Work.parse_timers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.Work.parse_timers" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the TIMER section reported in the ABINIT output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitTimerParser</span></code> object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.BandStructureWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">BandStructureWork</code><span class="sig-paren">(</span><em class="sig-param">scf_input</em>, <em class="sig-param">nscf_input</em>, <em class="sig-param">dos_inputs=None</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BandStructureWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BandStructureWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for band structure calculations.</p>
<dl class="method">
<dt id="abipy.flowtk.works.BandStructureWork.plot_ebands">
<code class="sig-name descname">plot_ebands</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BandStructureWork.plot_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BandStructureWork.plot_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure. kwargs are passed to the plot method of <code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronBands</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>matplotlib</cite> figure</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.BandStructureWork.plot_ebands_with_edos">
<code class="sig-name descname">plot_ebands_with_edos</code><span class="sig-paren">(</span><em class="sig-param">dos_pos=0</em>, <em class="sig-param">method='gaussian'</em>, <em class="sig-param">step=0.01</em>, <em class="sig-param">width=0.1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BandStructureWork.plot_ebands_with_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BandStructureWork.plot_ebands_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dos_pos</strong> – Index of the task from which the DOS should be obtained (note: 0 refers to the first DOS task).</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <cite>plot_with_edos</cite> method to customize the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>matplotlib</cite> figure.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.BandStructureWork.plot_edoses">
<code class="sig-name descname">plot_edoses</code><span class="sig-paren">(</span><em class="sig-param">dos_pos=None</em>, <em class="sig-param">method='gaussian'</em>, <em class="sig-param">step=0.01</em>, <em class="sig-param">width=0.1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BandStructureWork.plot_edoses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BandStructureWork.plot_edoses" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the band structure and the DOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dos_pos</strong> – Index of the task from which the DOS should be obtained.
None is all DOSes should be displayed. Accepts integer or list of integers.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <cite>plot</cite> method to customize the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>matplotlib</cite> figure.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.RelaxWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">RelaxWork</code><span class="sig-paren">(</span><em class="sig-param">ion_input</em>, <em class="sig-param">ioncell_input</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em>, <em class="sig-param">target_dilatmx=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#RelaxWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.RelaxWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for structural relaxations. The first task relaxes the atomic position
while keeping the unit cell parameters fixed. The second task uses the final
structure to perform a structural relaxation in which both the atomic positions
and the lattice parameters are optimized.</p>
<dl class="method">
<dt id="abipy.flowtk.works.RelaxWork.on_ok">
<code class="sig-name descname">on_ok</code><span class="sig-paren">(</span><em class="sig-param">sender</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#RelaxWork.on_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.RelaxWork.on_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is called when one task reaches status S_OK.
If sender == self.ion_task, we update the initial structure
used by self.ioncell_task and we unlock it so that the job can be submitted.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.RelaxWork.plot_ion_relaxation">
<code class="sig-name descname">plot_ion_relaxation</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#RelaxWork.plot_ion_relaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.RelaxWork.plot_ion_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the history of the ion-cell relaxation.
kwargs are passed to the plot method of <code class="xref py py-class docutils literal notranslate"><span class="pre">HistFile</span></code></p>
<p>Return <cite>matplotlib</cite> figure or None if hist file is not found.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.RelaxWork.plot_ioncell_relaxation">
<code class="sig-name descname">plot_ioncell_relaxation</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#RelaxWork.plot_ioncell_relaxation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.RelaxWork.plot_ioncell_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the history of the ion-cell relaxation.
kwargs are passed to the plot method of <code class="xref py py-class docutils literal notranslate"><span class="pre">HistFile</span></code></p>
<p>Return <cite>matplotlib</cite> figure or None if hist file is not found.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.G0W0Work">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">G0W0Work</code><span class="sig-paren">(</span><em class="sig-param">scf_inputs</em>, <em class="sig-param">nscf_inputs</em>, <em class="sig-param">scr_inputs</em>, <em class="sig-param">sigma_inputs</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#G0W0Work"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.G0W0Work" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for general G0W0 calculations.
All input can be either single inputs or lists of inputs</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.SigmaConvWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">SigmaConvWork</code><span class="sig-paren">(</span><em class="sig-param">wfk_node</em>, <em class="sig-param">scr_node</em>, <em class="sig-param">sigma_inputs</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#SigmaConvWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.SigmaConvWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for self-energy convergence studies.</p>
</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.BseMdfWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">BseMdfWork</code><span class="sig-paren">(</span><em class="sig-param">scf_input</em>, <em class="sig-param">nscf_input</em>, <em class="sig-param">bse_inputs</em>, <em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BseMdfWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BseMdfWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>Work for simple BSE calculations in which the self-energy corrections
are approximated by the scissors operator and the screening is modeled
with the model dielectric function.</p>
<dl class="method">
<dt id="abipy.flowtk.works.BseMdfWork.get_mdf_robot">
<code class="sig-name descname">get_mdf_robot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BseMdfWork.get_mdf_robot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BseMdfWork.get_mdf_robot" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds and returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">MdfRobot</span></code> for analyzing the results in the MDF files.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.QptdmWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">QptdmWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#QptdmWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.QptdmWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>This work parallelizes the calculation of the q-points of the screening.
It also provides the callback <cite>on_all_ok</cite> that calls mrgscr to merge
all the partial screening files produced.</p>
<dl class="method">
<dt id="abipy.flowtk.works.QptdmWork.create_tasks">
<code class="sig-name descname">create_tasks</code><span class="sig-paren">(</span><em class="sig-param">wfk_file</em>, <em class="sig-param">scr_input</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#QptdmWork.create_tasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.QptdmWork.create_tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the SCR tasks and register them in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wfk_file</strong> – Path to the ABINIT WFK file to use for the computation of the screening.</p></li>
<li><p><strong>scr_input</strong> – Input for the screening calculation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.QptdmWork.merge_scrfiles">
<code class="sig-name descname">merge_scrfiles</code><span class="sig-paren">(</span><em class="sig-param">remove_scrfiles=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#QptdmWork.merge_scrfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.QptdmWork.merge_scrfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the q-points have been computed.
It runs <cite>mrgscr</cite> in sequential on the local machine to produce
the final SCR file in the outdir of the <cite>Work</cite>.
If remove_scrfiles is True, the partial SCR files are removed after the merge.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.QptdmWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#QptdmWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.QptdmWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the q-points have been computed.
It runs <cite>mrgscr</cite> in sequential on the local machine to produce
the final SCR file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.PhononWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">PhononWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>This work consists of nirred Phonon tasks where nirred is
the number of irreducible atomic perturbations for a given set of q-points.
It provides the callback method (on_all_ok) that calls mrgddb (mrgdv) to merge
all the partial DDB (POT) files produced. The two files are available in the
output directory of the Work.</p>
<dl class="method">
<dt id="abipy.flowtk.works.PhononWork.from_scf_task">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_task</code><span class="sig-paren">(</span><em class="sig-param">scf_task</em>, <em class="sig-param">qpoints</em>, <em class="sig-param">is_ngqpt=False</em>, <em class="sig-param">tolerance=None</em>, <em class="sig-param">with_becs=False</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWork.from_scf_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWork.from_scf_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>PhononWork</cite> from a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScfTask</span></code> object.
The input file for phonons is automatically generated from the input of the ScfTask.
Each phonon task depends on the WFK file produced by the <cite>scf_task</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_task</strong> – ScfTask object.</p></li>
<li><p><strong>qpoints</strong> – q-points in reduced coordinates. Accepts single q-point, list of q-points
or three integers defining the q-mesh if <cite>is_ngqpt</cite>.</p></li>
<li><p><strong>is_ngqpt</strong> – True if <cite>qpoints</cite> should be interpreted as divisions instead of q-points.</p></li>
<li><p><strong>tolerance</strong> – dict {“varname”: value} with the tolerance to be used in the phonon run.
None to use AbiPy default.</p></li>
<li><p><strong>with_becs</strong> – Activate calculation of Electric field and Born effective charges.</p></li>
<li><p><strong>ddk_tolerance</strong> – dict {“varname”: value} with the tolerance used in the DDK run if with_becs.
None to use AbiPy default.</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.PhononWork.from_scf_input">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_input</code><span class="sig-paren">(</span><em class="sig-param">scf_input</em>, <em class="sig-param">qpoints</em>, <em class="sig-param">is_ngqpt=False</em>, <em class="sig-param">tolerance=None</em>, <em class="sig-param">with_becs=False</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWork.from_scf_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWork.from_scf_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <cite>from_scf_task</cite>, the difference is that this method requires
an input for SCF calculation. A new ScfTask is created and added to the Work.
This API should be used if the DDB of the GS task should be merged.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.PhononWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the q-points have been computed.
Ir runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.PhononWfkqWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">PhononWfkqWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWfkqWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWfkqWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>This work computes phonons with DFPT on an arbitrary q-mesh (usually denser than the k-mesh for electrons)
by computing WKQ files for each q-point.
The number of irreducible atomic perturbations for each q-point are taken into account.
It provides the callback method (on_all_ok) that calls mrgddb (mrgdv) to merge
all the partial DDB (POT) files produced. The two files are available in the
output directory of the Work. The WKQ files are removed at runtime.</p>
<dl class="method">
<dt id="abipy.flowtk.works.PhononWfkqWork.from_scf_task">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_task</code><span class="sig-paren">(</span><em class="sig-param">scf_task</em>, <em class="sig-param">ngqpt</em>, <em class="sig-param">ph_tolerance=None</em>, <em class="sig-param">tolwfr=1e-22</em>, <em class="sig-param">nband=None</em>, <em class="sig-param">with_becs=False</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">shiftq=(0</em>, <em class="sig-param">0</em>, <em class="sig-param">0)</em>, <em class="sig-param">is_ngqpt=True</em>, <em class="sig-param">remove_wfkq=True</em>, <em class="sig-param">prepgkk=0</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWfkqWork.from_scf_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWfkqWork.from_scf_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>PhononWfkqWork</cite> from a <code class="xref py py-class docutils literal notranslate"><span class="pre">ScfTask</span></code> object.
The input files for WFQ and phonons are automatically generated from the input of the ScfTask.
Each phonon task depends on the WFK file produced by scf_task and the associated WFQ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_task</strong> – ScfTask object.</p></li>
<li><p><strong>ngqpt</strong> – three integers defining the q-mesh</p></li>
<li><p><strong>with_becs</strong> – Activate calculation of Electric field and Born effective charges.</p></li>
<li><p><strong>ph_tolerance</strong> – dict {“varname”: value} with the tolerance for the phonon run.
None to use AbiPy default.</p></li>
<li><p><strong>tolwfr</strong> – tolerance used to compute WFQ.</p></li>
<li><p><strong>ddk_tolerance</strong> – dict {“varname”: value} with the tolerance used in the DDK run if with_becs.
None to use AbiPy default.</p></li>
<li><p><strong>shiftq</strong> – Q-mesh shift. Multiple shifts are not supported.</p></li>
<li><p><strong>is_ngqpt</strong> – the ngqpt is interpreted as a set of integers defining the q-mesh, otherwise
is an explicit list of q-points</p></li>
<li><p><strong>remove_wfkq</strong> – Remove WKQ files when the children are completed.</p></li>
<li><p><strong>prepgkk</strong> – 1 to activate computation of all 3*natom perts (debugging option).</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.PhononWfkqWork.on_ok">
<code class="sig-name descname">on_ok</code><span class="sig-paren">(</span><em class="sig-param">sender</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWfkqWork.on_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWfkqWork.on_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is called when one task reaches status <cite>S_OK</cite>.
It removes the WFKQ file if all its children have reached <cite>S_OK</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.PhononWfkqWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#PhononWfkqWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.PhononWfkqWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all the q-points have been computed.
Ir runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.GKKPWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">GKKPWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#GKKPWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.GKKPWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
<p>This work computes electron-phonon matrix elements for all the q-points
present in a DVDB and DDB file</p>
<dl class="method">
<dt id="abipy.flowtk.works.GKKPWork.from_den_ddb_dvdb">
<em class="property">classmethod </em><code class="sig-name descname">from_den_ddb_dvdb</code><span class="sig-paren">(</span><em class="sig-param">inp</em>, <em class="sig-param">den_path</em>, <em class="sig-param">ddb_path</em>, <em class="sig-param">dvdb_path</em>, <em class="sig-param">mpiprocs=1</em>, <em class="sig-param">remove_wfkq=True</em>, <em class="sig-param">qpath=None</em>, <em class="sig-param">with_ddk=True</em>, <em class="sig-param">expand=True</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#GKKPWork.from_den_ddb_dvdb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.GKKPWork.from_den_ddb_dvdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>PhononWfkqWork</cite> from a DDB and DVDB file.
For each q found, a WFQ task and an EPH task computing the matrix elements are created.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.GKKPWork.from_phononwfkq_work">
<em class="property">classmethod </em><code class="sig-name descname">from_phononwfkq_work</code><span class="sig-paren">(</span><em class="sig-param">phononwfkq_work</em>, <em class="sig-param">nscf_vars={}</em>, <em class="sig-param">remove_wfkq=True</em>, <em class="sig-param">with_ddk=True</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#GKKPWork.from_phononwfkq_work"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.GKKPWork.from_phononwfkq_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>GKKPWork</cite> from a <cite>PhononWfkqWork</cite> object.
The WFQ are the ones used for PhononWfkqWork so in principle have only valence bands</p>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.GKKPWork.on_ok">
<code class="sig-name descname">on_ok</code><span class="sig-paren">(</span><em class="sig-param">sender</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#GKKPWork.on_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.GKKPWork.on_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is called when one task reaches status <cite>S_OK</cite>.
It removes the WFKQ file if all its children have reached <cite>S_OK</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.BecWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">BecWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BecWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BecWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>Work for the computation of the Born effective charges.</p>
<p>This work consists of DDK tasks and phonon + electric field perturbation
It provides the callback method (on_all_ok) that calls mrgddb to merge the
partial DDB files produced by the work.</p>
<dl class="method">
<dt id="abipy.flowtk.works.BecWork.from_scf_task">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_task</code><span class="sig-paren">(</span><em class="sig-param">scf_task</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">ph_tolerance=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BecWork.from_scf_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BecWork.from_scf_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Build tasks for the computation of Born effective charges from a ground-state task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_task</strong> – ScfTask object.</p></li>
<li><p><strong>ddk_tolerance</strong> – tolerance used in the DDK run if with_becs. None to use AbiPy default.</p></li>
<li><p><strong>ph_tolerance</strong> – dict {“varname”: value} with the tolerance used in the phonon run.
None to use AbiPy default.</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.BecWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#BecWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.BecWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all tasks reach S_OK
Ir runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.works.DteWork">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.works.</code><code class="sig-name descname">DteWork</code><span class="sig-paren">(</span><em class="sig-param">workdir=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#DteWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.DteWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.MergeDdb</span></code></p>
<p>Work for the computation of the third derivative of the energy.</p>
<p>This work consists of DDK tasks and electric field perturbation.
It provides the callback method (on_all_ok) that calls mrgddb to merge the partial DDB files produced</p>
<dl class="method">
<dt id="abipy.flowtk.works.DteWork.from_scf_task">
<em class="property">classmethod </em><code class="sig-name descname">from_scf_task</code><span class="sig-paren">(</span><em class="sig-param">scf_task</em>, <em class="sig-param">ddk_tolerance=None</em>, <em class="sig-param">manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#DteWork.from_scf_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.DteWork.from_scf_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a DteWork from a ground-state task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf_task</strong> – ScfTask object.</p></li>
<li><p><strong>ddk_tolerance</strong> – tolerance used in the DDK run if with_becs. None to use AbiPy default.</p></li>
<li><p><strong>manager</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TaskManager</span></code> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.flowtk.works.DteWork.on_all_ok">
<code class="sig-name descname">on_all_ok</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/works.html#DteWork.on_all_ok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.works.DteWork.on_all_ok" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when all tasks reach S_OK
Ir runs <cite>mrgddb</cite> in sequential on the local machine to produce
the final DDB file in the outdir of the <cite>Work</cite>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.flowtk.wrappers">
<span id="wrappers-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">wrappers</span></code> Module</a><a class="headerlink" href="#module-abipy.flowtk.wrappers" title="Permalink to this headline">¶</a></h2>
<p>Wrappers for ABINIT main executables</p>
<dl class="class">
<dt id="abipy.flowtk.wrappers.Mrgscr">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.wrappers.</code><code class="sig-name descname">Mrgscr</code><span class="sig-paren">(</span><em class="sig-param">manager=None</em>, <em class="sig-param">executable=None</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgscr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgscr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.wrappers.ExecWrapper</span></code></p>
<dl class="method">
<dt id="abipy.flowtk.wrappers.Mrgscr.merge_qpoints">
<code class="sig-name descname">merge_qpoints</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">files_to_merge</em>, <em class="sig-param">out_prefix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgscr.merge_qpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgscr.merge_qpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute mrgscr inside directory <cite>workdir</cite> to merge <cite>files_to_merge</cite>.
Produce new file with prefix <cite>out_prefix</cite></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.wrappers.Mrgddb">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.wrappers.</code><code class="sig-name descname">Mrgddb</code><span class="sig-paren">(</span><em class="sig-param">manager=None</em>, <em class="sig-param">executable=None</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgddb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgddb" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.wrappers.ExecWrapper</span></code></p>
<dl class="method">
<dt id="abipy.flowtk.wrappers.Mrgddb.merge">
<code class="sig-name descname">merge</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">ddb_files</em>, <em class="sig-param">out_ddb</em>, <em class="sig-param">description</em>, <em class="sig-param">delete_source_ddbs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgddb.merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgddb.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge DDB file, return the absolute path of the new database in workdir.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.flowtk.wrappers.Mrgdvdb">
<em class="property">class </em><code class="sig-prename descclassname">abipy.flowtk.wrappers.</code><code class="sig-name descname">Mrgdvdb</code><span class="sig-paren">(</span><em class="sig-param">manager=None</em>, <em class="sig-param">executable=None</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgdvdb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgdvdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.wrappers.ExecWrapper</span></code></p>
<dl class="method">
<dt id="abipy.flowtk.wrappers.Mrgdvdb.merge">
<code class="sig-name descname">merge</code><span class="sig-paren">(</span><em class="sig-param">workdir</em>, <em class="sig-param">pot_files</em>, <em class="sig-param">out_dvdb</em>, <em class="sig-param">delete_source=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/flowtk/wrappers.html#Mrgdvdb.merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.flowtk.wrappers.Mrgdvdb.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge POT files containing 1st order DFPT potential
return the absolute path of the new database in workdir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>delete_source</strong> – True if POT1 files should be removed after (successful) merge.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, M. Giantomassi and the AbiPy group.<br/>
      Last updated on Oct 18, 2019.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>