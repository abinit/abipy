<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>core Package &#8212; abipy 0.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="data Package" href="data_api.html" />
    <link rel="prev" title="abio Package" href="abio_api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          abipy</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What’s new in abipy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/index.html">Developers’ Guide</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">core Package</a><ul>
<li><a class="reference internal" href="#id1"><code class="docutils literal"><span class="pre">core</span></code> Package</a></li>
<li><a class="reference internal" href="#module-abipy.core.abinit_units"><code class="docutils literal"><span class="pre">abinit_units</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.fields"><code class="docutils literal"><span class="pre">fields</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.func1d"><code class="docutils literal"><span class="pre">func1d</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.gsphere"><code class="docutils literal"><span class="pre">gsphere</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.irrepsdb"><code class="docutils literal"><span class="pre">irrepsdb</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.kpoints"><code class="docutils literal"><span class="pre">kpoints</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.mesh3d"><code class="docutils literal"><span class="pre">mesh3d</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.mixins"><code class="docutils literal"><span class="pre">mixins</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.restapi"><code class="docutils literal"><span class="pre">restapi</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.skw"><code class="docutils literal"><span class="pre">skw</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.structure"><code class="docutils literal"><span class="pre">structure</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.symmetries"><code class="docutils literal"><span class="pre">symmetries</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.tensor"><code class="docutils literal"><span class="pre">tensor</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.testing"><code class="docutils literal"><span class="pre">testing</span></code> Module</a></li>
<li><a class="reference internal" href="#module-abipy.core.wyckoff"><code class="docutils literal"><span class="pre">wyckoff</span></code> Module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="abio_api.html" title="Previous Chapter: abio Package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; abio Package</span>
    </a>
  </li>
  <li>
    <a href="data_api.html" title="Next Chapter: data Package"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">data Package &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/api/core_api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="core-package">
<h1>core Package<a class="headerlink" href="#core-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><code class="xref py py-mod docutils literal"><span class="pre">core</span></code> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.core"></span><p>Core objects.</p>
</div>
<div class="section" id="module-abipy.core.abinit_units">
<span id="abinit-units-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">abinit_units</span></code> Module<a class="headerlink" href="#module-abipy.core.abinit_units" title="Permalink to this headline">¶</a></h2>
<p>This module defines constants and conversion factors matching those present in abinit that can be used when
it is important to preserve consistency with the results produced by abinit.</p>
</div>
<div class="section" id="module-abipy.core.fields">
<span id="fields-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">fields</span></code> Module<a class="headerlink" href="#module-abipy.core.fields" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class describing densities in real space on uniform 3D meshes.</p>
<dl class="class">
<dt id="abipy.core.fields.Density">
<em class="property">class </em><code class="descclassname">abipy.core.fields.</code><code class="descname">Density</code><span class="sig-paren">(</span><em>nspinor</em>, <em>nsppol</em>, <em>nspden</em>, <em>datar</em>, <em>structure</em>, <em>iorder='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.fields._DensityField</span></code></p>
<p>Electronic density.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike in Abinit, datar[nspden] contains the up/down components if nsppol = 2</p>
</div>
<dl class="classmethod">
<dt id="abipy.core.fields.Density.ae_core_density_on_mesh">
<em class="property">classmethod </em><code class="descname">ae_core_density_on_mesh</code><span class="sig-paren">(</span><em>valence_density</em>, <em>structure</em>, <em>rhoc_files</em>, <em>maxr=2.0</em>, <em>nelec=None</em>, <em>method='mesh3d_dist_gridpoints'</em>, <em>small_dist_mesh=(8</em>, <em>8</em>, <em>8)</em>, <em>small_dist_factor=1.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.ae_core_density_on_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.ae_core_density_on_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the all electron core density of the structure from the pseudopotentials <em>rhoc</em> files
Note that these <em>rhoc</em> files contain one column with the radii in Bohrs and one column with the density
in #/Bohr^3 multiplied by a factor 4pi.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.fields.Density.export_to_cube">
<code class="descname">export_to_cube</code><span class="sig-paren">(</span><em>filename</em>, <em>spin='total'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.export_to_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.export_to_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Export real space density to CUBE file <cite>filename</cite>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.fields.Density.from_chgcar_poscar">
<em class="property">classmethod </em><code class="descname">from_chgcar_poscar</code><span class="sig-paren">(</span><em>chgcar</em>, <em>poscar</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.from_chgcar_poscar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.from_chgcar_poscar" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <cite>Density</cite> object from Vasp data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>chgcar</strong> – Either string with the name of a CHGCAR file or <code class="xref py py-class docutils literal"><span class="pre">Chgcar</span></code> pymatgen object.</li>
<li><strong>poscar</strong> – Either string with the name of a POSCAR file or <code class="xref py py-class docutils literal"><span class="pre">Poscar</span></code> pymatgen object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.fields.Density.from_cube">
<em class="property">classmethod </em><code class="descname">from_cube</code><span class="sig-paren">(</span><em>filename</em>, <em>spin='total'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.from_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.from_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Read real space density to CUBE file <cite>filename</cite>. Return new <cite>Density</cite> instance.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.fields.Density.get_nelect">
<code class="descname">get_nelect</code><span class="sig-paren">(</span><em>spin=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.get_nelect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.get_nelect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of electrons with given spin.</p>
<p>If spin is None, the total number of electrons is computed.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.latex_label">
<code class="descname">latex_label</code><em class="property"> = 'Density [$e/A^3$]'</em><a class="headerlink" href="#abipy.core.fields.Density.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.magnetization">
<code class="descname">magnetization</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.magnetization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.magnetization" title="Permalink to this definition">¶</a></dt>
<dd><p>Magnetization field integrated over the unit cell.
Scalar if collinear, vector with mx, my, mz components if non-collinear.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.magnetization_field">
<code class="descname">magnetization_field</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.magnetization_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.magnetization_field" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy array with the magnetization field in real space on the FFT mesh</em> –</p>
<ol class="arabic simple">
<li>0 if spin-unpolarized calculation</li>
<li>spin_up - spin_down if collinear spin-polarized</li>
<li>numpy array with (mx, my, mz) components if non-collinear magnetism</li>
</ol>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.nelect_updown">
<code class="descname">nelect_updown</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.nelect_updown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.nelect_updown" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with the number of electrons in the up/down channel.
Return (None, None) if non-collinear.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'density'</em><a class="headerlink" href="#abipy.core.fields.Density.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.fields.Density.to_chgcar">
<code class="descname">to_chgcar</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.to_chgcar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.to_chgcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a <cite>Density</cite> object into a <cite>Chgar</cite> object.
If <cite>filename</cite> is not None, density is written to this file in <cite>Chgar</cite> format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">Chgcar</span></code> instance.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>From: <a class="reference external" href="http://cms.mpi.univie.ac.at/vasp/vasp/CHGCAR_file.html">http://cms.mpi.univie.ac.at/vasp/vasp/CHGCAR_file.html</a>:</p>
<p class="last">This file contains the total charge density multiplied by the volume
For spinpolarized calculations, two sets of data can be found in the CHGCAR file.
The first set contains the total charge density (spin up plus spin down),
the second one the magnetization density (spin up minus spin down).
For non collinear calculations the CHGCAR file contains the total charge density
and the magnetisation density in the x, y and z direction in this order.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.total_rhog">
<code class="descname">total_rhog</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhog" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array with the total density in G-space.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.total_rhor">
<code class="descname">total_rhor</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhor" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array with the total density in real space on the FFT mesh</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.fields.Density.total_rhor_as_density">
<code class="descname">total_rhor_as_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhor_as_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhor_as_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <cite>Density</cite> object with the total density.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.Density.zeta">
<code class="descname">zeta</code><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.zeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.Density.zeta" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array with Magnetization(r) / total_density(r)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.fields.VxcPotential">
<em class="property">class </em><code class="descclassname">abipy.core.fields.</code><code class="descname">VxcPotential</code><span class="sig-paren">(</span><em>nspinor</em>, <em>nsppol</em>, <em>nspden</em>, <em>datar</em>, <em>structure</em>, <em>iorder='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VxcPotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.VxcPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>XC Potential.</p>
<dl class="attribute">
<dt id="abipy.core.fields.VxcPotential.latex_label">
<code class="descname">latex_label</code><em class="property"> = 'vxc $[eV/A^3]$'</em><a class="headerlink" href="#abipy.core.fields.VxcPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.VxcPotential.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'exchange_correlation_potential'</em><a class="headerlink" href="#abipy.core.fields.VxcPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.fields.VhartreePotential">
<em class="property">class </em><code class="descclassname">abipy.core.fields.</code><code class="descname">VhartreePotential</code><span class="sig-paren">(</span><em>nspinor</em>, <em>nsppol</em>, <em>nspden</em>, <em>datar</em>, <em>structure</em>, <em>iorder='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VhartreePotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.VhartreePotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree Potential.</p>
<dl class="attribute">
<dt id="abipy.core.fields.VhartreePotential.latex_label">
<code class="descname">latex_label</code><em class="property"> = 'vh $[eV/A^3]$'</em><a class="headerlink" href="#abipy.core.fields.VhartreePotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.VhartreePotential.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'vhartree'</em><a class="headerlink" href="#abipy.core.fields.VhartreePotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.fields.VhxcPotential">
<em class="property">class </em><code class="descclassname">abipy.core.fields.</code><code class="descname">VhxcPotential</code><span class="sig-paren">(</span><em>nspinor</em>, <em>nsppol</em>, <em>nspden</em>, <em>datar</em>, <em>structure</em>, <em>iorder='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VhxcPotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.VhxcPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree + XC</p>
<dl class="attribute">
<dt id="abipy.core.fields.VhxcPotential.latex_label">
<code class="descname">latex_label</code><em class="property"> = 'vhxc $[eV/A^3]$'</em><a class="headerlink" href="#abipy.core.fields.VhxcPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.VhxcPotential.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'vhxc'</em><a class="headerlink" href="#abipy.core.fields.VhxcPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.fields.VksPotential">
<em class="property">class </em><code class="descclassname">abipy.core.fields.</code><code class="descname">VksPotential</code><span class="sig-paren">(</span><em>nspinor</em>, <em>nsppol</em>, <em>nspden</em>, <em>datar</em>, <em>structure</em>, <em>iorder='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VksPotential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.fields.VksPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree + XC + sum of local pseudo-potential terms.</p>
<dl class="attribute">
<dt id="abipy.core.fields.VksPotential.latex_label">
<code class="descname">latex_label</code><em class="property"> = 'vks $[eV/A^3]$'</em><a class="headerlink" href="#abipy.core.fields.VksPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.fields.VksPotential.netcdf_name">
<code class="descname">netcdf_name</code><em class="property"> = 'vtrial'</em><a class="headerlink" href="#abipy.core.fields.VksPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.func1d">
<span id="func1d-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">func1d</span></code> Module<a class="headerlink" href="#module-abipy.core.func1d" title="Permalink to this headline">¶</a></h2>
<p>Function1D describes a function of a single variable and provides an easy-to-use API
for performing common tasks such as algebraic operations, integrations, differentiations, plots …</p>
<dl class="class">
<dt id="abipy.core.func1d.Function1D">
<em class="property">class </em><code class="descclassname">abipy.core.func1d.</code><code class="descname">Function1D</code><span class="sig-paren">(</span><em>mesh</em>, <em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Immutable object representing a (real|complex) function of real variable.</p>
<dl class="method">
<dt id="abipy.core.func1d.Function1D.abs">
<code class="descname">abs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute value.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.bma">
<code class="descname">bma</code><a class="headerlink" href="#abipy.core.func1d.Function1D.bma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return b-a. f(x) is defined in [a,b]</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.conjugate">
<code class="descname">conjugate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.conjugate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> with the complex conjugate.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.dx">
<code class="descname">dx</code><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.dx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.dx" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray of len(self)-1 elements giving the distance between two
consecutive points of the mesh, i.e. dx[i] = ||x[i+1] - x[i]||.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.fft">
<code class="descname">fft</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FFT transform (negative sign).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.find_mesh_index">
<code class="descname">find_mesh_index</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.find_mesh_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.find_mesh_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the first point in the mesh whose value is &gt;= value
-1 if not found</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.finite_diff">
<code class="descname">finite_diff</code><span class="sig-paren">(</span><em>order=1</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.finite_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivatives by finite differences.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> – Order of the derivative.</li>
<li><strong>acc</strong> – Accuracy. 4 is fine in many cases.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> instance with the derivative.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.func1d.Function1D.from_constant">
<em class="property">classmethod </em><code class="descname">from_constant</code><span class="sig-paren">(</span><em>mesh</em>, <em>const</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a constant function from the mesh and the scalart <cite>const</cite></p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.func1d.Function1D.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>path</em>, <em>comments='#'</em>, <em>delimiter=None</em>, <em>usecols=(0</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance by reading data from path (txt format)
see also <code class="xref py py-func docutils literal"><span class="pre">np.loadtxt()</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> – Path to the file containing data.</li>
<li><strong>comments</strong> – The character used to indicate the start of a comment; default: ‘#’.</li>
<li><strong>delimiter</strong> – str, optional The string used to separate values. By default, this is any whitespace.</li>
<li><strong>usecols</strong> – sequence, optional. Which columns to read, with 0 being the first.
For example, usecols = (1,4) will extract data from the 2nd, and 5th columns.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.func1d.Function1D.from_func">
<em class="property">classmethod </em><code class="descname">from_func</code><span class="sig-paren">(</span><em>func</em>, <em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a callable.</p>
<p class="rubric">example</p>
<p>Function1D.from_func(np.sin, mesh=np.arange(1,10))</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.h">
<code class="descname">h</code><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.h"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.h" title="Permalink to this definition">¶</a></dt>
<dd><p>The spacing of the mesh. None if mesh is not homogeneous.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.has_same_mesh">
<code class="descname">has_same_mesh</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.has_same_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.has_same_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self and other have the same mesh.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.ifft">
<code class="descname">ifft</code><span class="sig-paren">(</span><em>x0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.ifft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FFT transform <img src="../_images/mathmpl/math-0454b1db51.png" style="position: relative; bottom: -19px"/></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.imag">
<code class="descname">imag</code><a class="headerlink" href="#abipy.core.func1d.Function1D.imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> with the imaginary part of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.imag_from_kk">
<code class="descname">imag_from_kk</code><span class="sig-paren">(</span><em>with_div=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.imag_from_kk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.imag_from_kk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Kramers-Kronig transform of the real part
to get the imaginary part. Assume self represents the Fourier
transform of a response function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_div</strong> – True if the divergence should be treated numerically.
If False, the divergence is ignored, results are less accurate
but the calculation is faster.</td>
</tr>
</tbody>
</table>
<p>See: <a class="reference external" href="https://en.wikipedia.org/wiki/Kramers%E2%80%93Kronig_relations">https://en.wikipedia.org/wiki/Kramers%E2%80%93Kronig_relations</a></p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.integral">
<code class="descname">integral</code><span class="sig-paren">(</span><em>start=0</em>, <em>stop=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Cumulatively integrate y(x) from start to stop using the composite trapezoidal rule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> with <img src="../_images/mathmpl/math-4b91eeff10.png" style="position: relative; bottom: -19px"/></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.iscomplexobj">
<code class="descname">iscomplexobj</code><a class="headerlink" href="#abipy.core.func1d.Function1D.iscomplexobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if values is array of complex numbers.
The type of the input is checked, not the value. Even if the input
has an imaginary part equal to zero, <cite>iscomplexobj</cite> evaluates to True.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.l1_norm">
<code class="descname">l1_norm</code><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.l1_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.l1_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <img src="../_images/mathmpl/math-42938bc039.png" style="position: relative; bottom: -19px"/>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.l2_norm">
<code class="descname">l2_norm</code><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.l2_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.l2_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <img src="../_images/mathmpl/math-f524c34c91.png" style="position: relative; bottom: -19px"/>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.max">
<code class="descname">max</code><a class="headerlink" href="#abipy.core.func1d.Function1D.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Max of f(x) if f is real, max of <img src="../_images/mathmpl/math-9a556b94a9.png" style="position: relative; bottom: -8px"/> if complex.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.mesh">
<code class="descname">mesh</code><a class="headerlink" href="#abipy.core.func1d.Function1D.mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Array with the mesh points</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.min">
<code class="descname">min</code><a class="headerlink" href="#abipy.core.func1d.Function1D.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Min of f(x) if f is real, min of <img src="../_images/mathmpl/math-9a556b94a9.png" style="position: relative; bottom: -8px"/> if complex.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.plot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot the function.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
</dl>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>exchange_xy</td>
<td>True to exchange x- and y-axis (default: False)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns:</dt>
<dd><cite>matplotlib</cite> figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.plot_ax">
<code class="descname">plot_ax</code><span class="sig-paren">(</span><em>ax</em>, <em>exchange_xy=False</em>, <em>xfactor=1</em>, <em>yfactor=1</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.plot_ax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot self on axis ax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> – <cite>matplotlib</cite> axis.</li>
<li><strong>exchange_xy</strong> – True to exchange the axis in the plot</li>
<li><strong>args</strong> – Positional arguments passed to ax.plot</li>
<li><strong>kwargs</strong> – Keyword arguments passed to <cite>matplotlib</cite>.  Accepts also:</li>
<li><strong>yfactor</strong> (<em>xfactor</em><em>,</em>) – xvalues and yvalues are multiplied by this factor before plotting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cplx_mode</td>
<td>string defining the data to print.
Possible choices are (case-insensitive): <cite>re</cite> for the real part
“im” for the imaginary part, “abs” for the absolute value.
“angle” to display the phase of the complex number in radians.
Options can be concatenated with “-“</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of lines added.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.real">
<code class="descname">real</code><a class="headerlink" href="#abipy.core.func1d.Function1D.real" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> with the real part of self.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.real_from_kk">
<code class="descname">real_from_kk</code><span class="sig-paren">(</span><em>with_div=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.real_from_kk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.real_from_kk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Kramers-Kronig transform of the imaginary part
to get the real part. Assume self represents the Fourier
transform of a response function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_div</strong> – True if the divergence should be treated numerically.
If False, the divergence is ignored, results are less accurate
but the calculation is faster.</td>
</tr>
</tbody>
</table>
<p>See: <a class="reference external" href="https://en.wikipedia.org/wiki/Kramers%E2%80%93Kronig_relations">https://en.wikipedia.org/wiki/Kramers%E2%80%93Kronig_relations</a></p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.spline">
<code class="descname">spline</code><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Cubic spline with s=0</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.spline_derivatives">
<code class="descname">spline_derivatives</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all derivatives of the spline at point x.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.spline_integral">
<code class="descname">spline_integral</code><span class="sig-paren">(</span><em>a=None</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the definite integral of the spline of f between two given points a and b</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – First point. mesh[0] if a is None</li>
<li><strong>b</strong> – Last point. mesh[-1] if a is None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.spline_on_mesh">
<code class="descname">spline_on_mesh</code><span class="sig-paren">(</span><em>mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_on_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_on_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Spline the function on the given mesh, returns <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal"><span class="pre">Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.spline_roots">
<code class="descname">spline_roots</code><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeros of the spline.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.func1d.Function1D.to_file">
<code class="descname">to_file</code><span class="sig-paren">(</span><em>path</em>, <em>fmt='%.18e'</em>, <em>header=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data in a text file. Use format fmr. A header is added at the beggining.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.func1d.Function1D.values">
<code class="descname">values</code><a class="headerlink" href="#abipy.core.func1d.Function1D.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the functions.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.gsphere">
<span id="gsphere-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">gsphere</span></code> Module<a class="headerlink" href="#module-abipy.core.gsphere" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class defining the G-sphere for wavefunctions, densities and potentials</p>
<dl class="class">
<dt id="abipy.core.gsphere.GSphere">
<em class="property">class </em><code class="descclassname">abipy.core.gsphere.</code><code class="descname">GSphere</code><span class="sig-paren">(</span><em>ecut</em>, <em>lattice</em>, <em>kpoint</em>, <em>gvecs</em>, <em>istwfk=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">collections.abc.Sequence</span></code></p>
<p>Descriptor-class for the G-sphere.</p>
<dl class="method">
<dt id="abipy.core.gsphere.GSphere.cempty">
<code class="descname">cempty</code><span class="sig-paren">(</span><em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.cempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.cempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns New uninitialized 1D complex array.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.count">
<code class="descname">count</code><span class="sig-paren">(</span><em>gvec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of occurrences of gvec.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.czeros">
<code class="descname">czeros</code><span class="sig-paren">(</span><em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.czeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.czeros" title="Permalink to this definition">¶</a></dt>
<dd><p>New zeroed 1D complex array.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.empty">
<code class="descname">empty</code><span class="sig-paren">(</span><em>dtype=&lt;class 'float'&gt;</em>, <em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.empty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 1D array.</p>
<p>The type can be set with the <code class="docutils literal"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.fromfftmesh">
<code class="descname">fromfftmesh</code><span class="sig-paren">(</span><em>mesh</em>, <em>arr_on_mesh</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.fromfftmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.fromfftmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer arr_on_mesh given on the FFT mesh to the G-sphere.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.gsphere.GSphere.gvecs">
<code class="descname">gvecs</code><a class="headerlink" href="#abipy.core.gsphere.GSphere.gvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>ndarray with the G-vectors in reduced coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>gvec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.index" title="Permalink to this definition">¶</a></dt>
<dd><p>return the index of the G-vector gvec in self.
Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.tofftmesh">
<code class="descname">tofftmesh</code><span class="sig-paren">(</span><em>mesh</em>, <em>arr_on_sphere</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.tofftmesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.tofftmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the array arr_on_sphere given on the sphere inside the FFT mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh</strong> – </li>
<li><strong>arr_on_sphere</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.tostring">
<code class="descname">tostring</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.gsphere.GSphere.tostring" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.gsphere.GSphere.zeros">
<code class="descname">zeros</code><span class="sig-paren">(</span><em>dtype=&lt;class 'float'&gt;</em>, <em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 1D array.</p>
<p>The type can be set with the <code class="docutils literal"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.irrepsdb">
<span id="irrepsdb-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">irrepsdb</span></code> Module<a class="headerlink" href="#module-abipy.core.irrepsdb" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.core.kpoints">
<span id="kpoints-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">kpoints</span></code> Module<a class="headerlink" href="#module-abipy.core.kpoints" title="Permalink to this headline">¶</a></h2>
<p>This module defines objects describing the sampling of the Brillouin Zone.</p>
<dl class="function">
<dt id="abipy.core.kpoints.issamek">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">issamek</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em>, <em>atol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#issamek"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.issamek" title="Permalink to this definition">¶</a></dt>
<dd><p>True if k1 and k2 are equal modulo a lattice vector.
Use _ATOL_KDIFF is atol is None.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">issamek</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">issamek</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">issamek</span><span class="p">(</span><span class="mf">0.00003</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.wrap_to_ws">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">wrap_to_ws</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#wrap_to_ws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.wrap_to_ws" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms x in its corresponding reduced number in the interval ]-1/2,1/2].</p>
</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.wrap_to_bz">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">wrap_to_bz</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#wrap_to_bz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.wrap_to_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms x in its corresponding reduced number in the interval [0,1[.”</p>
</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.as_kpoints">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">as_kpoints</code><span class="sig-paren">(</span><em>obj</em>, <em>lattice</em>, <em>weights=None</em>, <em>names=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#as_kpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.as_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a list of k-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code></a> or list of Kpoint objects or array-like object.</li>
<li><strong>lattice</strong> – Reciprocal lattice.</li>
<li><strong>weights</strong> – k-point weights. Ignored if obj is already a <cite>Kpoint</cite> instance or a list
of <cite>Kpoint</cite> items.</li>
<li><strong>name</strong> – string with the name of the k-point. Ignored if obj is already a <cite>Kpoint</cite>
instance or a list of <cite>Kpoint</cite> items.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="abipy.core.kpoints.Kpoint">
<em class="property">class </em><code class="descclassname">abipy.core.kpoints.</code><code class="descname">Kpoint</code><span class="sig-paren">(</span><em>frac_coords</em>, <em>lattice</em>, <em>weight=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.util.serialization.html#pymatgen.util.serialization.SlotPickleMixin" title="(in pymatgen v2017.11.6)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.util.serialization.SlotPickleMixin</span></code></a></p>
<p>Class defining one k-point.</p>
<dl class="classmethod">
<dt id="abipy.core.kpoints.Kpoint.as_kpoint">
<em class="property">classmethod </em><code class="descname">as_kpoint</code><span class="sig-paren">(</span><em>obj</em>, <em>lattice</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.as_kpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.as_kpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a Kpoint instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code></a> instance or array-like with the reduced coordinates.</li>
<li><strong>lattice</strong> – <code class="xref py py-class docutils literal"><span class="pre">Lattice</span></code> object defining the reciprocal lattice.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.cart_coords">
<code class="descname">cart_coords</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.cart_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of the k-point.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.compute_star">
<code class="descname">compute_star</code><span class="sig-paren">(</span><em>symmops</em>, <em>wrap_tows=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.compute_star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.compute_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the star of the kpoint (tuple of <cite>Kpoint</cite> objects).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.frac_coords">
<code class="descname">frac_coords</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.frac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Fractional coordinates of the k-points.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.kpoints.Kpoint.gamma">
<em class="property">classmethod </em><code class="descname">gamma</code><span class="sig-paren">(</span><em>lattice</em>, <em>weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.gamma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for the Gamma point.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.lattice">
<code class="descname">lattice</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.name">
<code class="descname">name</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the k-point. None if not available.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.norm">
<code class="descname">norm</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm of the kpoint.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.on_border">
<code class="descname">on_border</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.on_border" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the k-point is on the border of the BZ  (lattice translations are taken into account).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.set_name">
<code class="descname">set_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.set_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the k-point.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.set_weight">
<code class="descname">set_weight</code><span class="sig-paren">(</span><em>weight</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.set_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.set_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the weight of the k-point.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.versor">
<code class="descname">versor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.versor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.versor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the versor i.e. ||k|| = 1</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpoint.weight">
<code class="descname">weight</code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight of the k-point. 0.0 if the weight is not defined.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.wrap_to_bz">
<code class="descname">wrap_to_bz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.wrap_to_bz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.wrap_to_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new <cite>Kpoint</cite> in the first unit cell.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpoint.wrap_to_ws">
<code class="descname">wrap_to_ws</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.wrap_to_ws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.wrap_to_ws" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new <cite>Kpoint</cite> in the Wigner-Seitz zone.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.kpoints.Kpath">
<em class="property">class </em><code class="descclassname">abipy.core.kpoints.</code><code class="descname">Kpath</code><span class="sig-paren">(</span><em>reciprocal_lattice</em>, <em>frac_coords</em>, <em>weights=None</em>, <em>names=None</em>, <em>ksampling=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.KpointList</span></code></p>
<p>This object describes a k-path in reciprocal space.
It provides methods to compute (line) derivatives along the path.
The k-points do not have weights so Kpath should not be used to compute integral in the BZ.</p>
<dl class="attribute">
<dt id="abipy.core.kpoints.Kpath.ds">
<code class="descname">ds</code><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.ds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.ds" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array of len(self)-1 elements giving the distance between two
consecutive k-points, i.e. ds[i] = ||k[i+1] - k[i]|| for i=0,1,…,n-1</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpath.finite_diff">
<code class="descname">finite_diff</code><span class="sig-paren">(</span><em>values</em>, <em>order=1</em>, <em>acc=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.finite_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivatives of values by finite differences.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>values</strong> – array-like object with shape=(nkpt) containing the values of the path.</li>
<li><strong>order</strong> – Order of the derivative.</li>
<li><strong>acc</strong> – Accuracy: 4 corresponds to a central difference with 5 points.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ragged numpy array. The i-th entry is a numpy array with the derivatives
on the i-th line.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.kpoints.Kpath.from_vertices_and_names">
<em class="property">classmethod </em><code class="descname">from_vertices_and_names</code><span class="sig-paren">(</span><em>structure</em>, <em>vertices_names</em>, <em>line_density=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.from_vertices_and_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.from_vertices_and_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate K-path from a list of vertices and the corresponding labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> – Structure object.</li>
<li><strong>vertices_names</strong> – List of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path.</li>
<li><strong>line_density</strong> – Number of points used to sample the smallest segment of the path</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpath.lines">
<code class="descname">lines</code><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Nested list containing the indices of the points belonging to the same line.
Used for extracting the eigenvalues while looping over the lines.</p>
<p class="rubric">Example</p>
<dl class="docutils">
<dt>for line in self.lines:</dt>
<dd>vals_on_line = eigens[spin, line, band]</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Kpath.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em>, <em>title=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> – Verbosity level. Default: 0</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Kpath.versors">
<code class="descname">versors</code><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.versors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.versors" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of len(self)-1 elements with the versors connecting k[i] to k[i+1].</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.kpoints.IrredZone">
<em class="property">class </em><code class="descclassname">abipy.core.kpoints.</code><code class="descname">IrredZone</code><span class="sig-paren">(</span><em>reciprocal_lattice</em>, <em>frac_coords</em>, <em>weights=None</em>, <em>names=None</em>, <em>ksampling=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.kpoints.KpointList</span></code></p>
<p>An <a class="reference internal" href="#abipy.core.kpoints.IrredZone" title="abipy.core.kpoints.IrredZone"><code class="xref py py-class docutils literal"><span class="pre">IrredZone</span></code></a> is a (immutable) sequence of points in the irreducible wedge of the BZ.
Each point has a weight whose sum must equal 1 so that we can integrate quantities in the full Brillouin zone.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Abinit supports different options for the specification of the BZ sampling:</p>
<blockquote>
<div><ul class="simple">
<li>kptrlatt(3,3) or ngkpt(3) for the definition grid.</li>
<li>shiftk(3, nshiftk) for the definition of multiple shifts.</li>
<li><cite>kptopt</cite> for the treatment of symmetry operations.</li>
</ul>
</div></blockquote>
<p>All these possibilities complicate the internal implementation in particular when
we need to recostruct the full BZ and take into account the presence of multiple shifts
since kptrlatt may have non-zero off-diagonal components. Client code that needs to know
how the mesh was generated can rely on the following checks:</p>
<p>if not self.ibz: raise(“Need an IBZ sampling”)</p>
<p class="last">mpdivs, shifts = self.mpdivs_shifts
if mpdivs is None: raise ValueError(“Cannot handle kptrlatt with non-zero off-diagonal elements”)
if len(shifts) &gt; 1: raise ValueError(“Multiple shifts are not supported”)
# Code for mesh defined in terms of mpdivs and one shift.</p>
</div>
<dl class="method">
<dt id="abipy.core.kpoints.IrredZone.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>func=&lt;class 'str'&gt;</em>, <em>verbose=0</em>, <em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.rc_list">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">rc_list</code><span class="sig-paren">(</span><em>mp</em>, <em>sh</em>, <em>pbc=False</em>, <em>order='bz'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#rc_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.rc_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>ndarray</cite> with the linear mesh used to sample one dimension of the reciprocal space.
Note that the coordinates are always ordered so that rc[i+1] &gt; rc[i].
so that we can easily plot quantities defined on the 3D multidimensional mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mp</strong> – Number of Monkhorst-Pack divisions along this direction.</li>
<li><strong>sh</strong> – Shift</li>
<li><strong>pbc</strong> – if pbc is True, periodic boundary conditions are enforced.</li>
<li><strong>order</strong> – Possible values [“bz”, “unit_cell”].
if “bz”, the coordinates are forced to be in [-1/2, 1/2)
if “unit_cell”, the coordinates are forced to be in [0, 1).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.kmesh_from_mpdivs">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">kmesh_from_mpdivs</code><span class="sig-paren">(</span><em>mpdivs</em>, <em>shifts</em>, <em>pbc=False</em>, <em>order='bz'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#kmesh_from_mpdivs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.kmesh_from_mpdivs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>ndarray</cite> with the reduced coordinates of the
k-points from the MP divisions and the shifts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mpdivs</strong> – The three MP divisions.</li>
<li><strong>shifts</strong> – Array-like object with the MP shift.</li>
<li><strong>pbc</strong> – If True, periodic images of the k-points will be included i.e. closed mesh.</li>
<li><strong>order</strong> – “unit_cell” if the kpoint coordinates must be in [0,1)
“bz” if the kpoint coordinates must be in [-1/2, +1/2)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="abipy.core.kpoints.Ktables">
<em class="property">class </em><code class="descclassname">abipy.core.kpoints.</code><code class="descname">Ktables</code><span class="sig-paren">(</span><em>structure</em>, <em>mesh</em>, <em>is_shift</em>, <em>has_timrev</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Call spglib to compute the k-points in the IBZ with the corresponding weights
as well as the mapping BZ –&gt; IBZ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh</strong> – </li>
<li><strong>is_shift</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.mesh">
<code class="descname">mesh</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.is_shift">
<code class="descname">is_shift</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.is_shift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.ibz">
<code class="descname">ibz</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.ibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.nibz">
<code class="descname">nibz</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.nibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.weights">
<code class="descname">weights</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.bz">
<code class="descname">bz</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.bz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.nbz">
<code class="descname">nbz</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.nbz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.kpoints.Ktables.grid">
<code class="descname">grid</code><a class="headerlink" href="#abipy.core.kpoints.Ktables.grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Ktables.print_bz2ibz">
<code class="descname">print_bz2ibz</code><span class="sig-paren">(</span><em>file=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables.print_bz2ibz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables.print_bz2ibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Print BZ –&gt; IBZ mapping.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.kpoints.Ktables.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em>, <em>title=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.core.kpoints.find_points_along_path">
<code class="descclassname">abipy.core.kpoints.</code><code class="descname">find_points_along_path</code><span class="sig-paren">(</span><em>cart_bounds</em>, <em>cart_coords</em>, <em>dist_tol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#find_points_along_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.kpoints.find_points_along_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points in <cite>cart_coords</cite> lying on the path defined by <cite>cart_bounds</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cart_bounds</strong> – [N, 3] array with the boundaries of the path in Cartesian coordinates.</li>
<li><strong>cart_coords</strong> – [M, 3] array with the points in Cartesian coordinate</li>
<li><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>(klines, dist_list, ticks)</p>
<p>klines is a numpy array with the indices of the points lying on the path. Empty if no point is found.
dist_list: numpy array with the distance of the points along the line.
ticks:</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.mesh3d">
<span id="mesh3d-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">mesh3d</span></code> Module<a class="headerlink" href="#module-abipy.core.mesh3d" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class defining Uniform 3D meshes.</p>
<dl class="class">
<dt id="abipy.core.mesh3d.Mesh3D">
<em class="property">class </em><code class="descclassname">abipy.core.mesh3d.</code><code class="descname">Mesh3D</code><span class="sig-paren">(</span><em>shape</em>, <em>vectors</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Descriptor-class for uniform 3D meshes.</p>
<p>A Mesh3D object holds information on how functions, such
as wave functions and electron densities, are discretized in a
certain domain in space. The main information here is how many
grid points are used in each direction of the unit cell.</p>
<p>There are methods for tasks such as allocating arrays, performing
symmetry operations and integrating functions over space.</p>
<p>This is how a 2x2x2 3D array arr[x,y,z] is stored in memory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">-----</span><span class="mi">7</span>
<span class="o">|</span>\    <span class="o">|</span>
<span class="o">|</span> \   <span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span><span class="o">-----</span><span class="mi">5</span>      <span class="n">z</span>
<span class="mi">2</span><span class="o">--|--</span><span class="mi">6</span>  <span class="o">|</span>   <span class="n">y</span>  <span class="o">|</span>
 \ <span class="o">|</span>   \ <span class="o">|</span>    \ <span class="o">|</span>
  \<span class="o">|</span>    \<span class="o">|</span>     \<span class="o">|</span>
   <span class="mi">0</span><span class="o">-----</span><span class="mi">4</span>      <span class="o">+-----</span><span class="n">x</span>
</pre></div>
</div>
<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.cempty">
<code class="descname">cempty</code><span class="sig-paren">(</span><em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.cempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.cempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 3D complex array for this domain.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.crandom">
<code class="descname">crandom</code><span class="sig-paren">(</span><em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.crandom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.crandom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns random complex array for this domain with val in [0.0, 1.0).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.czeros">
<code class="descname">czeros</code><span class="sig-paren">(</span><em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.czeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.czeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 3D complex array for this domain.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.dist_gridpoints_in_spheres">
<code class="descname">dist_gridpoints_in_spheres</code><span class="sig-paren">(</span><em>points</em>, <em>radius</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.dist_gridpoints_in_spheres"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.dist_gridpoints_in_spheres" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.empty">
<code class="descname">empty</code><span class="sig-paren">(</span><em>dtype=&lt;class 'float'&gt;</em>, <em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.empty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 3D array for this domain.</p>
<p>The type can be set with the <cite>dtype</cite> keyword.
Extra dimensions can be added with <cite>extra_dims</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.fft_g2r">
<code class="descname">fft_g2r</code><span class="sig-paren">(</span><em>fg</em>, <em>fg_ishifted=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.fft_g2r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.fft_g2r" title="Permalink to this definition">¶</a></dt>
<dd><p>FFT of array fg given in G-space.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.fft_r2g">
<code class="descname">fft_r2g</code><span class="sig-paren">(</span><em>fr</em>, <em>shift_fg=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.fft_r2g"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.fft_r2g" title="Permalink to this definition">¶</a></dt>
<dd><p>FFT of array fr given in real space.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.gmods">
<code class="descname">gmods</code><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.gmods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.gmods" title="Permalink to this definition">¶</a></dt>
<dd><p>[ng] array with $|G|$</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.gvecs">
<code class="descname">gvecs</code><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.gvecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.gvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Array with the reduced coordinates of the G-vectors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These are the G-vectors of the FFT box and should be used
when we compute quantities on the FFT mesh.
These vectors differ from the gvecs stored in <cite>GSphere</cite> that
are k-centered and enclosed by a sphere whose radius is defined by ecut.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.i_closest_gridpoints">
<code class="descname">i_closest_gridpoints</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.i_closest_gridpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.i_closest_gridpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of points, this function return a numpy array with the indices of the closest gridpoint.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.integrate">
<code class="descname">integrate</code><span class="sig-paren">(</span><em>fr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.integrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate array(s) fr.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.inv_vectors">
<code class="descname">inv_vectors</code><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.inv_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.inv_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.iter_ixyz_r">
<code class="descname">iter_ixyz_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.iter_ixyz_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.iter_ixyz_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator returning (ixyz, rr) where ixyz gives the index of the point and r is the point on the grid.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.nx">
<code class="descname">nx</code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along x.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.ny">
<code class="descname">ny</code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.ny" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along y.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.nz">
<code class="descname">nz</code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.nz" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along z.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.random">
<code class="descname">random</code><span class="sig-paren">(</span><em>dtype=&lt;class 'float'&gt;</em>, <em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns random real array for this domain with val in [0.0, 1.0).</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.reshape">
<code class="descname">reshape</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.reshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshape the array arr defined on the FFT box.</p>
<p>Returns ndarray with 4 dimensions (?,nx,ny,nz) where ?*nx*ny*nz == arr.size</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.rpoint">
<code class="descname">rpoint</code><span class="sig-paren">(</span><em>ix</em>, <em>iy</em>, <em>iz</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.rpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.rpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector corresponding to the (ix, iy, iz) indices</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mesh3d.Mesh3D.rpoints">
<code class="descname">rpoints</code><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.rpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.rpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Array with the points in real space in reduced coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mesh3d.Mesh3D.zeros">
<code class="descname">zeros</code><span class="sig-paren">(</span><em>dtype=&lt;class 'float'&gt;</em>, <em>extra_dims=()</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 3D array for this domain.</p>
<p>The type can be set with the <cite>dtype</cite> keyword.
Extra dimensions can be added with <cite>extra_dims</cite>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.mixins">
<span id="mixins-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">mixins</span></code> Module<a class="headerlink" href="#module-abipy.core.mixins" title="Permalink to this headline">¶</a></h2>
<p>This module …</p>
<dl class="class">
<dt id="abipy.core.mixins.AbinitNcFile">
<em class="property">class </em><code class="descclassname">abipy.core.mixins.</code><code class="descname">AbinitNcFile</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins._File</span></code></p>
<p>Abstract class representing a Netcdf file with data saved
according to the ETSF-IO specifications (when available).
A AbinitNcFile has a netcdf reader to read data from file and build objects.</p>
<dl class="attribute">
<dt id="abipy.core.mixins.AbinitNcFile.abinit_version">
<code class="descname">abinit_version</code><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile.abinit_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.abinit_version" title="Permalink to this definition">¶</a></dt>
<dd><p><em>String with abinit version</em> – three digits separated by comma.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.AbinitNcFile.ncdump">
<code class="descname">ncdump</code><span class="sig-paren">(</span><em>*nc_args</em>, <em>**nc_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile.ncdump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.ncdump" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with the output of ncdump.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.mixins.Has_Structure">
<em class="property">class </em><code class="descclassname">abipy.core.mixins.</code><code class="descname">Has_Structure</code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">AbinitNcFile</span></code></a> containing crystallographic data.</p>
<dl class="method">
<dt id="abipy.core.mixins.Has_Structure.export_structure">
<code class="descname">export_structure</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.export_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.export_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the structure on file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Instance of <code class="xref py py-class docutils literal"><span class="pre">Visualizer</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_Structure.plot_bz">
<code class="descname">plot_bz</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.plot_bz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.plot_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the plot (as a matplotlib object) of the symmetry line path in the Brillouin Zone.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_Structure.show_bz">
<code class="descname">show_bz</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.mixins.Has_Structure.show_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the plot (as a matplotlib object) of the symmetry line path in the Brillouin Zone.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_Structure.structure">
<code class="descname">structure</code><a class="headerlink" href="#abipy.core.mixins.Has_Structure.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_Structure.visualize_structure_with">
<code class="descname">visualize_structure_with</code><span class="sig-paren">(</span><em>visu_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.visualize_structure_with"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.visualize_structure_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the crystalline structure with the specified visualizer.</p>
<p>See <code class="xref py py-class docutils literal"><span class="pre">Visualizer</span></code> for the list of applications and formats supported.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.mixins.Has_ElectronBands">
<em class="property">class </em><code class="descclassname">abipy.core.mixins.</code><code class="descname">Has_ElectronBands</code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">AbinitNcFile</span></code></a> containing electron data.</p>
<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.ebands">
<code class="descname">ebands</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-class docutils literal"><span class="pre">ElectronBands</span></code> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.kpoints">
<code class="descname">kpoints</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterable with the Kpoints.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.mband">
<code class="descname">mband</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.mband" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of bands.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nband">
<code class="descname">nband</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nband" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of bands.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nelect">
<code class="descname">nelect</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nelect" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of elecrons per unit cell</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nkpt">
<code class="descname">nkpt</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of k-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nspden">
<code class="descname">nspden</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nspden" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of indepedendent spin-density components.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nspinor">
<code class="descname">nspinor</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nspinor" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spinors</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.mixins.Has_ElectronBands.nsppol">
<code class="descname">nsppol</code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nsppol" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spin polarizations</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_ElectronBands.plot_ebands">
<code class="descname">plot_ebands</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.plot_ebands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.plot_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electron energy bands. See the <code class="xref py py-func docutils literal"><span class="pre">ElectronBands.plot()</span></code> for the signature.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_ElectronBands.plot_ebands_with_edos">
<code class="descname">plot_ebands_with_edos</code><span class="sig-paren">(</span><em>dos</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.plot_ebands_with_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.plot_ebands_with_edos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.mixins.Has_PhononBands">
<em class="property">class </em><code class="descclassname">abipy.core.mixins.</code><code class="descname">Has_PhononBands</code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal"><span class="pre">AbinitNcFile</span></code></a> containing phonon data.</p>
<dl class="attribute">
<dt id="abipy.core.mixins.Has_PhononBands.phbands">
<code class="descname">phbands</code><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-class docutils literal"><span class="pre">PhononBands</span></code> object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.Has_PhononBands.plot_phbands">
<code class="descname">plot_phbands</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands.plot_phbands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.plot_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electron energy bands. See the <code class="xref py py-func docutils literal"><span class="pre">PhononBands.plot()</span></code> for the signature.”“</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.mixins.NotebookWriter">
<em class="property">class </em><code class="descclassname">abipy.core.mixins.</code><code class="descname">NotebookWriter</code><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Mixin class for objects that are able to generate jupyter notebooks.
Subclasses must provide a concrete implementation of <cite>write_notebook</cite>.</p>
<dl class="method">
<dt id="abipy.core.mixins.NotebookWriter.get_nbformat_nbv">
<code class="descname">get_nbformat_nbv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.get_nbformat_nbv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.get_nbformat_nbv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return nbformat module, notebook version module</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.NotebookWriter.get_nbformat_nbv_nb">
<code class="descname">get_nbformat_nbv_nb</code><span class="sig-paren">(</span><em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.get_nbformat_nbv_nb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.get_nbformat_nbv_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>Return nbformat module, notebook version module
and new notebook with title and import section</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.NotebookWriter.make_and_open_notebook">
<code class="descname">make_and_open_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em>, <em>foreground=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.make_and_open_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.make_and_open_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an ipython notebook and open it in the browser.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nbpath</strong> – If nbpath is None, a temporay file is created.</li>
<li><strong>foreground</strong> – By default, jupyter is executed in background and stdout, stderr are redirected</li>
<li><strong>devnull. Use foreground to run the process in foreground</strong> (<a class="reference internal" href="#abipy.core.structure.Structure.to" title="abipy.core.structure.Structure.to"><em>to</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">system exit code.</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Raise:</dt>
<dd>RuntimeError if jupyter is not in $PATH</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.NotebookWriter.pickle_dump">
<code class="descname">pickle_dump</code><span class="sig-paren">(</span><em>filepath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the status of the object in pickle format.
If filepath is None, a temporary file is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">name of the pickle file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.mixins.NotebookWriter.pickle_load">
<em class="property">classmethod </em><code class="descname">pickle_load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.pickle_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.mixins.NotebookWriter.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file is created.
Return path to the notebook. A typical template is given below.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.restapi">
<span id="restapi-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">restapi</span></code> Module<a class="headerlink" href="#module-abipy.core.restapi" title="Permalink to this headline">¶</a></h2>
<p>This module provides interfaces with the Materials Project REST API v2 to enable
the creation of data structures and pymatgen objects using Materials Project data.</p>
<dl class="class">
<dt id="abipy.core.restapi.CodStructures">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">CodStructures</code><span class="sig-paren">(</span><em>structures</em>, <em>ids</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#CodStructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.CodStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.restapi.DatabaseStructures" title="abipy.core.restapi.DatabaseStructures"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.restapi.DatabaseStructures</span></code></a></p>
<p>Store the results of a query to the COD database <a class="reference external" href="http://www.crystallography.net/cod/">http://www.crystallography.net/cod/</a></p>
<dl class="attribute">
<dt id="abipy.core.restapi.CodStructures.dbname">
<code class="descname">dbname</code><em class="property"> = 'COD'</em><a class="headerlink" href="#abipy.core.restapi.CodStructures.dbname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.restapi.DatabaseStructures">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">DatabaseStructures</code><span class="sig-paren">(</span><em>structures</em>, <em>ids</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Store the results of a query to the MP database.</p>
<dl class="method">
<dt id="abipy.core.restapi.DatabaseStructures.filter_by_spgnum">
<code class="descname">filter_by_spgnum</code><span class="sig-paren">(</span><em>spgnum</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.filter_by_spgnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.filter_by_spgnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter structures by space group number. Return new MpStructures object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.restapi.DatabaseStructures.print_results">
<code class="descname">print_results</code><span class="sig-paren">(</span><em>fmt='abivars'</em>, <em>verbose=0</em>, <em>file=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.print_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print pandas dataframe, structures using format <cite>fmt</cite>, and data to file <cite>file</cite>.
<cite>fmt</cite> is automaticall set to <cite>cif</cite> if structure is disordered.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.restapi.DatabaseStructures.table">
<code class="descname">table</code><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.table" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe constructed from self.data. None if data is not available.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.restapi.Dotdict">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">Dotdict</code><a class="reference internal" href="../_modules/abipy/core/restapi.html#Dotdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.Dotdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a></p>
<dl class="method">
<dt id="abipy.core.restapi.Dotdict.dotget">
<code class="descname">dotget</code><span class="sig-paren">(</span><em>key</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#Dotdict.dotget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.Dotdict.dotget" title="Permalink to this definition">¶</a></dt>
<dd><p>d.dotget[“foo.bar”] –&gt; d[“foo”][“bar”] if “foo.bar” not in self</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.restapi.MpStructures">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">MpStructures</code><span class="sig-paren">(</span><em>structures</em>, <em>ids</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MpStructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.MpStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.restapi.DatabaseStructures" title="abipy.core.restapi.DatabaseStructures"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.restapi.DatabaseStructures</span></code></a></p>
<p>Store the results of a query to the Materials Project database.</p>
<dl class="attribute">
<dt id="abipy.core.restapi.MpStructures.dbname">
<code class="descname">dbname</code><em class="property"> = 'Materials Project'</em><a class="headerlink" href="#abipy.core.restapi.MpStructures.dbname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.restapi.MpStructures.table">
<code class="descname">table</code><a class="reference internal" href="../_modules/abipy/core/restapi.html#MpStructures.table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.MpStructures.table" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe constructed from self.data. None if data is not available.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.restapi.MyMPRester">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">MyMPRester</code><span class="sig-paren">(</span><em>api_key=None</em>, <em>endpoint='https://www.materialsproject.org/rest/v2'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MyMPRester"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.MyMPRester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.ext.matproj.html#pymatgen.ext.matproj.MPRester" title="(in pymatgen v2017.11.6)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.ext.matproj.MPRester</span></code></a></p>
<dl class="attribute">
<dt id="abipy.core.restapi.MyMPRester.Error">
<code class="descname">Error</code><a class="headerlink" href="#abipy.core.restapi.MyMPRester.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">MPRestError</span></code></p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.restapi.MyMPRester.get_phasediagram_results">
<code class="descname">get_phasediagram_results</code><span class="sig-paren">(</span><em>elements</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MyMPRester.get_phasediagram_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.MyMPRester.get_phasediagram_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Contact the materials project database, fetch entries and build <cite>PhaseDiagramResults</cite> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>elements</strong> – List of chemical elements.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.restapi.PhaseDiagramResults">
<em class="property">class </em><code class="descclassname">abipy.core.restapi.</code><code class="descname">PhaseDiagramResults</code><span class="sig-paren">(</span><em>entries</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Simplified interface to phase-diagram pymatgen API.</p>
<p>Inspired to:</p>
<blockquote>
<div><a class="reference external" href="https://anaconda.org/matsci/plotting-and-analyzing-a-phase-diagram-using-the-materials-api/notebook">https://anaconda.org/matsci/plotting-and-analyzing-a-phase-diagram-using-the-materials-api/notebook</a></div></blockquote>
<dl class="method">
<dt id="abipy.core.restapi.PhaseDiagramResults.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>show_unstable=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phase diagram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>show_unstable</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Whether unstable phases will be plotted as
well as red crosses. If a number &gt; 0 is entered, all phases with
ehull &lt; show_unstable will be shown.</li>
<li><strong>show</strong> – True to show plot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">plotter object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.restapi.PhaseDiagramResults.print_dataframes">
<code class="descname">print_dataframes</code><span class="sig-paren">(</span><em>with_spglib=False</em>, <em>file=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='UTF-8'&gt;</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.print_dataframes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.print_dataframes" title="Permalink to this definition">¶</a></dt>
<dd><p>Print pandas dataframe to file <cite>file</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>with_spglib</strong> – True to compute spacegroup with spglib.</li>
<li><strong>file</strong> – Output stream.</li>
<li><strong>verbose</strong> – Verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.restapi.PhaseDiagramResults.table">
<code class="descname">table</code><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.table" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe with the most important results.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.core.restapi.get_mprester">
<code class="descclassname">abipy.core.restapi.</code><code class="descname">get_mprester</code><span class="sig-paren">(</span><em>api_key=None</em>, <em>endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#get_mprester"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.restapi.get_mprester" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in
your .pmgrc.yaml. If so, it will use that environment
This makes easier for heavy users to simply add
this environment variable to their setups and MPRester can
then be called without any arguments.</li>
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.skw">
<span id="skw-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">skw</span></code> Module<a class="headerlink" href="#module-abipy.core.skw" title="Permalink to this headline">¶</a></h2>
<p>Shankland-Koelling-Wood Fourier interpolation scheme.</p>
<dl class="class">
<dt id="abipy.core.skw.EDOS">
<em class="property">class </em><code class="descclassname">abipy.core.skw.</code><code class="descname">EDOS</code><span class="sig-paren">(</span><em>mesh</em>, <em>values</em>, <em>integral</em>, <em>is_shift</em>, <em>method</em>, <em>step</em>, <em>width</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#EDOS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.EDOS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="abipy.core.skw.ElectronInterpolator">
<em class="property">class </em><code class="descclassname">abipy.core.skw.</code><code class="descname">ElectronInterpolator</code><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="attribute">
<dt id="abipy.core.skw.ElectronInterpolator.angle_tolerance">
<code class="descname">angle_tolerance</code><em class="property"> = -1.0</em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.angle_tolerance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.calc_occfacts">
<code class="descname">calc_occfacts</code><span class="sig-paren">(</span><em>eigens</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.calc_occfacts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.calc_occfacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute occupation factors from the eigenvalues <cite>eigens</cite> and
the temperature <cite>temp</cite> in K. occfacts in [0, 1].</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.get_edos">
<code class="descname">get_edos</code><span class="sig-paren">(</span><em>kmesh</em>, <em>is_shift=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>wmesh=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_edos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electron DOS on a linear mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</li>
<li><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
<li><strong>method</strong> – String defining the method for the computation of the DOS.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>mesh</strong> – Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(mesh, values, integral)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.get_jdos_q0">
<code class="descname">get_jdos_q0</code><span class="sig-paren">(</span><em>kmesh</em>, <em>is_shift=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>wmesh=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_jdos_q0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_jdos_q0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the join density of states at q==0</p>
<blockquote>
<div><img src="../_images/mathmpl/math-409d93a935.png" style="position: relative; bottom: -21px"/></div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</li>
<li><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
<li><strong>method</strong> – String defining the method.</li>
<li><strong>step</strong> – Energy step (eV) of the linear mesh.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>wmesh</strong> – Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.get_nesting_at_e0">
<code class="descname">get_nesting_at_e0</code><span class="sig-paren">(</span><em>qpoints</em>, <em>kmesh</em>, <em>e0</em>, <em>width=0.2</em>, <em>is_shift=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_nesting_at_e0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_nesting_at_e0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nesting factor with gaussian broadening for an arbitrary list of q-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>qpoints</strong> – List of q-points in reduced coordinates.</li>
<li><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</li>
<li><strong>e0</strong> – Energy level in eV.</li>
<li><strong>width</strong> – Standard deviation (eV) of the gaussian.</li>
<li><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">numpy array of shape [self.nsppol, len(qpoints)]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.get_sampling">
<code class="descname">get_sampling</code><span class="sig-paren">(</span><em>mesh</em>, <em>is_shift</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_sampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Use spglib to compute the k-points in the IBZ with the corresponding weights
as well as the k-points in the full BZ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mesh</strong> – </li>
<li><strong>is_shift</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Return: named tuple with the following attributes:</p>
<blockquote>
<div>ibz:
nibz
weights:
bz:
nbz
grid:</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.skw.ElectronInterpolator.occtype">
<code class="descname">occtype</code><em class="property"> = 'insulator'</em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.occtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.pickle_dump">
<code class="descname">pickle_dump</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.pickle_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the status of the object in pickle format.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.skw.ElectronInterpolator.pickle_load">
<em class="property">classmethod </em><code class="descname">pickle_load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.pickle_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_dos_vs_kmeshes">
<code class="descname">plot_dos_vs_kmeshes</code><span class="sig-paren">(</span><em>kmeshes</em>, <em>is_shift=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_dos_vs_kmeshes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_dos_vs_kmeshes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot (interpolated) DOSes computed with different meshes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>kmeshes: List of kmeshes. Each item is given by three integers with the number of</dt>
<dd>divisions along the reciprocal primitive axes.</dd>
<dt>is_shift: three integers (spglib API). When is_shift is not None, the kmesh is shifted along</dt>
<dd>the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</dd>
</dl>
<p class="last">method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
ax: matplotlib <cite>Axes</cite> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_group_velocites">
<code class="descname">plot_group_velocites</code><span class="sig-paren">(</span><em>vertices_names=None</em>, <em>line_density=20</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_group_velocites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_group_velocites" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot (interpolated) group velocities computed along an arbitrary k-path.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>vertices_names
line_density:
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_jdosq0_vs_kmeshes">
<code class="descname">plot_jdosq0_vs_kmeshes</code><span class="sig-paren">(</span><em>kmeshes</em>, <em>is_shift=None</em>, <em>method='gaussian'</em>, <em>step=0.1</em>, <em>width=0.2</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_jdosq0_vs_kmeshes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_jdosq0_vs_kmeshes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot (interpolated) Joint DOSes at q=0 computed with different meshes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>kmeshes: List of kmeshes. Each item is given by three integers with the number of</dt>
<dd>divisions along the reciprocal primitive axes.</dd>
<dt>is_shift: three integers (spglib API). When is_shift is not None, the kmesh is shifted along</dt>
<dd>the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</dd>
</dl>
<p class="last">method: String defining the method for the computation of the DOS.
step: Energy step (eV) of the linear mesh.
width: Standard deviation (eV) of the gaussian.
ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_nesting_vs_kmeshes">
<code class="descname">plot_nesting_vs_kmeshes</code><span class="sig-paren">(</span><em>width</em>, <em>kmeshes</em>, <em>e0=None</em>, <em>qvertices_names=None</em>, <em>line_density=20</em>, <em>is_shift=None</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_nesting_vs_kmeshes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_nesting_vs_kmeshes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot (interpolated) nesting factor computed with different k-meshes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">width: Gaussian broadening (eV).
kmeshes: List of kmeshes. Each item is given by three integers with the number of</p>
<blockquote>
<div>divisions along the reciprocal primitive axes.</div></blockquote>
<p>e0: Energy level in eV.
qvertices_names
line_density:
is_shift: three integers (spglib API). When is_shift is not None, the kmesh is shifted along</p>
<blockquote>
<div>the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</div></blockquote>
<p class="last">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_nesting_vs_widths">
<code class="descname">plot_nesting_vs_widths</code><span class="sig-paren">(</span><em>widths</em>, <em>kmesh</em>, <em>e0=None</em>, <em>qvertices_names=None</em>, <em>line_density=20</em>, <em>is_shift=None</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_nesting_vs_widths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_nesting_vs_widths" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot (interpolated) nesting factor computed with different broadening.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">widths: List of standard deviations (eV) of the gaussian.
kmeshes: List of kmeshes. Each item is given by three integers with the number of</p>
<blockquote>
<div>divisions along the reciprocal primitive axes.</div></blockquote>
<p>e0: Energy level in eV.
qvertices_names
line_density:
is_shift: three integers (spglib API). When is_shift is not None, the kmesh is shifted along</p>
<blockquote>
<div>the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</div></blockquote>
<p class="last">ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.</p>
</dd>
<dt>Returns:</dt>
<dd>matplotlib figure.</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.set_fermie">
<code class="descname">set_fermie</code><span class="sig-paren">(</span><em>fermie</em>, <em>kmesh</em>, <em>is_shift=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.set_fermie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.set_fermie" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the Fermi level. Use the IDOS computed on the k-grid specifined by
<cite>kmesh</cite> and <cite>is_shift</cite> to recompute the total number of electrons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fermie</strong> – New Fermi level in eV</li>
<li><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</li>
<li><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">New value of <cite>self.nelect</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.ElectronInterpolator.set_nelect">
<code class="descname">set_nelect</code><span class="sig-paren">(</span><em>nelect</em>, <em>kmesh</em>, <em>is_shift=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.set_nelect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.set_nelect" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the total number of electrons. Use the IDOS computed on the k-grid specifined by
<cite>kmesh</cite> and <cite>is_shift</cite> to recompute the new Fermi level</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nelect</strong> – New numbre of electrons.</li>
<li><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</li>
<li><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">New value of <cite>self.fermie</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.skw.ElectronInterpolator.symprec">
<code class="descname">symprec</code><em class="property"> = 1e-05</em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.symprec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.skw.ElectronInterpolator.use_cache">
<code class="descname">use_cache</code><em class="property"> = True</em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.use_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.skw.ElectronInterpolator.val_ib">
<code class="descname">val_ib</code><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.val_ib" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the valence band.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.skw.SkwInterpolator">
<em class="property">class </em><code class="descclassname">abipy.core.skw.</code><code class="descname">SkwInterpolator</code><span class="sig-paren">(</span><em>lpratio</em>, <em>kpts</em>, <em>eigens</em>, <em>fermie</em>, <em>nelect</em>, <em>cell</em>, <em>symrel</em>, <em>has_timrev</em>, <em>filter_params=None</em>, <em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.skw.ElectronInterpolator" title="abipy.core.skw.ElectronInterpolator"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.skw.ElectronInterpolator</span></code></a></p>
<p>This object implements the Shankland-Koelling-Wood Fourier interpolation scheme.
It can be used to interpolate functions in k-space with the periodicity of the
reciprocal lattice and satisfying F(k) = F(Sk) for each rotation S
belonging to the point group of the crystal. For readability reason,
the names of the variables are chosen assuming we are interpolating electronic eigenvalues
but the same object can be used to interpolate other quantities. Just set the first dimension to 1.</p>
<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.eval_sk">
<code class="descname">eval_sk</code><span class="sig-paren">(</span><em>spin</em>, <em>kpt</em>, <em>der1=None</em>, <em>der2=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.eval_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.eval_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate eigenvalues for all bands at a given (spin, k-point).
Optionally compute gradients and Hessian matrices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spin</strong> – Spin index.</li>
<li><strong>kpt</strong> – K-point in reduced coordinates.</li>
<li><strong>der1</strong> – If not None, ouput gradient is stored in der1[nband, 3].</li>
<li><strong>der2</strong> – If not None, output Hessian is der2[nband, 3, 3].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">oeigs[nband]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark">
<code class="descname">get_stark</code><span class="sig-paren">(</span><em>kpt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the star function for k-point <cite>kpt</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpt</strong> – K-point in reduced coordinates.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">complex array of shape [self.nr]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark_dk1">
<code class="descname">get_stark_dk1</code><span class="sig-paren">(</span><em>kpt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark_dk1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark_dk1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 1st-order derivative of the star function wrt k</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpt</strong> – K-point in reduced coordinates.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">complex array [3, self.nr]  with the derivative of the
star function wrt k in reduced coordinates.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark_dk2">
<code class="descname">get_stark_dk2</code><span class="sig-paren">(</span><em>kpt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark_dk2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark_dk2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2nd-order derivatives of the star function wrt k.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpt</strong> – K-point in reduced coordinates.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Complex numpy array of shape [3, 3, self.nr] with the 2nd-order derivatives
of the star function wrt k in reduced coordinates.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.interp_kpts">
<code class="descname">interp_kpts</code><span class="sig-paren">(</span><em>kfrac_coords</em>, <em>dk1=False</em>, <em>dk2=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.interp_kpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.interp_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies on an arbitrary set of k-points. Optionally, compute
gradients and Hessian matrices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kfrac_coords</strong> – K-points in reduced coordinates.</li>
<li><strong>dk1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – True if gradient is wanted.</li>
<li><strong>dk2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – True to compute 2nd order derivatives.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>interpolated energies in eigens[nsppol, len(kfrac_coords), nband]
gradient in dedk[self.nsppol, len(kfrac_coords), self.nband, 3))
hessian in dedk2[self.nsppol, len(kfrac_coords), self.nband, 3, 3))</p>
<p>gradient and hessian are set to None if not computed.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">namedtuple with</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.interp_kpts_and_enforce_degs">
<code class="descname">interp_kpts_and_enforce_degs</code><span class="sig-paren">(</span><em>kfrac_coords</em>, <em>ref_eigens</em>, <em>atol=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.interp_kpts_and_enforce_degs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.interp_kpts_and_enforce_degs" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies on an arbitrary set of k-points. Use <cite>ref_eigens</cite>
to detect degeneracies and average the interpolated values in the degenerate subspace.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.skw.SkwInterpolator.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.core.skw.extract_point_group">
<code class="descclassname">abipy.core.skw.</code><code class="descname">extract_point_group</code><span class="sig-paren">(</span><em>symrel</em>, <em>has_timrev</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#extract_point_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.extract_point_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the point group rotations from the spacegroup. Add time-reversal
if spatial inversion is not present and <cite>has_timrev</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ptg_symrel, ptg_symrec) with rotations in real- and reciprocal-space.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.core.skw.find_degs_sk">
<code class="descclassname">abipy.core.skw.</code><code class="descname">find_degs_sk</code><span class="sig-paren">(</span><em>enesb</em>, <em>atol</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#find_degs_sk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.find_degs_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of lists with the indices of the degenerated bands.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>enesb</strong> – Iterable with energies for the different bands.
Energies are assumed to be ordered.</li>
<li><strong>atol</strong> – Absolute tolerance. Two states are degerated if they differ by less than <cite>atol</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>List of lists. The i-th item contains the indices of the degenerates states</dt>
<dd><p class="first last">for the i-th degenerated set.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_degs_sk</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.401</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="go">[[0, 1], [2], [3, 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="abipy.core.skw.map_bz2ibz">
<code class="descclassname">abipy.core.skw.</code><code class="descname">map_bz2ibz</code><span class="sig-paren">(</span><em>structure</em>, <em>ibz</em>, <em>ngkpt</em>, <em>has_timrev</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#map_bz2ibz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.map_bz2ibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="abipy.core.skw.n_fermi_dirac">
<code class="descclassname">abipy.core.skw.</code><code class="descname">n_fermi_dirac</code><span class="sig-paren">(</span><em>enes</em>, <em>mu</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#n_fermi_dirac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.skw.n_fermi_dirac" title="Permalink to this definition">¶</a></dt>
<dd><p>Fermi-Dirac distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>enes</strong> – Energies in eV</li>
<li><strong>mu</strong> – Chemical potential in eV.</li>
<li><strong>temp</strong> – Temperature in Kelvin.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">numpy array with occupations in [0, 1].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.structure">
<span id="structure-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">structure</span></code> Module<a class="headerlink" href="#module-abipy.core.structure" title="Permalink to this headline">¶</a></h2>
<p>This module defines basic objects representing the crystalline structure.</p>
<dl class="function">
<dt id="abipy.core.structure.mp_match_structure">
<code class="descclassname">abipy.core.structure.</code><code class="descname">mp_match_structure</code><span class="sig-paren">(</span><em>obj</em>, <em>api_key=None</em>, <em>endpoint=None</em>, <em>final=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#mp_match_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.mp_match_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds matching structures on the Materials Project database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obj</strong> – filename or Structure object.</li>
<li><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface.</li>
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.</li>
<li><strong>final</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to get the final structure, or the initial
(pre-relaxation) structure. Defaults to True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt><code class="xref py py-class docutils literal"><span class="pre">MpStructures</span></code> object with</dt>
<dd><p class="first last">structures: List of matching structures and list of Materials Project identifier.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.core.structure.mp_search">
<code class="descclassname">abipy.core.structure.</code><code class="descname">mp_search</code><span class="sig-paren">(</span><em>chemsys_formula_id</em>, <em>api_key=None</em>, <em>endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#mp_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.mp_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the materials project database.
Get a list of structures corresponding to a chemical system, formula, or materials_id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chemsys_formula_id</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A chemical system (e.g., Li-Fe-O),
or formula (e.g., Fe2O3) or materials_id (e.g., mp-1234).</li>
<li><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A String API key for accessing the MaterialsProject REST interface.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in your .pmgrc.yaml.</li>
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt><code class="xref py py-class docutils literal"><span class="pre">MpStructures</span></code> object with</dt>
<dd><p class="first last">List of Structure objects, Materials project ids associated to structures.
and List of dictionaries with MP data (same order as structures).</p>
</dd>
</dl>
<p>Note that the attributes evalute to False if no match is found</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.core.structure.cod_search">
<code class="descclassname">abipy.core.structure.</code><code class="descname">cod_search</code><span class="sig-paren">(</span><em>formula</em>, <em>primitive=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#cod_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.cod_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the COD database (<a class="reference external" href="http://www.crystallography.net/">http://www.crystallography.net/</a>)
Get a list of structures corresponding to a chemical formula</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>formula</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Chemical formula (e.g., Fe2O3)</li>
<li><strong>primitive</strong> – True if primitive structures are wanted. Note that many COD structures are not primitive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt><code class="xref py py-class docutils literal"><span class="pre">CodStructures</span></code> object with</dt>
<dd><p class="first last">List of Structure objects, COD ids associated to structures.
and List of dictionaries with COD data (same order as structures).</p>
</dd>
</dl>
<p>Note that the attributes evalute to False if no match is found</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="abipy.core.structure.Structure">
<em class="property">class </em><code class="descclassname">abipy.core.structure.</code><code class="descname">Structure</code><span class="sig-paren">(</span><em>lattice</em>, <em>species</em>, <em>coords</em>, <em>validate_proximity=False</em>, <em>to_unit_cell=False</em>, <em>coords_are_cartesian=False</em>, <em>site_properties=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.core.structure.html#pymatgen.core.structure.Structure" title="(in pymatgen v2017.11.6)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.core.structure.Structure</span></code></a>, <a class="reference internal" href="#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Extends <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structure</span></code> with Abinit-specific methods.</p>
<dl class="classmethod">
<dt id="abipy.core.structure.Structure.ABO3">
<em class="property">classmethod </em><code class="descname">ABO3</code><span class="sig-paren">(</span><em>a</em>, <em>species</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.ABO3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.ABO3" title="Permalink to this definition">¶</a></dt>
<dd><p>Peroviskite structures.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.abi_primitive">
<code class="descname">abi_primitive</code><span class="sig-paren">(</span><em>symprec=0.001</em>, <em>angle_tolerance=5</em>, <em>no_idealize=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.abi_primitive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.abi_primitive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.abi_sanitize">
<code class="descname">abi_sanitize</code><span class="sig-paren">(</span><em>symprec=0.001</em>, <em>angle_tolerance=5</em>, <em>primitive=True</em>, <em>primitive_standard=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.abi_sanitize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.abi_sanitize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new structure in which:</p>
<blockquote>
<div><ul class="simple">
<li>Structure is refined.</li>
<li>Reduced to primitive settings.</li>
<li>Lattice vectors are exchanged if the triple product is negative</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>symprec</strong> – Symmetry precision used to refine the structure.</li>
<li><strong>angle_tolerance</strong> – Tolerance on anglese
if <cite>symprec</cite> is None and <cite>angle_tolerance</cite> is None, no structure refinement is peformed.</li>
<li><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to convert to a primitive cell following
Setyawan, W., &amp; Curtarolo, S. (2010). doi:10.1016/j.commatsci.2010.05.010</li>
<li><strong>primitive_standard</strong> – Returns most primitive structure found.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.abi_spacegroup">
<code class="descname">abi_spacegroup</code><a class="headerlink" href="#abipy.core.structure.Structure.abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">AbinitSpaceGroup</span></code> instance with Abinit symmetries read from the netcd file.
None if abinit symmetries are not available e.g. if the structure has been created
from a CIF file.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.abi_string">
<code class="descname">abi_string</code><a class="headerlink" href="#abipy.core.structure.Structure.abi_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with the ABINIT input associated to this structure.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.as_structure">
<em class="property">classmethod </em><code class="descname">as_structure</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.as_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.as_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a structure. Accepts:</p>
<blockquote>
<div><ul class="simple">
<li>Structure instances</li>
<li>Filenames</li>
<li>Dictionaries (JSON format or dictionaries with abinit variables).</li>
<li>Objects with a <cite>structure</cite> attribute.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.bcc">
<em class="property">classmethod </em><code class="descname">bcc</code><span class="sig-paren">(</span><em>a</em>, <em>species</em>, <em>primitive=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.bcc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.bcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive or a conventional bcc crystal structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – Lattice parameter in Angstrom.</li>
<li><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structue</span></code></li>
<li><strong>primitive</strong> – if True a primitive cell will be produced, otherwise a conventional one</li>
<li><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structue</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.boxed_atom">
<em class="property">classmethod </em><code class="descname">boxed_atom</code><span class="sig-paren">(</span><em>pseudo</em>, <em>cart_coords=(0</em>, <em>0</em>, <em>0)</em>, <em>acell=(10</em>, <em>10</em>, <em>10)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.boxed_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.boxed_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an atom in a periodic box of lengths acell [Bohr]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pseudo</strong> – Pseudopotential object.</li>
<li><strong>cart_coords</strong> – Cartesian coordinates in Angstrom</li>
<li><strong>acell</strong> – Lengths of the box in <em>Bohr</em> (Abinit input variable)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.boxed_molecule">
<em class="property">classmethod </em><code class="descname">boxed_molecule</code><span class="sig-paren">(</span><em>pseudos</em>, <em>cart_coords</em>, <em>acell=(10</em>, <em>10</em>, <em>10)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.boxed_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.boxed_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a molecule in a periodic box of lengths acell [Bohr]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pseudos</strong> – List of pseudopotentials</li>
<li><strong>cart_coords</strong> – Cartesian coordinates</li>
<li><strong>acell</strong> – Lengths of the box in <em>Bohr</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.calc_kptbounds">
<code class="descname">calc_kptbounds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_kptbounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_kptbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the suggested value for the ABINIT variable <cite>kptbounds</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.calc_ksampling">
<code class="descname">calc_ksampling</code><span class="sig-paren">(</span><em>nksmall</em>, <em>symprec=0.01</em>, <em>angle_tolerance=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_ksampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_ksampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-point sampling from the number of divisions to be used for
the smallest reciprocal lattice vector.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.calc_ngkpt">
<code class="descname">calc_ngkpt</code><span class="sig-paren">(</span><em>nksmall</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_ngkpt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_ngkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ABINIT variable <cite>ngkpt</cite> from the number of divisions used for the smallest lattice vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nksmall</strong> – Number of division for the smallest lattice vector.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.calc_shiftk">
<code class="descname">calc_shiftk</code><span class="sig-paren">(</span><em>symprec=0.01</em>, <em>angle_tolerance=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_shiftk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_shiftk" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the values of <cite>shiftk</cite> and <cite>nshiftk</cite> appropriated for the sampling of the Brillouin zone.</p>
<p>When the primitive vectors of the lattice do NOT form a FCC or a BCC lattice,
the usual (shifted) Monkhorst-Pack grids are formed by using nshiftk=1 and shiftk 0.5 0.5 0.5 .
This is often the preferred k point sampling. For a non-shifted Monkhorst-Pack grid,
use <cite>nshiftk=1</cite> and <cite>shiftk 0.0 0.0 0.0</cite>, but there is little reason to do that.</p>
<p>When the primitive vectors of the lattice form a FCC lattice, with rprim:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">0.0</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>the (very efficient) usual Monkhorst-Pack sampling will be generated by using nshiftk= 4 and shiftk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.5</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>When the primitive vectors of the lattice form a BCC lattice, with rprim:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>
 <span class="mf">0.5</span> <span class="o">-</span><span class="mf">0.5</span>  <span class="mf">0.5</span>
 <span class="mf">0.5</span>  <span class="mf">0.5</span> <span class="o">-</span><span class="mf">0.5</span>
</pre></div>
</div>
<p>the usual Monkhorst-Pack sampling will be generated by using nshiftk= 2 and shiftk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="mf">0.25</span>  <span class="mf">0.25</span>  <span class="mf">0.25</span>
<span class="o">-</span><span class="mf">0.25</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">-</span><span class="mf">0.25</span>
</pre></div>
</div>
<p>However, the simple sampling nshiftk=1 and shiftk 0.5 0.5 0.5 is excellent.</p>
<p>For hexagonal lattices with hexagonal axes, e.g. rprim:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="mf">1.0</span>  <span class="mf">0.0</span>       <span class="mf">0.0</span>
<span class="o">-</span><span class="mf">0.5</span>  <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="mf">0.0</span>
 <span class="mf">0.0</span>  <span class="mf">0.0</span>       <span class="mf">1.0</span>
</pre></div>
</div>
<p>one can use nshiftk= 1 and shiftk 0.0 0.0 0.5
In rhombohedral axes, e.g. using angdeg 3*60., this corresponds to shiftk 0.5 0.5 0.5,
to keep the shift along the symmetry axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Suggested value of shiftk.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.chemview">
<code class="descname">chemview</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.chemview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.chemview" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize Structure in jupyter notebook using chemview package.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><em>fmt='cif'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.convert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with the structure in the given format <cite>fmt</cite>
Options include “abivars”, “cif”, “xsf”, “poscar”, “cssr”, “json”.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.displace">
<code class="descname">displace</code><span class="sig-paren">(</span><em>displ</em>, <em>eta</em>, <em>frac_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.displace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.displace" title="Permalink to this definition">¶</a></dt>
<dd><p>Displace the sites of the structure along the displacement vector displ.</p>
<p>The displacement vector is first rescaled so that the maxium atomic displacement
is one Angstrom, and then multiplied by eta. Hence passing eta=0.001, will move
all the atoms so that the maximum atomic displacement is 0.001 Angstrom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>displ</strong> – Displacement vector with 3*len(self) entries (fractional coordinates).</li>
<li><strong>eta</strong> – Scaling factor.</li>
<li><strong>frac_coords</strong> – Boolean stating whether the vector corresponds to fractional or cartesian coordinates.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.dot">
<code class="descname">dot</code><span class="sig-paren">(</span><em>coords_a</em>, <em>coords_b</em>, <em>space='r'</em>, <em>frac_coords=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the scalar product of vector(s) either in real space or
reciprocal space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coords</strong> (<em>3x1 array</em>) – Array-like object with the coordinates.</li>
<li><strong>space</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – “r” for real space, “g” for reciprocal space.</li>
<li><strong>frac_coords</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether the vector corresponds to fractional or
cartesian coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">one-dimensional <cite>numpy</cite> array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>filename</em>, <em>visu=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the crystalline structure on file filename.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> – String specifying the file path and the file format.
The format is defined by the file extension. filename=”prefix.xsf”, for example,
will produce a file in XSF format. An <em>empty</em> prefix, e.g. “.xsf” makes the code use a temporary file.</li>
<li><strong>visu</strong> – <cite>Visualizer</cite> subclass. By default, this method returns the first available
visualizer that supports the given file format. If visu is not None, an
instance of visu is returned. See <code class="xref py py-class docutils literal"><span class="pre">Visualizer</span></code> for the list of applications and formats supported.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: Instance of <code class="xref py py-class docutils literal"><span class="pre">Visualizer</span></code></p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.fcc">
<em class="property">classmethod </em><code class="descname">fcc</code><span class="sig-paren">(</span><em>a</em>, <em>species</em>, <em>primitive=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.fcc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.fcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive or a conventional fcc crystal structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – Lattice parameter in Angstrom.</li>
<li><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structure</span></code></li>
<li><strong>primitive</strong> – if True a primitive cell will be produced, otherwise a conventional one</li>
<li><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structure</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.findname_in_hsym_stars">
<code class="descname">findname_in_hsym_stars</code><span class="sig-paren">(</span><em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.findname_in_hsym_stars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.findname_in_hsym_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the special k-point, None if kpoint is unknown.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.from_abivars">
<em class="property">classmethod </em><code class="descname">from_abivars</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_abivars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> object from a dictionary with ABINIT variables.</p>
<p><cite>xred</cite> can be replaced with <cite>xcart</cite> or <cite>xangst</cite>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.from_ase_atoms">
<em class="property">classmethod </em><code class="descname">from_ase_atoms</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_ase_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_ase_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns structure from ASE Atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> – ASE Atoms object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Equivalent Structure</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.from_cod_id">
<em class="property">classmethod </em><code class="descname">from_cod_id</code><span class="sig-paren">(</span><em>cod_id</em>, <em>primitive=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_cod_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_cod_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries the COD for a structure by id. Returns Structure object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cod_id</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – COD id.</li>
<li><strong>primitive</strong> – True if primitive structures are wanted. Note that many COD structures are not primitive.</li>
<li><strong>kwargs</strong> – Arguments passed to <cite>get_structure_by_id</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A Structure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>filepath</em>, <em>primitive=False</em>, <em>sort=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a structure from a file. For example, anything ending in
a “cif” is assumed to be a Crystallographic Information Format file.
Supported formats include CIF, POSCAR/CONTCAR, CHGCAR, LOCPOT,
vasprun.xml, CSSR, Netcdf and pymatgen’s JSON serialized structures.</p>
<dl class="docutils">
<dt>Netcdf files supported:</dt>
<dd>All files produced by ABINIT with info of the crystalline geometry
HIST_FILEs, in this case the last structure of the history is returned.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The filename to read from.</li>
<li><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to convert to a primitive cell
Only available for cifs, POSCAR, CSSR, JSON, YAML
Defaults to True.</li>
<li><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to sort sites. Default to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.from_material_id">
<em class="property">classmethod </em><code class="descname">from_material_id</code><span class="sig-paren">(</span><em>material_id</em>, <em>final=True</em>, <em>api_key=None</em>, <em>endpoint=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_material_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_material_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a Structure corresponding to a material_id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>material_id</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Materials Project material_id (a string, e.g., mp-1234).</li>
<li><strong>final</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to get the final structure, or the initial
(pre-relaxation) structure. Defaults to True.</li>
<li><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in your .pmgrc.yaml.
If so, it will use that environment
This makes easier for heavy users to simply add this environment variable
to their setups and MPRester can then be called without any arguments.</li>
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Structure object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.frozen_2phonon">
<code class="descname">frozen_2phonon</code><span class="sig-paren">(</span><em>qpoint</em>, <em>displ1</em>, <em>displ2</em>, <em>do_real1=True</em>, <em>do_real2=True</em>, <em>frac_coords=True</em>, <em>scale_matrix=None</em>, <em>max_supercell=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.frozen_2phonon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.frozen_2phonon" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the supercell needed for a given qpoint and add the displacement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space.</li>
<li><strong>displ</strong> – displacement in real space of the atoms, will be normalized to 1 Angstrom.</li>
<li><strong>eta</strong> – pre-factor multiplying the displacement.</li>
<li><strong>do_real</strong> – true if we want only the real part of the displacement.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.frozen_phonon">
<code class="descname">frozen_phonon</code><span class="sig-paren">(</span><em>qpoint</em>, <em>displ</em>, <em>do_real=True</em>, <em>frac_coords=True</em>, <em>scale_matrix=None</em>, <em>max_supercell=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.frozen_phonon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.frozen_phonon" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the supercell needed for a given qpoint and add the displacement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space.</li>
<li><strong>displ</strong> – displacement in real space of the atoms, will be normalized to 1 Angstrom.</li>
<li><strong>eta</strong> – pre-factor multiplying the displacement.</li>
<li><strong>do_real</strong> – true if we want only the real part of the displacement.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_conventional_standard_structure">
<code class="descname">get_conventional_standard_structure</code><span class="sig-paren">(</span><em>international_monoclinic=True</em>, <em>symprec=0.001</em>, <em>angle_tolerance=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_conventional_standard_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_conventional_standard_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives a structure with a conventional cell according to certain
standards. The standards are defined in Setyawan, W., &amp; Curtarolo,
S. (2010). High-throughput electronic band structure calculations:
Challenges and tools. Computational Materials Science,
49(2), 299-312. doi:10.1016/j.commatsci.2010.05.010
They basically enforce as much as possible
norm(a1)&lt;norm(a2)&lt;norm(a3)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The structure in a conventional standardized cell</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_dict4frame">
<code class="descname">get_dict4frame</code><span class="sig-paren">(</span><em>with_spglib=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_dict4frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_dict4frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal"><span class="pre">OrderedDict</span></code> with the most important structural parameters:</p>
<blockquote>
<div><ul class="simple">
<li>Chemical formula and number of atoms.</li>
<li>Lattice lengths, angles and volume.</li>
<li>The spacegroup number computed by Abinit (set to None if not available).</li>
<li>The spacegroup number and symbol computed by spglib (if <cite>with_spglib</cite>).</li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_spglib</strong> – If True, spglib is invoked to get the spacegroup symbol and number</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_oxi_state_decorated">
<code class="descname">get_oxi_state_decorated</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_oxi_state_decorated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_oxi_state_decorated" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="xref py py-class docutils literal"><span class="pre">BVAnalyzer</span></code> to estimate oxidation states
Return oxidation state decorated structure.
This currently works only for ordered structures only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> – Arguments passed to BVAnalyzer</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A modified structure that is oxidation state decorated.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_smallest_supercell">
<code class="descname">get_smallest_supercell</code><span class="sig-paren">(</span><em>qpoint</em>, <em>max_supercell</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_smallest_supercell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_smallest_supercell" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space</li>
<li><strong>max_supercell</strong> – vector with the maximum supercell size</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns: the scaling matrix of the supercell</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_sorted_structure_z">
<code class="descname">get_sorted_structure_z</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_sorted_structure_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_sorted_structure_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Order the structure according to increasing Z of the elements</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_symbol2coords">
<code class="descname">get_symbol2coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_symbol2coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_symbol2coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping chemical symbols to coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.get_trans_vect">
<code class="descname">get_trans_vect</code><span class="sig-paren">(</span><em>scale_matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_trans_vect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_trans_vect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the translation vectors for a given scale matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scale_matrix</strong> – Scale matrix defining the new lattice vectors in term of the old ones</td>
</tr>
</tbody>
</table>
<p>Return: the translation vectors</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.has_abi_spacegroup">
<code class="descname">has_abi_spacegroup</code><a class="headerlink" href="#abipy.core.structure.Structure.has_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>True is the structure contains info on the spacegroup.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.hsym_kpath">
<code class="descname">hsym_kpath</code><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_kpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_kpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <code class="xref py py-class docutils literal"><span class="pre">HighSymmKpath</span></code>.
(Database of high symmetry k-points and high symmetry lines).</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.hsym_kpoints">
<code class="descname">hsym_kpoints</code><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_kpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">KpointList</span></code> object with the high-symmetry K-points.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.hsym_stars">
<code class="descname">hsym_stars</code><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_stars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <code class="xref py py-class docutils literal"><span class="pre">Star</span></code> objects. Each star is associated to one of the special k-points
present in the <cite>pymatgen</cite> database.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.lattice_vectors">
<code class="descname">lattice_vectors</code><span class="sig-paren">(</span><em>space='r'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.lattice_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.lattice_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the vectors of the unit cell in Angstrom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>space</strong> – “r” for real space vectors, “g” for reciprocal space basis vectors.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.mayaview">
<code class="descname">mayaview</code><span class="sig-paren">(</span><em>figure=None</em>, <em>show=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.mayaview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.mayaview" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the crystalline structure with mayaview</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><em>coords</em>, <em>space='r'</em>, <em>frac_coords=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the norm of vector(s) either in real space or reciprocal space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coords</strong> (<em>3x1 array</em>) – Array-like object with the coordinates.</li>
<li><strong>space</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – “r” for real space, “g” for reciprocal space.</li>
<li><strong>frac_coords</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether the vector corresponds to fractional or
cartesian coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">one-dimensional <cite>numpy</cite> array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.num_valence_electrons">
<code class="descname">num_valence_electrons</code><span class="sig-paren">(</span><em>pseudos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.num_valence_electrons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.num_valence_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of valence electrons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pseudos</strong> – List of <code class="xref py py-class docutils literal"><span class="pre">Pseudo</span></code> objects or list of filenames.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.plot_bz">
<code class="descname">plot_bz</code><span class="sig-paren">(</span><em>ax=None</em>, <em>pmg_path=True</em>, <em>with_labels=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_bz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_bz" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Gives the plot (as a matplotlib object) of the symmetry line path in the Brillouin Zone.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>ax: matplotlib <code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> or None if a new figure should be created.
pmg_path: True if the default path used in pymatgen should be show.
with_labels: True to plot k-point labels.</dd>
</dl>
<p>Returns: <cite>matplotlib</cite> figure.</p>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.plot_xrd">
<code class="descname">plot_xrd</code><span class="sig-paren">(</span><em>wavelength='CuKa'</em>, <em>symprec=0</em>, <em>debye_waller_factors=None</em>, <em>two_theta_range=(0</em>, <em>90)</em>, <em>annotate_peaks=True</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_xrd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_xrd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use pymatgen <code class="xref py py-class docutils literal"><span class="pre">XRDCalculator</span></code> to show the XRD plot.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>wavelength (str/float): The wavelength can be specified as either a</dt>
<dd>float or a string. If it is a string, it must be one of the
supported definitions in the AVAILABLE_RADIATION class
variable, which provides useful commonly used wavelengths.
If it is a float, it is interpreted as a wavelength in
angstroms. Defaults to “CuKa”, i.e, Cu K_alpha radiation.</dd>
<dt>symprec (float): Symmetry precision for structure refinement. If</dt>
<dd>set to 0, no refinement is done. Otherwise, refinement is
performed using spglib with provided precision.</dd>
<dt>debye_waller_factors ({element symbol: float}): Allows the</dt>
<dd>specification of Debye-Waller factors. Note that these
factors are temperature dependent.</dd>
<dt>two_theta_range ([float of length 2]): Tuple for range of</dt>
<dd>two_thetas to calculate in degrees. Defaults to (0, 90). Set to
None if you want all diffracted beams within the limiting
sphere of radius 2 / wavelength.</dd>
</dl>
<p class="last">annotate_peaks: Whether to annotate the peaks with plane information.</p>
</dd>
</dl>
</div></blockquote>
<p>keyword arguments controlling the display of the figure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kwargs</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Title of the plot (Default: None).</td>
</tr>
<tr class="row-odd"><td>show</td>
<td>True to show the figure (default: True).</td>
</tr>
<tr class="row-even"><td>savefig</td>
<td>‘abc.png’ or ‘abc.eps’ to save the figure to a file.</td>
</tr>
<tr class="row-odd"><td>size_kwargs</td>
<td>Dictionary with options passed to fig.set_size_inches
example: size_kwargs=dict(w=3, h=4)</td>
</tr>
<tr class="row-even"><td>tight_layout</td>
<td>True to call fig.tight_layout (default: False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.print_neighbors">
<code class="descname">print_neighbors</code><span class="sig-paren">(</span><em>radius=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.print_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.print_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get neighbors for each atom in the unit cell, out to a distance <cite>radius</cite> in Angstrom
Print results.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.structure.Structure.reciprocal_lattice">
<code class="descname">reciprocal_lattice</code><a class="headerlink" href="#abipy.core.structure.Structure.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice of the structure.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.structure.Structure.rocksalt">
<em class="property">classmethod </em><code class="descname">rocksalt</code><span class="sig-paren">(</span><em>a</em>, <em>species</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.rocksalt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.rocksalt" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive fcc crystal structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> – Lattice parameter in Angstrom.</li>
<li><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structure</span></code></li>
<li><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal"><span class="pre">pymatgen.Structure</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.set_abi_spacegroup">
<code class="descname">set_abi_spacegroup</code><span class="sig-paren">(</span><em>spacegroup</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.set_abi_spacegroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.set_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>AbinitSpaceGroup</cite> setter.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.show_bz">
<code class="descname">show_bz</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.structure.Structure.show_bz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.spget_equivalent_atoms">
<code class="descname">spget_equivalent_atoms</code><span class="sig-paren">(</span><em>symprec=0.001</em>, <em>angle_tolerance=5</em>, <em>printout=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_equivalent_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_equivalent_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Call spglib to find the inequivalent atoms and build symmetry tables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>symprec</strong> – Symmetry precision for distance</li>
<li><strong>angle_tolerance</strong> – Tolerance on anglese</li>
<li><strong>printout</strong> – True to print symmetry tables.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>irred_pos, eqmap, spgdata</p>
<dl class="docutils">
<dt>irred_pos: array giving the position of the i-th irred atom in the structure.</dt>
<dd><p class="first last">The number of irred atoms is len(irred_pos)</p>
</dd>
</dl>
<p>eqmap: Mapping irred atom position –&gt; list with positions of symmetrical atoms
spgdata: spglib dataset with additional data reported by spglib.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">namedtuple with the following attributes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.spget_summary">
<code class="descname">spget_summary</code><span class="sig-paren">(</span><em>symprec=0.001</em>, <em>angle_tolerance=5</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with full information about crystalline structure i.e.
space group, point group, wyckoff positions, equivalent sites.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>symprec</strong> – Symmetry precision for distance</li>
<li><strong>angle_tolerance</strong> – Tolerance on anglese</li>
<li><strong>verbose</strong> – Verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.spglib_summary">
<code class="descname">spglib_summary</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.structure.Structure.spglib_summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.spgset_abi_spacegroup">
<code class="descname">spgset_abi_spacegroup</code><span class="sig-paren">(</span><em>has_timerev</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spgset_abi_spacegroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.spgset_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Call spglib to find the spacegroup of the crystal, create new
<cite>AbinitSpaceGroup</cite> object and store it in <cite>self.abi_spacegroup</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>has_timerev</strong> – True if time-reversal can be used.</li>
<li><strong>overwrite</strong> – By default, the method raises <cite>ValueError</cite> if the object
already has the list of symmetries found by Abinit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>AbinitSpaceGroup</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.to">
<code class="descname">to</code><span class="sig-paren">(</span><em>fmt=None</em>, <em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.to_abivars">
<code class="descname">to_abivars</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_abivars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary with the ABINIT variables.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.to_ase_atoms">
<code class="descname">to_ase_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_ase_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_ase_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns ASE Atoms object from structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ASE Atoms object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>title=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.valence_electrons_per_atom">
<code class="descname">valence_electrons_per_atom</code><span class="sig-paren">(</span><em>pseudos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.valence_electrons_per_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.valence_electrons_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of valence electrons for each atom in the structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pseudos</strong> – List of <code class="xref py py-class docutils literal"><span class="pre">Pseudo</span></code> objects or list of filenames.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>visu_name='vesta'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the crystalline structure with visualizer.
See <code class="xref py py-class docutils literal"><span class="pre">Visualizer</span></code> for the list of applications and formats supported.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.vtkview">
<code class="descname">vtkview</code><span class="sig-paren">(</span><em>show=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.vtkview"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.vtkview" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize structure with VTK. Requires vtk python bindings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>show</strong> – True to show structure immediately.</li>
<li><strong>kwargs</strong> – keyword arguments passed to <code class="xref py py-class docutils literal"><span class="pre">StructureVis</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">StructureVis object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.write_notebook">
<code class="descname">write_notebook</code><span class="sig-paren">(</span><em>nbpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.write_notebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an ipython notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.structure.Structure.write_vib_file">
<code class="descname">write_vib_file</code><span class="sig-paren">(</span><em>xyz_file</em>, <em>qpoint</em>, <em>displ</em>, <em>do_real=True</em>, <em>frac_coords=True</em>, <em>scale_matrix=None</em>, <em>max_supercell=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.write_vib_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.Structure.write_vib_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write into the file descriptor xyz_file the positions and displacements of the atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xyz_file</strong> – file_descriptor</li>
<li><strong>qpoint</strong> – qpoint to be analyzed</li>
<li><strong>displ</strong> – eigendisplacements to be analyzed</li>
<li><strong>do_real</strong> – True if you want to get only real part, False means imaginary part</li>
<li><strong>frac_coords</strong> – True if the eigendisplacements are given in fractional coordinates</li>
<li><strong>scale_matrix</strong> – Scale matrix for supercell</li>
<li><strong>max_supercell</strong> – Maximum size of supercell vectors with respect to primitive cell</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="abipy.core.structure.frames_from_structures">
<code class="descclassname">abipy.core.structure.</code><code class="descname">frames_from_structures</code><span class="sig-paren">(</span><em>struct_objects</em>, <em>index=None</em>, <em>with_spglib=True</em>, <em>cart_coords=False</em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.structure.frames_from_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Build two pandas dataframes with the most important geometrical parameters associated to
a list of structures or a list of objects that can be converted into structures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>struct_objects</strong> – List of objects that can be converted to structure.
Support filenames, structure objects, Abinit input files, dicts and many more types.
See <cite>Structure.as_structure</cite> for the complete list.</li>
<li><strong>index</strong> – Index of the dataframe.</li>
<li><strong>with_spglib</strong> – If True, spglib is invoked to get the spacegroup symbol and number.</li>
<li><strong>cart_coords</strong> – True if the <cite>coords</cite> dataframe should contain Cartesian cordinates
instead of Reduced coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt><cite>lattice</cite> contains the lattice parameters,</dt>
<dd><p class="first last"><cite>coords</cite> the atomic positions.</p>
</dd>
</dl>
<p>The list of structures is available in the <cite>structures</cite> entry.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">namedtuple with two pandas <code class="xref py py-class docutils literal"><span class="pre">DataFrame</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="abipy.core.structure.dataframes_from_structures">
<code class="descclassname">abipy.core.structure.</code><code class="descname">dataframes_from_structures</code><span class="sig-paren">(</span><em>struct_objects</em>, <em>index=None</em>, <em>with_spglib=True</em>, <em>cart_coords=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#dataframes_from_structures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.structure.dataframes_from_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Build two pandas dataframes with the most important geometrical parameters associated to
a list of structures or a list of objects that can be converted into structures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>struct_objects</strong> – List of objects that can be converted to structure.
Support filenames, structure objects, Abinit input files, dicts and many more types.
See <cite>Structure.as_structure</cite> for the complete list.</li>
<li><strong>index</strong> – Index of the dataframe.</li>
<li><strong>with_spglib</strong> – If True, spglib is invoked to get the spacegroup symbol and number.</li>
<li><strong>cart_coords</strong> – True if the <cite>coords</cite> dataframe should contain Cartesian cordinates
instead of Reduced coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt><cite>lattice</cite> contains the lattice parameters,</dt>
<dd><p class="first last"><cite>coords</cite> the atomic positions.</p>
</dd>
</dl>
<p>The list of structures is available in the <cite>structures</cite> entry.</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">namedtuple with two pandas <code class="xref py py-class docutils literal"><span class="pre">DataFrame</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.symmetries">
<span id="symmetries-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">symmetries</span></code> Module<a class="headerlink" href="#module-abipy.core.symmetries" title="Permalink to this headline">¶</a></h2>
<p>Objects used to deal with symmetry operations in crystals.</p>
<dl class="class">
<dt id="abipy.core.symmetries.LatticeRotation">
<em class="property">class </em><code class="descclassname">abipy.core.symmetries.</code><code class="descname">LatticeRotation</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.symmetries.Operation</span></code></p>
<p>This object defines a pure rotation of the lattice (proper, improper, mirror symmetry)
that is a rotation which is compatible with a lattice. The rotation matrix is
expressed in reduced coordinates, therefore its elements are integers.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><a class="reference external" href="http://xrayweb2.chem.ou.edu/notes/symmetry.html#rotation">http://xrayweb2.chem.ou.edu/notes/symmetry.html#rotation</a></dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This object is immutable and therefore we do not inherit from <cite>ndarray`</cite></p>
</div>
<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.det">
<code class="descname">det</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.det" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the determinant of a symmetry matrix mat[3,3]. It must be +-1</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.symmetries.LatticeRotation.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Invert an orthogonal 3x3 matrix of INTEGER elements.
Note use of integer arithmetic. Raise ValueError if not invertible.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.isE">
<code class="descname">isE</code><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.isE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.isE" title="Permalink to this definition">¶</a></dt>
<dd><p>True if it is the identity</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.isI">
<code class="descname">isI</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.isI" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self is the inversion operation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.is_proper">
<code class="descname">is_proper</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.is_proper" title="Permalink to this definition">¶</a></dt>
<dd><p>True if proper rotation</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.name">
<code class="descname">name</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.order">
<code class="descname">order</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order of the rotation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.root_inv">
<code class="descname">root_inv</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.root_inv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.LatticeRotation.trace">
<code class="descname">trace</code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>The trace of the rotation matrix</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.symmetries.AbinitSpaceGroup">
<em class="property">class </em><code class="descclassname">abipy.core.symmetries.</code><code class="descname">AbinitSpaceGroup</code><span class="sig-paren">(</span><em>spgid</em>, <em>symrel</em>, <em>tnons</em>, <em>symafm</em>, <em>has_timerev</em>, <em>inord='C'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">abipy.core.symmetries.OpSequence</span></code></p>
<p>Container storing the space group symmetries.</p>
<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.afm_symmops">
<code class="descname">afm_symmops</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.afm_symmops" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with antiferromagnetic symmetries.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.find_little_group">
<code class="descname">find_little_group</code><span class="sig-paren">(</span><em>kpoint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.find_little_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.find_little_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the little group of the kpoint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kpoint</strong> – Accept vector with the reduced coordinates or <code class="xref py py-class docutils literal"><span class="pre">Kpoint</span></code> object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">LittleGroup</span></code> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.fm_symmops">
<code class="descname">fm_symmops</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.fm_symmops" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of ferromagnetic symmetries.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>ncfile</em>, <em>inord='F'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a Netcdf file.</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.from_structure">
<em class="property">classmethod </em><code class="descname">from_structure</code><span class="sig-paren">(</span><em>structure</em>, <em>has_timerev=True</em>, <em>symprec=1e-05</em>, <em>angle_tolerance=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.from_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a <code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object. Uses spglib to perform various symmetry finding operations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> – <code class="xref py py-class docutils literal"><span class="pre">Structure</span></code> object</li>
<li><strong>has_timerev</strong> – True is time-reversal symmetry is included.</li>
<li><strong>symprec</strong> – Tolerance for symmetry finding</li>
<li><strong>angle_tolerance</strong> – Angle tolerance for symmetry finding.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">AFM symmetries are not supported.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.has_timerev">
<code class="descname">has_timerev</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.has_timerev" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time-reversal symmetry is present.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.is_symmorphic">
<code class="descname">is_symmorphic</code><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.is_symmorphic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.is_symmorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>True if there’s at least one operation with non-zero fractional translation.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.num_spatial_symmetries">
<code class="descname">num_spatial_symmetries</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.num_spatial_symmetries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symafm">
<code class="descname">symafm</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symafm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symmops">
<code class="descname">symmops</code><span class="sig-paren">(</span><em>time_sign=None</em>, <em>afm_sign=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.symmops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symmops" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time_sign</strong> – If specified, only symmetries with time-reversal sign time_sign are returned.</li>
<li><strong>afm_sign</strong> – If specified, only symmetries with anti-ferromagnetic part afm_sign are returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of <code class="xref py py-class docutils literal"><span class="pre">SymmOp</span></code> instances.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symrec">
<code class="descname">symrec</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symrec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symrel">
<code class="descname">symrel</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symrel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.tnons">
<code class="descname">tnons</code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.tnons" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.tensor">
<span id="tensor-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">tensor</span></code> Module<a class="headerlink" href="#module-abipy.core.tensor" title="Permalink to this headline">¶</a></h2>
<p>This module contains classes representing tensors and helper functions to change lattice.</p>
<dl class="class">
<dt id="abipy.core.tensor.Tensor">
<em class="property">class </em><code class="descclassname">abipy.core.tensor.</code><code class="descname">Tensor</code><span class="sig-paren">(</span><em>red_tensor</em>, <em>lattice</em>, <em>space='r'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#Tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.Tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Representation of a 3x3 tensor</p>
<dl class="attribute">
<dt id="abipy.core.tensor.Tensor.cartesian_tensor">
<code class="descname">cartesian_tensor</code><a class="headerlink" href="#abipy.core.tensor.Tensor.cartesian_tensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="abipy.core.tensor.Tensor.from_cartesian_tensor">
<em class="property">classmethod </em><code class="descname">from_cartesian_tensor</code><span class="sig-paren">(</span><em>cartesian_tensor</em>, <em>lattice</em>, <em>space='r'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#Tensor.from_cartesian_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.Tensor.from_cartesian_tensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.tensor.Tensor.is_real_space">
<code class="descname">is_real_space</code><a class="headerlink" href="#abipy.core.tensor.Tensor.is_real_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.tensor.Tensor.lattice">
<code class="descname">lattice</code><a class="headerlink" href="#abipy.core.tensor.Tensor.lattice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="abipy.core.tensor.Tensor.reduced_tensor">
<code class="descname">reduced_tensor</code><a class="headerlink" href="#abipy.core.tensor.Tensor.reduced_tensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.tensor.Tensor.symmetrize">
<code class="descname">symmetrize</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#Tensor.symmetrize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.Tensor.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.tensor.Tensor.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>verbose=0</em>, <em>with_reduced=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#Tensor.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.Tensor.to_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.tensor.SymmetricTensor">
<em class="property">class </em><code class="descclassname">abipy.core.tensor.</code><code class="descname">SymmetricTensor</code><span class="sig-paren">(</span><em>red_tensor</em>, <em>lattice</em>, <em>space='r'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#SymmetricTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.SymmetricTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.tensor.Tensor" title="abipy.core.tensor.Tensor"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.tensor.Tensor</span></code></a></p>
<p>Representation of a 3x3 symmetric tensor</p>
<dl class="classmethod">
<dt id="abipy.core.tensor.SymmetricTensor.from_directions">
<em class="property">classmethod </em><code class="descname">from_directions</code><span class="sig-paren">(</span><em>qpoints</em>, <em>values</em>, <em>lattice</em>, <em>space</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/tensor.html#SymmetricTensor.from_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.tensor.SymmetricTensor.from_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <cite>SymmetricTensor</cite> from the values computed along 6 directions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>qpoints</strong> – fractional coordinates of 6 independent q-directions</li>
<li><strong>values</strong> – values of (q^T E q)/(q^T q) along the 6 qpoints</li>
<li><strong>lattice</strong> – <cite>Lattice</cite> object defining the reference system</li>
<li><strong>space</strong> – “r” if the lattice is a real space lattice
“g” if the lattice is a reciprocal space lattice</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.testing">
<span id="testing-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">testing</span></code> Module<a class="headerlink" href="#module-abipy.core.testing" title="Permalink to this headline">¶</a></h2>
<p>Common test support for all abipy test scripts.</p>
<p>This single module should provide all the common functionality for abipy tests
in a single location, so that test scripts can just import it and work right away.</p>
<dl class="class">
<dt id="abipy.core.testing.AbipyTest">
<em class="property">class </em><code class="descclassname">abipy.core.testing.</code><code class="descname">AbipyTest</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pymatgen.org/pymatgen.util.testing.html#pymatgen.util.testing.PymatgenTest" title="(in pymatgen v2017.11.6)"><code class="xref py py-class docutils literal"><span class="pre">pymatgen.util.testing.PymatgenTest</span></code></a></p>
<p>Extends PymatgenTest with Abinit-specific methods</p>
<dl class="exception">
<dt id="abipy.core.testing.AbipyTest.SkipTest">
<em class="property">exception </em><code class="descname">SkipTest</code><a class="headerlink" href="#abipy.core.testing.AbipyTest.SkipTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Raise this exception in a test to skip it.</p>
<p>Usually you can use TestCase.skipTest() or one of the skipping decorators
instead of raising this directly.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_input">
<code class="descname">abivalidate_input</code><span class="sig-paren">(</span><em>abinput</em>, <em>must_fail=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of an Input object
Print info to stdout if failure before raising AssertionError.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_multi">
<code class="descname">abivalidate_multi</code><span class="sig-paren">(</span><em>multi</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_multi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of a <cite>MultiDataset</cite> or a list of input objects.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.assert_almost_equal">
<em class="property">static </em><code class="descname">assert_almost_equal</code><span class="sig-paren">(</span><em>actual</em>, <em>desired</em>, <em>decimal=7</em>, <em>err_msg=''</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_almost_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_almost_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative naming for assertArrayAlmostEqual.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.assert_equal">
<em class="property">static </em><code class="descname">assert_equal</code><span class="sig-paren">(</span><em>actual</em>, <em>desired</em>, <em>err_msg=''</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative naming for assertArrayEqual.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.assert_input_equality">
<em class="property">static </em><code class="descname">assert_input_equality</code><span class="sig-paren">(</span><em>ref_basename</em>, <em>input_to_test</em>, <em>rtol=1e-05</em>, <em>atol=1e-08</em>, <em>equal_nan=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_input_equality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_input_equality" title="Permalink to this definition">¶</a></dt>
<dd><p>Check equality between an input and a reference in test_files.
only input variables and structure are compared.
:param ref_basename: base name of the reference file to test against in test_files
:param input_to_test: AbinitInput object to test
:param rtol: passed to numpy.isclose for float comparison
:param atol: passed to numpy.isclose for float comparison
:param equal_nan: passed to numpy.isclose for float comparison</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">raises an assertion error if the two inputs are not the same</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.get_abistructure_from_abiref">
<em class="property">static </em><code class="descname">get_abistructure_from_abiref</code><span class="sig-paren">(</span><em>basename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_abistructure_from_abiref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_abistructure_from_abiref" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an Abipy structure from the basename of one of the reference files.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.get_mock_module">
<em class="property">static </em><code class="descname">get_mock_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_mock_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_mock_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return mock module for testing. Raises ImportError if not found.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.get_tmpname">
<em class="property">static </em><code class="descname">get_tmpname</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_tmpname"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_tmpname" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke mkstep with kwargs, return the name of a temporary file.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_abinit">
<em class="property">static </em><code class="descname">has_abinit</code><span class="sig-paren">(</span><em>version=None</em>, <em>op='&gt;='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_abinit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_abinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if abinit is in $PATH and version is op min_version.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_ase">
<em class="property">static </em><code class="descname">has_ase</code><span class="sig-paren">(</span><em>version=None</em>, <em>op='&gt;='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_ase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_ase" title="Permalink to this definition">¶</a></dt>
<dd><p>True if ASE package is available.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_ipywidgets">
<em class="property">static </em><code class="descname">has_ipywidgets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_ipywidgets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_ipywidgets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if ipywidgets is available.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_matplotlib">
<em class="property">static </em><code class="descname">has_matplotlib</code><span class="sig-paren">(</span><em>version=None</em>, <em>op='&gt;='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_matplotlib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_matplotlib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyTest.has_mayavi">
<code class="descname">has_mayavi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_mayavi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_mayavi" title="Permalink to this definition">¶</a></dt>
<dd><p>True if Mayavi is available. Set also offscreen to True</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_nbformat">
<em class="property">static </em><code class="descname">has_nbformat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_nbformat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_nbformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if nbformat is available and we can test the generation of ipython notebooks.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.has_seaborn">
<em class="property">static </em><code class="descname">has_seaborn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_seaborn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_seaborn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.json_read_abinit_input">
<em class="property">static </em><code class="descname">json_read_abinit_input</code><span class="sig-paren">(</span><em>json_basename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.json_read_abinit_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.json_read_abinit_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an AbinitInput from the basename of the file in abipy/data/test_files.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.mkdtemp">
<em class="property">static </em><code class="descname">mkdtemp</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.mkdtemp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.mkdtemp" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke mkdtep with kwargs, return the name of a temporary directory.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_abinit">
<em class="property">static </em><code class="descname">skip_if_not_abinit</code><span class="sig-paren">(</span><em>version=None</em>, <em>op='&gt;='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_abinit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_abinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if the specified version of abinit is not installed.
Use <cite>version</cite> and <cite>op</cite> to ask for a specific version</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_phonopy">
<em class="property">static </em><code class="descname">skip_if_not_phonopy</code><span class="sig-paren">(</span><em>version=None</em>, <em>op='&gt;='</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_phonopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_phonopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if phonopy is not installed.
Use <cite>version</cite> and <cite>op</cite> to ask for a specific version</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_pseudodojo">
<em class="property">static </em><code class="descname">skip_if_not_pseudodojo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_pseudodojo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_pseudodojo" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if pseudodojo package is not installed.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.straceback">
<em class="property">static </em><code class="descname">straceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.straceback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.straceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with the traceback.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.tmpfileindir">
<em class="property">static </em><code class="descname">tmpfileindir</code><span class="sig-paren">(</span><em>basename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.tmpfileindir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.tmpfileindir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute path of a temporary file with basename <cite>basename</cite> created in a temporary directory.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyTest.which">
<em class="property">static </em><code class="descname">which</code><span class="sig-paren">(</span><em>program</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.which"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.which" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns full path to a executable. None if not found or not executable.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.testing.AbipyFileTest">
<em class="property">class </em><code class="descclassname">abipy.core.testing.</code><code class="descname">AbipyFileTest</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.testing.AbipyTest" title="abipy.core.testing.AbipyTest"><code class="xref py py-class docutils literal"><span class="pre">abipy.core.testing.AbipyTest</span></code></a></p>
<p>Test class for files with a __str__ attribute.
At setup, must set the ‘file’ attribute of the AbipyFileTest.</p>
<dl class="method">
<dt id="abipy.core.testing.AbipyFileTest.assertContains">
<code class="descname">assertContains</code><span class="sig-paren">(</span><em>expression</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest.assertContains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.assertContains" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that the string representation of the file contains ‘expression’
‘expression’ is trimmed of leading new line.
Each line of ‘expression’ is trimmed of blank spaces.
Empty lines are ignored.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyFileTest.assertContainsNot">
<code class="descname">assertContainsNot</code><span class="sig-paren">(</span><em>expression</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest.assertContainsNot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.assertContainsNot" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that the string representation of the file does not contain
‘expression’.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyFileTest.assertEmpty">
<code class="descname">assertEmpty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest.assertEmpty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.assertEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert the string representation is empty.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.testing.AbipyFileTest.assertOrder">
<code class="descname">assertOrder</code><span class="sig-paren">(</span><em>expression1</em>, <em>expression2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest.assertOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.assertOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that the string representation of the file
contains ‘expression1’ before ‘expression2’.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.testing.AbipyFileTest.file">
<code class="descname">file</code><em class="property"> = None</em><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="abipy.core.testing.AbipyFileTest.normalize">
<em class="property">static </em><code class="descname">normalize</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyFileTest.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.testing.AbipyFileTest.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.wyckoff">
<span id="wyckoff-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">wyckoff</span></code> Module<a class="headerlink" href="#module-abipy.core.wyckoff" title="Permalink to this headline">¶</a></h2>
<p>This module provides functions to generate crystalline structures from Wyckoff positions
or to retrieve Wyckoff parameters from a given structure.</p>
<dl class="class">
<dt id="abipy.core.wyckoff.Wyckoff">
<em class="property">class </em><code class="descclassname">abipy.core.wyckoff.</code><code class="descname">Wyckoff</code><span class="sig-paren">(</span><em>site2wpos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#Wyckoff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.Wyckoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="abipy.core.wyckoff.Wyckoff.error_of_params">
<code class="descname">error_of_params</code><span class="sig-paren">(</span><em>params</em>, <em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#Wyckoff.error_of_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.Wyckoff.error_of_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="abipy.core.wyckoff.Wyckoff.find_params">
<code class="descname">find_params</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#Wyckoff.find_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.Wyckoff.find_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the parameter given a Structure object.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.wyckoff.Wyckoff.generate_structure">
<code class="descname">generate_structure</code><span class="sig-paren">(</span><em>lattice</em>, <em>site2params</em>, <em>to_unit_cell=False</em>, <em>struct_cls=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#Wyckoff.generate_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.Wyckoff.generate_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate structure object from <cite>lattice</cite> and dictionary <cite>site2params</cite></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="abipy.core.wyckoff.WyckoffPositions">
<em class="property">class </em><code class="descclassname">abipy.core.wyckoff.</code><code class="descname">WyckoffPositions</code><span class="sig-paren">(</span><em>matrix_str</em>, <em>letter=None</em>, <em>site_symmetry=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#WyckoffPositions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">collections.abc.Sequence</span></code></p>
<p>A numpy array with sympy expression.</p>
<dl class="method">
<dt id="abipy.core.wyckoff.WyckoffPositions.error_of_params">
<code class="descname">error_of_params</code><span class="sig-paren">(</span><em>params</em>, <em>frac_coords</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#WyckoffPositions.error_of_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.error_of_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array with the difference between the
wyckoff positions computed from the sympy expressions and the input frac_coords</p>
</dd></dl>

<dl class="classmethod">
<dt id="abipy.core.wyckoff.WyckoffPositions.from_string">
<em class="property">classmethod </em><code class="descname">from_string</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#WyckoffPositions.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from string <cite>s</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.wyckoff.WyckoffPositions.mult">
<code class="descname">mult</code><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.mult" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplicity</p>
</dd></dl>

<dl class="attribute">
<dt id="abipy.core.wyckoff.WyckoffPositions.num_params">
<code class="descname">num_params</code><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.num_params" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of parameters.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.wyckoff.WyckoffPositions.params_from_frac_coords">
<code class="descname">params_from_frac_coords</code><span class="sig-paren">(</span><em>frac_coords</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#WyckoffPositions.params_from_frac_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.params_from_frac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Wyckoff parameters from the fractional coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="abipy.core.wyckoff.WyckoffPositions.ravel">
<code class="descname">ravel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/wyckoff.html#WyckoffPositions.ravel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#abipy.core.wyckoff.WyckoffPositions.ravel" title="Permalink to this definition">¶</a></dt>
<dd><p>Flat list, similar to np.ravel</p>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, The AbiPy group.<br/>
      Last updated on Nov 08, 2017.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>