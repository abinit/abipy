

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>core Package &mdash; abipy 0.9.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_style.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
    <script type="text/javascript" src="https://cdn.plot.ly/plotly-latest.min.js"></script> 
    
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="data Package" href="data_api.html" />
    <link rel="prev" title="abio Package" href="abio_api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> abipy
          

          
          </a>

          
            
            
              <div class="version">
                0.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting AbiPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzbiblio.html">Bibliography</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphical_interface.html">Graphical interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">AbiPy Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing_howto.html">Post-processing How-To</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflows/taskmanager.html">TaskManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/manager_examples.html">Manager Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow_gallery/index.html">Flow Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flows_howto.html">Flows How-To</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="abilab_api.html">abilab</a></li>
<li class="toctree-l2"><a class="reference internal" href="abio_api.html">abio Package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">core Package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code> Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.abinit_units"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abinit_units</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.fields"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fields</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.func1d"><code class="xref py py-mod docutils literal notranslate"><span class="pre">func1d</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.globals"><code class="xref py py-mod docutils literal notranslate"><span class="pre">globals</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.gsphere"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsphere</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.irrepsdb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">irrepsdb</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.kpoints"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kpoints</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.mesh3d"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh3d</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.mixins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mixins</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.restapi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">restapi</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.skw"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skw</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">structure</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.symmetries"><code class="xref py py-mod docutils literal notranslate"><span class="pre">symmetries</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">testing</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-abipy.core.site_symmetries"><code class="xref py py-mod docutils literal notranslate"><span class="pre">site_symmetries</span></code> Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_api.html">data Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dfpt_api.html">dfpt Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="display_api.html">display Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics_api.html">dynamics Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="electrons_api.html">electrons Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="eph_api.html">eph Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="flowtk_api.html">flowtk Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="iotools_api.html">iotools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="panels_api.html">panels Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools_api.html">tools Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="waves_api.html">waves Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wannier90_api.html">wannier90 Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guide.html">Coding guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting AbiPy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">abipy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API documentation</a> &raquo;</li>
        
      <li>core Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/core_api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core-package">
<h1><a class="toc-backref" href="#contents">core Package</a><a class="headerlink" href="#core-package" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#core-package" id="id14">core Package</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id15"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code> Package</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.abinit_units" id="id16"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abinit_units</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.fields" id="id17"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fields</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.func1d" id="id18"><code class="xref py py-mod docutils literal notranslate"><span class="pre">func1d</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.globals" id="id19"><code class="xref py py-mod docutils literal notranslate"><span class="pre">globals</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.gsphere" id="id20"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsphere</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.irrepsdb" id="id21"><code class="xref py py-mod docutils literal notranslate"><span class="pre">irrepsdb</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.kpoints" id="id22"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kpoints</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.mesh3d" id="id23"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh3d</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.mixins" id="id24"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mixins</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.restapi" id="id25"><code class="xref py py-mod docutils literal notranslate"><span class="pre">restapi</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.skw" id="id26"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skw</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.structure" id="id27"><code class="xref py py-mod docutils literal notranslate"><span class="pre">structure</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.symmetries" id="id28"><code class="xref py py-mod docutils literal notranslate"><span class="pre">symmetries</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.testing" id="id29"><code class="xref py py-mod docutils literal notranslate"><span class="pre">testing</span></code> Module</a></p></li>
<li><p><a class="reference internal" href="#module-abipy.core.site_symmetries" id="id30"><code class="xref py py-mod docutils literal notranslate"><span class="pre">site_symmetries</span></code> Module</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code> Package</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-abipy.core"></span><p>Core objects.</p>
</div>
<div class="section" id="module-abipy.core.abinit_units">
<span id="abinit-units-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">abinit_units</span></code> Module</a><a class="headerlink" href="#module-abipy.core.abinit_units" title="Permalink to this headline">¶</a></h2>
<p>This module defines constants and conversion factors matching those present in abinit that can be used when
it is important to preserve consistency with the results produced by abinit.</p>
<dl class="py function">
<dt id="abipy.core.abinit_units.phfactor_ev2units">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">phfactor_ev2units</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#phfactor_ev2units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.phfactor_ev2units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return conversion factor eV –&gt; units for phonons (case-insensitive)</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.abinit_units.phunit_tag">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">phunit_tag</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unicode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#phunit_tag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.phunit_tag" title="Permalink to this definition">¶</a></dt>
<dd><p>Mainly used for phonons.
Return latex string from <code class="docutils literal notranslate"><span class="pre">units</span></code>.
If unicode is True, replace Latex superscript with unitcode.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.abinit_units.wlabel_from_units">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">wlabel_from_units</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unicode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#wlabel_from_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.wlabel_from_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return latex string for phonon frequencies in <code class="docutils literal notranslate"><span class="pre">units</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.abinit_units.phdos_label_from_units">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">phdos_label_from_units</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unicode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#phdos_label_from_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.phdos_label_from_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return latex string for phonon DOS values in <code class="docutils literal notranslate"><span class="pre">units</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.abinit_units.s2itup">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">s2itup</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#s2itup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.s2itup" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert string in the form <code class="docutils literal notranslate"><span class="pre">xx</span></code>, <code class="docutils literal notranslate"><span class="pre">xyz</span></code> into tuple of two (three) indices
that can be used to slice susceptibility tensors (numpy array).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s2itup</span><span class="p">(</span><span class="s2">&quot;yy&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s2itup</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.abinit_units.itup2s">
<code class="sig-prename descclassname"><span class="pre">abipy.core.abinit_units.</span></code><code class="sig-name descname"><span class="pre">itup2s</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/abinit_units.html#itup2s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.abinit_units.itup2s" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert tuple of 2 (3) integers into string in the form <code class="docutils literal notranslate"><span class="pre">xx</span></code> (<code class="docutils literal notranslate"><span class="pre">xyz</span></code>).
Assume C-indexing e.g. 0 –&gt; x</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">itup2s</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">itup2s</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;xyz&quot;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.fields">
<span id="fields-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fields</span></code> Module</a><a class="headerlink" href="#module-abipy.core.fields" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class describing densities in real space on uniform 3D meshes.</p>
<dl class="py class">
<dt id="abipy.core.fields.Density">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.fields.</span></code><code class="sig-name descname"><span class="pre">Density</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.fields._DensityField</span></code></p>
<p>Electronic density.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike in Abinit, datar[nspden] contains the up/down components if nsppol = 2</p>
</div>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-1209aed2c23905ce4171fd8d42516cc588344088.png" alt="Inheritance diagram of Density" usemap="#inheritancebce6f28259" class="inheritance graphviz" /></div>
<map id="inheritancebce6f28259" name="inheritancebce6f28259">
<area shape="rect" id="node1" href="#abipy.core.fields.Density" target="_top" title="Electronic density." alt="" coords="5,5,170,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.fields.Density.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'density'</span></em><a class="headerlink" href="#abipy.core.fields.Density.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.fields.Density.latex_label">
<code class="sig-name descname"><span class="pre">latex_label</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'Density</span> <span class="pre">[$e/A^3$]'</span></em><a class="headerlink" href="#abipy.core.fields.Density.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.ae_core_density_on_mesh">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">ae_core_density_on_mesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valence_density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhoc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'get_sites_in_sphere'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_dist_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_dist_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.ae_core_density_on_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.ae_core_density_on_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the all electron core density of the structure from the pseudopotentials <em>rhoc</em> files.
For points close to the atoms, the value at the grid point would be defined as the average on a finer grid
in the neghibourhood of the point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>valence_density</strong> – a Density object representing the valence charge density</p></li>
<li><p><strong>structure</strong> – the structure for which the total core density will be calculated</p></li>
<li><p><strong>rhoc</strong> – <em>rhoc</em> files for the elements in structure. Can be a list with len=len(structure) or a
dictionary {element: rhoc}. Distances should be in Angstrom and densities in e/A^3.</p></li>
<li><p><strong>maxr</strong> – maximum radius for the distance between grid points and atoms.</p></li>
<li><p><strong>nelec</strong> – if given a check will be perfomed to verify that the integrated density will be within 1% error
with respect to nelec. The total density will also be rescaled to fit exactly the given number.</p></li>
<li><p><strong>tol</strong> – tolerance above which the system will raise an exception if the integrated density doesn’t sum up
to the value specified in nelec. Default 0.01 (1% error).</p></li>
<li><p><strong>method</strong> – <p>different methods to perform the calculation:</p>
<ul>
<li><p>get_sites_in_sphere: based on <code class="docutils literal notranslate"><span class="pre">Structure.get_sites_in_sphere</span></code>.</p></li>
<li><dl class="simple">
<dt>mesh3d_dist_gridpoints: based on <code class="docutils literal notranslate"><span class="pre">Mesh3D.dist_gridpoints_in_spheres</span></code>. Generally faster than</dt><dd><p><code class="docutils literal notranslate"><span class="pre">get_sites_in_sphere</span></code>, but tests can be made for specific cases.</p>
</dd>
</dl>
</li>
<li><p>get_sites_in_sphere_legacy: as get_sites_in_sphere, but part of the procedure is not vectorized</p></li>
<li><p>mesh3d_dist_gridpoints_legacy: as mesh3d_dist_gridpoints, but part of the procedure is not vectorized</p></li>
</ul>
</p></li>
<li><p><strong>small_dist_mesh</strong> – defines the finer mesh.</p></li>
<li><p><strong>small_dist_factor</strong> – defines the maximum distance for which a point should be considered close enough to
switch to the finer grid method. Note that this is a factor, the distance is defined with respect
to the size of the cell.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.get_nelect">
<code class="sig-name descname"><span class="pre">get_nelect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.get_nelect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.get_nelect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of electrons with given spin.</p>
<p>If spin is None, the total number of electrons is computed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.total_rhor">
<code class="sig-name descname"><span class="pre">total_rhor</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhor" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the total density in real space on the FFT mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.total_rhor_as_density">
<code class="sig-name descname"><span class="pre">total_rhor_as_density</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhor_as_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhor_as_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#abipy.core.fields.Density" title="abipy.core.fields.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> object with the total density.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.total_rhog">
<code class="sig-name descname"><span class="pre">total_rhog</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.total_rhog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.total_rhog" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the total density in G-space.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.magnetization_field">
<code class="sig-name descname"><span class="pre">magnetization_field</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.magnetization_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.magnetization_field" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the magnetization field in real space on the FFT mesh:</p>
<blockquote>
<div><ul class="simple">
<li><p>0 if spin-unpolarized calculation</p></li>
<li><p>spin_up - spin_down if collinear spin-polarized</p></li>
<li><p>numpy array with (mx, my, mz) components if non-collinear magnetism</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.magnetization">
<code class="sig-name descname"><span class="pre">magnetization</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.magnetization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.magnetization" title="Permalink to this definition">¶</a></dt>
<dd><p>Magnetization field integrated over the unit cell.
Scalar if collinear, vector with (mx, my, mz) components if non-collinear.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.nelect_updown">
<code class="sig-name descname"><span class="pre">nelect_updown</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.nelect_updown"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.nelect_updown" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with the number of electrons in the up/down channel.
Return (None, None) if non-collinear.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.zeta">
<code class="sig-name descname"><span class="pre">zeta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.zeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.zeta" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with Magnetization(r) / total_density(r)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.export_to_cube">
<code class="sig-name descname"><span class="pre">export_to_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'total'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.export_to_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.export_to_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Export real space density to CUBE file <code class="docutils literal notranslate"><span class="pre">filename</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.from_cube">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_cube</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'total'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.from_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.from_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Read real space density to CUBE file <code class="docutils literal notranslate"><span class="pre">filename</span></code>.
Return new <a class="reference internal" href="#abipy.core.fields.Density" title="abipy.core.fields.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> instance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.to_chgcar">
<code class="sig-name descname"><span class="pre">to_chgcar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.to_chgcar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.to_chgcar" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a <a class="reference internal" href="#abipy.core.fields.Density" title="abipy.core.fields.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> object into a <code class="docutils literal notranslate"><span class="pre">Chgar</span></code> object.
If <code class="docutils literal notranslate"><span class="pre">filename</span></code> is not None, density is written to this file in Chgar format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Chgcar</span></code> instance.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From: <a class="reference external" href="http://cms.mpi.univie.ac.at/vasp/vasp/CHGCAR_file.html">http://cms.mpi.univie.ac.at/vasp/vasp/CHGCAR_file.html</a>:</p>
<p>This file contains the total charge density multiplied by the volume
For spinpolarized calculations, two sets of data can be found in the CHGCAR file.
The first set contains the total charge density (spin up plus spin down),
the second one the magnetization density (spin up minus spin down).
For non collinear calculations the CHGCAR file contains the total charge density
and the magnetisation density in the x, y and z direction in this order.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.fields.Density.from_chgcar_poscar">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_chgcar_poscar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chgcar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poscar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#Density.from_chgcar_poscar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.Density.from_chgcar_poscar" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a :class`Density` object from Vasp data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chgcar</strong> – Either string with the name of a CHGCAR file or <code class="xref py py-class docutils literal notranslate"><span class="pre">Chgcar</span></code> pymatgen object.</p></li>
<li><p><strong>poscar</strong> – Either string with the name of a POSCAR file or <code class="xref py py-class docutils literal notranslate"><span class="pre">Poscar</span></code> pymatgen object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.fields.VxcPotential">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.fields.</span></code><code class="sig-name descname"><span class="pre">VxcPotential</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VxcPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.VxcPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>XC Potential.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-806c42b62f9dba2f616aa913c2a5e6dc725ef9a0.png" alt="Inheritance diagram of VxcPotential" usemap="#inheritance6807b9abe3" class="inheritance graphviz" /></div>
<map id="inheritance6807b9abe3" name="inheritance6807b9abe3">
<area shape="rect" id="node1" href="#abipy.core.fields.VxcPotential" target="_top" title="XC Potential." alt="" coords="5,5,200,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.fields.VxcPotential.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'exchange_correlation_potential'</span></em><a class="headerlink" href="#abipy.core.fields.VxcPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.fields.VxcPotential.latex_label">
<code class="sig-name descname"><span class="pre">latex_label</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vxc</span> <span class="pre">$[eV/A^3]$'</span></em><a class="headerlink" href="#abipy.core.fields.VxcPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.fields.VhartreePotential">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.fields.</span></code><code class="sig-name descname"><span class="pre">VhartreePotential</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VhartreePotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.VhartreePotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree Potential.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-b7847c09e552cef42bbfc25484f782b1bfae5c0b.png" alt="Inheritance diagram of VhartreePotential" usemap="#inheritancee5c0659e66" class="inheritance graphviz" /></div>
<map id="inheritancee5c0659e66" name="inheritancee5c0659e66">
<area shape="rect" id="node1" href="#abipy.core.fields.VhartreePotential" target="_top" title="Hartree Potential." alt="" coords="5,5,229,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.fields.VhartreePotential.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vhartree'</span></em><a class="headerlink" href="#abipy.core.fields.VhartreePotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.fields.VhartreePotential.latex_label">
<code class="sig-name descname"><span class="pre">latex_label</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vh</span> <span class="pre">$[eV/A^3]$'</span></em><a class="headerlink" href="#abipy.core.fields.VhartreePotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.fields.VhxcPotential">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.fields.</span></code><code class="sig-name descname"><span class="pre">VhxcPotential</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VhxcPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.VhxcPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree + XC</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-1792f179bb19486f375efef94bb50faaf7ddde3c.png" alt="Inheritance diagram of VhxcPotential" usemap="#inheritance167215d95e" class="inheritance graphviz" /></div>
<map id="inheritance167215d95e" name="inheritance167215d95e">
<area shape="rect" id="node1" href="#abipy.core.fields.VhxcPotential" target="_top" title="Hartree + XC" alt="" coords="5,5,207,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.fields.VhxcPotential.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vhxc'</span></em><a class="headerlink" href="#abipy.core.fields.VhxcPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.fields.VhxcPotential.latex_label">
<code class="sig-name descname"><span class="pre">latex_label</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vhxc</span> <span class="pre">$[eV/A^3]$'</span></em><a class="headerlink" href="#abipy.core.fields.VhxcPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.fields.VksPotential">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.fields.</span></code><code class="sig-name descname"><span class="pre">VksPotential</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspinor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsppol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/fields.html#VksPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.fields.VksPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.fields._PotentialField</span></code></p>
<p>Hartree + XC + sum of local pseudo-potential terms.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-fbff6aad68f01bab72fd7a323261ddb434a6bf4c.png" alt="Inheritance diagram of VksPotential" usemap="#inheritanceb24c6df877" class="inheritance graphviz" /></div>
<map id="inheritanceb24c6df877" name="inheritanceb24c6df877">
<area shape="rect" id="node1" href="#abipy.core.fields.VksPotential" target="_top" title="Hartree + XC + sum of local pseudo&#45;potential terms." alt="" coords="5,5,200,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.fields.VksPotential.netcdf_name">
<code class="sig-name descname"><span class="pre">netcdf_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vtrial'</span></em><a class="headerlink" href="#abipy.core.fields.VksPotential.netcdf_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.fields.VksPotential.latex_label">
<code class="sig-name descname"><span class="pre">latex_label</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'vks</span> <span class="pre">$[eV/A^3]$'</span></em><a class="headerlink" href="#abipy.core.fields.VksPotential.latex_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.func1d">
<span id="func1d-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">func1d</span></code> Module</a><a class="headerlink" href="#module-abipy.core.func1d" title="Permalink to this headline">¶</a></h2>
<p>Function1D describes a function of a single variable and provides an easy-to-use API
for performing common tasks such as algebraic operations, integrations, differentiations, plots …</p>
<dl class="py class">
<dt id="abipy.core.func1d.Function1D">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.func1d.</span></code><code class="sig-name descname"><span class="pre">Function1D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Immutable object representing a (real|complex) function of real variable.</p>
<dl class="py method">
<dt id="abipy.core.func1d.Function1D.from_constant">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_constant</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a constant function from the mesh and the scalar <code class="docutils literal notranslate"><span class="pre">const</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.mesh">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">mesh</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.mesh" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the mesh points</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.values">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">values</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values of the functions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.real">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">real</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.real" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> with the real part of self.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.imag">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">imag</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> with the imaginary part of self.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.conjugate">
<code class="sig-name descname"><span class="pre">conjugate</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.conjugate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> with the complex conjugate.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.abs">
<code class="sig-name descname"><span class="pre">abs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> with the absolute value.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.from_func">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_func</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the object from a callable.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p>Function1D.from_func(np.sin, mesh=np.arange(1,10))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usecols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an instance by reading data from path (txt format)
see also <code class="xref py py-func docutils literal notranslate"><span class="pre">np.loadtxt()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Path to the file containing data.</p></li>
<li><p><strong>comments</strong> – The character used to indicate the start of a comment; default: ‘#’.</p></li>
<li><p><strong>delimiter</strong> – str, optional The string used to separate values. By default, this is any whitespace.</p></li>
<li><p><strong>usecols</strong> – sequence, optional. Which columns to read, with 0 being the first.
For example, usecols = (1,4) will extract data from the 2nd, and 5th columns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.to_file">
<code class="sig-name descname"><span class="pre">to_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%.18e'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data in a text file. Use format fmr. A header is added at the beginning.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.has_same_mesh">
<code class="sig-name descname"><span class="pre">has_same_mesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.has_same_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.has_same_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self and other have the same mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.bma">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">bma</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.bma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return b-a. f(x) is defined in [a,b]</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.max">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">max</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Max of f(x) if f is real, max of <span class="math notranslate nohighlight">\(|f(x)|\)</span> if complex.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.min">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">min</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Min of f(x) if f is real, min of <span class="math notranslate nohighlight">\(|f(x)|\)</span> if complex.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.iscomplexobj">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">iscomplexobj</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.iscomplexobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if values is array of complex numbers.
The type of the input is checked, not the value. Even if the input
has an imaginary part equal to zero, <cite>np.iscomplexobj</cite> evaluates to True.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.h">
<code class="sig-name descname"><span class="pre">h</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.h" title="Permalink to this definition">¶</a></dt>
<dd><p>The spacing of the mesh. None if mesh is not homogeneous.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.dx">
<code class="sig-name descname"><span class="pre">dx</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.dx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.dx" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of len(self) - 1 elements giving the distance between two
consecutive points of the mesh, i.e. dx[i] = ||x[i+1] - x[i]||.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.find_mesh_index">
<code class="sig-name descname"><span class="pre">find_mesh_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.find_mesh_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.find_mesh_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the first point in the mesh whose value is &gt;= value
-1 if not found</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.finite_diff">
<code class="sig-name descname"><span class="pre">finite_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.finite_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivatives by finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> – Order of the derivative.</p></li>
<li><p><strong>acc</strong> – Accuracy. 4 is fine in many cases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> instance with the derivative.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.integral">
<code class="sig-name descname"><span class="pre">integral</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Cumulatively integrate y(x) from start to stop using the composite trapezoidal rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> with <span class="math notranslate nohighlight">\(\int y(x) dx\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.spline">
<code class="sig-name descname"><span class="pre">spline</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Cubic spline with s=0</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.spline_roots">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">spline_roots</span></code><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeros of the spline.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.spline_on_mesh">
<code class="sig-name descname"><span class="pre">spline_on_mesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_on_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_on_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Spline the function on the given mesh, returns <a class="reference internal" href="#abipy.core.func1d.Function1D" title="abipy.core.func1d.Function1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function1D</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.spline_derivatives">
<code class="sig-name descname"><span class="pre">spline_derivatives</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all derivatives of the spline at point x.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.spline_integral">
<code class="sig-name descname"><span class="pre">spline_integral</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.spline_integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.spline_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the definite integral of the spline of f between two given points a and b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – First point. mesh[0] if a is None</p></li>
<li><p><strong>b</strong> – Last point. mesh[-1] if a is None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.integral_value">
<code class="sig-name descname"><span class="pre">integral_value</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.integral_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.integral_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\int f(x) dx\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.l1_norm">
<code class="sig-name descname"><span class="pre">l1_norm</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.l1_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.l1_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\int |f(x)| dx\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.l2_norm">
<code class="sig-name descname"><span class="pre">l2_norm</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.l2_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.l2_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\(\sqrt{\int |f(x)|^2 dx}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.fft">
<code class="sig-name descname"><span class="pre">fft</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FFT transform (negative sign).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.ifft">
<code class="sig-name descname"><span class="pre">ifft</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the FFT transform <span class="math notranslate nohighlight">\(\int e+i\)</span></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.plot_ax">
<code class="sig-name descname"><span class="pre">plot_ax</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.plot_ax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.plot_ax" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot self on axis ax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange the axis in the plot.</p></li>
<li><p><strong>args</strong> – Positional arguments passed to ax.plot</p></li>
<li><p><strong>xfactor</strong> – xvalues and yvalues are multiplied by this factor before plotting.</p></li>
<li><p><strong>yfactor</strong> – xvalues and yvalues are multiplied by this factor before plotting.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Accepts</p></li>
</ul>
</dd>
</dl>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cplx_mode</p></td>
<td><p>string defining the data to print.
Possible choices are (case-insensitive): <cite>re</cite> for the real part
“im” for the imaginary part, “abs” for the absolute value.
“angle” to display the phase of the complex number in radians.
Options can be concatenated with “-“</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of lines added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.plotly_traces">
<code class="sig-name descname"><span class="pre">plotly_traces</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exchange_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.plotly_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.plotly_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to plot the function with plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">plotly.graph_objects.Figure</span></code>.</p></li>
<li><p><strong>rcd</strong> – PlotlyRowColDesc object used when fig is not None to specify the (row, col) of the subplot in the grid.</p></li>
<li><p><strong>exchange_xy</strong> – True to exchange the x and y in the plot.</p></li>
<li><p><strong>xfactor</strong> – xvalues and yvalues are multiplied by this factor before plotting.</p></li>
<li><p><strong>yfactor</strong> – xvalues and yvalues are multiplied by this factor before plotting.</p></li>
<li><p><strong>args</strong> – Positional arguments passed to ‘plotly.graph_objects.Scatter’</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to ‘plotly.graph_objects.Scatter’.
Accepts also AbiPy specific kwargs:</p></li>
</ul>
</dd>
</dl>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cplx_mode</p></td>
<td><p>string defining the data to print.
Possible choices are (case-insensitive): <cite>re</cite> for the real part
“im” for the imaginary part, “abs” for the absolute value.
“angle” to display the phase of the complex number in radians.
Options can be concatenated with “-“</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.func1d.Function1D.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/func1d.html#Function1D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.func1d.Function1D.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the function with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p>
</dd>
</dl>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>exchange_xy</p></td>
<td><p>True to exchange x- and y-axis (default: False)</p></td>
</tr>
</tbody>
</table>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.globals">
<span id="globals-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">globals</span></code> Module</a><a class="headerlink" href="#module-abipy.core.globals" title="Permalink to this headline">¶</a></h2>
<p>Global variables used to initialize AbiPy environment in notebooks.</p>
<dl class="py function">
<dt id="abipy.core.globals.in_notebook">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">in_notebook</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#in_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.in_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>True if we are running inside a jupyter notebook (and enable_notebook has been called).</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.globals.disable_notebook">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">disable_notebook</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#disable_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.disable_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="docutils literal notranslate"><span class="pre">in_notebook</span></code> flag to False.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.globals.enable_notebook">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">enable_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_seaborn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#enable_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.enable_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="docutils literal notranslate"><span class="pre">in_notebook</span></code> flag to True and activate seaborn settings for notebooks if <code class="docutils literal notranslate"><span class="pre">with_seaborn</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.globals.get_abinb_workdir">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">get_abinb_workdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#get_abinb_workdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.get_abinb_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute path of the scratch directory used to produce
and save temporary files when we are runnning inside a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook.</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.globals.abinb_mkstemp">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">abinb_mkstemp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_abinb_workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_relpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#abinb_mkstemp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.abinb_mkstemp" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke mkstep with kwargs, return the (fd, name) of the temporary file.
kwargs are passed to <code class="docutils literal notranslate"><span class="pre">mkstemp</span></code> except for <code class="docutils literal notranslate"><span class="pre">dir</span></code> if we are inside a jupyter notebook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_abipy_nbworkdir</strong> – </p></li>
<li><p><strong>use_relpath</strong> – Return relative path (os.path.relpath) if True else absolute (default)
Relative paths are required if we are gonna use the temporary file in
notebooks or in web browers.
In this case, the caller is responsbile for calling the function with the correct flag.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.globals.get_workdir">
<code class="sig-prename descclassname"><span class="pre">abipy.core.globals.</span></code><code class="sig-name descname"><span class="pre">get_workdir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/globals.html#get_workdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.globals.get_workdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return temporary directory if workdir is None else workdir.
Allow users to specify the temporary directory via ABIPY_TMPDIR env variable.</p>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.gsphere">
<span id="gsphere-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsphere</span></code> Module</a><a class="headerlink" href="#module-abipy.core.gsphere" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class defining the G-sphere for wavefunctions, densities and potentials</p>
<dl class="py class">
<dt id="abipy.core.gsphere.GSphere">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.gsphere.</span></code><code class="sig-name descname"><span class="pre">GSphere</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istwfk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a></p>
<p>Descriptor-class for the G-sphere.</p>
<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.gvecs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">gvecs</span></code><a class="headerlink" href="#abipy.core.gsphere.GSphere.gvecs" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the G-vectors in reduced coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.index">
<code class="sig-name descname"><span class="pre">index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gvec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.index" title="Permalink to this definition">¶</a></dt>
<dd><p>return the index of the G-vector <code class="docutils literal notranslate"><span class="pre">gvec</span></code> in self.
Raises: <cite>ValueError</cite> if the value is not present.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.count">
<code class="sig-name descname"><span class="pre">count</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gvec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of occurrences of gvec.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>shallow copy.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.zeros">
<code class="sig-name descname"><span class="pre">zeros</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em>, <em class="sig-param"><span class="pre">extra_dims=()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.zeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 1D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
<p>The type can be set with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal notranslate"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.czeros">
<code class="sig-name descname"><span class="pre">czeros</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.czeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.czeros" title="Permalink to this definition">¶</a></dt>
<dd><p>New zeroed 1D complex <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.empty">
<code class="sig-name descname"><span class="pre">empty</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em>, <em class="sig-param"><span class="pre">extra_dims=()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 1D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
<p>The type can be set with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal notranslate"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.cempty">
<code class="sig-name descname"><span class="pre">cempty</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.cempty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.cempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 1D complex <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.tofftmesh">
<code class="sig-name descname"><span class="pre">tofftmesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_on_sphere</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.tofftmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.tofftmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert the array <code class="docutils literal notranslate"><span class="pre">arr_on_sphere</span></code> given on the sphere inside the FFT mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – </p></li>
<li><p><strong>arr_on_sphere</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.gsphere.GSphere.fromfftmesh">
<code class="sig-name descname"><span class="pre">fromfftmesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr_on_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/gsphere.html#GSphere.fromfftmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.gsphere.GSphere.fromfftmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer <code class="docutils literal notranslate"><span class="pre">arr_on_mesh</span></code> given on the FFT mesh to the G-sphere.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.irrepsdb">
<span id="irrepsdb-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">irrepsdb</span></code> Module</a><a class="headerlink" href="#module-abipy.core.irrepsdb" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-abipy.core.kpoints">
<span id="kpoints-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kpoints</span></code> Module</a><a class="headerlink" href="#module-abipy.core.kpoints" title="Permalink to this headline">¶</a></h2>
<p>This module defines objects describing the sampling of the Brillouin Zone.</p>
<dl class="py function">
<dt id="abipy.core.kpoints.issamek">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">issamek</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#issamek"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.issamek" title="Permalink to this definition">¶</a></dt>
<dd><p>True if k1 and k2 are equal modulo a lattice vector.
Use _ATOL_KDIFF is atol is None.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">issamek</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">issamek</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">issamek</span><span class="p">(</span><span class="mf">0.00003</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.wrap_to_ws">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">wrap_to_ws</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#wrap_to_ws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.wrap_to_ws" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms x in its corresponding reduced number in the interval ]-1/2,1/2].</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.wrap_to_bz">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">wrap_to_bz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#wrap_to_bz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.wrap_to_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms x in its corresponding reduced number in the interval [0,1[.”</p>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.as_kpoints">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">as_kpoints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#as_kpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.as_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a list of k-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code></a> or list of Kpoint objects or array-like object.</p></li>
<li><p><strong>lattice</strong> – Reciprocal lattice.</p></li>
<li><p><strong>weights</strong> – k-point weights. Ignored if obj is already a <cite>Kpoint</cite> instance or a list of <cite>Kpoint</cite> items.</p></li>
<li><p><strong>name</strong> – string with the name of the k-point. Ignored if obj is already a <cite>Kpoint</cite>
instance or a list of <cite>Kpoint</cite> items.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.Kpoint">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">Kpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.util.serialization.html#pymatgen.util.serialization.SlotPickleMixin" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.util.serialization.SlotPickleMixin</span></code></a></p>
<p>Class defining one k-point. This object is immutable and can be used as key in dictionaries</p>
<p>Note that we usually construct the object by passing pymatgen.reciprocal_lattice
that is the standard reciprocal lattice used for solid state physics
with a factor of 2 * pi i.e. a_i . b_j = 2pi delta_ij.
Abinit, on the contrary, uses the crystallographic reciprocal lattice i.e. no 2pi factor.
so pay attention when converting Abinit routines to AbiPy.</p>
<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.from_name_and_structure">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_name_and_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.from_name_and_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.from_name_and_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Build Kpoint object from string with name and structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.frac_coords">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">frac_coords</span></code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.frac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Fractional coordinates of the k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.lattice">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lattice</span></code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.lattice.Lattice</span></code></a> object describing the Reciprocal lattice.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.weight">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">weight</span></code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight of the k-point. 0.0 if the weight is not defined.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.set_weight">
<code class="sig-name descname"><span class="pre">set_weight</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.set_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.set_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the weight of the k-point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.cart_coords">
<code class="sig-name descname"><span class="pre">cart_coords</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.cart_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.cart_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of the k-point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">name</span></code><a class="headerlink" href="#abipy.core.kpoints.Kpoint.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the k-point. None if not available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.set_name">
<code class="sig-name descname"><span class="pre">set_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.set_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the k-point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.on_border">
<code class="sig-name descname"><span class="pre">on_border</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.on_border"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.on_border" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the k-point is on the border of the BZ (lattice translations are taken into account).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.tos">
<code class="sig-name descname"><span class="pre">tos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fract'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.tos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.tos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with fractional or cartesian coords depending
on mode <cite>m</cite> in (“fract”, “cart”, “fracart”)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.as_kpoint">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_kpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.as_kpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.as_kpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code></a> instance or array-like with the reduced coordinates.</p></li>
<li><p><strong>lattice</strong> – <a class="reference external" href="https://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.lattice.Lattice</span></code></a> object defining the reciprocal lattice.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.gamma">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">gamma</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for the Gamma point.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.is_gamma">
<code class="sig-name descname"><span class="pre">is_gamma</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_umklapp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.is_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.is_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this the gamma point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_umklapp</strong> – True if umklapp G-vectors are allowed.</p></li>
<li><p><strong>atol</strong> – Absolute tolerance for k-point comparison (used only if umklapp).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.norm">
<code class="sig-name descname"><span class="pre">norm</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm of the kpoint.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.versor">
<code class="sig-name descname"><span class="pre">versor</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.versor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.versor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the versor i.e. math:<cite>||k|| = 1</cite></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.wrap_to_ws">
<code class="sig-name descname"><span class="pre">wrap_to_ws</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.wrap_to_ws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.wrap_to_ws" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> in the Wigner-Seitz zone.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.wrap_to_bz">
<code class="sig-name descname"><span class="pre">wrap_to_bz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.wrap_to_bz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.wrap_to_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> in the first unit cell.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpoint.compute_star">
<code class="sig-name descname"><span class="pre">compute_star</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_tows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpoint.compute_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpoint.compute_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the star of the kpoint (tuple of <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> objects).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.KpointList">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">KpointList</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reciprocal_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a></p>
<p>Base class defining a sequence of <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> objects. Essentially consists
of base methods implementing the sequence protocol and helper functions.
The subclasses <a class="reference internal" href="#abipy.core.kpoints.Kpath" title="abipy.core.kpoints.Kpath"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpath</span></code></a> and <a class="reference internal" href="#abipy.core.kpoints.IrredZone" title="abipy.core.kpoints.IrredZone"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.IrredZone</span></code></a> provide specialized methods to operate
on k-points representing a path or list of points in the IBZ, respectively.
This object is immutable.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-e44e9bc36fcc018b5452eba22c505a1c12236cb9.png" alt="Inheritance diagram of KpointList" usemap="#inheritance5c4fb443de" class="inheritance graphviz" /></div>
<map id="inheritance5c4fb443de" name="inheritance5c4fb443de">
<area shape="rect" id="node1" href="#abipy.core.kpoints.KpointList" target="_top" title="Base class defining a sequence of |Kpoint| objects. Essentially consists" alt="" coords="594,69,763,90"/>
</map><dl class="py attribute">
<dt id="abipy.core.kpoints.KpointList.Error">
<code class="sig-name descname"><span class="pre">Error</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointsError</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.subclass_from_name">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">subclass_from_name</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.subclass_from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.subclass_from_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the class with the given name.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.from_dict">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes Kpoints obey the general json interface used in pymatgen for easier serialization.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.as_dict">
<code class="sig-name descname"><span class="pre">as_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes Kpoints obey the general json interface used in pymatgen for easier serialization.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.reciprocal_lattice">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">reciprocal_lattice</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.lattice.Lattice</span></code></a> object defining the reciprocal lattice.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">func=&lt;class</span> <span class="pre">'str'&gt;</span></em>, <em class="sig-param"><span class="pre">title=None</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.index">
<code class="sig-name descname"><span class="pre">index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns: the first index of kpoint in self.</p>
<p>Raises: <cite>ValueError</cite> if not found.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.get_all_kindices">
<code class="sig-name descname"><span class="pre">get_all_kindices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.get_all_kindices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.get_all_kindices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return numpy array with indexes of all the k-point
Accepts: <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance or integer.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.find">
<code class="sig-name descname"><span class="pre">find</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns: first index of kpoint. -1 if not found</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.count">
<code class="sig-name descname"><span class="pre">count</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of occurrences of kpoint</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.find_closest">
<code class="sig-name descname"><span class="pre">find_closest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.find_closest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.find_closest" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest k-point in the list (not necessarily equal).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – Fractional coordinates or <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>(ind, kpoint, dist)</p>
<p>where <code class="docutils literal notranslate"><span class="pre">ind</span></code> is the index in self of the closest k-point.
<code class="docutils literal notranslate"><span class="pre">kpoint</span></code> is the <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.Kpoint</span></code></a> instance of index <code class="docutils literal notranslate"><span class="pre">ind</span></code>.
dist is the distance between <code class="docutils literal notranslate"><span class="pre">obj</span></code> and <code class="docutils literal notranslate"><span class="pre">kpoint</span></code>.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.is_path">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_path</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.is_path" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self represents a path in the BZ.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.is_ibz">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_ibz</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.is_ibz" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self represents a list of points in the IBZ.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.mpdivs_shifts">
<code class="sig-name descname"><span class="pre">mpdivs_shifts</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.mpdivs_shifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.mpdivs_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>The Monkhorst-Pack (MP) divisions and shifts.
Both quantities are set to None if self is not a MP mesh.
Use <cite>is_mpmesh</cite> to check whether self is a MP mesh.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.is_mpmesh">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_mpmesh</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.is_mpmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self represents a Monkhorst-Pack mesh.
i.e if the sampling has been specified in terms of divisions
along the reciprocal lattice vectors (ngkpt)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.frac_coords">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">frac_coords</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.frac_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Fractional coordinates of the k-point as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape (len(self), 3)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.get_cart_coords">
<code class="sig-name descname"><span class="pre">get_cart_coords</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.get_cart_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.get_cart_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of the k-point as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape (len(self), 3)</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.names">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">names</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.names" title="Permalink to this definition">¶</a></dt>
<dd><p>List with the name of the k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.weights">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">weights</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointList.weights" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the weights of the k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.sum_weights">
<code class="sig-name descname"><span class="pre">sum_weights</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.sum_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.sum_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum of the weights.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.check_weights">
<code class="sig-name descname"><span class="pre">check_weights</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.check_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.check_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if weights are normalized to one.
Raises: <cite>ValueError</cite> if Weights are not normalized.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.get_highsym_datataframe">
<code class="sig-name descname"><span class="pre">get_highsym_datataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_cart_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.get_highsym_datataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.get_highsym_datataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pandas Dataframe with the names of the high-symmetry k-points
and the reduced coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>with_cart_coords</strong> – True to add extra column with the Cartesian coordinates.</p>
</dd>
</dl>
<p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.remove_duplicated">
<code class="sig-name descname"><span class="pre">remove_duplicated</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.remove_duplicated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.remove_duplicated" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicated k-points from self. Returns new <a class="reference internal" href="#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">KpointList</span></code></a> instance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.to_array">
<code class="sig-name descname"><span class="pre">to_array</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.to_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [nkpy, 3] with the fractional coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.to_json">
<code class="sig-name descname"><span class="pre">to_json</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> string representation of the MSONable object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-points with matplotlib.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointList.get_k2kqg_map">
<code class="sig-name descname"><span class="pre">get_k2kqg_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_kdiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointList.get_k2kqg_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointList.get_k2kqg_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mapping k_index –&gt; (k + q)_index, g0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpt</strong> – q-point in fractional coordinate or <a class="reference internal" href="#abipy.core.kpoints.Kpoint" title="abipy.core.kpoints.Kpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code></a> instance.</p></li>
<li><p><strong>atol_kdiff</strong> – Tolerance used to compare k-points.
Use _ATOL_KDIFF is atol is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.KpointStar">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">KpointStar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reciprocal_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#KpointStar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.KpointStar" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointList</span></code></a></p>
<p>Star of the kpoint. Note that the first k-point is assumed to be the base
of the star namely the point that is used to generate the Star.</p>
<div class="graphviz"><img src="../_images/inheritance-18b0c20e32a30ac3b152df497aa92eb3ff3536be.png" alt="Inheritance diagram of KpointStar" usemap="#inheritance66b938a85c" class="inheritance graphviz" /></div>
<map id="inheritance66b938a85c" name="inheritance66b938a85c">
<area shape="rect" id="node1" href="#abipy.core.kpoints.KpointList" target="_top" title="Base class defining a sequence of |Kpoint| objects. Essentially consists" alt="" coords="464,54,596,70"/>
<area shape="rect" id="node3" href="#abipy.core.kpoints.KpointStar" target="_top" title="Star of the kpoint. Note that the first k&#45;point is assumed to be the base" alt="" coords="630,54,764,70"/>
</map><dl class="py method">
<dt id="abipy.core.kpoints.KpointStar.base_point">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">base_point</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointStar.base_point" title="Permalink to this definition">¶</a></dt>
<dd><p>The point used to generate the star.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.KpointStar.name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">name</span></code><a class="headerlink" href="#abipy.core.kpoints.KpointStar.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the star (inherited from the name of the base point).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.Kpath">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">Kpath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reciprocal_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointList</span></code></a></p>
<p>This object describes a k-path in reciprocal space.
It provides methods to compute (line) derivatives along the path.
The k-points do not have weights so Kpath should not be used to compute integral in the BZ.</p>
<div class="graphviz"><img src="../_images/inheritance-df5ca19e6312c0ec4ffebb089f3b8ed5b64c6cb6.png" alt="Inheritance diagram of Kpath" usemap="#inheritance08679ad966" class="inheritance graphviz" /></div>
<map id="inheritance08679ad966" name="inheritance08679ad966">
<area shape="rect" id="node1" href="#abipy.core.kpoints.Kpath" target="_top" title="This object describes a k&#45;path in reciprocal space." alt="" coords="646,55,764,72"/>
<area shape="rect" id="node2" href="#abipy.core.kpoints.KpointList" target="_top" title="Base class defining a sequence of |Kpoint| objects. Essentially consists" alt="" coords="476,55,611,72"/>
</map><dl class="py method">
<dt id="abipy.core.kpoints.Kpath.from_names">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.from_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.from_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate normalized K-path from list of k-point labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p></li>
<li><p><strong>knames</strong> – List of strings with the k-point labels.</p></li>
<li><p><strong>line_density</strong> – Number of points used to sample the smallest segment of the path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.from_vertices_and_names">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_vertices_and_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.from_vertices_and_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.from_vertices_and_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate normalized K-path from a list of vertices and the corresponding labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p></li>
<li><p><strong>vertices_names</strong> – List of tuple, each tuple is of the form (kfrac_coords, kname) where
kfrac_coords are the reduced coordinates of the k-point and kname is a string with the name of
the k-point. Each point represents a vertex of the k-path.</p></li>
<li><p><strong>line_density</strong> – Number of points used to sample the smallest segment of the path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> – Verbosity level. Default: 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.ds">
<code class="sig-name descname"><span class="pre">ds</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.ds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.ds" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of len(self)-1 elements giving the distance between two
consecutive k-points, i.e. ds[i] = ||k[i+1] - k[i]|| for i=0,1,…,n-1</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.versors">
<code class="sig-name descname"><span class="pre">versors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.versors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.versors" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of len(self) - 1 elements with the versors connecting k[i] to k[i+1].</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.lines">
<code class="sig-name descname"><span class="pre">lines</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Nested list containing the indices of the points belonging to the same line.
Used for extracting the eigenvalues while looping over the lines.</p>
<p class="rubric">Example</p>
<dl class="simple">
<dt>for line in self.lines:</dt><dd><p>vals_on_line = eigens[spin, line, band]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.frac_bounds">
<code class="sig-name descname"><span class="pre">frac_bounds</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.frac_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.frac_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape [M, 3] with the vertexes of the path in frac coords.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.cart_bounds">
<code class="sig-name descname"><span class="pre">cart_bounds</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.cart_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.cart_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of shape [M, 3] with the vertexes of the path in frac coords.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.find_points_along_path">
<code class="sig-name descname"><span class="pre">find_points_along_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.find_points_along_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.find_points_along_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points in <code class="docutils literal notranslate"><span class="pre">cart_coords</span></code> lying on the path with distance less than <cite>dist_tol</cite>.
See find_points_along_path function for API.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Kpath.finite_diff">
<code class="sig-name descname"><span class="pre">finite_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Kpath.finite_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Kpath.finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivatives of values by finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – array-like object with shape=(nkpt) containing the values of the path.</p></li>
<li><p><strong>order</strong> – Order of the derivative.</p></li>
<li><p><strong>acc</strong> – Accuracy: 4 corresponds to a central difference with 5 points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ragged numpy array. The i-th entry is a numpy array with the derivatives on the i-th line.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.IrredZone">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">IrredZone</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reciprocal_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointList</span></code></a></p>
<p>An <a class="reference internal" href="#abipy.core.kpoints.IrredZone" title="abipy.core.kpoints.IrredZone"><code class="xref py py-class docutils literal notranslate"><span class="pre">IrredZone</span></code></a> is a (immutable) sequence of points in the irreducible wedge of the BZ.
Each point has a weight whose sum must equal 1 so that we can integrate quantities in the full Brillouin zone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Abinit supports different options for the specification of the BZ sampling:</p>
<blockquote>
<div><ul class="simple">
<li><p>kptrlatt(3,3) or ngkpt(3) for the definition grid.</p></li>
<li><p>shiftk(3, nshiftk) for the definition of multiple shifts.</p></li>
<li><p><cite>kptopt</cite> for the treatment of symmetry operations.</p></li>
</ul>
</div></blockquote>
<p>All these possibilities complicate the internal implementation in particular when
we need to recostruct the full BZ and take into account the presence of multiple shifts
since kptrlatt may have non-zero off-diagonal components. Client code that needs to know
how the mesh was generated can rely on the following checks:</p>
<p>if not self.ibz: raise(“Need an IBZ sampling”)</p>
<p>mpdivs, shifts = self.mpdivs_shifts
if mpdivs is None: raise ValueError(“Cannot handle kptrlatt with non-zero off-diagonal elements”)
if len(shifts) &gt; 1: raise ValueError(“Multiple shifts are not supported”)
# Code for mesh defined in terms of mpdivs and one shift.</p>
</div>
<div class="graphviz"><img src="../_images/inheritance-1378b7be8b50325a3d17e9439a45fe1cc49741dd.png" alt="Inheritance diagram of IrredZone" usemap="#inheritance85e3b67a6a" class="inheritance graphviz" /></div>
<map id="inheritance85e3b67a6a" name="inheritance85e3b67a6a">
<area shape="rect" id="node1" href="#abipy.core.kpoints.IrredZone" target="_top" title="An :class:`IrredZone` is a (immutable) sequence of points in the irreducible wedge of the BZ." alt="" coords="632,54,764,71"/>
<area shape="rect" id="node2" href="#abipy.core.kpoints.KpointList" target="_top" title="Base class defining a sequence of |Kpoint| objects. Essentially consists" alt="" coords="466,54,599,71"/>
</map><dl class="py method">
<dt id="abipy.core.kpoints.IrredZone.from_ngkpt">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ngkpt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngkpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shiftk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kptopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unpolarized'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone.from_ngkpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone.from_ngkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Build an IrredZone object from (ngkpt, shift) by calling Abinit
to get the list of irreducible k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.IrredZone.from_kppa">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_kppa</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kppa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shiftk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kptopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone.from_kppa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone.from_kppa" title="Permalink to this definition">¶</a></dt>
<dd><p>Build an IrredZone object from (kppa, shift) by calling Abinit
to get the list of irreducible k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.IrredZone.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">func=&lt;class</span> <span class="pre">'str'&gt;</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em>, <em class="sig-param"><span class="pre">title=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#IrredZone.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.IrredZone.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.rc_list">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">rc_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#rc_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.rc_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the linear mesh used to sample one dimension of the reciprocal space.
Note that the coordinates are always ordered so that rc[i+1] &gt; rc[i].
so that we can easily plot quantities defined on the 3D multidimensional mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mp</strong> – Number of Monkhorst-Pack divisions along this direction.</p></li>
<li><p><strong>sh</strong> – Shift</p></li>
<li><p><strong>pbc</strong> – if pbc is True, periodic boundary conditions are enforced.</p></li>
<li><p><strong>order</strong> – Possible values [“bz”, “unit_cell”].
if “bz”, the coordinates are forced to be in [-1/2, 1/2)
if “unit_cell”, the coordinates are forced to be in [0, 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.kmesh_from_mpdivs">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">kmesh_from_mpdivs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpdivs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#kmesh_from_mpdivs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.kmesh_from_mpdivs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the reduced coordinates of the
k-points from the MP divisions and the shifts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpdivs</strong> – The three MP divisions.</p></li>
<li><p><strong>shifts</strong> – Array-like object with the MP shift.</p></li>
<li><p><strong>pbc</strong> – If True, periodic images of the k-points will be included i.e. closed mesh.</p></li>
<li><p><strong>order</strong> – “unit_cell” if the kpoint coordinates must be in [0,1)
“bz” if the kpoint coordinates must be in [-1/2, +1/2)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.core.kpoints.Ktables">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">Ktables</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timrev</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Call spglib to compute the k-points in the IBZ with the corresponding weights
as well as the mapping BZ –&gt; IBZ.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – </p></li>
<li><p><strong>is_shift</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.mesh">
<code class="sig-name descname"><span class="pre">mesh</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.is_shift">
<code class="sig-name descname"><span class="pre">is_shift</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.is_shift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.ibz">
<code class="sig-name descname"><span class="pre">ibz</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.ibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.nibz">
<code class="sig-name descname"><span class="pre">nibz</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.nibz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.weights">
<code class="sig-name descname"><span class="pre">weights</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.bz">
<code class="sig-name descname"><span class="pre">bz</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.bz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.nbz">
<code class="sig-name descname"><span class="pre">nbz</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.nbz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.kpoints.Ktables.grid">
<code class="sig-name descname"><span class="pre">grid</span></code><a class="headerlink" href="#abipy.core.kpoints.Ktables.grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Ktables.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.kpoints.Ktables.print_bz2ibz">
<code class="sig-name descname"><span class="pre">print_bz2ibz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#Ktables.print_bz2ibz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.Ktables.print_bz2ibz" title="Permalink to this definition">¶</a></dt>
<dd><p>Print BZ –&gt; IBZ mapping.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.core.kpoints.find_points_along_path">
<code class="sig-prename descclassname"><span class="pre">abipy.core.kpoints.</span></code><code class="sig-name descname"><span class="pre">find_points_along_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cart_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_tol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/kpoints.html#find_points_along_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.kpoints.find_points_along_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points in <code class="docutils literal notranslate"><span class="pre">cart_coords</span></code> lying on the path defined by <code class="docutils literal notranslate"><span class="pre">cart_bounds</span></code>.
Result are ordered according to distance along the path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cart_bounds</strong> – [N, 3] array with the boundaries of the path in Cartesian coordinates.</p></li>
<li><p><strong>cart_coords</strong> – [M, 3] array with the points in Cartesian coordinate</p></li>
<li><p><strong>dist_tol</strong> – A point is considered to be on the path if its distance from the line
is less than dist_tol.</p></li>
</ul>
</dd>
</dl>
<p>Return: namedtuple with the following attributes:</p>
<blockquote>
<div><p>(ikfound, dist_list, path_ticks)</p>
<p>ikfound is a numpy array with the indices of the points lying on the path. Empty if no point is found.
dist_list: numpy array with the distance of the points along the line.
path_ticks: numpy array with the ticks associated to the input k-path.</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.mesh3d">
<span id="mesh3d-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh3d</span></code> Module</a><a class="headerlink" href="#module-abipy.core.mesh3d" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class defining Uniform 3D meshes.</p>
<dl class="py class">
<dt id="abipy.core.mesh3d.Mesh3D">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mesh3d.</span></code><code class="sig-name descname"><span class="pre">Mesh3D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Descriptor-class for uniform 3D meshes.</p>
<p>A Mesh3D object holds information on how functions, such
as wave functions and electron densities, are discretized in a
certain domain in space. The main information here is how many
grid points are used in each direction of the unit cell.</p>
<p>There are methods for tasks such as allocating arrays, performing
symmetry operations and integrating functions over space.</p>
<p>This is how a 2x2x2 3D array arr[x,y,z] is stored in memory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">-----</span><span class="mi">7</span>
<span class="o">|</span>\    <span class="o">|</span>
<span class="o">|</span> \   <span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span><span class="o">-----</span><span class="mi">5</span>      <span class="n">z</span>
<span class="mi">2</span><span class="o">--|--</span><span class="mi">6</span>  <span class="o">|</span>   <span class="n">y</span>  <span class="o">|</span>
 \ <span class="o">|</span>   \ <span class="o">|</span>    \ <span class="o">|</span>
  \<span class="o">|</span>    \<span class="o">|</span>     \<span class="o">|</span>
   <span class="mi">0</span><span class="o">-----</span><span class="mi">4</span>      <span class="o">+-----</span><span class="n">x</span>
</pre></div>
</div>
<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.iter_ixyz_r">
<code class="sig-name descname"><span class="pre">iter_ixyz_r</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.iter_ixyz_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.iter_ixyz_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator returning (ixyz, rr) where ixyz gives the index of the point and r is the point on the grid.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.rpoint">
<code class="sig-name descname"><span class="pre">rpoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.rpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.rpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector corresponding to the (ix, iy, iz) indices</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.nx">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nx</span></code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along x.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.ny">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ny</span></code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.ny" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along y.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.nz">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nz</span></code><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.nz" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points along z.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.inv_vectors">
<code class="sig-name descname"><span class="pre">inv_vectors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.inv_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.inv_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.zeros">
<code class="sig-name descname"><span class="pre">zeros</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em>, <em class="sig-param"><span class="pre">extra_dims=()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.zeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 3D array for this domain.</p>
<p>The type can be set with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal notranslate"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.czeros">
<code class="sig-name descname"><span class="pre">czeros</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.czeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.czeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new zeroed 3D complex array for this domain.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.empty">
<code class="sig-name descname"><span class="pre">empty</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em>, <em class="sig-param"><span class="pre">extra_dims=()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 3D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> for this domain.</p>
<p>The type can be set with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword.
Extra dimensions can be added with <code class="docutils literal notranslate"><span class="pre">extra_dims</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.cempty">
<code class="sig-name descname"><span class="pre">cempty</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.cempty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.cempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns new uninitialized 3D complex <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> for this domain.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.random">
<code class="sig-name descname"><span class="pre">random</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em>, <em class="sig-param"><span class="pre">extra_dims=()</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.random"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns random real <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> for this domain with val in [0.0, 1.0).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.crandom">
<code class="sig-name descname"><span class="pre">crandom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.crandom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.crandom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns random complex <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> for this domain with val in [0.0, 1.0).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.reshape">
<code class="sig-name descname"><span class="pre">reshape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshape the array arr defined on the FFT box.</p>
<p>Returns <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with 4 dimensions (?, nx, ny, nz) where ?*nx*ny*nz == arr.size</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.fft_r2g">
<code class="sig-name descname"><span class="pre">fft_r2g</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_fg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.fft_r2g"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.fft_r2g" title="Permalink to this definition">¶</a></dt>
<dd><p>FFT of array <code class="docutils literal notranslate"><span class="pre">fr</span></code> given in real space.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.fft_g2r">
<code class="sig-name descname"><span class="pre">fft_g2r</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fg_ishifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.fft_g2r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.fft_g2r" title="Permalink to this definition">¶</a></dt>
<dd><p>FFT of array <code class="docutils literal notranslate"><span class="pre">fg</span></code> given in G-space.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.integrate">
<code class="sig-name descname"><span class="pre">integrate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.integrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate array(s) fr.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.gvecs">
<code class="sig-name descname"><span class="pre">gvecs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.gvecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.gvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Array with the reduced coordinates of the G-vectors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These are the G-vectors of the FFT box and should be used
when we compute quantities on the FFT mesh.
These vectors differ from the gvecs stored in <a class="reference internal" href="#abipy.core.gsphere.GSphere" title="abipy.core.gsphere.GSphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.gsphere.GSphere</span></code></a> that
are k-centered and enclosed by a sphere whose radius is defined by ecut.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.gmods">
<code class="sig-name descname"><span class="pre">gmods</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.gmods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.gmods" title="Permalink to this definition">¶</a></dt>
<dd><p>[ng] <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with <span class="math notranslate nohighlight">\(|G|\)</span></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.rpoints">
<code class="sig-name descname"><span class="pre">rpoints</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.rpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.rpoints" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the points in real space in reduced coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.i_closest_gridpoints">
<code class="sig-name descname"><span class="pre">i_closest_gridpoints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.i_closest_gridpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.i_closest_gridpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of points, this function return a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the indices of the closest gridpoint.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mesh3d.Mesh3D.dist_gridpoints_in_spheres">
<code class="sig-name descname"><span class="pre">dist_gridpoints_in_spheres</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mesh3d.html#Mesh3D.dist_gridpoints_in_spheres"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mesh3d.Mesh3D.dist_gridpoints_in_spheres" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.mixins">
<span id="mixins-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mixins</span></code> Module</a><a class="headerlink" href="#module-abipy.core.mixins" title="Permalink to this headline">¶</a></h2>
<p>This module provides mixin classes</p>
<dl class="py class">
<dt id="abipy.core.mixins.AbinitNcFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">AbinitNcFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.BaseFile</span></code></p>
<p>Abstract class representing a Netcdf file with data saved
according to the ETSF-IO specifications (when available).
An AbinitNcFile has a netcdf reader to read data from file and build objects.</p>
<dl class="py method">
<dt id="abipy.core.mixins.AbinitNcFile.ncdump">
<code class="sig-name descname"><span class="pre">ncdump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">nc_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">nc_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile.ncdump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.ncdump" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with the output of ncdump.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.AbinitNcFile.abinit_version">
<code class="sig-name descname"><span class="pre">abinit_version</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile.abinit_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.abinit_version" title="Permalink to this definition">¶</a></dt>
<dd><p>String with abinit version: three digits separated by comma.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.AbinitNcFile.params">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">params</span></code><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the convergence parameters
Used to construct <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.AbinitNcFile.get_dims_dataframe">
<code class="sig-name descname"><span class="pre">get_dims_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#AbinitNcFile.get_dims_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.AbinitNcFile.get_dims_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return: <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the dimensions defined in the <cite>path</cite> group.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.mixins.Has_Structure">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">Has_Structure</span></code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a> containing crystallographic data.</p>
<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.structure">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.core.mixins.Has_Structure.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.plot_bz">
<code class="sig-name descname"><span class="pre">plot_bz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.plot_bz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.plot_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the plot (as a matplotlib object) of the symmetry line path in the Brillouin Zone.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.show_bz">
<code class="sig-name descname"><span class="pre">show_bz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abipy.core.mixins.Has_Structure.show_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the plot (as a matplotlib object) of the symmetry line path in the Brillouin Zone.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.export_structure">
<code class="sig-name descname"><span class="pre">export_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.export_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.export_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the structure on file.</p>
<p>returns: <a class="reference internal" href="iotools_api.html#abipy.iotools.visualizer.Visualizer" title="abipy.iotools.visualizer.Visualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.visualizer.Visualizer</span></code></a> instance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.visualize_structure_with">
<code class="sig-name descname"><span class="pre">visualize_structure_with</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">appname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.visualize_structure_with"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.visualize_structure_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the crystalline structure with the specified visualizer.</p>
<p>See <a class="reference internal" href="iotools_api.html#abipy.iotools.visualizer.Visualizer" title="abipy.iotools.visualizer.Visualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.visualizer.Visualizer</span></code></a> for the list of applications and formats supported.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_Structure.yield_structure_figs">
<code class="sig-name descname"><span class="pre">yield_structure_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Structure.yield_structure_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Structure.yield_structure_figs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.mixins.Has_ElectronBands">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">Has_ElectronBands</span></code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a> containing electron data.</p>
<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.ebands">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ebands</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="electrons_api.html#abipy.electrons.ebands.ElectronBands" title="abipy.electrons.ebands.ElectronBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.electrons.ebands.ElectronBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nsppol">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nsppol</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nsppol" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spin polarizations</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nspinor">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nspinor</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nspinor" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spinors</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nspden">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nspden</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nspden" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of indepedendent spin-density components.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.mband">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">mband</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.mband" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of bands.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nband">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nband</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nband" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of bands.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nelect">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nelect</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nelect" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of electrons per unit cell</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.nkpt">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nkpt</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.nkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of k-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.kpoints">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">kpoints</span></code><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterable with the Kpoints.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.tsmear">
<code class="sig-name descname"><span class="pre">tsmear</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.tsmear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.tsmear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.get_ebands_params">
<code class="sig-name descname"><span class="pre">get_ebands_params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.get_ebands_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.get_ebands_params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the convergence parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.plot_ebands">
<code class="sig-name descname"><span class="pre">plot_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.plot_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.plot_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electron energy bands. See the <code class="xref py py-func docutils literal notranslate"><span class="pre">ElectronBands.plot()</span></code> for the signature.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.plot_ebands_with_edos">
<code class="sig-name descname"><span class="pre">plot_ebands_with_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edos</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.plot_ebands_with_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.plot_ebands_with_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electron energy bands with DOS. See the <code class="xref py py-func docutils literal notranslate"><span class="pre">ElectronBands.plot_with_edos()</span></code> for the signature.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.get_edos">
<code class="sig-name descname"><span class="pre">get_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.get_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electronic DOS on a linear mesh. Wraps ebands.get_edos.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.yield_ebands_figs">
<code class="sig-name descname"><span class="pre">yield_ebands_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.yield_ebands_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.yield_ebands_figs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_ElectronBands.expose_ebands">
<code class="sig-name descname"><span class="pre">expose_ebands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slide_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_ElectronBands.expose_ebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_ElectronBands.expose_ebands" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a predefined list of matplotlib figures for electron bands with minimal input from the user.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.mixins.Has_PhononBands">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">Has_PhononBands</span></code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#abipy.core.mixins.AbinitNcFile" title="abipy.core.mixins.AbinitNcFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.AbinitNcFile</span></code></a> containing phonon data.</p>
<dl class="py method">
<dt id="abipy.core.mixins.Has_PhononBands.phbands">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">phbands</span></code><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="dfpt_api.html#abipy.dfpt.phonons.PhononBands" title="abipy.dfpt.phonons.PhononBands"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.dfpt.phonons.PhononBands</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_PhononBands.get_phbands_params">
<code class="sig-name descname"><span class="pre">get_phbands_params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands.get_phbands_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.get_phbands_params" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the convergence parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_PhononBands.plot_phbands">
<code class="sig-name descname"><span class="pre">plot_phbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands.plot_phbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.plot_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the electron energy bands. See the <code class="xref py py-func docutils literal notranslate"><span class="pre">PhononBands.plot()</span></code> for the signature.””</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_PhononBands.yield_phbands_figs">
<code class="sig-name descname"><span class="pre">yield_phbands_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands.yield_phbands_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.yield_phbands_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.Has_PhononBands.expose_phbands">
<code class="sig-name descname"><span class="pre">expose_phbands</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slide_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_PhononBands.expose_phbands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_PhononBands.expose_phbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a predefined list of matplotlib figures for phonon bands with minimal input from the user.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.mixins.NotebookWriter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">NotebookWriter</span></code><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for objects that are able to generate <a class="reference external" href="http://jupyter.org/">jupyter</a> notebooks.
Subclasses must provide a concrete implementation of <cite>write_notebook</cite>.</p>
<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.has_panel">
<code class="sig-name descname"><span class="pre">has_panel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.has_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.has_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return panel module (that evaluates to True) if panel is installed else False.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.make_and_open_notebook">
<code class="sig-name descname"><span class="pre">make_and_open_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classic_notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.make_and_open_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.make_and_open_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook and open it in the browser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nbpath</strong> – If nbpath is None, a temporay file is created.</p></li>
<li><p><strong>foreground</strong> – By default, jupyter is executed in background and stdout, stderr are redirected.</p></li>
<li><p><strong>devnull. Use foreground to run the process in foreground</strong> (<em>to</em>) – </p></li>
<li><p><strong>classic_notebook</strong> – True to use the classic notebook instead of jupyter-lab (default)</p></li>
<li><p><strong>no_browser</strong> – Start the jupyter server to serve the notebook but don’t open the notebook in the browser.
Use this option to connect remotely from localhost to the machine running the kernel</p></li>
</ul>
</dd>
</dl>
<p>Return: system exit code.</p>
<p>Raise: <cite>RuntimeError</cite> if jupyter executable is not in $PATH</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.get_nbformat_nbv">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_nbformat_nbv</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.get_nbformat_nbv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.get_nbformat_nbv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return nbformat module, notebook version module</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.get_nbformat_nbv_nb">
<code class="sig-name descname"><span class="pre">get_nbformat_nbv_nb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.get_nbformat_nbv_nb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.get_nbformat_nbv_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">nbformat</span></code> module, notebook version module
and new notebook with title and import section</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.write_notebook">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to nbpath. If nbpath is None, a temporay file is created.
Return path to the notebook. A typical template:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preable.</span>
<span class="n">nbformat</span><span class="p">,</span> <span class="n">nbv</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nbformat_nbv_nb</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1">#####################</span>
<span class="c1"># Put your code here</span>
<span class="n">nb</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
    <span class="n">nbv</span><span class="o">.</span><span class="n">new_markdown_cell</span><span class="p">(</span><span class="s2">&quot;# This is a markdown cell&quot;</span><span class="p">),</span>
    <span class="n">nbv</span><span class="o">.</span><span class="n">new_code_cell</span><span class="p">(</span><span class="s2">&quot;a = 1&quot;</span><span class="p">),</span>
<span class="p">])</span>
<span class="c1">#####################</span>

<span class="c1"># Call _write_nb_nbpath</span>
<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_nb_nbpath</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span> <span class="n">nbpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.pickle_load">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">pickle_load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.pickle_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.pickle_dump">
<code class="sig-name descname"><span class="pre">pickle_dump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.pickle_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the status of the object in pickle format.
If filepath is None, a temporary file is created.</p>
<p>Return: The name of the pickle file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.yield_figs">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.
Used in abiview.py to get a quick look at the results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.mixins.NotebookWriter.expose">
<code class="sig-name descname"><span class="pre">expose</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slide_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#NotebookWriter.expose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.NotebookWriter.expose" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.mixins.Has_Header">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.mixins.</span></code><code class="sig-name descname"><span class="pre">Has_Header</span></code><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Header" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for netcdf files containing the Abinit header.</p>
<dl class="py method">
<dt id="abipy.core.mixins.Has_Header.hdr">
<code class="sig-name descname"><span class="pre">hdr</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/mixins.html#Has_Header.hdr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.mixins.Has_Header.hdr" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://pythonhosted.org/monty/monty.html#monty.collections.AttrDict" title="(in monty v1.0.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">monty.collections.AttrDict</span></code></a> with the Abinit header e.g. hdr.ecut.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.restapi">
<span id="restapi-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">restapi</span></code> Module</a><a class="headerlink" href="#module-abipy.core.restapi" title="Permalink to this headline">¶</a></h2>
<p>This module provides interfaces with the Materials Project REST API v2 to enable
the creation of data structures and pymatgen objects using Materials Project data.</p>
<dl class="py function">
<dt id="abipy.core.restapi.get_mprester">
<code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">get_mprester</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#get_mprester"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.get_mprester" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in
your .pmgrc.yaml. If so, it will use that environment
This makes easier for heavy users to simply add
this environment variable to their setups and MPRester can
then be called without any arguments.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.MyMPRester">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">MyMPRester</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notify_db_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_user_agent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MyMPRester"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.MyMPRester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.ext.matproj.html#pymatgen.ext.matproj.MPRester" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.ext.matproj.MPRester</span></code></a></p>
<p>Subclass Materials project Rester.
See <a class="bibtex reference internal" href="../zzbiblio.html#jain2013" id="id2">[Jain2013]</a><a class="bibtex reference internal" href="../zzbiblio.html#ong2015" id="id3">[Ong2015]</a>.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-b5571c163a3d8f8c880b765de200b1ba2cf6ef9c.png" alt="Inheritance diagram of MyMPRester" usemap="#inheritance6fa0732b8a" class="inheritance graphviz" /></div>
<map id="inheritance6fa0732b8a" name="inheritance6fa0732b8a">
<area shape="rect" id="node1" href="#abipy.core.restapi.MyMPRester" target="_top" title="Subclass Materials project Rester." alt="" coords="266,5,472,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.restapi.MyMPRester.Error">
<code class="sig-name descname"><span class="pre">Error</span></code><a class="headerlink" href="#abipy.core.restapi.MyMPRester.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="https://pymatgen.org/pymatgen.ext.matproj.html#pymatgen.ext.matproj.MPRestError" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.ext.matproj.MPRestError</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.MyMPRester.get_phasediagram_results">
<code class="sig-name descname"><span class="pre">get_phasediagram_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MyMPRester.get_phasediagram_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.MyMPRester.get_phasediagram_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Contact the materials project database, fetch entries and build :class:<code class="docutils literal notranslate"><span class="pre">PhaseDiagramResults</span></code> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>elements</strong> – List of chemical elements.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.PhaseDiagramResults">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">PhaseDiagramResults</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entries</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Simplified interface to phase-diagram pymatgen API.</p>
<p>Inspired to:</p>
<blockquote>
<div><p><a class="reference external" href="https://anaconda.org/matsci/plotting-and-analyzing-a-phase-diagram-using-the-materials-api/notebook">https://anaconda.org/matsci/plotting-and-analyzing-a-phase-diagram-using-the-materials-api/notebook</a></p>
</div></blockquote>
<p>See also: <a class="bibtex reference internal" href="../zzbiblio.html#ong2008" id="id4">[Ong2008]</a><a class="bibtex reference internal" href="../zzbiblio.html#ong2010" id="id5">[Ong2010]</a></p>
<dl class="py method">
<dt id="abipy.core.restapi.PhaseDiagramResults.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_unstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot phase diagram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_unstable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Whether unstable phases will be plotted as
well as red crosses. If a number &gt; 0 is entered, all phases with
ehull &lt; show_unstable will be shown.</p></li>
<li><p><strong>show</strong> – True to show plot.</p></li>
</ul>
</dd>
</dl>
<p>Return: plotter object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.PhaseDiagramResults.dataframe">
<code class="sig-name descname"><span class="pre">dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe with the most important results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.PhaseDiagramResults.print_dataframes">
<code class="sig-name descname"><span class="pre">print_dataframes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">with_spglib=False</span></em>, <em class="sig-param"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#PhaseDiagramResults.print_dataframes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.PhaseDiagramResults.print_dataframes" title="Permalink to this definition">¶</a></dt>
<dd><p>Print pandas dataframe to file <cite>file</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_spglib</strong> – True to compute spacegroup with spglib.</p></li>
<li><p><strong>file</strong> – Output stream.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.DatabaseStructures">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">DatabaseStructures</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Store the results of a query to the MP database.
This object is immutable, use add_entry to create a new instance.</p>
<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.filter_by_spgnum">
<code class="sig-name descname"><span class="pre">filter_by_spgnum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spgnum</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.filter_by_spgnum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.filter_by_spgnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter structures by space group number. Return new MpStructures object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.add_entry">
<code class="sig-name descname"><span class="pre">add_entry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.add_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.add_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new entry, return new object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – New structure object.</p></li>
<li><p><strong>entry_id</strong> – ID associated to new structure.</p></li>
<li><p><strong>data_dict</strong> – Option dictionary with metadata.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.lattice_dataframe">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">lattice_dataframe</span></code><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.lattice_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>pandas DataFrame with lattice parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.coords_dataframe">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">coords_dataframe</span></code><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.coords_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>pandas DataFrame with atomic positions.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.structure_dataframes">
<code class="sig-name descname"><span class="pre">structure_dataframes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.structure_dataframes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.structure_dataframes" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframes constructed from self.structures.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.print_results">
<code class="sig-name descname"><span class="pre">print_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fmt='abivars'</span></em>, <em class="sig-param"><span class="pre">verbose=0</span></em>, <em class="sig-param"><span class="pre">file=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.print_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.print_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Print pandas dataframe, structures using format <cite>fmt</cite>, and data to file <cite>file</cite>.
<cite>fmt</cite> is automaticall set to <cite>cif</cite> if structure is disordered.
Set fmt to None or empty string to disable structure output.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>NOP required by NotebookWriter protocol.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.DatabaseStructures.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#DatabaseStructures.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.DatabaseStructures.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a jupyter notebook to nbpath. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.MpStructures">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">MpStructures</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MpStructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.MpStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.restapi.DatabaseStructures" title="abipy.core.restapi.DatabaseStructures"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.restapi.DatabaseStructures</span></code></a></p>
<p>Store the results of a query to the Materials Project database.</p>
<div class="graphviz"><img src="../_images/inheritance-a15eab6dbcc95f5e9ba6c02a215b2b14fa406cab.png" alt="Inheritance diagram of MpStructures" usemap="#inheritance8d6cbd6d0c" class="inheritance graphviz" /></div>
<map id="inheritance8d6cbd6d0c" name="inheritance8d6cbd6d0c">
<area shape="rect" id="node1" href="#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,221,29"/>
<area shape="rect" id="node2" href="#abipy.core.restapi.DatabaseStructures" target="_top" title="Store the results of a query to the MP database." alt="" coords="268,5,511,29"/>
<area shape="rect" id="node3" href="#abipy.core.restapi.MpStructures" target="_top" title="Store the results of a query to the Materials Project database." alt="" coords="558,5,763,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.restapi.MpStructures.dbname">
<code class="sig-name descname"><span class="pre">dbname</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'Materials</span> <span class="pre">Project'</span></em><a class="headerlink" href="#abipy.core.restapi.MpStructures.dbname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.MpStructures.dataframe">
<code class="sig-name descname"><span class="pre">dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MpStructures.dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.MpStructures.dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe constructed from self.data. None if data is not available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.MpStructures.open_browser">
<code class="sig-name descname"><span class="pre">open_browser</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">browser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#MpStructures.open_browser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.MpStructures.open_browser" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>browser</strong> – Open webpage in <code class="docutils literal notranslate"><span class="pre">browser</span></code>. Use default if $BROWSER if None.</p></li>
<li><p><strong>limit</strong> – Max number of tabs opened in browser. None for no limit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.CodStructures">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">CodStructures</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#CodStructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.CodStructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.restapi.DatabaseStructures" title="abipy.core.restapi.DatabaseStructures"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.restapi.DatabaseStructures</span></code></a></p>
<p>Store the results of a query to the <a class="reference external" href="http://www.crystallography.net/cod/">COD</a> database <a class="bibtex reference internal" href="../zzbiblio.html#grazulis2011" id="id6">[Grazulis2011]</a>.</p>
<div class="graphviz"><img src="../_images/inheritance-840c0f282bf09e5202c3210c11b8faf74953473a.png" alt="Inheritance diagram of CodStructures" usemap="#inheritance1fae80e31c" class="inheritance graphviz" /></div>
<map id="inheritance1fae80e31c" name="inheritance1fae80e31c">
<area shape="rect" id="node1" href="#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="5,5,219,29"/>
<area shape="rect" id="node3" href="#abipy.core.restapi.DatabaseStructures" target="_top" title="Store the results of a query to the MP database." alt="" coords="266,5,507,29"/>
<area shape="rect" id="node2" href="#abipy.core.restapi.CodStructures" target="_top" title="Store the results of a query to the COD_ database :cite:`Grazulis2011`." alt="" coords="554,5,763,29"/>
</map><dl class="py attribute">
<dt id="abipy.core.restapi.CodStructures.dbname">
<code class="sig-name descname"><span class="pre">dbname</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'COD'</span></em><a class="headerlink" href="#abipy.core.restapi.CodStructures.dbname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.restapi.CodStructures.dataframe">
<code class="sig-name descname"><span class="pre">dataframe</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#CodStructures.dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.CodStructures.dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> constructed. Essentially geometrical info and space groups found by <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a>
as COD API is rather limited.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.restapi.Dotdict">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.restapi.</span></code><code class="sig-name descname"><span class="pre">Dotdict</span></code><a class="reference internal" href="../_modules/abipy/core/restapi.html#Dotdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.Dotdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<dl class="py method">
<dt id="abipy.core.restapi.Dotdict.dotget">
<code class="sig-name descname"><span class="pre">dotget</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/restapi.html#Dotdict.dotget"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.restapi.Dotdict.dotget" title="Permalink to this definition">¶</a></dt>
<dd><p>d.dotget[“foo.bar”] –&gt; d[“foo”][“bar”] if “foo.bar” not in self</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.skw">
<span id="skw-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skw</span></code> Module</a><a class="headerlink" href="#module-abipy.core.skw" title="Permalink to this headline">¶</a></h2>
<p>Shankland-Koelling-Wood Fourier interpolation scheme.
For the theoretical background see <a class="bibtex reference internal" href="../zzbiblio.html#euwema1969" id="id7">[Euwema1969]</a><a class="bibtex reference internal" href="../zzbiblio.html#koelling1986" id="id8">[Koelling1986]</a><a class="bibtex reference internal" href="../zzbiblio.html#pickett1988" id="id9">[Pickett1988]</a><a class="bibtex reference internal" href="../zzbiblio.html#madsen2006" id="id10">[Madsen2006]</a>.</p>
<dl class="py class">
<dt id="abipy.core.skw.ElectronInterpolator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.skw.</span></code><code class="sig-name descname"><span class="pre">ElectronInterpolator</span></code><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt id="abipy.core.skw.ElectronInterpolator.symprec">
<code class="sig-name descname"><span class="pre">symprec</span></code><em class="property"> <span class="pre">=</span> <span class="pre">1e-05</span></em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.symprec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.skw.ElectronInterpolator.angle_tolerance">
<code class="sig-name descname"><span class="pre">angle_tolerance</span></code><em class="property"> <span class="pre">=</span> <span class="pre">-1.0</span></em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.angle_tolerance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.skw.ElectronInterpolator.occtype">
<code class="sig-name descname"><span class="pre">occtype</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'insulator'</span></em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.occtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="abipy.core.skw.ElectronInterpolator.use_cache">
<code class="sig-name descname"><span class="pre">use_cache</span></code><em class="property"> <span class="pre">=</span> <span class="pre">True</span></em><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.use_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.pickle_load">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">pickle_load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.pickle_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.pickle_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the object from a pickle file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.pickle_dump">
<code class="sig-name descname"><span class="pre">pickle_dump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.pickle_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.pickle_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the status of the object in pickle format.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.get_sampling">
<code class="sig-name descname"><span class="pre">get_sampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_shift</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Use spglib to compute the k-points in the IBZ with the corresponding weights
as well as the k-points in the full BZ.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – </p></li>
<li><p><strong>is_shift</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Return: named tuple with the following attributes:</p>
<blockquote>
<div><p>ibz:
nibz
weights:
bz:
nbz
grid:</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.val_ib">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">val_ib</span></code><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.val_ib" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of the valence band.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.get_edos">
<code class="sig-name descname"><span class="pre">get_edos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.get_edos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.get_edos" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electron DOS on a linear mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kmesh</strong> – Three integers with the number of divisions along the reciprocal primitive axes.</p></li>
<li><p><strong>is_shift</strong> – three integers (spglib API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>mesh</strong> – Frequency mesh to use. If None, the mesh is computed automatically from the eigenvalues.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(mesh, values, integral)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.plot_dos_vs_kmeshes">
<code class="sig-name descname"><span class="pre">plot_dos_vs_kmeshes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmeshes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.plot_dos_vs_kmeshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.plot_dos_vs_kmeshes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot (interpolated) DOSes computed with different meshes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kmeshes</strong> – List of kmeshes. Each item is given by three integers with the number of
divisions along the reciprocal primitive axes.</p></li>
<li><p><strong>is_shift</strong> – three integers (<a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> API). When is_shift is not None, the kmesh is shifted along
the axis in half of adjacent mesh points irrespective of the mesh numbers. None means unshited mesh.</p></li>
<li><p><strong>method</strong> – String defining the method for the computation of the DOS.</p></li>
<li><p><strong>step</strong> – Energy step (eV) of the linear mesh.</p></li>
<li><p><strong>width</strong> – Standard deviation (eV) of the gaussian.</p></li>
<li><p><strong>ax</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> or None if a new figure should be created.</p></li>
<li><p><strong>fontsize</strong> – Legend and title fontsize.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.eval_sk">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">eval_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">der1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">der2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.eval_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.eval_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate eigenvalues for all bands at a given (spin, k-point).
Optionally compute gradients and Hessian matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpt</strong> – K-point in reduced coordinates.</p></li>
<li><p><strong>der1</strong> – If not None, ouput gradient is stored in der1[nband, 3].</p></li>
<li><p><strong>der2</strong> – If not None, output Hessian is der2[nband, 3, 3].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>oeigs[nband]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.interp_kpts">
<code class="sig-name descname"><span class="pre">interp_kpts</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kfrac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.interp_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.interp_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies on an arbitrary set of k-points. Optionally, compute
gradients and Hessian matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kfrac_coords</strong> – K-points in reduced coordinates.</p></li>
<li><p><strong>dk1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True if gradient is wanted.</p></li>
<li><p><strong>dk2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True to compute 2nd order derivatives.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>interpolated energies in eigens[nsppol, len(kfrac_coords), nband]
gradient in dedk[self.nsppol, len(kfrac_coords), self.nband, 3))
hessian in dedk2[self.nsppol, len(kfrac_coords), self.nband, 3, 3))</p>
<p>gradient and hessian are set to None if not computed.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>namedtuple with</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.ElectronInterpolator.interp_kpts_and_enforce_degs">
<code class="sig-name descname"><span class="pre">interp_kpts_and_enforce_degs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kfrac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_eigens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#ElectronInterpolator.interp_kpts_and_enforce_degs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.ElectronInterpolator.interp_kpts_and_enforce_degs" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate energies on an arbitrary set of k-points. Use <cite>ref_eigens</cite>
to detect degeneracies and average the interpolated values in the degenerate subspace.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.skw.SkwInterpolator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.skw.</span></code><code class="sig-name descname"><span class="pre">SkwInterpolator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lpratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symrel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timrev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.skw.ElectronInterpolator" title="abipy.core.skw.ElectronInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.skw.ElectronInterpolator</span></code></a></p>
<p>This object implements the Shankland-Koelling-Wood Fourier interpolation scheme.
It can be used to interpolate functions in k-space with the periodicity of the
reciprocal lattice and satisfying F(k) = F(Sk) for each rotation S
belonging to the point group of the crystal. For readability reason,
the names of the variables are chosen assuming we are interpolating electronic eigenvalues
but the same object can be used to interpolate other quantities. Just set the first dimension to 1.</p>
<dl class="py method">
<dt id="abipy.core.skw.SkwInterpolator.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.SkwInterpolator.eval_sk">
<code class="sig-name descname"><span class="pre">eval_sk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">der1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">der2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.eval_sk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.eval_sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate eigenvalues for all bands at a given (spin, k-point).
Optionally compute gradients and Hessian matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin</strong> – Spin index.</p></li>
<li><p><strong>kpt</strong> – K-point in reduced coordinates.</p></li>
<li><p><strong>der1</strong> – If not None, ouput gradient is stored in der1[nband, 3].</p></li>
<li><p><strong>der2</strong> – If not None, output Hessian is der2[nband, 3, 3].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>oeigs[nband]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark">
<code class="sig-name descname"><span class="pre">get_stark</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the star function for k-point <cite>kpt</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpt</strong> – K-point in reduced coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>complex array of shape [self.nr]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark_dk1">
<code class="sig-name descname"><span class="pre">get_stark_dk1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark_dk1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark_dk1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 1st-order derivative of the star function wrt k</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpt</strong> – K-point in reduced coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>complex array [3, self.nr]  with the derivative of the
star function wrt k in reduced coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.skw.SkwInterpolator.get_stark_dk2">
<code class="sig-name descname"><span class="pre">get_stark_dk2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#SkwInterpolator.get_stark_dk2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.SkwInterpolator.get_stark_dk2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 2nd-order derivatives of the star function wrt k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpt</strong> – K-point in reduced coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Complex numpy array of shape [3, 3, self.nr] with the 2nd-order derivatives
of the star function wrt k in reduced coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.core.skw.extract_point_group">
<code class="sig-prename descclassname"><span class="pre">abipy.core.skw.</span></code><code class="sig-name descname"><span class="pre">extract_point_group</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symrel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timrev</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/skw.html#extract_point_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.skw.extract_point_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the point group rotations from the spacegroup. Add time-reversal
if spatial inversion is not present and <cite>has_timrev</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(ptg_symrel, ptg_symrec) with rotations in real- and reciprocal-space.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.structure">
<span id="structure-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">structure</span></code> Module</a><a class="headerlink" href="#module-abipy.core.structure" title="Permalink to this headline">¶</a></h2>
<p>This module defines basic objects representing the crystalline structure.</p>
<dl class="py function">
<dt id="abipy.core.structure.mp_match_structure">
<code class="sig-prename descclassname"><span class="pre">abipy.core.structure.</span></code><code class="sig-name descname"><span class="pre">mp_match_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#mp_match_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.mp_match_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds matching structures on the Materials Project database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – filename or <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject REST interface.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.</p></li>
<li><p><strong>final</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to get the final structure, or the initial
(pre-relaxation) structure. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">MpStructures</span></code> object with</dt><dd><p>structures: List of matching structures and list of Materials Project identifier.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.structure.mp_search">
<code class="sig-prename descclassname"><span class="pre">abipy.core.structure.</span></code><code class="sig-name descname"><span class="pre">mp_search</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemsys_formula_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#mp_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.mp_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the materials project database.
Get a list of structures corresponding to a chemical system, formula, or materials_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemsys_formula_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A chemical system (e.g., Li-Fe-O),
or formula (e.g., Fe2O3) or materials_id (e.g., mp-1234).</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject REST interface.
If this is None, the code will check if there is a <cite>PMG_MAPI_KEY</cite> in your .pmgrc.yaml.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">MpStructures</span></code> object with</dt><dd><p>List of Structure objects, Materials project ids associated to structures.
and List of dictionaries with MP data (same order as structures).</p>
</dd>
</dl>
<p>Note that the attributes evalute to False if no match is found</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="abipy.core.structure.cod_search">
<code class="sig-prename descclassname"><span class="pre">abipy.core.structure.</span></code><code class="sig-name descname"><span class="pre">cod_search</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#cod_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.cod_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the <a class="reference external" href="http://www.crystallography.net/cod/">COD</a> database. Get list of structures corresponding to a chemical formula</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Chemical formula (e.g., Fe2O3)</p></li>
<li><p><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True if primitive structures are wanted. Note that many COD structures are not primitive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">CodStructures</span></code> object with</dt><dd><p>List of Structure objects, COD ids associated to structures.
and List of dictionaries with COD data (same order as structures).</p>
</dd>
</dl>
<p>Note that the attributes evalute to False if no match is found</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="abipy.core.structure.Structure">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.structure.</span></code><code class="sig-name descname"><span class="pre">Structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.20)"><span class="pre">numpy.generic</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.20)"><span class="pre">numpy.generic</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.typing._array_like._SupportsArray</span><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pymatgen.org/pymatgen.core.lattice.html#pymatgen.core.lattice.Lattice" title="(in pymatgen v2022.0.7)"><span class="pre">pymatgen.core.lattice.Lattice</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pymatgen.org/pymatgen.core.periodic_table.html#pymatgen.core.periodic_table.Element" title="(in pymatgen v2022.0.7)"><span class="pre">pymatgen.core.periodic_table.Element</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pymatgen.org/pymatgen.core.periodic_table.html#pymatgen.core.periodic_table.Species" title="(in pymatgen v2022.0.7)"><span class="pre">pymatgen.core.periodic_table.Species</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pymatgen.org/pymatgen.core.periodic_table.html#pymatgen.core.periodic_table.DummySpecies" title="(in pymatgen v2022.0.7)"><span class="pre">pymatgen.core.periodic_table.DummySpecies</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pymatgen.org/pymatgen.core.composition.html#pymatgen.core.composition.Composition" title="(in pymatgen v2022.0.7)"><span class="pre">pymatgen.core.composition.Composition</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.20)"><span class="pre">numpy.generic</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><span class="pre">bytes</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.generic" title="(in NumPy v1.20)"><span class="pre">numpy.generic</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.typing._array_like._SupportsArray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_proximity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_unit_cell</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_are_cartesian</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_properties</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.core.structure.html#pymatgen.core.structure.Structure" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.Structure</span></code></a>, <a class="reference internal" href="#abipy.core.mixins.NotebookWriter" title="abipy.core.mixins.NotebookWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.NotebookWriter</span></code></a></p>
<p>Extends <a class="reference external" href="https://pymatgen.org/pymatgen.core.structure.html#pymatgen.core.structure.Structure" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.Structure</span></code></a> with Abinit-specific methods.</p>
<p>A <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook documenting the usage of this object is available at
&lt;<a class="reference external" href="https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/structure.ipynb">https://nbviewer.jupyter.org/github/abinit/abitutorials/blob/master/abitutorials/structure.ipynb</a>&gt;</p>
<p>For the pymatgen project see <a class="bibtex reference internal" href="../zzbiblio.html#ong2013" id="id11">[Ong2013]</a>.</p>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-bc249e2cc8c4ce7840aa415bc2d262f256a2b55b.png" alt="Inheritance diagram of Structure" usemap="#inheritance1cec5e4573" class="inheritance graphviz" /></div>
<map id="inheritance1cec5e4573" name="inheritance1cec5e4573">
<area shape="rect" id="node1" href="#abipy.core.mixins.NotebookWriter" target="_top" title="Mixin class for objects that are able to generate jupyter_ notebooks." alt="" coords="557,13,656,24"/>
<area shape="rect" id="node2" href="#abipy.core.structure.Structure" target="_top" title="Extends :class:`pymatgen.core.structure.Structure` with Abinit&#45;specific methods." alt="" coords="678,24,766,35"/>
</map><dl class="py method">
<dt id="abipy.core.structure.Structure.as_structure">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">as_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.as_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.as_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into a <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a>. Accepts:</p>
<blockquote>
<div><ul class="simple">
<li><p>Structure object.</p></li>
<li><p>Filename</p></li>
<li><p>Dictionaries (<a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> format or dictionaries with abinit variables).</p></li>
<li><p>Objects with a <code class="docutils literal notranslate"><span class="pre">structure</span></code> attribute.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_file">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a structure from a file. For example, anything ending in
a “cif” is assumed to be a Crystallographic Information Format file.
Supported formats include <a class="reference external" href="http://www.iucr.org/resources/cif">CIF</a>, POSCAR/CONTCAR, CHGCAR, LOCPOT,
vasprun.xml, CSSR, Netcdf and pymatgen’s JSON serialized structures.</p>
<dl class="simple">
<dt>Netcdf files supported:</dt><dd><p>All files produced by ABINIT with info of the crystalline geometry
HIST.nc, in this case the last structure of the history is returned.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The filename to read from.</p></li>
<li><p><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to convert to a primitive cell
Only available for cifs, POSCAR, CSSR, JSON, YAML
Defaults to True.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to sort sites. Default to False.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_mpid">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_mpid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">material_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_mpid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_mpid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a Structure corresponding to a material_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>material_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Materials Project material_id (a string, e.g., mp-1234).</p></li>
<li><p><strong>final</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to get the final structure, or the initial
(pre-relaxation) structure. Defaults to True.</p></li>
<li><p><strong>api_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – A String API key for accessing the MaterialsProject
REST interface. Please apply on the Materials Project website for one.
If this is None, the code will check if there is a <code class="docutils literal notranslate"><span class="pre">PMG_MAPI_KEY</span></code> in your .pmgrc.yaml.
If so, it will use that environment
This makes easier for heavy users to simply add this environment variable
to their setups and MPRester can then be called without any arguments.</p></li>
<li><p><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Url of endpoint to access the MaterialsProject REST interface.
Defaults to the standard Materials Project REST address, but
can be changed to other urls implementing a similar interface.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_cod_id">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_cod_id</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cod_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_cod_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_cod_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries the <a class="reference external" href="http://www.crystallography.net/cod/">COD</a> for a structure by id. Returns <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cod_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – COD id.</p></li>
<li><p><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True if primitive structures are wanted. Note that many COD structures are not primitive.</p></li>
<li><p><strong>kwargs</strong> – Arguments passed to <code class="docutils literal notranslate"><span class="pre">get_structure_by_id</span></code></p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_ase_atoms">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ase_atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_ase_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_ase_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns structure from ASE Atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atoms</strong> – ASE Atoms object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Equivalent Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.to_ase_atoms">
<code class="sig-name descname"><span class="pre">to_ase_atoms</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_ase_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_ase_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> Atoms object from structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.boxed_molecule">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">boxed_molecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.boxed_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.boxed_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a molecule in a periodic box of lengths acell [Bohr]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pseudos</strong> – List of pseudopotentials</p></li>
<li><p><strong>cart_coords</strong> – Cartesian coordinates</p></li>
<li><p><strong>acell</strong> – Lengths of the box in <em>Bohr</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.boxed_atom">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">boxed_atom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.boxed_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.boxed_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an atom in a periodic box of lengths acell [Bohr]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pseudo</strong> – Pseudopotential object.</p></li>
<li><p><strong>cart_coords</strong> – Cartesian coordinates in Angstrom</p></li>
<li><p><strong>acell</strong> – Lengths of the box in <em>Bohr</em> (Abinit input variable)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.bcc">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">bcc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.bcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.bcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive or a conventional bcc crystal structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Lattice parameter (Angstrom if units is not given)</p></li>
<li><p><strong>species</strong> – Chemical species. See __init__ method of <a class="reference external" href="https://pymatgen.org/pymatgen.core.structure.html#pymatgen.core.structure.Structure" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.Structure</span></code></a></p></li>
<li><p><strong>primitive</strong> – if True a primitive cell will be produced, otherwise a conventional one</p></li>
<li><p><strong>units</strong> – Units of input lattice parameters e.g. “bohr”, “pm”</p></li>
<li><p><strong>kwargs</strong> – All keyword arguments accepted by <a class="reference external" href="https://pymatgen.org/pymatgen.core.structure.html#pymatgen.core.structure.Structure" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.Structure</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.fcc">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">fcc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.fcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.fcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive or a conventional fcc crystal structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Lattice parameter (Angstrom if units is not given)</p></li>
<li><p><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
<li><p><strong>primitive</strong> – if True a primitive cell will be produced, otherwise a conventional one</p></li>
<li><p><strong>units</strong> – Units of input lattice parameters e.g. “bohr”, “pm”</p></li>
<li><p><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.zincblende">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">zincblende</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.zincblende"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.zincblende" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive zincblende crystal structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Lattice parameter (Angstrom if units is not given)</p></li>
<li><p><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
<li><p><strong>units</strong> – Units of input lattice parameters e.g. “bohr”, “pm”</p></li>
<li><p><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Structure</span><span class="o">.</span><span class="n">zincblende</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Zn&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.rocksalt">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">rocksalt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.rocksalt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.rocksalt" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a primitive fcc crystal structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Lattice parameter (Angstrom if units is not given)</p></li>
<li><p><strong>units</strong> – Units of input lattice parameters e.g. “bohr”, “pm”</p></li>
<li><p><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
<li><p><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Structure</span><span class="o">.</span><span class="n">rocksalt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Na&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.ABO3">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">ABO3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ang'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.ABO3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.ABO3" title="Permalink to this definition">¶</a></dt>
<dd><p>Peroviskite structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Lattice parameter (Angstrom if units is not given)</p></li>
<li><p><strong>species</strong> – Chemical species. See __init__ method of <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
<li><p><strong>units</strong> – Units of input lattice parameters e.g. “bohr”, “pm”</p></li>
<li><p><strong>kwargs</strong> – All keyword arguments accepted by <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.Structure</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_abistring">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_abistring</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_abistring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_abistring" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize Structure from string with Abinit input variables.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.from_abivars">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_abivars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.from_abivars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.from_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object from a dictionary with ABINIT variables.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">al_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="o">.</span><span class="n">from_abivars</span><span class="p">(</span>
    <span class="n">acell</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="mf">7.5</span><span class="p">],</span>
    <span class="n">rprim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
           <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
           <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="n">typat</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">xred</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="n">ntypat</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">znucl</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">xred</span></code> can be replaced with <code class="docutils literal notranslate"><span class="pre">xcart</span></code> or <code class="docutils literal notranslate"><span class="pre">xangst</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.species_by_znucl">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">species_by_znucl</span></code><a class="headerlink" href="#abipy.core.structure.Structure.species_by_znucl" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of unique specie found in the structure <strong>ordered according to sites</strong>.</p>
<p class="rubric">Example</p>
<p>Site0: 0.5 0 0 O
Site1: 0   0 0 Si</p>
<p>produces [Specie_O, Specie_Si] and not set([Specie_O, Specie_Si]) as in <cite>types_of_specie</cite>.</p>
<p>Important:: We call this method <cite>species_by_znucl</cite> but this does not mean that the list can automagically
reproduce the value of <cite>znucl(ntypat)</cite> specified in an <strong>arbitrary</strong> ABINIT input file created by the user.
This array is ordered as the znucl list produced by AbiPy when writing the structure to the input file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.to">
<code class="sig-name descname"><span class="pre">to</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.to" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs the structure to a file or string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Format to output to. Defaults to JSON unless filename
is provided. If fmt is specifies, it overrides whatever the
filename is. Options include “cif”, “poscar”, “cssr”, “json”.
Non-case sensitive.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – If provided, output will be written to a file. If
fmt is not specified, the format is determined from the
filename. Defaults is None, i.e. string output.</p></li>
<li><p><strong>**kwargs</strong> – Kwargs passthru to relevant methods. E.g., This allows
the passing of parameters like symprec to the
CifWriter.__init__ method for generation of symmetric cifs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(str) if filename is None. None otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.write_cif_with_spglib_symms">
<code class="sig-name descname"><span class="pre">write_cif_with_spglib_symms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significant_figures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.write_cif_with_spglib_symms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.write_cif_with_spglib_symms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – If not none, finds the symmetry of the structure
and writes the cif with symmetry information. Passes symprec
to the SpacegroupAnalyzer.</p></li>
<li><p><strong>significant_figures</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Specifies precision for formatting of floats.
Defaults to 8.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Angle tolerance for symmetry finding. Passes
angle_tolerance to the SpacegroupAnalyzer. Used only if symprec
is not None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.to_abivars">
<code class="sig-name descname"><span class="pre">to_abivars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enforce_znucl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_typat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.to_abivars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.to_abivars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary with the ABINIT variables.</p>
<p>enforce_znucl[ntypat] = Enforce this value for znucl.
enforce_typat[natom] = Fortran conventions. Start to count from 1.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.latex_formula">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">latex_formula</span></code><a class="headerlink" href="#abipy.core.structure.Structure.latex_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>LaTeX formatted formula. E.g., Fe2O3 is transformed to Fe$_{2}$O$_{3}$.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.abi_string">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">abi_string</span></code><a class="headerlink" href="#abipy.core.structure.Structure.abi_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with the ABINIT input associated to this structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_panel">
<code class="sig-name descname"><span class="pre">get_panel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build panel with widgets to interact with the structure either in a notebook or in a bokeh app</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_conventional_standard_structure">
<code class="sig-name descname"><span class="pre">get_conventional_standard_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">international_monoclinic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_conventional_standard_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_conventional_standard_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives a structure with a conventional cell according to certain
standards. The standards are defined in <a class="bibtex reference internal" href="../zzbiblio.html#setyawan2010" id="id12">[Setyawan2010]</a>
They basically enforce as much as possible norm(a1) &lt; norm(a2) &lt; norm(a3)</p>
<p>Returns: The structure in a conventional standardized cell</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.abi_primitive">
<code class="sig-name descname"><span class="pre">abi_primitive</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_idealize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.abi_primitive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.abi_primitive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.refine">
<code class="sig-name descname"><span class="pre">refine</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.refine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.refine" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the refined structure based on detected symmetry. The refined
structure is a <em>conventional</em> cell setting with atoms moved to the
expected symmetry positions.</p>
<p>Returns: Refined structure.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.abi_sanitize">
<code class="sig-name descname"><span class="pre">abi_sanitize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive_standard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.abi_sanitize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.abi_sanitize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new structure in which:</p>
<blockquote>
<div><ul class="simple">
<li><p>Structure is refined.</p></li>
<li><p>Reduced to primitive settings.</p></li>
<li><p>Lattice vectors are exchanged if the triple product is negative</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision used to refine the structure.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.
if <code class="docutils literal notranslate"><span class="pre">symprec</span></code> is None and <cite>angle_tolerance</cite> is None, no structure refinement is peformed.</p></li>
<li><p><strong>primitive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to convert to a primitive cell following <a class="bibtex reference internal" href="../zzbiblio.html#setyawan2010" id="id13">[Setyawan2010]</a></p></li>
<li><p><strong>primitive_standard</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Returns most primitive structure found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_oxi_state_decorated">
<code class="sig-name descname"><span class="pre">get_oxi_state_decorated</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_oxi_state_decorated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_oxi_state_decorated" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.bond_valence.html#pymatgen.analysis.bond_valence.BVAnalyzer" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.analysis.bond_valence.BVAnalyzer</span></code></a> to estimate oxidation states
Return oxidation state decorated structure.
This currently works only for ordered structures only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Arguments passed to BVAnalyzer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A modified structure that is oxidation state decorated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.reciprocal_lattice">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">reciprocal_lattice</span></code><a class="headerlink" href="#abipy.core.structure.Structure.reciprocal_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Reciprocal lattice of the structure. Note that this is the standard
reciprocal lattice used for solid state physics with a factor of 2 * pi
i.e.  a_j . b_j = 2pi delta_ij</p>
<p>If you are looking for the crystallographic reciprocal lattice,
use the reciprocal_lattice_crystallographic property.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.lattice_vectors">
<code class="sig-name descname"><span class="pre">lattice_vectors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.lattice_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.lattice_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the vectors of the unit cell in Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>space</strong> – “r” for real space vectors, “g” for reciprocal space basis vectors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.spget_lattice_type">
<code class="sig-name descname"><span class="pre">spget_lattice_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_lattice_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_lattice_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Call spglib to get the lattice for the structure, e.g., (triclinic,
orthorhombic, cubic, etc.).This is the same than the
crystal system with the exception of the hexagonal/rhombohedral lattice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision for distance</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lattice type for structure or None if type cannot be detected.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.spget_equivalent_atoms">
<code class="sig-name descname"><span class="pre">spget_equivalent_atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_equivalent_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_equivalent_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> to find the inequivalent atoms and build symmetry tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision for distance.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.</p></li>
<li><p><strong>printout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True to print symmetry tables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> (irred_pos, eqmap, spgdata) with the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">irred_pos</span><span class="p">:</span> <span class="n">array</span> <span class="n">giving</span> <span class="n">the</span> <span class="n">position</span> <span class="n">of</span> <span class="n">the</span> <span class="n">i</span><span class="o">-</span><span class="n">th</span> <span class="n">irred</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">structure</span><span class="o">.</span>
    <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">irred</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="nb">len</span><span class="p">(</span><span class="n">irred_pos</span><span class="p">)</span><span class="o">.</span>
<span class="o">*</span>   <span class="n">eqmap</span><span class="p">:</span> <span class="n">Mapping</span> <span class="n">irred</span> <span class="n">atom</span> <span class="n">position</span> <span class="o">--&gt;</span> <span class="nb">list</span> <span class="k">with</span> <span class="n">positions</span> <span class="n">of</span> <span class="n">symmetrical</span> <span class="n">atoms</span><span class="o">.</span>
<span class="o">*</span>   <span class="n">wyckoffs</span><span class="p">:</span> <span class="n">Wyckoff</span> <span class="n">letters</span><span class="o">.</span>
<span class="o">*</span>   <span class="n">wyck_mult</span><span class="p">:</span> <span class="n">Array</span> <span class="k">with</span> <span class="n">Wyckoff</span> <span class="n">multiplicity</span><span class="o">.</span>
<span class="o">*</span>   <span class="n">wyck_labels</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="n">labels</span> <span class="k">with</span> <span class="n">Wyckoff</span> <span class="n">multiplicity</span> <span class="ow">and</span> <span class="n">letter</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">3</span><span class="n">a</span>
<span class="o">*</span>   <span class="n">site_labels</span><span class="p">:</span> <span class="n">Labels</span> <span class="k">for</span> <span class="n">each</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">computed</span> <span class="kn">from</span> <span class="nn">element</span> <span class="n">symbol</span> <span class="ow">and</span> <span class="n">wyckoff</span> <span class="n">positions</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span> <span class="n">Si2a</span>
<span class="o">*</span>   <span class="n">spgdata</span><span class="p">:</span> <span class="n">spglib</span> <span class="n">dataset</span> <span class="k">with</span> <span class="n">additional</span> <span class="n">data</span> <span class="n">reported</span> <span class="n">by</span> <span class="n">spglib_</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><dl class="simple">
<dt>for irr_pos in irred_pos:</dt><dd><p>eqmap[irr_pos]   # List of symmetrical positions associated to the irr_pos atom.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.spget_summary">
<code class="sig-name descname"><span class="pre">spget_summary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with full information about crystalline structure i.e.
space group, point group, wyckoff positions, equivalent sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision for distance.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.</p></li>
<li><p><strong>site_symmetry</strong> – True to show site symmetries i.e. the point group operations that leave the site invariant.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.abi_spacegroup">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">abi_spacegroup</span></code><a class="headerlink" href="#abipy.core.structure.Structure.abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitSpaceGroup</span></code> instance with Abinit symmetries read from the netcd file.
None if abinit symmetries are not available e.g. if the structure has been created
from a CIF file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.set_abi_spacegroup">
<code class="sig-name descname"><span class="pre">set_abi_spacegroup</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spacegroup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.set_abi_spacegroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.set_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">AbinitSpaceGroup</span></code> setter.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.has_abi_spacegroup">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_abi_spacegroup</span></code><a class="headerlink" href="#abipy.core.structure.Structure.has_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>True is the structure contains info on the spacegroup.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.spgset_abi_spacegroup">
<code class="sig-name descname"><span class="pre">spgset_abi_spacegroup</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_timerev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spgset_abi_spacegroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.spgset_abi_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Call spglib to find the spacegroup of the crystal, create new
<code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitSpaceGroup</span></code> object and store it in <code class="docutils literal notranslate"><span class="pre">self.abi_spacegroup</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_timerev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True if time-reversal can be used.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – By default, the method raises <cite>ValueError</cite> if the object
already has the list of symmetries found by Abinit.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbinitSpaceGroup</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.indsym">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">indsym</span></code><a class="headerlink" href="#abipy.core.structure.Structure.indsym" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute indsym (natom, nsym, 4) array.</p>
<p>For each isym,iatom, the fourth element is label of atom into
which iatom is sent by INVERSE of symmetry operation isym;
first three elements are the primitive translations which must be
subtracted after the transformation to get back to the original unit cell (see symatm.F90).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.site_symmetries">
<code class="sig-name descname"><span class="pre">site_symmetries</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.site_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.site_symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Object with SiteSymmetries.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.spget_site_symmetries">
<code class="sig-name descname"><span class="pre">spget_site_symmetries</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.spget_site_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.spget_site_symmetries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.abiget_spginfo">
<code class="sig-name descname"><span class="pre">abiget_spginfo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tolsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.abiget_spginfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.abiget_spginfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Call Abinit to get spacegroup information.
Return dictionary with e.g.
{‘bravais’: ‘Bravais cF (face-center cubic)’, ‘spg_number’: 227, ‘spg_symbol’: ‘Fd-3m’}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tolsym</strong> – Abinit tolsym input variable. None correspondes to the default value.</p></li>
<li><p><strong>pre</strong> – Keywords in dictionary are prepended with this string</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.print_neighbors">
<code class="sig-name descname"><span class="pre">print_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.print_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.print_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get neighbors for each atom in the unit cell, out to a distance <code class="docutils literal notranslate"><span class="pre">radius</span></code> in Angstrom
Print results.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.hsym_kpath">
<code class="sig-name descname"><span class="pre">hsym_kpath</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_kpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_kpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference external" href="https://pymatgen.org/pymatgen.symmetry.bandstructure.html#pymatgen.symmetry.bandstructure.HighSymmKpath" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.symmetry.bandstructure.HighSymmKpath</span></code></a>.
(Database of high symmetry k-points and high symmetry lines).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.hsym_kpoints">
<code class="sig-name descname"><span class="pre">hsym_kpoints</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_kpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_kpoints" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.core.kpoints.KpointList" title="abipy.core.kpoints.KpointList"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointList</span></code></a> object with the high-symmetry K-points.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_kcoords_from_names">
<code class="sig-name descname"><span class="pre">get_kcoords_from_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">knames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_kcoords_from_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_kcoords_from_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return numpy array with the fractional coordinates of the high-symmetry k-points listed in <cite>knames</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knames</strong> – List of strings with the k-point labels.</p></li>
<li><p><strong>cart_coords</strong> – True if the <code class="docutils literal notranslate"><span class="pre">coords</span></code> dataframe should contain Cartesian cordinates
instead of Reduced coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.hsym_stars">
<code class="sig-name descname"><span class="pre">hsym_stars</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.hsym_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.hsym_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>List of <a class="reference internal" href="#abipy.core.kpoints.KpointStar" title="abipy.core.kpoints.KpointStar"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.kpoints.KpointStar</span></code></a> objects. Each star is associated to one of the special k-points
present in the pymatgen database.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_sorted_structure_z">
<code class="sig-name descname"><span class="pre">get_sorted_structure_z</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_sorted_structure_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_sorted_structure_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Order the structure according to increasing Z of the elements</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.findname_in_hsym_stars">
<code class="sig-name descname"><span class="pre">findname_in_hsym_stars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.findname_in_hsym_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.findname_in_hsym_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the special k-point, None if kpoint is unknown.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_symbol2indices">
<code class="sig-name descname"><span class="pre">get_symbol2indices</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_symbol2indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_symbol2indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping chemical symbols to numpy array with the position of the atoms.</p>
<p class="rubric">Example</p>
<p>MgB2 –&gt; {Mg: [0], B: [1, 2]}</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_symbol2coords">
<code class="sig-name descname"><span class="pre">get_symbol2coords</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_symbol2coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_symbol2coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping chemical symbols to a [ntype_symbol, 3] numpy array
with the fractional coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.dot">
<code class="sig-name descname"><span class="pre">dot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the scalar product of vector(s) either in real space or
reciprocal space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>3x1 array</em>) – Array-like object with the coordinates.</p></li>
<li><p><strong>space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – “r” for real space, “g” for reciprocal space.</p></li>
<li><p><strong>frac_coords</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether the vector corresponds to fractional or
cartesian coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>one-dimensional <cite>numpy</cite> array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.norm">
<code class="sig-name descname"><span class="pre">norm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the norm of vector(s) either in real space or reciprocal space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>3x1 array</em>) – Array-like object with the coordinates.</p></li>
<li><p><strong>space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – “r” for real space, “g” for reciprocal space.</p></li>
<li><p><strong>frac_coords</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether the vector corresponds to fractional or
cartesian coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>one-dimensional <cite>numpy</cite> array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.scale_lattice">
<code class="sig-name descname"><span class="pre">scale_lattice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_volume</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.scale_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.scale_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> with volume new_volume by performing a
scaling of the lattice vectors so that length proportions and angles are preserved.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_dict4pandas">
<code class="sig-name descname"><span class="pre">get_dict4pandas</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_dict4pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_dict4pandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code> with the most important structural parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>Chemical formula and number of atoms.</p></li>
<li><p>Lattice lengths, angles and volume.</p></li>
<li><p>The spacegroup number computed by Abinit (set to None if not available).</p></li>
<li><p>The spacegroup number and symbol computed by spglib (if <cite>with_spglib</cite>).</p></li>
</ul>
</div></blockquote>
<p>Useful to construct pandas DataFrames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_spglib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, spglib is invoked to get the spacegroup symbol and number</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision used to refine the structure.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_symb2coords_dataframe">
<code class="sig-name descname"><span class="pre">get_symb2coords_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_cart_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_symb2coords_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_symb2coords_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary mapping element symbol to DataFrame with atomic positions
in cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>with_cart_coords</strong> – True if Cartesian coordinates should be added as well.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot structure in 3D with matplotlib. Return matplotlib Figure
See plot_structure for kwargs</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot_bz">
<code class="sig-name descname"><span class="pre">plot_bz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmg_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_bz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_bz" title="Permalink to this definition">¶</a></dt>
<dd><p>Use matplotlib to plot the symmetry line path in the Brillouin Zone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code> or None if a new figure should be created.</p></li>
<li><p><strong>pmg_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True if the default path used in pymatgen should be show.</p></li>
<li><p><strong>with_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – True to plot k-point labels.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a>.</p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot_xrd">
<code class="sig-name descname"><span class="pre">plot_xrd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CuKa'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debye_waller_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_theta_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">90)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_xrd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_xrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Use pymatgen <code class="xref py py-class docutils literal notranslate"><span class="pre">XRDCalculator</span></code> to show the XRD plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>str/float</em>) – The wavelength can be specified as either a
float or a string. If it is a string, it must be one of the
supported definitions in the AVAILABLE_RADIATION class
variable, which provides useful commonly used wavelengths.
If it is a float, it is interpreted as a wavelength in
angstroms. Defaults to “CuKa”, i.e, Cu K_alpha radiation.</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision for structure refinement. If
set to 0, no refinement is done. Otherwise, refinement is
performed using <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> with provided precision.</p></li>
<li><p><strong>(</strong><strong>{element symbol</strong> (<em>debye_waller_factors</em>) – float}): Allows the
specification of Debye-Waller factors. Note that these
factors are temperature dependent.</p></li>
<li><p><strong>two_theta_range</strong> (<em>[</em><em>float of length 2</em><em>]</em>) – Tuple for range of
two_thetas to calculate in degrees. Defaults to (0, 90). Set to
None if you want all diffracted beams within the limiting
sphere of radius 2 / wavelength.</p></li>
<li><p><strong>annotate_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to annotate the peaks with plane information.</p></li>
<li><p><strong>ax</strong> – matplotlib <code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code> or None if a new figure should be created.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.yield_figs">
<code class="sig-name descname"><span class="pre">yield_figs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.yield_figs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.yield_figs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function <em>generates</em> a predefined list of matplotlib figures with minimal input from the user.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.export">
<code class="sig-name descname"><span class="pre">export</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the crystalline structure to file <code class="docutils literal notranslate"><span class="pre">filename</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String specifying the file path and the file format.
The format is defined by the file extension. filename=”prefix.xsf”, for example,
will produce a file in XSF format. An <em>empty</em> prefix, e.g. “.xsf” makes the code use a temporary file.</p></li>
<li><p><strong>visu</strong> – <a class="reference internal" href="iotools_api.html#abipy.iotools.visualizer.Visualizer" title="abipy.iotools.visualizer.Visualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.visualizer.Visualizer</span></code></a> subclass. By default, this method returns the first available
visualizer that supports the given file format. If visu is not None, an
instance of visu is returned. See <a class="reference internal" href="iotools_api.html#abipy.iotools.visualizer.Visualizer" title="abipy.iotools.visualizer.Visualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.visualizer.Visualizer</span></code></a> for the list of applications and formats supported.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
</ul>
</dd>
</dl>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Visulizer</span></code> instance.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_chemview">
<code class="sig-name descname"><span class="pre">get_chemview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_chemview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_chemview" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize structure inside the jupyter notebook using chemview package.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot_vtk">
<code class="sig-name descname"><span class="pre">plot_vtk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_vtk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_vtk" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize structure with VTK. Requires vVTK python bindings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> – True to show structure immediately.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureVis</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Return: StructureVis object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot_mayaview">
<code class="sig-name descname"><span class="pre">plot_mayaview</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_mayaview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_mayaview" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize structure with mayavi.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.plot_atoms">
<code class="sig-name descname"><span class="pre">plot_atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.plot_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.plot_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot 2d representation with matplotlib using ASE <cite>plot_atoms</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rotations</strong> – String or List of strings.
Each string defines a rotation (in degrees) in the form ‘10x,20y,30z’
Note that the order of rotation matters, i.e. ‘50x,40z’ is different from ‘40z,50x’.</p></li>
<li><p><strong>kwargs</strong> – extra kwargs passed to plot_atoms ASE function.</p></li>
</ul>
</dd>
</dl>
<p>Returns: <a class="reference external" href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="(in Matplotlib v3.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></a></p>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_ngl_view">
<code class="sig-name descname"><span class="pre">get_ngl_view</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_ngl_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_ngl_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the structure with nglview inside the jupyter notebook.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_crystaltk_view">
<code class="sig-name descname"><span class="pre">get_crystaltk_view</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_crystaltk_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_crystaltk_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the structure with crystal_toolkit inside the jupyter notebook.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_jsmol_view">
<code class="sig-name descname"><span class="pre">get_jsmol_view</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_jsmol_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_jsmol_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the structure with jsmol inside the jupyter notebook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – If not none, finds the symmetry of the structure
and writes the CIF with symmetry information.
Passes symprec to the spglib SpacegroupAnalyzer.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.visualize">
<code class="sig-name descname"><span class="pre">visualize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">appname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vesta'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the crystalline structure with visualizer.
See <a class="reference internal" href="iotools_api.html#abipy.iotools.visualizer.Visualizer" title="abipy.iotools.visualizer.Visualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.iotools.visualizer.Visualizer</span></code></a> for the list of applications and formats supported.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.convert">
<code class="sig-name descname"><span class="pre">convert</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cif'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with the structure in the given format <cite>fmt</cite>
Options include “abivars”, “cif”, “xsf”, “poscar”, “siesta”, “wannier90”, “cssr”, “json”.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.displace">
<code class="sig-name descname"><span class="pre">displace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">displ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.displace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.displace" title="Permalink to this definition">¶</a></dt>
<dd><p>Displace the sites of the structure along the displacement vector displ.</p>
<p>The displacement vector is first rescaled so that the maxium atomic displacement
is one Angstrom, and then multiplied by eta. Hence passing eta=0.001, will move
all the atoms so that the maximum atomic displacement is 0.001 Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>displ</strong> – Displacement vector with 3*len(self) entries (fractional coordinates).</p></li>
<li><p><strong>eta</strong> – Scaling factor.</p></li>
<li><p><strong>frac_coords</strong> – Boolean stating whether the vector corresponds to fractional or cartesian coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_smallest_supercell">
<code class="sig-name descname"><span class="pre">get_smallest_supercell</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_smallest_supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_smallest_supercell" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinates in reciprocal space</p></li>
<li><p><strong>max_supercell</strong> – vector with the maximum supercell size</p></li>
</ul>
</dd>
</dl>
<p>Returns: the scaling matrix of the supercell</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_trans_vect">
<code class="sig-name descname"><span class="pre">get_trans_vect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_trans_vect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_trans_vect" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the translation vectors for a given scale matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale_matrix</strong> – Scale matrix defining the new lattice vectors in term of the old ones</p>
</dd>
</dl>
<p>Return: the translation vectors</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.write_vib_file">
<code class="sig-name descname"><span class="pre">write_vib_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">displ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.write_vib_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.write_vib_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write into the file descriptor xyz_file the positions and displacements of the atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz_file</strong> – file_descriptor</p></li>
<li><p><strong>qpoint</strong> – qpoint to be analyzed</p></li>
<li><p><strong>displ</strong> – eigendisplacements to be analyzed</p></li>
<li><p><strong>do_real</strong> – True if you want to get only real part, False means imaginary part</p></li>
<li><p><strong>frac_coords</strong> – True if the eigendisplacements are given in fractional coordinates</p></li>
<li><p><strong>scale_matrix</strong> – Scale matrix for supercell</p></li>
<li><p><strong>max_supercell</strong> – Maximum size of supercell vectors with respect to primitive cell</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.frozen_2phonon">
<code class="sig-name descname"><span class="pre">frozen_2phonon</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">displ1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">displ2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.frozen_2phonon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.frozen_2phonon" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the supercell needed for a given qpoint and adds the displacements.
The displacements are normalized so that the largest atomic displacement will correspond to the
value of eta in Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space.</p></li>
<li><p><strong>displ1</strong> – first displacement in real space of the atoms.</p></li>
<li><p><strong>displ2</strong> – second displacement in real space of the atoms.</p></li>
<li><p><strong>eta</strong> – pre-factor multiplying the displacement. Gives the value in Angstrom of the
largest displacement.</p></li>
<li><p><strong>frac_coords</strong> – whether the displacements are given in fractional or cartesian coordinates</p></li>
<li><p><strong>scale_matrix</strong> – the scaling matrix of the supercell. If None a scaling matrix suitable for
the qpoint will be determined.</p></li>
<li><p><strong>max_supercell</strong> – mandatory if scale_matrix is None, ignored otherwise. Defines the largest
supercell in the search for a scaling matrix suitable for the q point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A namedtuple with a Structure with the displaced atoms, a numpy array containing the
displacements applied to each atom and the scale matrix used to generate the supercell.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.frozen_phonon">
<code class="sig-name descname"><span class="pre">frozen_phonon</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">displ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_supercell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.frozen_phonon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.frozen_phonon" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a supercell with displaced atoms for the specified q-point.
The displacements are normalized so that the largest atomic displacement will correspond to the
value of eta in Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> – q vector in reduced coordinate in reciprocal space.</p></li>
<li><p><strong>displ</strong> – displacement in real space of the atoms.</p></li>
<li><p><strong>eta</strong> – pre-factor multiplying the displacement. Gives the value in Angstrom of the
largest displacement.</p></li>
<li><p><strong>frac_coords</strong> – whether the displacements are given in fractional or cartesian coordinates</p></li>
<li><p><strong>scale_matrix</strong> – the scaling matrix of the supercell. If None a scaling matrix suitable for
the qpoint will be determined.</p></li>
<li><p><strong>max_supercell</strong> – mandatory if scale_matrix is None, ignored otherwise. Defines the largest
supercell in the search for a scaling matrix suitable for the q point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A namedtuple with a Structure with the displaced atoms, a numpy array containing the
displacements applied to each atom and the scale matrix used to generate the supercell.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.calc_kptbounds">
<code class="sig-name descname"><span class="pre">calc_kptbounds</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_kptbounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_kptbounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the suggested value for the ABINIT variable <code class="docutils literal notranslate"><span class="pre">kptbounds</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.get_kpath_input_string">
<code class="sig-name descname"><span class="pre">get_kpath_input_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'abinit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.get_kpath_input_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.get_kpath_input_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with input variables for band-structure calculations
in the format used by code <cite>fmt</cite>.
Use <cite>line_density</cite> points for the smallest segment (if supported by code).</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.calc_ksampling">
<code class="sig-name descname"><span class="pre">calc_ksampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nksmall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_ksampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_ksampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-point sampling from the number of divisions <code class="docutils literal notranslate"><span class="pre">nksmall</span></code> to be used for
the smallest reciprocal lattice vector.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.calc_ngkpt">
<code class="sig-name descname"><span class="pre">calc_ngkpt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nksmall</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_ngkpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_ngkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ABINIT variable <code class="docutils literal notranslate"><span class="pre">ngkpt</span></code> from the number of divisions used
for the smallest lattice vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nksmall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of division for the smallest lattice vector.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.calc_shiftk">
<code class="sig-name descname"><span class="pre">calc_shiftk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.calc_shiftk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.calc_shiftk" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the values of <code class="docutils literal notranslate"><span class="pre">shiftk</span></code> and <code class="docutils literal notranslate"><span class="pre">nshiftk</span></code> appropriated for the sampling of the Brillouin zone.</p>
<p>When the primitive vectors of the lattice do NOT form a FCC or a BCC lattice,
the usual (shifted) Monkhorst-Pack grids are formed by using nshiftk=1 and shiftk 0.5 0.5 0.5 .
This is often the preferred k point sampling. For a non-shifted Monkhorst-Pack grid,
use <cite>nshiftk=1</cite> and <cite>shiftk 0.0 0.0 0.0</cite>, but there is little reason to do that.</p>
<p>When the primitive vectors of the lattice form a FCC lattice, with rprim:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>the (very efficient) usual Monkhorst-Pack sampling will be generated by using nshiftk= 4 and shiftk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.5</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>When the primitive vectors of the lattice form a BCC lattice, with rprim:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>
 <span class="mf">0.5</span> <span class="o">-</span><span class="mf">0.5</span>  <span class="mf">0.5</span>
 <span class="mf">0.5</span>  <span class="mf">0.5</span> <span class="o">-</span><span class="mf">0.5</span>
</pre></div>
</div>
<p>the usual Monkhorst-Pack sampling will be generated by using nshiftk= 2 and shiftk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mf">0.25</span>  <span class="mf">0.25</span>  <span class="mf">0.25</span>
<span class="o">-</span><span class="mf">0.25</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">-</span><span class="mf">0.25</span>
</pre></div>
</div>
<p>However, the simple sampling nshiftk=1 and shiftk 0.5 0.5 0.5 is excellent.</p>
<p>For hexagonal lattices with hexagonal axes, e.g. rprim:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mf">1.0</span>  <span class="mf">0.0</span>       <span class="mf">0.0</span>
<span class="o">-</span><span class="mf">0.5</span>  <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="mf">0.0</span>
 <span class="mf">0.0</span>  <span class="mf">0.0</span>       <span class="mf">1.0</span>
</pre></div>
</div>
<p>one can use nshiftk= 1 and shiftk 0.0 0.0 0.5
In rhombohedral axes, e.g. using angdeg 3*60., this corresponds to shiftk 0.5 0.5 0.5,
to keep the shift along the symmetry axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Suggested value of shiftk.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.num_valence_electrons">
<code class="sig-name descname"><span class="pre">num_valence_electrons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.num_valence_electrons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.num_valence_electrons" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of valence electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pseudos</strong> – List of <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.Pseudo" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.Pseudo</span></code></a> objects or list of filenames.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.valence_electrons_per_atom">
<code class="sig-name descname"><span class="pre">valence_electrons_per_atom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pseudos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.valence_electrons_per_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.valence_electrons_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of valence electrons for each atom in the structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pseudos</strong> – List of <a class="reference external" href="https://pymatgen.org/pymatgen.io.abinit.pseudos.html#pymatgen.io.abinit.pseudos.Pseudo" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.io.abinit.pseudos.Pseudo</span></code></a> objects or list of filenames.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.structure.Structure.write_notebook">
<code class="sig-name descname"><span class="pre">write_notebook</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#Structure.write_notebook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.Structure.write_notebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <a class="reference external" href="http://jupyter.org/">jupyter</a> notebook to <code class="docutils literal notranslate"><span class="pre">nbpath</span></code>. If nbpath is None, a temporay file in the current
working directory is created. Return path to the notebook.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="abipy.core.structure.dataframes_from_structures">
<code class="sig-prename descclassname"><span class="pre">abipy.core.structure.</span></code><code class="sig-name descname"><span class="pre">dataframes_from_structures</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struct_objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_spglib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/structure.html#dataframes_from_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.structure.dataframes_from_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Build two pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">Dataframes</a> with the most important geometrical parameters associated to
a list of structures or a list of objects that can be converted into structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struct_objects</strong> – List of objects that can be converted to structure.
Support filenames, structure objects, Abinit input files, dicts and many more types.
See <code class="docutils literal notranslate"><span class="pre">Structure.as_structure</span></code> for the complete list.</p></li>
<li><p><strong>index</strong> – Index of the <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p></li>
<li><p><strong>symprec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Symmetry precision used to refine the structure.</p></li>
<li><p><strong>angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Tolerance on angles.</p></li>
<li><p><strong>with_spglib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, <a class="reference external" href="https://atztogo.github.io/spglib/">spglib</a> is invoked to get the spacegroup symbol and number.</p></li>
<li><p><strong>cart_coords</strong> – True if the <code class="docutils literal notranslate"><span class="pre">coords</span></code> dataframe should contain Cartesian cordinates
instead of Reduced coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>namedtuple with two <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> named <code class="docutils literal notranslate"><span class="pre">lattice</span></code> and <code class="docutils literal notranslate"><span class="pre">coords</span></code>
<code class="docutils literal notranslate"><span class="pre">lattice</span></code> contains the lattice parameters. <code class="docutils literal notranslate"><span class="pre">coords</span></code> the atomic positions..
The list of structures is available in the <code class="docutils literal notranslate"><span class="pre">structures</span></code> entry.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="n">dataframes_from_structures</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="n">dfs</span><span class="o">.</span><span class="n">lattice</span>
<span class="n">dfs</span><span class="o">.</span><span class="n">coords</span>
<span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">structures</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-abipy.core.symmetries">
<span id="symmetries-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">symmetries</span></code> Module</a><a class="headerlink" href="#module-abipy.core.symmetries" title="Permalink to this headline">¶</a></h2>
<p>Objects used to deal with symmetry operations in crystals.</p>
<dl class="py class">
<dt id="abipy.core.symmetries.LatticeRotation">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.symmetries.</span></code><code class="sig-name descname"><span class="pre">LatticeRotation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.symmetries.Operation</span></code></p>
<p>This object defines a pure rotation of the lattice (proper, improper, mirror symmetry)
that is a rotation which is compatible with a lattice. The rotation matrix is
expressed in reduced coordinates, therefore its elements are integers.</p>
<dl class="simple">
<dt>See:</dt><dd><p><a class="reference external" href="http://xrayweb2.chem.ou.edu/notes/symmetry.html#rotation">http://xrayweb2.chem.ou.edu/notes/symmetry.html#rotation</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This object is immutable and therefore we do not inherit from <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
</div>
<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.inverse">
<code class="sig-name descname"><span class="pre">inverse</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Invert an orthogonal 3x3 matrix of INTEGER elements.
Note use of integer arithmetic. Raise ValueError if not invertible.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.isE">
<code class="sig-name descname"><span class="pre">isE</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.isE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.isE" title="Permalink to this definition">¶</a></dt>
<dd><p>True if it is the identity</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.order">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">order</span></code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order of the rotation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.root_inv">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">root_inv</span></code><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.root_inv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.det">
<code class="sig-name descname"><span class="pre">det</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.det"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.det" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the determinant of a symmetry matrix mat[3,3]. It must be +-1</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.trace">
<code class="sig-name descname"><span class="pre">trace</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>The trace of the rotation matrix</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.is_proper">
<code class="sig-name descname"><span class="pre">is_proper</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.is_proper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.is_proper" title="Permalink to this definition">¶</a></dt>
<dd><p>True if proper rotation</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.isI">
<code class="sig-name descname"><span class="pre">isI</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.isI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.isI" title="Permalink to this definition">¶</a></dt>
<dd><p>True if self is the inversion operation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.LatticeRotation.name">
<code class="sig-name descname"><span class="pre">name</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#LatticeRotation.name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.LatticeRotation.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="abipy.core.symmetries.AbinitSpaceGroup">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.symmetries.</span></code><code class="sig-name descname"><span class="pre">AbinitSpaceGroup</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spgid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symrel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tnons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symafm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timerev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.symmetries.OpSequence</span></code></p>
<p>Container storing the space group symmetries.</p>
<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.from_ncreader">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_ncreader</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.from_ncreader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.from_ncreader" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the object from a netcdf reader</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.from_structure">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_timerev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.from_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object. Uses spglib to perform various symmetry finding operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p></li>
<li><p><strong>has_timerev</strong> – True is time-reversal symmetry is included.</p></li>
<li><p><strong>symprec</strong> – Tolerance for symmetry finding.</p></li>
<li><p><strong>angle_tolerance</strong> – Angle tolerance for symmetry finding.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>AFM symmetries are not supported.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.is_symmorphic">
<code class="sig-name descname"><span class="pre">is_symmorphic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.is_symmorphic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.is_symmorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>True if there’s at least one operation with non-zero fractional translation.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.has_timerev">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">has_timerev</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.has_timerev" title="Permalink to this definition">¶</a></dt>
<dd><p>True if time-reversal symmetry is present.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symrel">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">symrel</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symrel" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsym, 3, 3] int array with symmetries in reduced coordinates of the direct lattice.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.tnons">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tnons</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.tnons" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsym, 3] float array with fractional translations in reduced coordinates of the direct lattice.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symrec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">symrec</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symrec" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsym, 3, 3] int array with symmetries in reduced coordinates of the reciprocal lattice.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symafm">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">symafm</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symafm" title="Permalink to this definition">¶</a></dt>
<dd><p>[nsym] int array with +1 if FM or -1 if AFM symmetry.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.num_spatial_symmetries">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_spatial_symmetries</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.num_spatial_symmetries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.afm_symmops">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">afm_symmops</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.afm_symmops" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with antiferromagnetic symmetries.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.fm_symmops">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">fm_symmops</span></code><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.fm_symmops" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of ferromagnetic symmetries.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symmops">
<code class="sig-name descname"><span class="pre">symmops</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">afm_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.symmops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symmops" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_sign</strong> – If specified, only symmetries with time-reversal sign time_sign are returned.</p></li>
<li><p><strong>afm_sign</strong> – If specified, only symmetries with anti-ferromagnetic part afm_sign are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">SymmOp</span></code> instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.symeq">
<code class="sig-name descname"><span class="pre">symeq</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1_frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2_frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.symeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.symeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether two k-points in fractional coordinates are symmetry equivalent
i.e. if there’s a symmetry operations TO (including time-reversal T, if present)
such that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TO</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k2</span> <span class="o">+</span> <span class="n">G0</span>
</pre></div>
</div>
<p>Return: namedtuple with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">isym</span><span class="p">:</span> <span class="n">The</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symmetry</span> <span class="n">operation</span> <span class="n">such</span> <span class="n">that</span> <span class="n">TS</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="n">k2</span> <span class="o">+</span> <span class="n">G0</span>
    <span class="n">Set</span> <span class="n">to</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">k1</span> <span class="ow">and</span> <span class="n">k2</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">related</span> <span class="n">by</span> <span class="n">symmetry</span><span class="o">.</span>
<span class="n">op</span><span class="p">:</span> <span class="n">Symmetry</span> <span class="n">operation</span><span class="o">.</span>
<span class="n">g0</span><span class="p">:</span> <span class="n">numpy</span> <span class="n">vector</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.find_little_group">
<code class="sig-name descname"><span class="pre">find_little_group</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.find_little_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.find_little_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the little group of the kpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpoint</strong> – Accept vector with the reduced coordinates or <code class="xref py py-class docutils literal notranslate"><span class="pre">Kpoint</span></code> object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">LittleGroup</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.symmetries.AbinitSpaceGroup.get_spglib_hall_number">
<code class="sig-name descname"><span class="pre">get_spglib_hall_number</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/symmetries.html#AbinitSpaceGroup.get_spglib_hall_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.symmetries.AbinitSpaceGroup.get_spglib_hall_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses spglib.get_hall_number_from_symmetry to determine the hall number
based on the symmetry operations. Useful when the space group number
is not available, but the symmetries are (e.g. the DDB file)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symprec</strong> – distance tolerance in fractional coordinates (not the standard
in cartesian coordinates). See spglib docs for more details.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the hall number.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.testing">
<span id="testing-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">testing</span></code> Module</a><a class="headerlink" href="#module-abipy.core.testing" title="Permalink to this headline">¶</a></h2>
<p>Common test support for all AbiPy test scripts.</p>
<p>This single module should provide all the common functionality for abipy tests
in a single location, so that test scripts can just import it and work right away.</p>
<dl class="py class">
<dt id="abipy.core.testing.AbipyTest">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.testing.</span></code><code class="sig-name descname"><span class="pre">AbipyTest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methodName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'runTest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pymatgen.org/pymatgen.util.testing.html#pymatgen.util.testing.PymatgenTest" title="(in pymatgen v2022.0.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.util.testing.PymatgenTest</span></code></a></p>
<p>Extends PymatgenTest with Abinit-specific methods.
Several helper functions are implemented as static methods so that we
can easily reuse the code in the pytest integration tests.</p>
<dl class="py exception">
<dt id="abipy.core.testing.AbipyTest.SkipTest">
<em class="property"><span class="pre">exception</span> </em><code class="sig-name descname"><span class="pre">SkipTest</span></code><a class="headerlink" href="#abipy.core.testing.AbipyTest.SkipTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Raise this exception in a test to skip it.</p>
<p>Usually you can use TestCase.skipTest() or one of the skipping decorators
instead of raising this directly.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.which">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">which</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">program</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.which"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.which" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns full path to a executable. None if not found or not executable.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_abinit">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_abinit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_abinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_abinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if abinit is in $PATH and version is op min_version.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.skip_if_abinit_not_ge">
<code class="sig-name descname"><span class="pre">skip_if_abinit_not_ge</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_abinit_not_ge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_abinit_not_ge" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip test if Abinit version is not &gt;= <cite>version</cite></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_matplotlib">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_matplotlib</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_matplotlib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_matplotlib" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_plotly">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_plotly</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_plotly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_plotly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_seaborn">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_seaborn</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_seaborn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_seaborn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_ase">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_ase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_ase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_ase" title="Permalink to this definition">¶</a></dt>
<dd><p>True if <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> package is available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_skimage">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_skimage</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_skimage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_skimage" title="Permalink to this definition">¶</a></dt>
<dd><p>True if skimage package is available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_python_graphviz">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_python_graphviz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">need_dotexec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_python_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_python_graphviz" title="Permalink to this definition">¶</a></dt>
<dd><p>True if python-graphviz package is installed and dot executable in path.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_mayavi">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_mayavi</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_mayavi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_mayavi" title="Permalink to this definition">¶</a></dt>
<dd><p>True if <a class="reference external" href="http://docs.enthought.com/mayavi/mayavi/">mayavi</a> is available. Set also offscreen to True</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_panel">
<code class="sig-name descname"><span class="pre">has_panel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_panel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_panel" title="Permalink to this definition">¶</a></dt>
<dd><p>False if Panel library is not installed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_networkx">
<code class="sig-name descname"><span class="pre">has_networkx</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_networkx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_networkx" title="Permalink to this definition">¶</a></dt>
<dd><p>False if networkx library is not installed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_graphviz">
<code class="sig-name descname"><span class="pre">has_graphviz</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_graphviz" title="Permalink to this definition">¶</a></dt>
<dd><p>True if graphviz library is installed and <cite>dot</cite> in $PATH</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.get_abistructure_from_abiref">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_abistructure_from_abiref</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_abistructure_from_abiref"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_abistructure_from_abiref" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an Abipy <a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> from the basename of one of the reference files.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.mkdtemp">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">mkdtemp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.mkdtemp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.mkdtemp" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke mkdtep with kwargs, return the name of a temporary directory.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.tmpfileindir">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">tmpfileindir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.tmpfileindir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.tmpfileindir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute path of a temporary file with basename <code class="docutils literal notranslate"><span class="pre">basename</span></code> created in a temporary directory.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.get_tmpname">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_tmpname</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_tmpname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_tmpname" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke mkstep with kwargs, return the name of a temporary file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.tmpfile_write">
<code class="sig-name descname"><span class="pre">tmpfile_write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.tmpfile_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.tmpfile_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write string to a temporary file. Returns the name of the temporary file.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_nbformat">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_nbformat</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_nbformat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_nbformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if nbformat is available and we can test the generation of <a class="reference external" href="http://jupyter.org/">jupyter</a> notebooks.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.run_nbpath">
<code class="sig-name descname"><span class="pre">run_nbpath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.run_nbpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.run_nbpath" title="Permalink to this definition">¶</a></dt>
<dd><p>Test that the notebook in question runs all cells correctly.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.has_ipywidgets">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">has_ipywidgets</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.has_ipywidgets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.has_ipywidgets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if <a class="reference external" href="https://github.com/jupyter-widgets/ipywidgets">ipywidgets</a> package is available.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.assert_almost_equal">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">assert_almost_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_almost_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_almost_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative naming for assertArrayAlmostEqual.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.assert_equal">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">assert_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative naming for assertArrayEqual.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.json_read_abinit_input">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">json_read_abinit_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_basename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.json_read_abinit_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.json_read_abinit_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AbinitInput" title="abipy.abio.inputs.AbinitInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AbinitInput</span></code></a> from the basename of the file in abipy/data/test_files.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.assert_input_equality">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">assert_input_equality</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_basename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_to_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.assert_input_equality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.assert_input_equality" title="Permalink to this definition">¶</a></dt>
<dd><p>Check equality between an input and a reference in test_files.
only input variables and structure are compared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_basename</strong> – base name of the reference file to test against in test_files</p></li>
<li><p><strong>input_to_test</strong> – <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AbinitInput" title="abipy.abio.inputs.AbinitInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AbinitInput</span></code></a> object to test</p></li>
<li><p><strong>rtol</strong> – passed to numpy.isclose for float comparison</p></li>
<li><p><strong>atol</strong> – passed to numpy.isclose for float comparison</p></li>
<li><p><strong>equal_nan</strong> – passed to numpy.isclose for float comparison</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>raises an assertion error if the two inputs are not the same</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.straceback">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">straceback</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.straceback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.straceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with the traceback.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_phonopy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">skip_if_not_phonopy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_phonopy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_phonopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if <a class="reference external" href="https://atztogo.github.io/phonopy/">phonopy</a> is not installed.
Use <code class="docutils literal notranslate"><span class="pre">version</span></code> and <code class="docutils literal notranslate"><span class="pre">op</span></code> to ask for a specific version</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_bolztrap2">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">skip_if_not_bolztrap2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;='</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_bolztrap2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_bolztrap2" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if bolztrap2 is not installed.
Use <code class="docutils literal notranslate"><span class="pre">version</span></code> and <code class="docutils literal notranslate"><span class="pre">op</span></code> to ask for a specific version</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_executable">
<code class="sig-name descname"><span class="pre">skip_if_not_executable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">executable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_executable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_executable" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if executable is not installed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.skip_if_not_pseudodojo">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">skip_if_not_pseudodojo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.skip_if_not_pseudodojo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.skip_if_not_pseudodojo" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise SkipTest if pseudodojo package is not installed.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.get_mock_module">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_mock_module</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_mock_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_mock_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return mock module for testing. Raises ImportError if not found.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.decode_with_MSON">
<code class="sig-name descname"><span class="pre">decode_with_MSON</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.decode_with_MSON"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.decode_with_MSON" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert obj into JSON assuming MSONable protocolo. Return new object decoded with MontyDecoder</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_input">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">abivalidate_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abinput</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">must_fail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of an <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AbinitInput" title="abipy.abio.inputs.AbinitInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AbinitInput</span></code></a> object
Print info to stdout if failure before raising AssertionError.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_multi">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">abivalidate_multi</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of a <a class="reference internal" href="abio_api.html#abipy.abio.inputs.MultiDataset" title="abipy.abio.inputs.MultiDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.MultiDataset</span></code></a> or a list of <a class="reference internal" href="abio_api.html#abipy.abio.inputs.AbinitInput" title="abipy.abio.inputs.AbinitInput"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.abio.inputs.AbinitInput</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_work">
<code class="sig-name descname"><span class="pre">abivalidate_work</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">work</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_work"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of the inputs of a <a class="reference internal" href="flowtk_api.html#abipy.flowtk.works.Work" title="abipy.flowtk.works.Work"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.works.Work</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.abivalidate_flow">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">abivalidate_flow</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.abivalidate_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.abivalidate_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke Abinit to test validity of the inputs of a <a class="reference internal" href="flowtk_api.html#abipy.flowtk.flows.Flow" title="abipy.flowtk.flows.Flow"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.flowtk.flows.Flow</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.get_gsinput_si">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_gsinput_si</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usepaw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_gsinput_si"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_gsinput_si" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and return a GS input file for silicon or a Task if <cite>as_task</cite></p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.testing.AbipyTest.get_gsinput_alas_ngkpt">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_gsinput_alas_ngkpt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngkpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usepaw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/testing.html#AbipyTest.get_gsinput_alas_ngkpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.testing.AbipyTest.get_gsinput_alas_ngkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and return a GS input file for AlAs or a Task if <cite>as_task</cite></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-abipy.core.site_symmetries">
<span id="site-symmetries-module"></span><h2><a class="toc-backref" href="#contents"><code class="xref py py-mod docutils literal notranslate"><span class="pre">site_symmetries</span></code> Module</a><a class="headerlink" href="#module-abipy.core.site_symmetries" title="Permalink to this headline">¶</a></h2>
<p>This module provides objects related to site symmetries</p>
<dl class="py class">
<dt id="abipy.core.site_symmetries.SiteSymmetries">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">abipy.core.site_symmetries.</span></code><code class="sig-name descname"><span class="pre">SiteSymmetries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/site_symmetries.html#SiteSymmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#abipy.core.mixins.Has_Structure" title="abipy.core.mixins.Has_Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.mixins.Has_Structure</span></code></a></p>
<dl class="py method">
<dt id="abipy.core.site_symmetries.SiteSymmetries.structure">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">structure</span></code><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#abipy.core.structure.Structure" title="abipy.core.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">abipy.core.structure.Structure</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.site_symmetries.SiteSymmetries.to_string">
<code class="sig-name descname"><span class="pre">to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/site_symmetries.html#SiteSymmetries.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation with verbosity level verbose.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.site_symmetries.SiteSymmetries.get_wyckoff_dataframe">
<code class="sig-name descname"><span class="pre">get_wyckoff_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/site_symmetries.html#SiteSymmetries.get_wyckoff_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries.get_wyckoff_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Find Wyckoff positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> – </p></li>
<li><p><strong>select_symbols</strong> – </p></li>
<li><p><strong>decimals</strong> – Number of decimal places to round to.
If decimals is negative, it specifies the number of positions to the left of the decimal point.</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with cartesian tensor components as columns and (inequivalent) sites along the rows.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.site_symmetries.SiteSymmetries.get_tensor_rank2_dataframe">
<code class="sig-name descname"><span class="pre">get_tensor_rank2_dataframe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/site_symmetries.html#SiteSymmetries.get_tensor_rank2_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries.get_tensor_rank2_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Use site symmetries to detect indipendent elements of rank 2 tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> – </p></li>
<li><p><strong>select_symbols</strong> – </p></li>
<li><p><strong>decimals</strong> – Number of decimal places to round to.
If decimals is negative, it specifies the number of positions to the left of the decimal point.</p></li>
<li><p><strong>verbose</strong> – Verbosity level</p></li>
</ul>
</dd>
</dl>
<p>Return <a class="reference external" href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.0.dev0+752.g49f33f0d)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with cartesian tensor components as columns and (inequivalent) sites along the rows.</p>
</dd></dl>

<dl class="py method">
<dt id="abipy.core.site_symmetries.SiteSymmetries.check_site_symmetries">
<code class="sig-name descname"><span class="pre">check_site_symmetries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/abipy/core/site_symmetries.html#SiteSymmetries.check_site_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abipy.core.site_symmetries.SiteSymmetries.check_site_symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether a set of tensors associated to the crystalline sites are compatible
with the space group symmetries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcart</strong> – (natom, 3, 3) array</p></li>
<li><p><strong>verbose</strong> – Verbosity level.</p></li>
</ul>
</dd>
</dl>
<p>Return: max_err</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="data_api.html" class="btn btn-neutral float-right" title="data Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="abio_api.html" class="btn btn-neutral float-left" title="abio Package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, M. Giantomassi and the AbiPy group.
      <span class="lastupdated">
        Last updated on May 07, 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>