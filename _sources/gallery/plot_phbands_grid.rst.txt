
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/plot_phbands_grid.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_gallery_plot_phbands_grid.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_phbands_grid.py:


Multiple phonon bands
=====================

This example shows how to plot several phonon band structures on a grid.

We use two files produced by anaddb:

    trf2_5.out_PHBST.nc: phonon frequencies on a q-path in the BZ (used to plot the band dispersion)
    trf2_5.out_PHDOS.nc: phonon DOS compute with anaddb.

See also tutorial/lesson_rf2.html

.. GENERATED FROM PYTHON SOURCE LINES 17-20

We start by defining a list with the paths to the PHBST.nc files
In this case, for simplicity, we use the same file but we must
use different labels when adding them to the plotter with the add_phbands method.

.. GENERATED FROM PYTHON SOURCE LINES 20-30

.. code-block:: default


    from abipy import abilab
    import abipy.data as abidata

    phbst_paths = 2 * [abidata.ref_file("trf2_5.out_PHBST.nc")]

    plotter = abilab.PhononBandsPlotter()
    plotter.add_phbands("AlAs", phbst_paths[0])
    plotter.add_phbands("Same AlAs", phbst_paths[1])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [31mWarning: file /Users/gmatteo/git_repos/abipy/abipy/data/refs/alas_phonons/trf2_5.out_PHBST.nc does not contain atomic_numbers.
    Particular methods need them![0m
    [31mWarning: file /Users/gmatteo/git_repos/abipy/abipy/data/refs/alas_phonons/trf2_5.out_PHBST.nc does not contain atomic_numbers.
    Particular methods need them![0m




.. GENERATED FROM PYTHON SOURCE LINES 31-33

At this point, we can use the plotter methods to plot the data:
To produce a grid plot:

.. GENERATED FROM PYTHON SOURCE LINES 33-36

.. code-block:: default


    plotter.gridplot(units="eV", title="GridPlot in eV")




.. image:: /gallery/images/sphx_glr_plot_phbands_grid_001.png
    :alt: GridPlot in eV, AlAs, Same AlAs
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Figure size 640x480 with 2 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 37-38

At this point, we can use the plotter methods to plot the data:

.. GENERATED FROM PYTHON SOURCE LINES 38-45

.. code-block:: default


    plotter.boxplot(units="cm-1", title="BoxPlot in cm-1")

    plotter.combiboxplot(units="Ha", title="CombiboxPlot in Ha")

    #plotter.combiplot(title="CombiPlot in eV")




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /gallery/images/sphx_glr_plot_phbands_grid_002.png
          :alt: BoxPlot in cm-1, AlAs, Same AlAs
          :class: sphx-glr-multi-img

    *

      .. image:: /gallery/images/sphx_glr_plot_phbands_grid_003.png
          :alt: CombiboxPlot in Ha
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Figure size 640x480 with 1 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 46-48

To plot a grid with band structures + DOS, use the optional argument `phdos` of add_phbands
The first subplot gets the band dispersion from phbst_paths[0] and the dos from phdos_paths[0]

.. GENERATED FROM PYTHON SOURCE LINES 48-60

.. code-block:: default


    phbst_paths = 3 * [abidata.ref_file("trf2_5.out_PHBST.nc")]
    phdos_paths = 3 * [abidata.ref_file("trf2_5.out_PHDOS.nc")]

    plotter = abilab.PhononBandsPlotter()
    plotter.add_phbands("AlAs phbands + DOS", phbst_paths[0], phdos=phdos_paths[0])
    plotter.add_phbands("Same-data", phbst_paths[1], phdos=phdos_paths[1])
    plotter.add_phbands("Same-data2", phbst_paths[2], phdos=phdos_paths[2])

    plotter.gridplot(units="cm-1", tight_layout=True, title="Bands + DOS in cm-1 with gridplot")

    #plotter.combiplot(title="Bands + DOS in eV with combiplot")



.. image:: /gallery/images/sphx_glr_plot_phbands_grid_004.png
    :alt: Bands + DOS in cm-1 with gridplot, AlAs phbands + DOS, Same-data, Same-data2
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [31mWarning: file /Users/gmatteo/git_repos/abipy/abipy/data/refs/alas_phonons/trf2_5.out_PHBST.nc does not contain atomic_numbers.
    Particular methods need them![0m
    [31mWarning: file /Users/gmatteo/git_repos/abipy/abipy/data/refs/alas_phonons/trf2_5.out_PHBST.nc does not contain atomic_numbers.
    Particular methods need them![0m
    [31mWarning: file /Users/gmatteo/git_repos/abipy/abipy/data/refs/alas_phonons/trf2_5.out_PHBST.nc does not contain atomic_numbers.
    Particular methods need them![0m

    <Figure size 640x480 with 6 Axes>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  6.809 seconds)


.. _sphx_glr_download_gallery_plot_phbands_grid.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_phbands_grid.py <plot_phbands_grid.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_phbands_grid.ipynb <plot_phbands_grid.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
